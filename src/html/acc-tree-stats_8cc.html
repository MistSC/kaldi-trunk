<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: bin/acc-tree-stats.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('acc-tree-stats_8cc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">acc-tree-stats.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="kaldi-common_8h_source.html">base/kaldi-common.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="common-utils_8h_source.html">util/common-utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="context-dep_8h_source.html">tree/context-dep.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="build-tree-utils_8h_source.html">tree/build-tree-utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="transition-model_8h_source.html">hmm/transition-model.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tree-accu_8h_source.html">hmm/tree-accu.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for acc-tree-stats.cc:</div>
<div class="dyncontent">
<div class="center"><img src="acc-tree-stats_8cc__incl.png" border="0" usemap="#bin_2acc-tree-stats_8cc" alt=""/></div>
<map name="bin_2acc-tree-stats_8cc" id="bin_2acc-tree-stats_8cc">
<area shape="rect" id="node2" href="kaldi-common_8h.html" title="base/kaldi&#45;common.h" alt="" coords="1474,536,1633,563"/><area shape="rect" id="node25" href="common-utils_8h.html" title="util/common&#45;utils.h" alt="" coords="480,155,625,181"/><area shape="rect" id="node39" href="context-dep_8h.html" title="tree/context&#45;dep.h" alt="" coords="1482,304,1622,331"/><area shape="rect" id="node44" href="build-tree-utils_8h.html" title="tree/build&#45;tree&#45;utils.h" alt="" coords="1452,80,1608,107"/><area shape="rect" id="node46" href="transition-model_8h.html" title="hmm/transition&#45;model.h" alt="" coords="1800,155,1977,181"/><area shape="rect" id="node49" href="tree-accu_8h.html" title="hmm/tree&#45;accu.h" alt="" coords="1633,80,1766,107"/><area shape="rect" id="node13" href="kaldi-utils_8h.html" title="base/kaldi&#45;utils.h" alt="" coords="1390,693,1518,720"/><area shape="rect" id="node16" href="kaldi-error_8h.html" title="base/kaldi&#45;error.h" alt="" coords="1704,619,1837,645"/><area shape="rect" id="node18" href="kaldi-types_8h.html" title="base/kaldi&#45;types.h" alt="" coords="2173,693,2312,720"/><area shape="rect" id="node20" href="io-funcs_8h.html" title="base/io&#45;funcs.h" alt="" coords="1030,619,1148,645"/><area shape="rect" id="node23" href="kaldi-math_8h.html" title="base/kaldi&#45;math.h" alt="" coords="2067,619,2204,645"/><area shape="rect" id="node22" href="io-funcs-inl_8h.html" title="base/io&#45;funcs&#45;inl.h" alt="" coords="1074,693,1213,720"/><area shape="rect" id="node26" href="parse-options_8h.html" title="util/parse&#45;options.h" alt="" coords="1218,379,1362,405"/><area shape="rect" id="node29" href="kaldi-io_8h.html" title="util/kaldi&#45;io.h" alt="" coords="286,453,388,480"/><area shape="rect" id="node31" href="simple-io-funcs_8h.html" title="util/simple&#45;io&#45;funcs.h" alt="" coords="44,379,197,405"/><area shape="rect" id="node32" href="kaldi-holder_8h.html" title="util/kaldi&#45;holder.h" alt="" coords="469,379,598,405"/><area shape="rect" id="node34" href="text-utils_8h.html" title="util/text&#45;utils.h" alt="" coords="724,453,837,480"/><area shape="rect" id="node36" href="kaldi-table_8h.html" title="util/kaldi&#45;table.h" alt="" coords="290,304,413,331"/><area shape="rect" id="node37" href="table-types_8h.html" title="util/table&#45;types.h" alt="" coords="488,229,617,256"/><area shape="rect" id="node28" href="options-itf_8h.html" title="itf/options&#45;itf.h" alt="" coords="1759,453,1872,480"/><area shape="rect" id="node30" href="kaldi-io-inl_8h.html" title="util/kaldi&#45;io&#45;inl.h" alt="" coords="247,536,368,563"/><area shape="rect" id="node35" href="kaldi-vector_8h.html" title="matrix/kaldi&#45;vector.h" alt="" coords="849,536,1001,563"/><area shape="rect" id="node38" href="matrix-lib_8h.html" title="matrix/matrix&#45;lib.h" alt="" coords="862,453,1001,480"/><area shape="rect" id="node40" href="context-dep-itf_8h.html" title="itf/context&#45;dep&#45;itf.h" alt="" coords="1540,453,1682,480"/><area shape="rect" id="node41" href="event-map_8h.html" title="tree/event&#45;map.h" alt="" coords="1178,453,1312,480"/><area shape="rect" id="node43" href="cluster-utils_8h.html" title="tree/cluster&#45;utils.h" alt="" coords="1056,379,1193,405"/><area shape="rect" id="node42" href="const-integer-set_8h.html" title="util/const&#45;integer\l&#45;set.h" alt="" coords="2166,529,2296,570"/><area shape="rect" id="node45" href="build-tree-questions_8h.html" title="tree/build&#45;tree&#45;questions.h" alt="" coords="1434,155,1626,181"/><area shape="rect" id="node48" href="hmm-topology_8h.html" title="hmm/hmm&#45;topology.h" alt="" coords="1854,229,2017,256"/><area shape="rect" id="node50" href="clusterable-classes_8h.html" title="tree/clusterable&#45;classes.h" alt="" coords="744,379,930,405"/></map>
</div>
</div>
<p><a href="acc-tree-stats_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="acc-tree-stats_8cc.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accumulate tree statistics for decision tree training.  <a href="#a0ddf1224851353fc92bfbff6f499fa97">More...</a><br/></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accumulate tree statistics for decision tree training. </p>
<p>The program reads in a feature archive, and the corresponding alignments, and generates the sufficient statistics for the decision tree creation. Context width and central phone position are used to identify the contexts.Transition model is used as an input to identify the PDF's and the phones. </p>

<p>Definition at line <a class="el" href="acc-tree-stats_8cc_source.html#l00034">34</a> of file <a class="el" href="acc-tree-stats_8cc_source.html">acc-tree-stats.cc</a>.</p>

<p>References <a class="el" href="tree-accu_8cc_source.html#l00036">kaldi::AccumulateTreeStats()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00754">kaldi::DeleteBuildTreeStats()</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l00613">SequentialTableReader&lt; Holder &gt;::Done()</a>, <a class="el" href="parse-options_8cc_source.html#l00202">ParseOptions::GetArg()</a>, <a class="el" href="parse-options_8h_source.html#l00127">ParseOptions::GetOptArg()</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l02175">RandomAccessTableReader&lt; Holder &gt;::HasKey()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l00583">SequentialTableReader&lt; Holder &gt;::Key()</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l00607">SequentialTableReader&lt; Holder &gt;::Next()</a>, <a class="el" href="parse-options_8cc_source.html#l00198">ParseOptions::NumArgs()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="parse-options_8cc_source.html#l00402">ParseOptions::PrintUsage()</a>, <a class="el" href="parse-options_8cc_source.html#l00311">ParseOptions::Read()</a>, <a class="el" href="transition-model_8cc_source.html#l00274">TransitionModel::Read()</a>, <a class="el" href="tree-accu_8h_source.html#l00047">AccumulateTreeStatsOptions::Register()</a>, <a class="el" href="parse-options_8cc_source.html#l00056">ParseOptions::Register()</a>, <a class="el" href="kaldi-io_8cc_source.html#l00680">Output::Stream()</a>, <a class="el" href="kaldi-io_8cc_source.html#l00801">Input::Stream()</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l02185">RandomAccessTableReader&lt; Holder &gt;::Value()</a>, <a class="el" href="kaldi-table-inl_8h_source.html#l00599">SequentialTableReader&lt; Holder &gt;::Value()</a>, and <a class="el" href="build-tree-utils_8cc_source.html#l00029">kaldi::WriteBuildTreeStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                 {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keyword">using namespace </span>kaldi;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a> <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span> *usage =</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="stringliteral">&quot;Accumulate statistics for phonetic-context tree building.\n&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="stringliteral">&quot;Usage:  acc-tree-stats [options] &lt;model-in&gt; &lt;features-rspecifier&gt; &lt;alignments-rspecifier&gt; &lt;tree-accs-out&gt;\n&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="stringliteral">&quot;e.g.: \n&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="stringliteral">&quot; acc-tree-stats 1.mdl scp:train.scp ark:1.ali 1.tacc\n&quot;</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordtype">bool</span> binary = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="structkaldi_1_1AccumulateTreeStatsOptions.html">AccumulateTreeStatsOptions</a> opts;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="classkaldi_1_1ParseOptions.html">ParseOptions</a> po(usage);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    po.Register(<span class="stringliteral">&quot;binary&quot;</span>, &amp;binary, <span class="stringliteral">&quot;Write output in binary mode&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    opts.<a class="code" href="structkaldi_1_1AccumulateTreeStatsOptions.html#a5a584da9b018440b2b3023e248f448fc">Register</a>(&amp;po);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    po.Read(argc, argv);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (po.NumArgs() != 4) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      po.PrintUsage();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      exit(1);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    std::string model_filename = po.GetArg(1),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        feature_rspecifier = po.GetArg(2),</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        alignment_rspecifier = po.GetArg(3),</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        accs_out_wxfilename = po.GetOptArg(4);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structkaldi_1_1AccumulateTreeStatsInfo.html">AccumulateTreeStatsInfo</a> acc_tree_stats_info(opts);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> trans_model;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordtype">bool</span> binary;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="classkaldi_1_1Input.html">Input</a> ki(model_filename, &amp;binary);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      trans_model.<a class="code" href="classkaldi_1_1TransitionModel.html#a8e7d2790fc7e94fe9780ccc937de1270">Read</a>(ki.Stream(), binary);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="comment">// There is more in this file but we don&#39;t need it.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classkaldi_1_1SequentialTableReader.html">SequentialBaseFloatMatrixReader</a> feature_reader(feature_rspecifier);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classkaldi_1_1RandomAccessTableReader.html">RandomAccessInt32VectorReader</a> alignment_reader(alignment_rspecifier);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::map&lt;EventType, GaussClusterable*&gt; tree_stats;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordtype">int</span> num_done = 0, num_no_alignment = 0, num_other_error = 0;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">for</span> (; !feature_reader.Done(); feature_reader.Next()) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      std::string key = feature_reader.Key();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <span class="keywordflow">if</span> (!alignment_reader.HasKey(key)) {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        num_no_alignment++;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> &amp;mat = feature_reader.Value();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;alignment = alignment_reader.Value(key);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordflow">if</span> (alignment.size() != mat.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>()) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Alignments has wrong size &quot;</span>&lt;&lt; (alignment.size())&lt;&lt;<span class="stringliteral">&quot; vs. &quot;</span>&lt;&lt; (mat.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          num_other_error++;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        <a class="code" href="namespacekaldi.html#a8be6e4d8555478bf47183acd8d8337ee">AccumulateTreeStats</a>(trans_model,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                            acc_tree_stats_info,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                            alignment,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                            mat,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                            &amp;tree_stats);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        num_done++;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">if</span> (num_done % 1000 == 0)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Processed &quot;</span> &lt;&lt; num_done &lt;&lt; <span class="stringliteral">&quot; utterances.&quot;</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="group__tree__group.html#gab329e7820899feed82ce631806c61975">BuildTreeStatsType</a> stats;  <span class="comment">// vectorized form.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (std::map&lt;EventType, GaussClusterable*&gt;::const_iterator iter = tree_stats.begin();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         iter != tree_stats.end();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;         ++iter) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      stats.push_back(std::make_pair(iter-&gt;first, iter-&gt;second));</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    tree_stats.clear();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="classkaldi_1_1Output.html">Output</a> ko(accs_out_wxfilename, binary);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="group__tree__group__lower.html#ga9a15a2d49fdd5c582a8cf297d318bba9">WriteBuildTreeStats</a>(ko.Stream(), binary, stats);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Accumulated stats for &quot;</span> &lt;&lt; num_done &lt;&lt; <span class="stringliteral">&quot; files, &quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;              &lt;&lt; num_no_alignment &lt;&lt; <span class="stringliteral">&quot; failed due to no alignment, &quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;              &lt;&lt; num_other_error &lt;&lt; <span class="stringliteral">&quot; failed for other reasons.&quot;</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Number of separate stats (context-dependent states) is &quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              &lt;&lt; stats.size();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="group__tree__group__lower.html#ga33e6c91c3ab79436fae03a307d89fa5d">DeleteBuildTreeStats</a>(&amp;stats);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (num_done != 0) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  } <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception &amp;e) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    std::cerr &lt;&lt; e.what();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1AccumulateTreeStatsOptions_html_a5a584da9b018440b2b3023e248f448fc"><div class="ttname"><a href="structkaldi_1_1AccumulateTreeStatsOptions.html#a5a584da9b018440b2b3023e248f448fc">kaldi::AccumulateTreeStatsOptions::Register</a></div><div class="ttdeci">void Register(OptionsItf *opts)</div><div class="ttdef"><b>Definition:</b> <a href="tree-accu_8h_source.html#l00047">tree-accu.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1Input_html"><div class="ttname"><a href="classkaldi_1_1Input.html">kaldi::Input</a></div><div class="ttdef"><b>Definition:</b> <a href="kaldi-io_8h_source.html#l00188">kaldi-io.h:188</a></div></div>
<div class="ttc" id="namespacekaldi_html_a8be6e4d8555478bf47183acd8d8337ee"><div class="ttname"><a href="namespacekaldi.html#a8be6e4d8555478bf47183acd8d8337ee">kaldi::AccumulateTreeStats</a></div><div class="ttdeci">void AccumulateTreeStats(const TransitionModel &amp;trans_model, const AccumulateTreeStatsInfo &amp;info, const std::vector&lt; int32 &gt; &amp;alignment, const Matrix&lt; BaseFloat &gt; &amp;features, std::map&lt; EventType, GaussClusterable * &gt; *stats)</div><div class="ttdoc">Accumulates the stats needed for training context-dependency trees (in the &quot;normal&quot; way)...</div><div class="ttdef"><b>Definition:</b> <a href="tree-accu_8cc_source.html#l00036">tree-accu.cc:36</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html"><div class="ttname"><a href="classkaldi_1_1Matrix.html">kaldi::Matrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="structkaldi_1_1AccumulateTreeStatsInfo_html"><div class="ttname"><a href="structkaldi_1_1AccumulateTreeStatsInfo.html">kaldi::AccumulateTreeStatsInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="tree-accu_8h_source.html#l00063">tree-accu.h:63</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a></div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8h_source.html#l00121">transition-model.h:121</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga33e6c91c3ab79436fae03a307d89fa5d"><div class="ttname"><a href="group__tree__group__lower.html#ga33e6c91c3ab79436fae03a307d89fa5d">kaldi::DeleteBuildTreeStats</a></div><div class="ttdeci">void DeleteBuildTreeStats(BuildTreeStatsType *stats)</div><div class="ttdoc">This frees the Clusterable* pointers in &quot;stats&quot;, where non-NULL, and sets them to NULL...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00754">build-tree-utils.cc:754</a></div></div>
<div class="ttc" id="classkaldi_1_1RandomAccessTableReader_html"><div class="ttname"><a href="classkaldi_1_1RandomAccessTableReader.html">kaldi::RandomAccessTableReader</a></div><div class="ttdoc">Allows random access to a collection of objects in an archive or script file; see The Table concept...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-table_8h_source.html#l00231">kaldi-table.h:231</a></div></div>
<div class="ttc" id="classkaldi_1_1ParseOptions_html"><div class="ttname"><a href="classkaldi_1_1ParseOptions.html">kaldi::ParseOptions</a></div><div class="ttdoc">The class ParseOptions is for parsing command-line options; see Parsing command-line options for more...</div><div class="ttdef"><b>Definition:</b> <a href="parse-options_8h_source.html#l00036">parse-options.h:36</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a8e7d2790fc7e94fe9780ccc937de1270"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a8e7d2790fc7e94fe9780ccc937de1270">kaldi::TransitionModel::Read</a></div><div class="ttdeci">void Read(std::istream &amp;is, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8cc_source.html#l00274">transition-model.cc:274</a></div></div>
<div class="ttc" id="classkaldi_1_1SequentialTableReader_html"><div class="ttname"><a href="classkaldi_1_1SequentialTableReader.html">kaldi::SequentialTableReader</a></div><div class="ttdoc">A templated class for reading objects sequentially from an archive or script file; see The Table conc...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-table_8h_source.html#l00285">kaldi-table.h:285</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1Output_html"><div class="ttname"><a href="classkaldi_1_1Output.html">kaldi::Output</a></div><div class="ttdef"><b>Definition:</b> <a href="kaldi-io_8h_source.html#l00122">kaldi-io.h:122</a></div></div>
<div class="ttc" id="structkaldi_1_1AccumulateTreeStatsOptions_html"><div class="ttname"><a href="structkaldi_1_1AccumulateTreeStatsOptions.html">kaldi::AccumulateTreeStatsOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="tree-accu_8h_source.html#l00036">tree-accu.h:36</a></div></div>
<div class="ttc" id="group__tree__group_html_gab329e7820899feed82ce631806c61975"><div class="ttname"><a href="group__tree__group.html#gab329e7820899feed82ce631806c61975">kaldi::BuildTreeStatsType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventType, Clusterable * &gt; &gt; BuildTreeStatsType</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-questions_8h_source.html#l00032">build-tree-questions.h:32</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga9a15a2d49fdd5c582a8cf297d318bba9"><div class="ttname"><a href="group__tree__group__lower.html#ga9a15a2d49fdd5c582a8cf297d318bba9">kaldi::WriteBuildTreeStats</a></div><div class="ttdeci">void WriteBuildTreeStats(std::ostream &amp;os, bool binary, const BuildTreeStatsType &amp;stats)</div><div class="ttdoc">Writes BuildTreeStats object. This works even if pointers are NULL. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00029">build-tree-utils.cc:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_2ea30aa2956a8db99dd22aa5e597f384.html">bin</a></li><li class="navelem"><a class="el" href="acc-tree-stats_8cc.html">acc-tree-stats.cc</a></li>
    <li class="footer">Generated on Tue Apr 26 2016 14:54:43 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
