<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: LatticeWordAligner::ComputationState Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1LatticeWordAligner_1_1ComputationState.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LatticeWordAligner::ComputationState Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for LatticeWordAligner::ComputationState:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1LatticeWordAligner_1_1ComputationState__coll__graph.png" border="0" usemap="#LatticeWordAligner_1_1ComputationState_coll__map" alt="Collaboration graph"/></div>
<map name="LatticeWordAligner_1_1ComputationState_coll__map" id="LatticeWordAligner_1_1ComputationState_coll__map">
<area shape="rect" id="node3" href="classfst_1_1LatticeWeightTpl.html" title="LatticeWeightTpl\&lt; BaseFloat \&gt;" alt="" coords="153,109,372,136"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5c547c2b0e31d2f656e8f96cbfb056a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a5c547c2b0e31d2f656e8f96cbfb056a8">Advance</a> (const <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> &amp;arc, <a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a> *weight)</td></tr>
<tr class="memdesc:a5c547c2b0e31d2f656e8f96cbfb056a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The state of the computation in which,.  <a href="#a5c547c2b0e31d2f656e8f96cbfb056a8">More...</a><br/></td></tr>
<tr class="separator:a5c547c2b0e31d2f656e8f96cbfb056a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb5e72e53509a0303f66387b37c90696"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#aeb5e72e53509a0303f66387b37c90696">OutputArc</a> (const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;info, const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *arc_out, bool *error)</td></tr>
<tr class="memdesc:aeb5e72e53509a0303f66387b37c90696"><td class="mdescLeft">&#160;</td><td class="mdescRight">If it can output a whole word, it will do so, will put it in arc_out, and return true; else it will return false.  <a href="#aeb5e72e53509a0303f66387b37c90696">More...</a><br/></td></tr>
<tr class="separator:aeb5e72e53509a0303f66387b37c90696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8dd46e45a9a9268c5d755922ee5ccd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a6d8dd46e45a9a9268c5d755922ee5ccd">OutputSilenceArc</a> (const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;info, const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *arc_out, bool *error)</td></tr>
<tr class="separator:a6d8dd46e45a9a9268c5d755922ee5ccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad06930fff186c75ac536d094b78c4b08"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ad06930fff186c75ac536d094b78c4b08">OutputOnePhoneWordArc</a> (const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;info, const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *arc_out, bool *error)</td></tr>
<tr class="separator:ad06930fff186c75ac536d094b78c4b08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11cc7a2e9b40e9e89195dd62f42e4a18"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a11cc7a2e9b40e9e89195dd62f42e4a18">OutputNormalWordArc</a> (const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;info, const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *arc_out, bool *error)</td></tr>
<tr class="memdesc:a11cc7a2e9b40e9e89195dd62f42e4a18"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function tries to see if it can output a normal word arc&ndash; one with at least two phones in it.  <a href="#a11cc7a2e9b40e9e89195dd62f42e4a18">More...</a><br/></td></tr>
<tr class="separator:a11cc7a2e9b40e9e89195dd62f42e4a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357657ded604ecb97b76251146f7ac75"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">IsEmpty</a> ()</td></tr>
<tr class="separator:a357657ded604ecb97b76251146f7ac75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb6f9973478911accaa98aa294025d54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#acb6f9973478911accaa98aa294025d54">FinalWeight</a> ()</td></tr>
<tr class="memdesc:acb6f9973478911accaa98aa294025d54"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#acb6f9973478911accaa98aa294025d54" title="FinalWeight() will return &quot;weight&quot; if both transition_ids and word_labels are empty, otherwise it will return Weight::Zero(). ">FinalWeight()</a> will return "weight" if both transition_ids and word_labels are empty, otherwise it will return Weight::Zero().  <a href="#acb6f9973478911accaa98aa294025d54">More...</a><br/></td></tr>
<tr class="separator:acb6f9973478911accaa98aa294025d54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addcfdaf87d4a0c73a427e67ba10d196c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#addcfdaf87d4a0c73a427e67ba10d196c">OutputArcForce</a> (const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;info, const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *arc_out, bool *error)</td></tr>
<tr class="memdesc:addcfdaf87d4a0c73a427e67ba10d196c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function may be called when you reach the end of the lattice and this structure hasn't voluntarily output words using "OutputArc".  <a href="#addcfdaf87d4a0c73a427e67ba10d196c">More...</a><br/></td></tr>
<tr class="separator:addcfdaf87d4a0c73a427e67ba10d196c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06a372dc4de2a58546192dbd7def3f20"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a06a372dc4de2a58546192dbd7def3f20">Hash</a> () const </td></tr>
<tr class="separator:a06a372dc4de2a58546192dbd7def3f20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac12a79b088372bc5e6da38df1cd848e7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ac12a79b088372bc5e6da38df1cd848e7">operator==</a> (const <a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> &amp;other) const </td></tr>
<tr class="separator:ac12a79b088372bc5e6da38df1cd848e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c6ea0da80e6a88c3b39a683325a9072"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a9c6ea0da80e6a88c3b39a683325a9072">ComputationState</a> ()</td></tr>
<tr class="separator:a9c6ea0da80e6a88c3b39a683325a9072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43112282121c619d98acd46f059f0f7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a43112282121c619d98acd46f059f0f7c">ComputationState</a> (const <a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> &amp;other)</td></tr>
<tr class="separator:a43112282121c619d98acd46f059f0f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a3fa41eff79c8a87c04278d55ca6caf55"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a></td></tr>
<tr class="separator:a3fa41eff79c8a87c04278d55ca6caf55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af87bd57b9f051fc0aa6383f159dd808e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a></td></tr>
<tr class="separator:af87bd57b9f051fc0aa6383f159dd808e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae685d3279f8c4fb028164f1624ca25f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a></td></tr>
<tr class="separator:ae685d3279f8c4fb028164f1624ca25f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00032">32</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9c6ea0da80e6a88c3b39a683325a9072"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00125">125</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;: <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>(<a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>()) { } <span class="comment">// initial state.</span></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43112282121c619d98acd46f059f0f7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00126">126</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                   :</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>(other.transition_ids_), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>(other.word_labels_),</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>(other.weight_) { }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a5c547c2b0e31d2f656e8f96cbfb056a8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Advance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> &amp;&#160;</td>
          <td class="paramname"><em>arc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a> *&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The state of the computation in which,. </p>
<p>along a single path in the lattice, we work out the word boundaries and output aligned arcs. Advance the computation state by adding the symbols and weights from this arc. We'll put the weight on the output arc; this helps keep the state-space smaller. </p>

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00040">40</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="lattice-weight_8h_source.html#l00081">LatticeWeightTpl&lt; BaseFloat &gt;::One()</a>, <a class="el" href="lattice-weight_8h_source.html#l00332">fst::Times()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00130">LatticeWordAligner::ComputationState::transition_ids_</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00132">LatticeWordAligner::ComputationState::weight_</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00131">LatticeWordAligner::ComputationState::word_labels_</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00201">LatticeWordAligner::ProcessQueueElement()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                                                                      {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;<span class="keywordtype">string</span> = arc.weight.String();</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.insert(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.end(),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                             <span class="keywordtype">string</span>.begin(), <span class="keywordtype">string</span>.end());</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">if</span> (arc.ilabel != 0) <span class="comment">// note: arc.ilabel==arc.olabel (acceptor)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.push_back(arc.ilabel);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      *weight = <a class="code" href="namespacefst.html#a0807071c6ceb397bc35281fce74ff8a7">Times</a>(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, arc.weight.Weight());</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
<div class="ttc" id="namespacefst_html_a0807071c6ceb397bc35281fce74ff8a7"><div class="ttname"><a href="namespacefst.html#a0807071c6ceb397bc35281fce74ff8a7">fst::Times</a></div><div class="ttdeci">LatticeWeightTpl&lt; FloatType &gt; Times(const LatticeWeightTpl&lt; FloatType &gt; &amp;w1, const LatticeWeightTpl&lt; FloatType &gt; &amp;w2)</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00332">lattice-weight.h:332</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb6f9973478911accaa98aa294025d54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a> FinalWeight </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#acb6f9973478911accaa98aa294025d54" title="FinalWeight() will return &quot;weight&quot; if both transition_ids and word_labels are empty, otherwise it will return Weight::Zero(). ">FinalWeight()</a> will return "weight" if both transition_ids and word_labels are empty, otherwise it will return Weight::Zero(). </p>

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00089">89</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="word-align-lattice_8cc_source.html#l00084">LatticeWordAligner::ComputationState::IsEmpty()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00132">LatticeWordAligner::ComputationState::weight_</a>, and <a class="el" href="lattice-weight_8h_source.html#l00076">LatticeWeightTpl&lt; BaseFloat &gt;::Zero()</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00172">LatticeWordAligner::ProcessFinal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ <span class="keywordflow">return</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">IsEmpty</a>() ? <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> : <a class="code" href="classfst_1_1LatticeWeightTpl.html#ab613ad9709d4e8373dd2ab8426915baa">LatticeWeight::Zero</a>()); }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a357657ded604ecb97b76251146f7ac75"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">kaldi::LatticeWordAligner::ComputationState::IsEmpty</a></div><div class="ttdeci">bool IsEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00084">word-align-lattice.cc:84</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_ab613ad9709d4e8373dd2ab8426915baa"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#ab613ad9709d4e8373dd2ab8426915baa">fst::LatticeWeightTpl&lt; BaseFloat &gt;::Zero</a></div><div class="ttdeci">static const LatticeWeightTpl Zero()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00076">lattice-weight.h:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06a372dc4de2a58546192dbd7def3f20"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Hash </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00108">108</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="word-align-lattice_8cc_source.html#l00130">LatticeWordAligner::ComputationState::transition_ids_</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00131">LatticeWordAligner::ComputationState::word_labels_</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00144">LatticeWordAligner::TupleHash::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      VectorHasher&lt;int32&gt; vh;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">return</span> vh(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>) + 90647 * vh(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="comment">// 90647 is an arbitrary largish prime number.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">// We don&#39;t bother including the weight in the hash--</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">// we don&#39;t really expect duplicates with the same vectors</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// but different weights, and anyway, this is only an</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">// efficiency issue.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a357657ded604ecb97b76251146f7ac75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool IsEmpty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00084">84</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="word-align-lattice_8cc_source.html#l00130">LatticeWordAligner::ComputationState::transition_ids_</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00131">LatticeWordAligner::ComputationState::word_labels_</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00089">LatticeWordAligner::ComputationState::FinalWeight()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00172">LatticeWordAligner::ProcessFinal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;{ <span class="keywordflow">return</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty() &amp;&amp; <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty()); }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac12a79b088372bc5e6da38df1cd848e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool operator== </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00119">119</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="word-align-lattice_8cc_source.html#l00130">LatticeWordAligner::ComputationState::transition_ids_</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00132">LatticeWordAligner::ComputationState::weight_</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00131">LatticeWordAligner::ComputationState::word_labels_</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                           {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">return</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a> == other.transition_ids_</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;              &amp;&amp; <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a> == other.word_labels_</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              &amp;&amp; <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> == other.weight_);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb5e72e53509a0303f66387b37c90696"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool OutputArc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *&#160;</td>
          <td class="paramname"><em>arc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>If it can output a whole word, it will do so, will put it in arc_out, and return true; else it will return false. </p>
<p>If it detects an error condition and *error = false, it will set *error to true and print a warning. In this case it may or may not [output an arc and return true], depending on what we think is most likely the right thing to do. Of course once *error is set, something has gone wrong so don't trust the output too fully. Note: the "next_state" of the arc will not be set, you have to do that yourself. </p>

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00059">59</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="word-align-lattice_8cc_source.html#l00443">LatticeWordAligner::ComputationState::OutputNormalWordArc()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00392">LatticeWordAligner::ComputationState::OutputOnePhoneWordArc()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00346">LatticeWordAligner::ComputationState::OutputSilenceArc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// order of this ||-expression doesn&#39;t matter for</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">// function behavior, only for efficiency, since the</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="comment">// cases are disjoint.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a11cc7a2e9b40e9e89195dd62f42e4a18">OutputNormalWordArc</a>(info, tmodel, arc_out, error) ||</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a6d8dd46e45a9a9268c5d755922ee5ccd">OutputSilenceArc</a>(info, tmodel, arc_out, error) ||</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ad06930fff186c75ac536d094b78c4b08">OutputOnePhoneWordArc</a>(info, tmodel, arc_out, error);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a11cc7a2e9b40e9e89195dd62f42e4a18"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a11cc7a2e9b40e9e89195dd62f42e4a18">kaldi::LatticeWordAligner::ComputationState::OutputNormalWordArc</a></div><div class="ttdeci">bool OutputNormalWordArc(const WordBoundaryInfo &amp;info, const TransitionModel &amp;tmodel, CompactLatticeArc *arc_out, bool *error)</div><div class="ttdoc">This function tries to see if it can output a normal word arcâ€“ one with at least two phones in it...</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00443">word-align-lattice.cc:443</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a6d8dd46e45a9a9268c5d755922ee5ccd"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a6d8dd46e45a9a9268c5d755922ee5ccd">kaldi::LatticeWordAligner::ComputationState::OutputSilenceArc</a></div><div class="ttdeci">bool OutputSilenceArc(const WordBoundaryInfo &amp;info, const TransitionModel &amp;tmodel, CompactLatticeArc *arc_out, bool *error)</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00346">word-align-lattice.cc:346</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ad06930fff186c75ac536d094b78c4b08"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ad06930fff186c75ac536d094b78c4b08">kaldi::LatticeWordAligner::ComputationState::OutputOnePhoneWordArc</a></div><div class="ttdeci">bool OutputOnePhoneWordArc(const WordBoundaryInfo &amp;info, const TransitionModel &amp;tmodel, CompactLatticeArc *arc_out, bool *error)</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00392">word-align-lattice.cc:392</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addcfdaf87d4a0c73a427e67ba10d196c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutputArcForce </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *&#160;</td>
          <td class="paramname"><em>arc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function may be called when you reach the end of the lattice and this structure hasn't voluntarily output words using "OutputArc". </p>
<p>If <a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">IsEmpty()</a> == false, then you can call this function and it will output an arc. The only non-error state in which this happens, is when a word (or silence) has ended, but we don't know that it's ended because we haven't seen the first transition-id from the next word. Otherwise (error state), the output will consist of partial words, and this will only happen for lattices that were somehow broken, i.e. had not reached the final state. </p>

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00554">554</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="transition-model_8cc_source.html#l00211">TransitionModel::IsFinal()</a>, <a class="el" href="word-align-lattice-lexicon_8cc_source.html#l00745">kaldi::IsPlausibleWord()</a>, <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="word-align-lattice_8h_source.html#l00142">WordBoundaryInfo::kNonWordPhone</a>, <a class="el" href="lattice-weight_8h_source.html#l00081">LatticeWeightTpl&lt; BaseFloat &gt;::One()</a>, <a class="el" href="word-align-lattice_8h_source.html#l00158">WordBoundaryInfo::partial_word_label</a>, <a class="el" href="word-align-lattice_8h_source.html#l00162">WordBoundaryInfo::reorder</a>, <a class="el" href="word-align-lattice_8h_source.html#l00156">WordBoundaryInfo::silence_label</a>, <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>, and <a class="el" href="word-align-lattice_8h_source.html#l00147">WordBoundaryInfo::TypeOfPhone()</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00172">LatticeWordAligner::ProcessFinal()</a>.</p>
<div class="fragment"><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                                              {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">IsEmpty</a>());</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty()</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      &amp;&amp; !<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty()) { <span class="comment">// We have at least one word to</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">// output, and some transition-ids.  We assume that the normal OutputArc was called</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// and failed, so this means we didn&#39;t see the end of that</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="comment">// word.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> word = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>[0];</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (! *error &amp;&amp; !<a class="code" href="namespacekaldi.html#aae51900e622898f38269b92e623d2b72">IsPlausibleWord</a>(info, tmodel, <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>)) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Invalid word at end of lattice [partial lattice, forced out?]&quot;</span>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a> cw(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(word, word, cw, fst::kNoStateId);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.clear();</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin()+1);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty() &amp;&amp; <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty()) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="comment">// We won&#39;t create arcs with these word labels on, as most likely</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="comment">// this will cause errors down the road.  This is an error</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="comment">// condition anyway, in some sense.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span> (! *error) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Discarding word-ids at the end of a sentence, &quot;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;          <span class="stringliteral">&quot;that don&#39;t have alignments.&quot;</span>;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a> cw(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// This creates an epsilon arc with a weight on it, but</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">// no transition-ids since the vector is empty.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// The word labels are discarded.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(0, 0, cw, fst::kNoStateId);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>();</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.clear();</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty() &amp;&amp; <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty()) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// Transition-ids but no word label-- either silence or partial word.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[0]);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">if</span> (info.TypeOfPhone(first_phone) == <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f">WordBoundaryInfo::kNonWordPhone</a>) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">// first phone is silence...</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (first_phone != tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.back())</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;          &amp;&amp; ! *error) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="comment">// Phone changed-- this is a code error, because the regular OutputArc</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="comment">// should have output an arc (a silence arc) if that phone finished.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">// So we make it fatal.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Broken silence arc at end of utterance (the phone &quot;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="stringliteral">&quot;changed); code error&quot;</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">if</span> (!*error) { <span class="comment">// Check that it ends at the end state of silence; error otherwise.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.size() - 1;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (info.reorder)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;          <span class="keywordflow">while</span>(tmodel.IsSelfLoop(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i]) &amp;&amp; i &gt; 0) i--;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">if</span> (!tmodel.IsFinal(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i])) {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;          *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Broken silence arc at end of utterance (does not &quot;</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;              <span class="stringliteral">&quot;reach end of silence)&quot;</span>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a> cw(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(info.silence_label, info.silence_label,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                   cw, fst::kNoStateId);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="comment">// Not silence phone -- treat as partial word (with no word label).</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <span class="comment">// This is in itself an error condition, i.e. the lattice was maybe</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">// forced out.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">if</span> (! *error) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Partial word detected at end of utterance&quot;</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a> cw(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>);</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(info.partial_word_label, info.partial_word_label,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                                   cw, fst::kNoStateId);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.clear();</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>();</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Code error, word-aligning lattice&quot;</span>; <span class="comment">// this shouldn&#39;t</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="comment">// be able to happen; we don&#39;t call this function of they&#39;re both empty.</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
<div class="ttc" id="namespacekaldi_html_a374d09d7b7a9a638aee58cc1cc0ca92e"><div class="ttname"><a href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">kaldi::CompactLatticeWeight</a></div><div class="ttdeci">fst::CompactLatticeWeightTpl&lt; LatticeWeight, int32 &gt; CompactLatticeWeight</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00035">kaldi-lattice.h:35</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a357657ded604ecb97b76251146f7ac75"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a357657ded604ecb97b76251146f7ac75">kaldi::LatticeWordAligner::ComputationState::IsEmpty</a></div><div class="ttdeci">bool IsEmpty()</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00084">word-align-lattice.cc:84</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_aae51900e622898f38269b92e623d2b72"><div class="ttname"><a href="namespacekaldi.html#aae51900e622898f38269b92e623d2b72">kaldi::IsPlausibleWord</a></div><div class="ttdeci">static bool IsPlausibleWord(const WordAlignLatticeLexiconInfo &amp;lexicon_info, const TransitionModel &amp;tmodel, int32 word_id, const std::vector&lt; int32 &gt; &amp;transition_ids)</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice-lexicon_8cc_source.html#l00745">word-align-lattice-lexicon.cc:745</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f">kaldi::WordBoundaryInfo::kNonWordPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00142">word-align-lattice.h:142</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a33b7ea55be82ee6bab64430dd93cbcba"><div class="ttname"><a href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a></div><div class="ttdeci">fst::ArcTpl&lt; CompactLatticeWeight &gt; CompactLatticeArc</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00042">kaldi-lattice.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a11cc7a2e9b40e9e89195dd62f42e4a18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OutputNormalWordArc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *&#160;</td>
          <td class="paramname"><em>arc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function tries to see if it can output a normal word arc&ndash; one with at least two phones in it. </p>

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00443">443</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="transition-model_8cc_source.html#l00211">TransitionModel::IsFinal()</a>, <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="word-align-lattice_8h_source.html#l00138">WordBoundaryInfo::kWordBeginPhone</a>, <a class="el" href="word-align-lattice_8h_source.html#l00139">WordBoundaryInfo::kWordEndPhone</a>, <a class="el" href="word-align-lattice_8h_source.html#l00141">WordBoundaryInfo::kWordInternalPhone</a>, <a class="el" href="lattice-weight_8h_source.html#l00081">LatticeWeightTpl&lt; BaseFloat &gt;::One()</a>, <a class="el" href="word-align-lattice_8h_source.html#l00162">WordBoundaryInfo::reorder</a>, <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>, and <a class="el" href="word-align-lattice_8h_source.html#l00147">WordBoundaryInfo::TypeOfPhone()</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00059">LatticeWordAligner::ComputationState::OutputArc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                              {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> begin_phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[0]);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">if</span> (info.TypeOfPhone(begin_phone) != <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa28b98ba667f75d077c4cd9742bb1b8f6">WordBoundaryInfo::kWordBeginPhone</a>)</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// we assume the start of transition_ids_ is the start of the phone.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">// this is a precondition.</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordtype">size_t</span> len = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.size(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// Eat up the transition-ids of this word-begin phone until we get to the</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// &quot;final&quot; transition-id.  [there may be self-loops following this though,</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="comment">// if reorder==true]</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len &amp;&amp; !tmodel.IsFinal(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]); i++);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  i++; <span class="comment">// Skip over this final-transition.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="keywordflow">if</span> (info.reorder) <span class="comment">// Skip over any reordered self-loops for this final-transition</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">for</span> (; i &lt; len &amp;&amp; tmodel.IsSelfLoop(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i]); i++);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i-1]) != begin_phone</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      &amp;&amp; ! *error) { <span class="comment">// another check.</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed unexpectedly in lattice &quot;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="stringliteral">&quot;[broken lattice or mismatched model?]&quot;</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Now keep going till we hit a word-ending phone.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// Note: we don&#39;t expect anything except word-internal phones</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// here, but we&#39;ll just print a warning if we get something</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// else.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">for</span> (; i &lt; len; i++) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i]);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (info.TypeOfPhone(this_phone) == <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa2ba288ea482bb493c320ab0a16137aa9">WordBoundaryInfo::kWordEndPhone</a>)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (info.TypeOfPhone(this_phone) != <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baaeffcf9962747f0fbc7da394d8b45dbfb">WordBoundaryInfo::kWordInternalPhone</a></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        &amp;&amp; !*error) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Unexpected phone &quot;</span> &lt;&lt; this_phone</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot; found inside a word.&quot;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  }</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// OK, we hit a word-ending phone.  Continue till we get to</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// a &quot;final-transition&quot;.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// this variable just used for checks.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> final_phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i]);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordflow">for</span> (; i &lt; len; i++) {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i]);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (this_phone != final_phone &amp;&amp; ! *error) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed before final transition-id found &quot;</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          <span class="stringliteral">&quot;[broken lattice or mismatched model or wrong --reorder option?]&quot;</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (tmodel.IsFinal(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i])) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  i++;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// We got to the final-transition of the final phone;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// if reorder==true, continue eating up the self-loop.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> (info.reorder == <span class="keyword">true</span>)</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">while</span> (i &lt; len &amp;&amp; tmodel.IsSelfLoop(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i])) i++;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="keywordflow">if</span> (tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i-1]) != final_phone</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      &amp;&amp; ! *error) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed while following final self-loop &quot;</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="stringliteral">&quot;[broken lattice or mismatched model or wrong --reorder option?]&quot;</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// OK, we&#39;re ready to output the word.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// Interpret i as the number of transition-ids to consume.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  std::vector&lt;int32&gt; tids_out(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// consumed transition ids from our internal state.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> word = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>[0];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(word, word,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                               <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a>(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, tids_out),</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                               fst::kNoStateId);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>); <span class="comment">// delete these</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin()+1); <span class="comment">// remove the word we output.</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>(); <span class="comment">// we just output the weight.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baa2ba288ea482bb493c320ab0a16137aa9"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa2ba288ea482bb493c320ab0a16137aa9">kaldi::WordBoundaryInfo::kWordEndPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00139">word-align-lattice.h:139</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
<div class="ttc" id="namespacekaldi_html_a374d09d7b7a9a638aee58cc1cc0ca92e"><div class="ttname"><a href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">kaldi::CompactLatticeWeight</a></div><div class="ttdeci">fst::CompactLatticeWeightTpl&lt; LatticeWeight, int32 &gt; CompactLatticeWeight</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00035">kaldi-lattice.h:35</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baaeffcf9962747f0fbc7da394d8b45dbfb"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baaeffcf9962747f0fbc7da394d8b45dbfb">kaldi::WordBoundaryInfo::kWordInternalPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00141">word-align-lattice.h:141</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a33b7ea55be82ee6bab64430dd93cbcba"><div class="ttname"><a href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a></div><div class="ttdeci">fst::ArcTpl&lt; CompactLatticeWeight &gt; CompactLatticeArc</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00042">kaldi-lattice.h:42</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baa28b98ba667f75d077c4cd9742bb1b8f6"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa28b98ba667f75d077c4cd9742bb1b8f6">kaldi::WordBoundaryInfo::kWordBeginPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00138">word-align-lattice.h:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad06930fff186c75ac536d094b78c4b08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OutputOnePhoneWordArc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *&#160;</td>
          <td class="paramname"><em>arc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00392">392</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="transition-model_8cc_source.html#l00211">TransitionModel::IsFinal()</a>, <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="word-align-lattice_8h_source.html#l00140">WordBoundaryInfo::kWordBeginAndEndPhone</a>, <a class="el" href="lattice-weight_8h_source.html#l00081">LatticeWeightTpl&lt; BaseFloat &gt;::One()</a>, <a class="el" href="word-align-lattice_8h_source.html#l00162">WordBoundaryInfo::reorder</a>, <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>, and <a class="el" href="word-align-lattice_8h_source.html#l00147">WordBoundaryInfo::TypeOfPhone()</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00059">LatticeWordAligner::ComputationState::OutputArc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                                              {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[0]);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">if</span> (info.TypeOfPhone(phone) != <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa98e6c8efe0e8f4256386dc6aa3551607">WordBoundaryInfo::kWordBeginAndEndPhone</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// we assume the start of transition_ids_ is the start of the phone.</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// this is a precondition.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">size_t</span> len = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.size(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_phone = tmodel.TransitionIdToPhone(tid);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (this_phone != phone &amp;&amp; ! *error) { <span class="comment">// error condition: should have reached final transition-id first.</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed before final transition-id found &quot;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="stringliteral">&quot;[broken lattice or mismatched model or wrong --reorder option?]&quot;</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">// just continue, ignoring this-- we&#39;ll probably output something...</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordflow">if</span> (tmodel.IsFinal(tid))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == len) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// fell off loop.</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">// go past the one for which IsFinal returned true.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">if</span> (info.reorder) <span class="comment">// we have to consume the following self-loop transition-ids.</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len &amp;&amp; tmodel.IsSelfLoop(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>])) i++;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// we don&#39;t know if it ends here... so can&#39;t output arc.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i-1]) != phone</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      &amp;&amp; ! *error) { <span class="comment">// another check.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed unexpectedly in lattice &quot;</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="stringliteral">&quot;[broken lattice or mismatched model?]&quot;</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// interpret i as the number of transition-ids to consume.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  std::vector&lt;int32&gt; tids_out(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// consumed transition ids from our internal state.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> word = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>[0];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(word, word,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                               <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a>(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, tids_out), fst::kNoStateId);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>); <span class="comment">// delete these</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">word_labels_</a>.begin()+1); <span class="comment">// remove the word we output.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>(); <span class="comment">// we just output the weight.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
<div class="ttc" id="namespacekaldi_html_a374d09d7b7a9a638aee58cc1cc0ca92e"><div class="ttname"><a href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">kaldi::CompactLatticeWeight</a></div><div class="ttdeci">fst::CompactLatticeWeightTpl&lt; LatticeWeight, int32 &gt; CompactLatticeWeight</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00035">kaldi-lattice.h:35</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baa98e6c8efe0e8f4256386dc6aa3551607"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa98e6c8efe0e8f4256386dc6aa3551607">kaldi::WordBoundaryInfo::kWordBeginAndEndPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00140">word-align-lattice.h:140</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_af87bd57b9f051fc0aa6383f159dd808e"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#af87bd57b9f051fc0aa6383f159dd808e">kaldi::LatticeWordAligner::ComputationState::word_labels_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; word_labels_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00131">word-align-lattice.cc:131</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a33b7ea55be82ee6bab64430dd93cbcba"><div class="ttname"><a href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a></div><div class="ttdeci">fst::ArcTpl&lt; CompactLatticeWeight &gt; CompactLatticeArc</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00042">kaldi-lattice.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6d8dd46e45a9a9268c5d755922ee5ccd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool OutputSilenceArc </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1WordBoundaryInfo.html">WordBoundaryInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a> *&#160;</td>
          <td class="paramname"><em>arc_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00346">346</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="transition-model_8cc_source.html#l00211">TransitionModel::IsFinal()</a>, <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="word-align-lattice_8h_source.html#l00142">WordBoundaryInfo::kNonWordPhone</a>, <a class="el" href="lattice-weight_8h_source.html#l00081">LatticeWeightTpl&lt; BaseFloat &gt;::One()</a>, <a class="el" href="word-align-lattice_8h_source.html#l00162">WordBoundaryInfo::reorder</a>, <a class="el" href="word-align-lattice_8h_source.html#l00156">WordBoundaryInfo::silence_label</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00130">LatticeWordAligner::ComputationState::transition_ids_</a>, <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>, <a class="el" href="word-align-lattice_8h_source.html#l00147">WordBoundaryInfo::TypeOfPhone()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00132">LatticeWordAligner::ComputationState::weight_</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00059">LatticeWordAligner::ComputationState::OutputArc()</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                              {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.empty()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> phone = tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[0]);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordflow">if</span> (info.TypeOfPhone(phone) != <a class="code" href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f">WordBoundaryInfo::kNonWordPhone</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// we assume the start of transition_ids_ is the start of the phone [silence];</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// this is a precondition.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">size_t</span> len = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.size(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// Keep going till we reach a &quot;final&quot; transition-id; note, if</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// reorder==true, we have to go a bit further after this.</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_phone = tmodel.TransitionIdToPhone(tid);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (this_phone != phone &amp;&amp; ! *error) { <span class="comment">// error condition: should have reached final transition-id first.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      *error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed before final transition-id found &quot;</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="stringliteral">&quot;[broken lattice or mismatched model or wrong --reorder option?]&quot;</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (tmodel.IsFinal(tid))</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == len) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// fell off loop.</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++; <span class="comment">// go past the one for which IsFinal returned true.</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">if</span> (info.reorder) <span class="comment">// we have to consume the following self-loop transition-ids.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; len &amp;&amp; tmodel.IsSelfLoop(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>])) i++;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">if</span> (i == len) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// we don&#39;t know if it ends here... so can&#39;t output arc.</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">if</span> (tmodel.TransitionIdToPhone(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>[i-1]) != phone</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      &amp;&amp; ! *error) { <span class="comment">// another check.</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone changed unexpectedly in lattice &quot;</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="stringliteral">&quot;[broken lattice or mismatched model?]&quot;</span>;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="comment">// interpret i as the number of transition-ids to consume.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  std::vector&lt;int32&gt; tids_out(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// consumed transition ids from our internal state.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  *arc_out = <a class="code" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">CompactLatticeArc</a>(info.silence_label, info.silence_label,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                               <a class="code" href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">CompactLatticeWeight</a>(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a>, tids_out), fst::kNoStateId);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.erase(<a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin(), <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">transition_ids_</a>.begin()+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>); <span class="comment">// delete these</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">weight_</a> = <a class="code" href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">LatticeWeight::One</a>(); <span class="comment">// we just output the weight.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_a3fa41eff79c8a87c04278d55ca6caf55"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#a3fa41eff79c8a87c04278d55ca6caf55">kaldi::LatticeWordAligner::ComputationState::transition_ids_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; transition_ids_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00130">word-align-lattice.cc:130</a></div></div>
<div class="ttc" id="classkaldi_1_1LatticeWordAligner_1_1ComputationState_html_ae685d3279f8c4fb028164f1624ca25f6"><div class="ttname"><a href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html#ae685d3279f8c4fb028164f1624ca25f6">kaldi::LatticeWordAligner::ComputationState::weight_</a></div><div class="ttdeci">LatticeWeight weight_</div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8cc_source.html#l00132">word-align-lattice.cc:132</a></div></div>
<div class="ttc" id="classfst_1_1LatticeWeightTpl_html_a5421f358cae61e1da1ebab7b0a1294c6"><div class="ttname"><a href="classfst_1_1LatticeWeightTpl.html#a5421f358cae61e1da1ebab7b0a1294c6">fst::LatticeWeightTpl&lt; BaseFloat &gt;::One</a></div><div class="ttdeci">static const LatticeWeightTpl One()</div><div class="ttdef"><b>Definition:</b> <a href="lattice-weight_8h_source.html#l00081">lattice-weight.h:81</a></div></div>
<div class="ttc" id="namespacekaldi_html_a374d09d7b7a9a638aee58cc1cc0ca92e"><div class="ttname"><a href="namespacekaldi.html#a374d09d7b7a9a638aee58cc1cc0ca92e">kaldi::CompactLatticeWeight</a></div><div class="ttdeci">fst::CompactLatticeWeightTpl&lt; LatticeWeight, int32 &gt; CompactLatticeWeight</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00035">kaldi-lattice.h:35</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="structkaldi_1_1WordBoundaryInfo_html_aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f"><div class="ttname"><a href="structkaldi_1_1WordBoundaryInfo.html#aabfb5a3e4143872e7c546c86970601baa565853e6133c9520fa0baa5dbfa6da8f">kaldi::WordBoundaryInfo::kNonWordPhone</a></div><div class="ttdef"><b>Definition:</b> <a href="word-align-lattice_8h_source.html#l00142">word-align-lattice.h:142</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a33b7ea55be82ee6bab64430dd93cbcba"><div class="ttname"><a href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a></div><div class="ttdeci">fst::ArcTpl&lt; CompactLatticeWeight &gt; CompactLatticeArc</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-lattice_8h_source.html#l00042">kaldi-lattice.h:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a3fa41eff79c8a87c04278d55ca6caf55"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&gt; transition_ids_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00130">130</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00040">LatticeWordAligner::ComputationState::Advance()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00108">LatticeWordAligner::ComputationState::Hash()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00084">LatticeWordAligner::ComputationState::IsEmpty()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00119">LatticeWordAligner::ComputationState::operator==()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00346">LatticeWordAligner::ComputationState::OutputSilenceArc()</a>.</p>

</div>
</div>
<a class="anchor" id="ae685d3279f8c4fb028164f1624ca25f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacefst.html#a312b29f86c5ef78810556e470635a291">LatticeWeight</a> weight_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00132">132</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00040">LatticeWordAligner::ComputationState::Advance()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00089">LatticeWordAligner::ComputationState::FinalWeight()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00119">LatticeWordAligner::ComputationState::operator==()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00346">LatticeWordAligner::ComputationState::OutputSilenceArc()</a>.</p>

</div>
</div>
<a class="anchor" id="af87bd57b9f051fc0aa6383f159dd808e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&gt; word_labels_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="word-align-lattice_8cc_source.html#l00131">131</a> of file <a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a>.</p>

<p>Referenced by <a class="el" href="word-align-lattice_8cc_source.html#l00040">LatticeWordAligner::ComputationState::Advance()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00108">LatticeWordAligner::ComputationState::Hash()</a>, <a class="el" href="word-align-lattice_8cc_source.html#l00084">LatticeWordAligner::ComputationState::IsEmpty()</a>, and <a class="el" href="word-align-lattice_8cc_source.html#l00119">LatticeWordAligner::ComputationState::operator==()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>lat/<a class="el" href="word-align-lattice_8cc_source.html">word-align-lattice.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="classkaldi_1_1LatticeWordAligner.html">LatticeWordAligner</a></li><li class="navelem"><a class="el" href="classkaldi_1_1LatticeWordAligner_1_1ComputationState.html">ComputationState</a></li>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:45 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
