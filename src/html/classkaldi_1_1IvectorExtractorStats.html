<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: IvectorExtractorStats Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classkaldi_1_1IvectorExtractorStats.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classkaldi_1_1IvectorExtractorStats-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">IvectorExtractorStats Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classkaldi_1_1IvectorExtractorStats.html" title="IvectorExtractorStats is a class used to update the parameters of the ivector extractor. ">IvectorExtractorStats</a> is a class used to update the parameters of the ivector extractor.  
 <a href="classkaldi_1_1IvectorExtractorStats.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for IvectorExtractorStats:</div>
<div class="dyncontent">
<div class="center"><img src="classkaldi_1_1IvectorExtractorStats__coll__graph.png" border="0" usemap="#IvectorExtractorStats_coll__map" alt="Collaboration graph"/></div>
<map name="IvectorExtractorStats_coll__map" id="IvectorExtractorStats_coll__map">
<area shape="rect" id="node2" href="classkaldi_1_1Mutex.html" title="This class encapsulates mutex to ensure exclusive access to some critical section which manipulates s..." alt="" coords="713,119,775,145"/><area shape="rect" id="node4" href="classkaldi_1_1Matrix.html" title="Matrix\&lt; double \&gt;" alt="" coords="677,269,811,296"/><area shape="rect" id="node5" href="classkaldi_1_1MatrixBase.html" title="Base class which provides matrix operations not involving resizing or allocation. ..." alt="" coords="314,269,481,296"/><area shape="rect" id="node11" href="classkaldi_1_1PackedMatrix.html" title="PackedMatrix\&lt; double \&gt;" alt="" coords="308,437,487,464"/><area shape="rect" id="node12" href="structkaldi_1_1IvectorExtractorStatsOptions.html" title="Options for IvectorExtractorStats, which is used to update the parameters of IvectorExtractor. " alt="" coords="294,608,501,635"/><area shape="rect" id="node17" href="classkaldi_1_1VectorBase.html" title="Provides a vector abstraction class. " alt="" coords="313,179,481,205"/><area shape="rect" id="node10" href="classkaldi_1_1SpMatrix.html" title="SpMatrix\&lt; double \&gt;" alt="" coords="669,437,819,464"/><area shape="rect" id="node16" href="classkaldi_1_1Vector.html" title="Vector\&lt; double \&gt;" alt="" coords="676,179,812,205"/></map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7ff848c79112a21887c7d9f275b2a62a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a7ff848c79112a21887c7d9f275b2a62a">IvectorExtractorStats</a> ()</td></tr>
<tr class="separator:a7ff848c79112a21887c7d9f275b2a62a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d884ef81caf7be2f49d7de189c5b674"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a3d884ef81caf7be2f49d7de189c5b674">IvectorExtractorStats</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="structkaldi_1_1IvectorExtractorStatsOptions.html">IvectorExtractorStatsOptions</a> &amp;stats_opts)</td></tr>
<tr class="separator:a3d884ef81caf7be2f49d7de189c5b674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cd2b7deae6f9c1ef93e59cf342b9f8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a4cd2b7deae6f9c1ef93e59cf342b9f8f">Add</a> (const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;other)</td></tr>
<tr class="separator:a4cd2b7deae6f9c1ef93e59cf342b9f8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9078a662eda069ce5e5c180ae10b2c3e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a9078a662eda069ce5e5c180ae10b2c3e">AccStatsForUtterance</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;feats, const <a class="el" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> &amp;post)</td></tr>
<tr class="separator:a9078a662eda069ce5e5c180ae10b2c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54136365ef0f996d8557dbdf9078abe6"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a54136365ef0f996d8557dbdf9078abe6">AccStatsForUtterance</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;feats, const <a class="el" href="classkaldi_1_1FullGmm.html">FullGmm</a> &amp;fgmm)</td></tr>
<tr class="separator:a54136365ef0f996d8557dbdf9078abe6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0bf83c9362bc2a8f732c6f5e50ffdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a4e0bf83c9362bc2a8f732c6f5e50ffdd">Read</a> (std::istream &amp;is, bool binary, bool add=false)</td></tr>
<tr class="separator:a4e0bf83c9362bc2a8f732c6f5e50ffdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d27e841639bdc831576ed1c690fe08"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">Write</a> (std::ostream &amp;os, bool binary)</td></tr>
<tr class="separator:ad5d27e841639bdc831576ed1c690fe08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5da0494b3a3f4bc33ff83c9b5ff5b40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">Write</a> (std::ostream &amp;os, bool binary) const </td></tr>
<tr class="separator:ad5da0494b3a3f4bc33ff83c9b5ff5b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab98cd0287389f6faf1acc29f5b4111fd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ab98cd0287389f6faf1acc29f5b4111fd">Update</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="memdesc:ab98cd0287389f6faf1acc29f5b4111fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the objf improvement per frame.  <a href="#ab98cd0287389f6faf1acc29f5b4111fd">More...</a><br/></td></tr>
<tr class="separator:ab98cd0287389f6faf1acc29f5b4111fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeafcf56697a3c94d7d73c3671eabc7b0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#aeafcf56697a3c94d7d73c3671eabc7b0">AuxfPerFrame</a> ()</td></tr>
<tr class="separator:aeafcf56697a3c94d7d73c3671eabc7b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3df83e12b5913d5ff087591a9219ded2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a3df83e12b5913d5ff087591a9219ded2">IvectorVarianceDiagnostic</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor)</td></tr>
<tr class="memdesc:a3df83e12b5913d5ff087591a9219ded2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the proportion of the variance explained by the Ivector model versus the Gaussians.  <a href="#a3df83e12b5913d5ff087591a9219ded2">More...</a><br/></td></tr>
<tr class="separator:a3df83e12b5913d5ff087591a9219ded2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a385949c75ab7e55efaad9f3de06d7e94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a385949c75ab7e55efaad9f3de06d7e94">IvectorExtractorStats</a> (const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;other)</td></tr>
<tr class="separator:a385949c75ab7e55efaad9f3de06d7e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a8923beaf8153f8828d8cf85b4c8550bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a8923beaf8153f8828d8cf85b4c8550bc">CommitStatsForUtterance</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;utt_stats)</td></tr>
<tr class="separator:a8923beaf8153f8828d8cf85b4c8550bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb26637ad57afd8d625397218637ca9e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#adb26637ad57afd8d625397218637ca9e">CommitStatsForM</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;utt_stats, const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;ivec_mean, const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;ivec_var)</td></tr>
<tr class="memdesc:adb26637ad57afd8d625397218637ca9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is called by CommitStatsForUtterance.  <a href="#adb26637ad57afd8d625397218637ca9e">More...</a><br/></td></tr>
<tr class="separator:adb26637ad57afd8d625397218637ca9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bca9f5d3b106f8c412e17cba441c7ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a4bca9f5d3b106f8c412e17cba441c7ef">FlushCache</a> ()</td></tr>
<tr class="memdesc:a4bca9f5d3b106f8c412e17cba441c7ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flushes the cache for the R_ stats.  <a href="#a4bca9f5d3b106f8c412e17cba441c7ef">More...</a><br/></td></tr>
<tr class="separator:a4bca9f5d3b106f8c412e17cba441c7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad779e613a2ac7ab9fd2b4811e1981e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ad779e613a2ac7ab9fd2b4811e1981e7a">CommitStatsForSigma</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;utt_stats)</td></tr>
<tr class="memdesc:ad779e613a2ac7ab9fd2b4811e1981e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit the stats used to update the variance.  <a href="#ad779e613a2ac7ab9fd2b4811e1981e7a">More...</a><br/></td></tr>
<tr class="separator:ad779e613a2ac7ab9fd2b4811e1981e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66b2b3ac11229f325a4ab2993971004e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a66b2b3ac11229f325a4ab2993971004e">CommitStatsForWPoint</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;utt_stats, const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;ivector, double weight)</td></tr>
<tr class="memdesc:a66b2b3ac11229f325a4ab2993971004e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit the stats used to update the weight-projection w_&ndash; this one takes a point sample, it's called from <a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a825292fa4cb109e468fd6301cdf610d7" title="Commit the stats used to update the weight-projection w_. ">CommitStatsForW()</a>.  <a href="#a66b2b3ac11229f325a4ab2993971004e">More...</a><br/></td></tr>
<tr class="separator:a66b2b3ac11229f325a4ab2993971004e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a825292fa4cb109e468fd6301cdf610d7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a825292fa4cb109e468fd6301cdf610d7">CommitStatsForW</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor, const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;utt_stats, const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;ivec_mean, const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;ivec_var)</td></tr>
<tr class="memdesc:a825292fa4cb109e468fd6301cdf610d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit the stats used to update the weight-projection w_.  <a href="#a825292fa4cb109e468fd6301cdf610d7">More...</a><br/></td></tr>
<tr class="separator:a825292fa4cb109e468fd6301cdf610d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a968ca5ee8e1eb1c145956a8c7b5a6098"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a968ca5ee8e1eb1c145956a8c7b5a6098">CommitStatsForPrior</a> (const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;ivec_mean, const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;ivec_var)</td></tr>
<tr class="memdesc:a968ca5ee8e1eb1c145956a8c7b5a6098"><td class="mdescLeft">&#160;</td><td class="mdescRight">Commit the stats used to update the prior distribution.  <a href="#a968ca5ee8e1eb1c145956a8c7b5a6098">More...</a><br/></td></tr>
<tr class="separator:a968ca5ee8e1eb1c145956a8c7b5a6098"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324c315bad7b1c422c702a33404adc93"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a324c315bad7b1c422c702a33404adc93">UpdateProjections</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:a324c315bad7b1c422c702a33404adc93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8effcbfb888765a258a3141e9b29de0d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a8effcbfb888765a258a3141e9b29de0d">UpdateProjection</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> gaussian, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:a8effcbfb888765a258a3141e9b29de0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbeb51570be96507c7ca9a7f08ee76fa"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#adbeb51570be96507c7ca9a7f08ee76fa">UpdateWeights</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:adbeb51570be96507c7ca9a7f08ee76fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b95556f077a55cc7691ccd0cf5d7e8b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a6b95556f077a55cc7691ccd0cf5d7e8b">UpdateWeight</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> gaussian, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:a6b95556f077a55cc7691ccd0cf5d7e8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e670dee665f61c7fa9fa1d6b010fed1"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a1e670dee665f61c7fa9fa1d6b010fed1">UpdateVariances</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:a1e670dee665f61c7fa9fa1d6b010fed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33f0978df21eb0d8168d556fd76de54"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ad33f0978df21eb0d8168d556fd76de54">UpdatePrior</a> (const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;opts, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor) const </td></tr>
<tr class="separator:ad33f0978df21eb0d8168d556fd76de54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee3688cee9aed69e95240efbc0fd4d7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#acee3688cee9aed69e95240efbc0fd4d7">PriorDiagnostics</a> (double old_prior_offset) const </td></tr>
<tr class="separator:acee3688cee9aed69e95240efbc0fd4d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ce553a30c834384555bc0f10024b7d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a9ce553a30c834384555bc0f10024b7d2">CheckDims</a> (const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;extractor) const </td></tr>
<tr class="separator:a9ce553a30c834384555bc0f10024b7d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a9ef1d9fef5999d5b41712230a376108c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structkaldi_1_1IvectorExtractorStatsOptions.html">IvectorExtractorStatsOptions</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a></td></tr>
<tr class="separator:a9ef1d9fef5999d5b41712230a376108c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9584d93c3d3f36ae1b654fe4ea0fe2d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a></td></tr>
<tr class="memdesc:ab9584d93c3d3f36ae1b654fe4ea0fe2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Caution: if we read from disk, this.  <a href="#ab9584d93c3d3f36ae1b654fe4ea0fe2d">More...</a><br/></td></tr>
<tr class="separator:ab9584d93c3d3f36ae1b654fe4ea0fe2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af78986e36e6a8f2e249fbe9801f3ee75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#af78986e36e6a8f2e249fbe9801f3ee75">gamma_Y_lock_</a></td></tr>
<tr class="memdesc:af78986e36e6a8f2e249fbe9801f3ee75"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards gamma_ and Y_ (for multi-threaded update)  <a href="#af78986e36e6a8f2e249fbe9801f3ee75">More...</a><br/></td></tr>
<tr class="separator:af78986e36e6a8f2e249fbe9801f3ee75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de396bc25cd2a22f046fad7c5ce2d36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a></td></tr>
<tr class="memdesc:a1de396bc25cd2a22f046fad7c5ce2d36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total occupation count for each Gaussian index (zeroth-order stats)  <a href="#a1de396bc25cd2a22f046fad7c5ce2d36">More...</a><br/></td></tr>
<tr class="separator:a1de396bc25cd2a22f046fad7c5ce2d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b5993cde86bc844e4967d63b7f2364d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a></td></tr>
<tr class="memdesc:a0b5993cde86bc844e4967d63b7f2364d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stats Y_i for estimating projections M.  <a href="#a0b5993cde86bc844e4967d63b7f2364d">More...</a><br/></td></tr>
<tr class="separator:a0b5993cde86bc844e4967d63b7f2364d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49017afa7dc30fd2cb91cbebd57102aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a49017afa7dc30fd2cb91cbebd57102aa">R_lock_</a></td></tr>
<tr class="memdesc:a49017afa7dc30fd2cb91cbebd57102aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards R_ (for multi-threaded update)  <a href="#a49017afa7dc30fd2cb91cbebd57102aa">More...</a><br/></td></tr>
<tr class="separator:a49017afa7dc30fd2cb91cbebd57102aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04c5bee6d676aee6c5a98bd103e3154f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a></td></tr>
<tr class="memdesc:a04c5bee6d676aee6c5a98bd103e3154f"><td class="mdescLeft">&#160;</td><td class="mdescRight">R_i, quadratic term for ivector subspace (M matrix)estimation.  <a href="#a04c5bee6d676aee6c5a98bd103e3154f">More...</a><br/></td></tr>
<tr class="separator:a04c5bee6d676aee6c5a98bd103e3154f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33fe7be89c94c2541badd2d004134388"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a></td></tr>
<tr class="memdesc:a33fe7be89c94c2541badd2d004134388"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards R_num_cached_, R_gamma_cache_, R_ivec_cache_ (for multi-threaded update)  <a href="#a33fe7be89c94c2541badd2d004134388">More...</a><br/></td></tr>
<tr class="separator:a33fe7be89c94c2541badd2d004134388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee54470df81f1c790f4c6c4edf517f0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a></td></tr>
<tr class="memdesc:a0ee54470df81f1c790f4c6c4edf517f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here.  <a href="#a0ee54470df81f1c790f4c6c4edf517f0">More...</a><br/></td></tr>
<tr class="separator:a0ee54470df81f1c790f4c6c4edf517f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b0f0a3b8809bbfd635c8f068e5e1c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a></td></tr>
<tr class="memdesc:ab0b0f0a3b8809bbfd635c8f068e5e1c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">dimension: [num-to-cache][I]  <a href="#ab0b0f0a3b8809bbfd635c8f068e5e1c7">More...</a><br/></td></tr>
<tr class="separator:ab0b0f0a3b8809bbfd635c8f068e5e1c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0827fd9bd6c2a3b0f602ab98cfa45990"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a></td></tr>
<tr class="memdesc:a0827fd9bd6c2a3b0f602ab98cfa45990"><td class="mdescLeft">&#160;</td><td class="mdescRight">dimension: [num-to-cache][S*(S+1)/2]  <a href="#a0827fd9bd6c2a3b0f602ab98cfa45990">More...</a><br/></td></tr>
<tr class="separator:a0827fd9bd6c2a3b0f602ab98cfa45990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d7ede213a100c69107a6e4868c660be"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a0d7ede213a100c69107a6e4868c660be">weight_stats_lock_</a></td></tr>
<tr class="memdesc:a0d7ede213a100c69107a6e4868c660be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards Q_ and G_ (for multi-threaded update)  <a href="#a0d7ede213a100c69107a6e4868c660be">More...</a><br/></td></tr>
<tr class="separator:a0d7ede213a100c69107a6e4868c660be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90659470063b71ea93d07e7432d8437f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a></td></tr>
<tr class="memdesc:a90659470063b71ea93d07e7432d8437f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is weighted by the coefficient of the quadratic term in the expansion for w (the "safe" one, with the max expression).  <a href="#a90659470063b71ea93d07e7432d8437f">More...</a><br/></td></tr>
<tr class="separator:a90659470063b71ea93d07e7432d8437f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac04e6ac0138efc552fa6ca3c688c5fe2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a></td></tr>
<tr class="memdesc:ac04e6ac0138efc552fa6ca3c688c5fe2"><td class="mdescLeft">&#160;</td><td class="mdescRight">G_ is the linear term in the weight projection matrix w_.  <a href="#ac04e6ac0138efc552fa6ca3c688c5fe2">More...</a><br/></td></tr>
<tr class="separator:ac04e6ac0138efc552fa6ca3c688c5fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa19c3f94a4f9a633906cbdc38c31f942"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#aa19c3f94a4f9a633906cbdc38c31f942">variance_stats_lock_</a></td></tr>
<tr class="memdesc:aa19c3f94a4f9a633906cbdc38c31f942"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards S_ (for multi-threaded update)  <a href="#aa19c3f94a4f9a633906cbdc38c31f942">More...</a><br/></td></tr>
<tr class="separator:aa19c3f94a4f9a633906cbdc38c31f942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e4cc17a0737faace498025a5afe4552"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a></td></tr>
<tr class="memdesc:a3e4cc17a0737faace498025a5afe4552"><td class="mdescLeft">&#160;</td><td class="mdescRight">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_.  <a href="#a3e4cc17a0737faace498025a5afe4552">More...</a><br/></td></tr>
<tr class="separator:a3e4cc17a0737faace498025a5afe4552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77101ca2b796aab9e9c1fa0ea521d5ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a77101ca2b796aab9e9c1fa0ea521d5ac">prior_stats_lock_</a></td></tr>
<tr class="memdesc:a77101ca2b796aab9e9c1fa0ea521d5ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">This mutex guards num_ivectors_, ivector_sum_ and ivector_scatter_ (for multi-threaded update)  <a href="#a77101ca2b796aab9e9c1fa0ea521d5ac">More...</a><br/></td></tr>
<tr class="separator:a77101ca2b796aab9e9c1fa0ea521d5ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6cc4dd6805e9e5cb5bed8dc2e974b28"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a></td></tr>
<tr class="memdesc:ab6cc4dd6805e9e5cb5bed8dc2e974b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Count of the number of iVectors we trained on.  <a href="#ab6cc4dd6805e9e5cb5bed8dc2e974b28">More...</a><br/></td></tr>
<tr class="separator:ab6cc4dd6805e9e5cb5bed8dc2e974b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23c49a3df61b3447865b86ff695b87df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a></td></tr>
<tr class="memdesc:a23c49a3df61b3447865b86ff695b87df"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sum of all the iVector means. Needed for prior re-estimation.  <a href="#a23c49a3df61b3447865b86ff695b87df">More...</a><br/></td></tr>
<tr class="separator:a23c49a3df61b3447865b86ff695b87df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc2459b63a0e449a545b18a393998b9b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a></td></tr>
<tr class="memdesc:acc2459b63a0e449a545b18a393998b9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Second-order stats for the iVectors. Needed for prior re-estimation.  <a href="#acc2459b63a0e449a545b18a393998b9b">More...</a><br/></td></tr>
<tr class="separator:acc2459b63a0e449a545b18a393998b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa27f0e56d6ba2aeb151091a10bf7385d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#aa27f0e56d6ba2aeb151091a10bf7385d">GetOrthogonalIvectorTransform</a> (const <a class="el" href="classkaldi_1_1SubMatrix.html">SubMatrix</a>&lt; double &gt; &amp;T, <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *extractor, <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; *A) const </td></tr>
<tr class="memdesc:aa27f0e56d6ba2aeb151091a10bf7385d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes an orthogonal matrix A from the iVector transform T such that T' = A*T is an alternative transform which diagonalizes the quadratic_term_ in the iVector estimation objective function.  <a href="#aa27f0e56d6ba2aeb151091a10bf7385d">More...</a><br/></td></tr>
<tr class="separator:aa27f0e56d6ba2aeb151091a10bf7385d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addbcf588eba97d93d9e4612be3dcb4f6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#addbcf588eba97d93d9e4612be3dcb4f6">operator=</a> (const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;other)</td></tr>
<tr class="separator:addbcf588eba97d93d9e4612be3dcb4f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a570adb0fce688854d96dea3b01464b9f"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a570adb0fce688854d96dea3b01464b9f">IvectorExtractor</a></td></tr>
<tr class="separator:a570adb0fce688854d96dea3b01464b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a4f520516ebbf6ad4ee67bdfe76b1f"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a30a4f520516ebbf6ad4ee67bdfe76b1f">IvectorExtractorUpdateProjectionClass</a></td></tr>
<tr class="separator:a30a4f520516ebbf6ad4ee67bdfe76b1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12d337d4dabccc9c1ce3d676a03a494e"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a12d337d4dabccc9c1ce3d676a03a494e">IvectorExtractorUpdateWeightClass</a></td></tr>
<tr class="separator:a12d337d4dabccc9c1ce3d676a03a494e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classkaldi_1_1IvectorExtractorStats.html" title="IvectorExtractorStats is a class used to update the parameters of the ivector extractor. ">IvectorExtractorStats</a> is a class used to update the parameters of the ivector extractor. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00474">474</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7ff848c79112a21887c7d9f275b2a62a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00478">478</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;: <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a>(0.0), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>(0), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>(0) { }</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d884ef81caf7be2f49d7de189c5b674"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorStatsOptions.html">IvectorExtractorStatsOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>stats_opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00790">790</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8h_source.html#l00425">IvectorExtractorStatsOptions::cache_size</a>, <a class="el" href="ivector-extractor_8h_source.html#l00596">IvectorExtractorStats::config_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00028">IvectorExtractor::FeatDim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00245">IvectorExtractor::IvectorDependentWeights()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00424">IvectorExtractorStatsOptions::num_samples_for_weights</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00634">IvectorExtractorStats::R_gamma_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00636">IvectorExtractorStats::R_ivec_scatter_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00632">IvectorExtractorStats::R_num_cached_</a>, <a class="el" href="sp-matrix_8h_source.html#l00081">SpMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00189">Vector&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00692">Matrix&lt; Real &gt;::Resize()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00422">IvectorExtractorStatsOptions::update_variances</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                                   :</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>(stats_opts) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> S = extractor.IvectorDim(), D = extractor.FeatDim(),</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      I = extractor.NumGauss();</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> &gt; 1);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a> = 0.0;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">Resize</a>(I);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.resize(I);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Resize(D, S);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">Resize</a>(I, S * (S + 1) / 2);</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a> = 0;</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(stats_opts.cache_size &gt; 0 &amp;&amp; <span class="stringliteral">&quot;--cache-size=0 not allowed&quot;</span>);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">Resize</a>(stats_opts.cache_size, I);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">Resize</a>(stats_opts.cache_size, S*(S+1)/2);</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;  <span class="keywordflow">if</span> (extractor.IvectorDependentWeights()) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">Resize</a>(I, S * (S + 1) / 2);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">Resize</a>(I, S);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">if</span> (stats_opts.update_variances) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.resize(I);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Resize(D);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  }</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> = 0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">Resize</a>(S);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1SpMatrix.html#ad7f89691424b7c530334add5fb9aeb9d">Resize</a>(S);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0827fd9bd6c2a3b0f602ab98cfa45990"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">kaldi::IvectorExtractorStats::R_ivec_scatter_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_ivec_scatter_cache_</div><div class="ttdoc">dimension: [num-to-cache][S*(S+1)/2] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00636">ivector-extractor.h:636</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab0b0f0a3b8809bbfd635c8f068e5e1c7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">kaldi::IvectorExtractorStats::R_gamma_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_gamma_cache_</div><div class="ttdoc">dimension: [num-to-cache][I] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00634">ivector-extractor.h:634</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html_ae98e624cca1982e866ff195131ed4427"><div class="ttname"><a href="classkaldi_1_1Vector.html#ae98e624cca1982e866ff195131ed4427">kaldi::Vector::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT length, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Set vector to a specified size (can be zero). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00189">kaldi-vector.cc:189</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="structkaldi_1_1IvectorExtractorStatsOptions_html_a3c55a1bf921bffe681780fb909f375fb"><div class="ttname"><a href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">kaldi::IvectorExtractorStatsOptions::num_samples_for_weights</a></div><div class="ttdeci">int32 num_samples_for_weights</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00424">ivector-extractor.h:424</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html_aaabb78f23b01b8ac551b3cc56f602be4"><div class="ttname"><a href="classkaldi_1_1Matrix.html#aaabb78f23b01b8ac551b3cc56f602be4">kaldi::Matrix::Resize</a></div><div class="ttdeci">void Resize(const MatrixIndexT r, const MatrixIndexT c, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Sets matrix to a specified size (zero is OK as long as both r and c are zero). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l00692">kaldi-matrix.cc:692</a></div></div>
<div class="ttc" id="classkaldi_1_1SpMatrix_html_ad7f89691424b7c530334add5fb9aeb9d"><div class="ttname"><a href="classkaldi_1_1SpMatrix.html#ad7f89691424b7c530334add5fb9aeb9d">kaldi::SpMatrix::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT nRows, MatrixResizeType resize_type=kSetZero)</div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8h_source.html#l00081">sp-matrix.h:81</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a385949c75ab7e55efaad9f3de06d7e94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01653">1653</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                                       :</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>(other.config_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a>(other.tot_auxf_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(other.gamma_),</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>(other.Y_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>(other.R_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>(other.R_num_cached_),</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>(other.R_gamma_cache_),</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a>(other.R_ivec_scatter_cache_),</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>(other.Q_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>(other.G_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>(other.S_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>(other.num_ivectors_),</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>(other.ivector_sum_), <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>(other.ivector_scatter_) {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0827fd9bd6c2a3b0f602ab98cfa45990"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">kaldi::IvectorExtractorStats::R_ivec_scatter_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_ivec_scatter_cache_</div><div class="ttdoc">dimension: [num-to-cache][S*(S+1)/2] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00636">ivector-extractor.h:636</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab0b0f0a3b8809bbfd635c8f068e5e1c7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">kaldi::IvectorExtractorStats::R_gamma_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_gamma_cache_</div><div class="ttdoc">dimension: [num-to-cache][I] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00634">ivector-extractor.h:634</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a9078a662eda069ce5e5c180ae10b2c3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AccStatsForUtterance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> &amp;&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01031">1031</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l00751">IvectorExtractorUtteranceStats::AccStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00028">IvectorExtractor::FeatDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01058">IvectorExtractorStats::AccStatsForUtterance()</a>, <a class="el" href="ivector-extractor-acc-stats_8cc_source.html#l00043">IvectorTask::operator()()</a>, and <a class="el" href="ivector-extractor-test_8cc_source.html#l00145">kaldi::UnitTestIvectorExtractor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                           {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keyword">typedef</span> std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; VecType;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ce553a30c834384555bc0f10024b7d2">CheckDims</a>(extractor);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_gauss = extractor.NumGauss(), feat_dim = extractor.FeatDim();</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordflow">if</span> (feat_dim != feats.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>()) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Feature dimension mismatch, expected &quot;</span> &lt;&lt; feat_dim</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;, got &quot;</span> &lt;&lt; feats.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  }</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;int32&gt;(post.size()) == feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>());</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;  <span class="keywordtype">bool</span> update_variance = (!<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.empty());</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  <span class="comment">// The zeroth and 1st-order stats are in &quot;utt_stats&quot;.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  IvectorExtractorUtteranceStats utt_stats(num_gauss, feat_dim,</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                           update_variance);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  utt_stats.AccStats(feats, post);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a8923beaf8153f8828d8cf85b4c8550bc">CommitStatsForUtterance</a>(extractor, utt_stats);</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a8923beaf8153f8828d8cf85b4c8550bc"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a8923beaf8153f8828d8cf85b4c8550bc">kaldi::IvectorExtractorStats::CommitStatsForUtterance</a></div><div class="ttdeci">void CommitStatsForUtterance(const IvectorExtractor &amp;extractor, const IvectorExtractorUtteranceStats &amp;utt_stats)</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00979">ivector-extractor.cc:979</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ce553a30c834384555bc0f10024b7d2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ce553a30c834384555bc0f10024b7d2">kaldi::IvectorExtractorStats::CheckDims</a></div><div class="ttdeci">void CheckDims(const IvectorExtractor &amp;extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01003">ivector-extractor.cc:1003</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::MatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdoc">Returns number of columns (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a54136365ef0f996d8557dbdf9078abe6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AccStatsForUtterance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1FullGmm.html">FullGmm</a> &amp;&#160;</td>
          <td class="paramname"><em>fgmm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01058">1058</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l01031">IvectorExtractorStats::AccStatsForUtterance()</a>, <a class="el" href="full-gmm_8cc_source.html#l00719">FullGmm::ComponentPosteriors()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="matrix-common_8h_source.html#l00037">kaldi::kUndefined</a>, <a class="el" href="full-gmm_8h_source.html#l00059">FullGmm::NumGauss()</a>, and <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>.</p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                         {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_frames = feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> post(num_frames);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="keywordtype">double</span> tot_log_like = 0.0;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = 0; t &lt; num_frames; t++) {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    SubVector&lt;BaseFloat&gt; frame(feats, t);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    Vector&lt;BaseFloat&gt; posterior(fgmm.NumGauss(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    tot_log_like += fgmm.ComponentPosteriors(frame, &amp;posterior);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; posterior.Dim(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      post[t].push_back(std::make_pair(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>, posterior(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>)));</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9078a662eda069ce5e5c180ae10b2c3e">AccStatsForUtterance</a>(extractor, feats, post);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <span class="keywordflow">return</span> tot_log_like;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00037">matrix-common.h:37</a></div></div>
<div class="ttc" id="group__posterior__group_html_ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><div class="ttname"><a href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">kaldi::Posterior</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &gt; Posterior</div><div class="ttdoc">Posterior is a typedef for storing acoustic-state (actually, transition-id) posteriors over an uttera...</div><div class="ttdef"><b>Definition:</b> <a href="posterior_8h_source.html#l00042">posterior.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9078a662eda069ce5e5c180ae10b2c3e"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9078a662eda069ce5e5c180ae10b2c3e">kaldi::IvectorExtractorStats::AccStatsForUtterance</a></div><div class="ttdeci">void AccStatsForUtterance(const IvectorExtractor &amp;extractor, const MatrixBase&lt; BaseFloat &gt; &amp;feats, const Posterior &amp;post)</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01031">ivector-extractor.cc:1031</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4cd2b7deae6f9c1ef93e59cf342b9f8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01077">1077</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-matrix_8cc_source.html#l00346">MatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="sp-matrix_8h_source.html#l00221">SpMatrix&lt; Real &gt;::AddSp()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01017">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00596">IvectorExtractorStats::config_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00424">IvectorExtractorStatsOptions::num_samples_for_weights</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor-test_8cc_source.html#l00039">kaldi::TestIvectorExtractorStatsIO()</a>.</p>
<div class="fragment"><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                                                  {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> ==</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;               other.config_.num_samples_for_weights);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="keywordtype">double</span> weight = 1.0; <span class="comment">// will later make this configurable if needed.</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a> += weight * other.tot_auxf_;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(weight, other.gamma_);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.size() == other.Y_.size());</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].AddMat(weight, other.Y_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a83bf9ed8e818113d1bbbece64dc754da">AddMat</a>(weight, other.R_);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a83bf9ed8e818113d1bbbece64dc754da">AddMat</a>(weight, other.Q_);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a83bf9ed8e818113d1bbbece64dc754da">AddMat</a>(weight, other.G_);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.size() == other.S_.size());</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].AddSp(weight, other.S_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> += weight * other.num_ivectors_;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(weight, other.ivector_sum_);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1SpMatrix.html#a22694b33a617880141039386dbbe62f7">AddSp</a>(weight, other.ivector_scatter_);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a83bf9ed8e818113d1bbbece64dc754da"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a83bf9ed8e818113d1bbbece64dc754da">kaldi::MatrixBase::AddMat</a></div><div class="ttdeci">void AddMat(const Real alpha, const MatrixBase&lt; Real &gt; &amp;M, MatrixTransposeType transA=kNoTrans)</div><div class="ttdoc">*this += alpha * M [or M^T] </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l00346">kaldi-matrix.cc:346</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1SpMatrix_html_a22694b33a617880141039386dbbe62f7"><div class="ttname"><a href="classkaldi_1_1SpMatrix.html#a22694b33a617880141039386dbbe62f7">kaldi::SpMatrix::AddSp</a></div><div class="ttdeci">void AddSp(const Real alpha, const SpMatrix&lt; Real &gt; &amp;Ma)</div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8h_source.html#l00221">sp-matrix.h:221</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="structkaldi_1_1IvectorExtractorStatsOptions_html_a3c55a1bf921bffe681780fb909f375fb"><div class="ttname"><a href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">kaldi::IvectorExtractorStatsOptions::num_samples_for_weights</a></div><div class="ttdeci">int32 num_samples_for_weights</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00424">ivector-extractor.h:424</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ab109eed73378866c0e8747379378ca44"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">kaldi::VectorBase::AddVec</a></div><div class="ttdeci">void AddVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;v)</div><div class="ttdoc">Add vector : *this = *this + alpha * rv (with casting between floats and doubles) ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01017">kaldi-vector.cc:1017</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeafcf56697a3c94d7d73c3671eabc7b0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double AuxfPerFrame </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00508">508</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>References <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor-test_8cc_source.html#l00145">kaldi::UnitTestIvectorExtractor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a> / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>(); }</div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ce553a30c834384555bc0f10024b7d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CheckDims </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01003">1003</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8h_source.html#l00596">IvectorExtractorStats::config_</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00028">IvectorExtractor::FeatDim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00245">IvectorExtractor::IvectorDependentWeights()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00424">IvectorExtractorStatsOptions::num_samples_for_weights</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="packed-matrix_8h_source.html#l00104">PackedMatrix&lt; Real &gt;::NumRows()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01031">IvectorExtractorStats::AccStatsForUtterance()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                                                                             {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> S = extractor.IvectorDim(), D = extractor.FeatDim(),</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      I = extractor.NumGauss();</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> &gt; 0);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() == I);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;int32&gt;(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.size()) == I);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].NumRows() == D &amp;&amp; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].NumCols() == S);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == I &amp;&amp; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>() == S*(S+1)/2);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <span class="keywordflow">if</span> (extractor.IvectorDependentWeights()) {</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == I &amp;&amp; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>() == S*(S+1)/2);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == I &amp;&amp; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>() == S);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == 0);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == 0);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  }</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="comment">// S_ may be empty or not, depending on whether update_variances == true in</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="comment">// the options.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.empty()) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;int32&gt;(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.size() == I));</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].NumRows() == D);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  }</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> &gt;= 0);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() == S);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1PackedMatrix.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == S);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1PackedMatrix_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1PackedMatrix.html#ab204078beff8151c95d1828544acf92c">kaldi::PackedMatrix::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdef"><b>Definition:</b> <a href="packed-matrix_8h_source.html#l00104">packed-matrix.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::MatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdoc">Returns number of columns (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="structkaldi_1_1IvectorExtractorStatsOptions_html_a3c55a1bf921bffe681780fb909f375fb"><div class="ttname"><a href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">kaldi::IvectorExtractorStatsOptions::num_samples_for_weights</a></div><div class="ttdeci">int32 num_samples_for_weights</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00424">ivector-extractor.h:424</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb26637ad57afd8d625397218637ca9e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForM </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;&#160;</td>
          <td class="paramname"><em>utt_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is called by CommitStatsForUtterance. </p>
<p>We commit the stats used to update the M matrix. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00825">825</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l01017">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00970">SpMatrix&lt; Real &gt;::AddVec2()</a>, <a class="el" href="packed-matrix_8h_source.html#l00102">PackedMatrix&lt; Real &gt;::Data()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00101">IvectorExtractorUtteranceStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00607">IvectorExtractorStats::gamma_Y_lock_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00056">Mutex::Lock()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00628">IvectorExtractorStats::R_cache_lock_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00634">IvectorExtractorStats::R_gamma_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00636">IvectorExtractorStats::R_ivec_scatter_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00632">IvectorExtractorStats::R_num_cached_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00077">Mutex::Unlock()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00102">IvectorExtractorUtteranceStats::X_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                      {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#af78986e36e6a8f2e249fbe9801f3ee75">gamma_Y_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">// We do the occupation stats here also.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(1.0, utt_stats.gamma_);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <span class="comment">// Stats for the linear term in M:</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keywordflow">for</span>  (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; extractor.NumGauss(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].AddVecVec(1.0, utt_stats.X_.Row(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>),</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                    Vector&lt;double&gt;(ivec_mean));</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#af78986e36e6a8f2e249fbe9801f3ee75">gamma_Y_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  SpMatrix&lt;double&gt; ivec_scatter(ivec_var);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  ivec_scatter.AddVec2(1.0, ivec_mean);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a> == <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>()) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="comment">// Cache full.  The &quot;while&quot; statement is in case of certain race conditions.</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a4bca9f5d3b106f8c412e17cba441c7ef">FlushCache</a>();</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>).CopyFromVec(utt_stats.gamma_);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = ivec_mean.Dim();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  SubVector&lt;double&gt; ivec_scatter_vec(ivec_scatter.Data(),</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                     ivector_dim * (ivector_dim + 1) / 2);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>).CopyFromVec(ivec_scatter_vec);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>++;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a33fe7be89c94c2541badd2d004134388"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">kaldi::IvectorExtractorStats::R_cache_lock_</a></div><div class="ttdeci">Mutex R_cache_lock_</div><div class="ttdoc">This mutex guards R_num_cached_, R_gamma_cache_, R_ivec_cache_ (for multi-threaded update) ...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00628">ivector-extractor.h:628</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0827fd9bd6c2a3b0f602ab98cfa45990"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">kaldi::IvectorExtractorStats::R_ivec_scatter_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_ivec_scatter_cache_</div><div class="ttdoc">dimension: [num-to-cache][S*(S+1)/2] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00636">ivector-extractor.h:636</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab0b0f0a3b8809bbfd635c8f068e5e1c7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">kaldi::IvectorExtractorStats::R_gamma_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_gamma_cache_</div><div class="ttdoc">dimension: [num-to-cache][I] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00634">ivector-extractor.h:634</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a74d183962cfb39d8c50382b496c82703"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">kaldi::Mutex::Lock</a></div><div class="ttdeci">void Lock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00056">kaldi-mutex.cc:56</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a29c8fdd802482a5c58eaa224a4fdb170"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">kaldi::MatrixBase::Row</a></div><div class="ttdeci">const SubVector&lt; Real &gt; Row(MatrixIndexT i) const </div><div class="ttdoc">Return specific row of matrix [const]. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00182">kaldi-matrix.h:182</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">kaldi::Mutex::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00077">kaldi-mutex.cc:77</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a4bca9f5d3b106f8c412e17cba441c7ef"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a4bca9f5d3b106f8c412e17cba441c7ef">kaldi::IvectorExtractorStats::FlushCache</a></div><div class="ttdeci">void FlushCache()</div><div class="ttdoc">Flushes the cache for the R_ stats. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00862">ivector-extractor.cc:862</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_af78986e36e6a8f2e249fbe9801f3ee75"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#af78986e36e6a8f2e249fbe9801f3ee75">kaldi::IvectorExtractorStats::gamma_Y_lock_</a></div><div class="ttdeci">Mutex gamma_Y_lock_</div><div class="ttdoc">This mutex guards gamma_ and Y_ (for multi-threaded update) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00607">ivector-extractor.h:607</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ab109eed73378866c0e8747379378ca44"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">kaldi::VectorBase::AddVec</a></div><div class="ttdeci">void AddVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;v)</div><div class="ttdoc">Add vector : *this = *this + alpha * rv (with casting between floats and doubles) ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01017">kaldi-vector.cc:1017</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a968ca5ee8e1eb1c145956a8c7b5a6098"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForPrior </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit the stats used to update the prior distribution. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00966">966</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="sp-matrix_8h_source.html#l00221">SpMatrix&lt; Real &gt;::AddSp()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01017">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00970">SpMatrix&lt; Real &gt;::AddVec2()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00056">Mutex::Lock()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00660">IvectorExtractorStats::prior_stats_lock_</a>, and <a class="el" href="kaldi-mutex_8cc_source.html#l00077">Mutex::Unlock()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                                      {</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  SpMatrix&lt;double&gt; ivec_scatter(ivec_var);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  ivec_scatter.AddVec2(1.0, ivec_mean);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a77101ca2b796aab9e9c1fa0ea521d5ac">prior_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> += 1.0;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">AddVec</a>(1.0, ivec_mean);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1SpMatrix.html#a22694b33a617880141039386dbbe62f7">AddSp</a>(1.0, ivec_scatter);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a77101ca2b796aab9e9c1fa0ea521d5ac">prior_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a77101ca2b796aab9e9c1fa0ea521d5ac"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a77101ca2b796aab9e9c1fa0ea521d5ac">kaldi::IvectorExtractorStats::prior_stats_lock_</a></div><div class="ttdeci">Mutex prior_stats_lock_</div><div class="ttdoc">This mutex guards num_ivectors_, ivector_sum_ and ivector_scatter_ (for multi-threaded update) ...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00660">ivector-extractor.h:660</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a74d183962cfb39d8c50382b496c82703"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">kaldi::Mutex::Lock</a></div><div class="ttdeci">void Lock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00056">kaldi-mutex.cc:56</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">kaldi::Mutex::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00077">kaldi-mutex.cc:77</a></div></div>
<div class="ttc" id="classkaldi_1_1SpMatrix_html_a22694b33a617880141039386dbbe62f7"><div class="ttname"><a href="classkaldi_1_1SpMatrix.html#a22694b33a617880141039386dbbe62f7">kaldi::SpMatrix::AddSp</a></div><div class="ttdeci">void AddSp(const Real alpha, const SpMatrix&lt; Real &gt; &amp;Ma)</div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8h_source.html#l00221">sp-matrix.h:221</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ab109eed73378866c0e8747379378ca44"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ab109eed73378866c0e8747379378ca44">kaldi::VectorBase::AddVec</a></div><div class="ttdeci">void AddVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;v)</div><div class="ttdoc">Add vector : *this = *this + alpha * rv (with casting between floats and doubles) ...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01017">kaldi-vector.cc:1017</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad779e613a2ac7ab9fd2b4811e1981e7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForSigma </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;&#160;</td>
          <td class="paramname"><em>utt_stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit the stats used to update the variance. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00887">887</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00056">Mutex::Lock()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00103">IvectorExtractorUtteranceStats::S_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00077">Mutex::Unlock()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00651">IvectorExtractorStats::variance_stats_lock_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                                                     {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#aa19c3f94a4f9a633906cbdc38c31f942">variance_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="comment">// Storing the raw scatter statistics per Gaussian.  In the update phase we&#39;ll</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">// take into account some other terms relating to the model means and their</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="comment">// correlation with the data.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; extractor.NumGauss(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].AddSp(1.0, utt_stats.S_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#aa19c3f94a4f9a633906cbdc38c31f942">variance_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a74d183962cfb39d8c50382b496c82703"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">kaldi::Mutex::Lock</a></div><div class="ttdeci">void Lock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00056">kaldi-mutex.cc:56</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">kaldi::Mutex::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00077">kaldi-mutex.cc:77</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_aa19c3f94a4f9a633906cbdc38c31f942"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#aa19c3f94a4f9a633906cbdc38c31f942">kaldi::IvectorExtractorStats::variance_stats_lock_</a></div><div class="ttdeci">Mutex variance_stats_lock_</div><div class="ttdoc">This mutex guards S_ (for multi-threaded update) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00651">ivector-extractor.h:651</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8923beaf8153f8828d8cf85b4c8550bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForUtterance </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;&#160;</td>
          <td class="paramname"><em>utt_stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00979">979</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00966">IvectorExtractorStats::CommitStatsForPrior()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00887">IvectorExtractorStats::CommitStatsForSigma()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00937">IvectorExtractorStats::CommitStatsForW()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00423">IvectorExtractorStatsOptions::compute_auxf</a>, <a class="el" href="ivector-extractor_8h_source.html#l00596">IvectorExtractorStats::config_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00331">IvectorExtractor::GetAuxf()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00063">IvectorExtractor::GetIvectorDistribution()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00245">IvectorExtractor::IvectorDependentWeights()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01031">IvectorExtractorStats::AccStatsForUtterance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                                                     {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = extractor.IvectorDim();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  Vector&lt;double&gt; ivec_mean(ivector_dim);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  SpMatrix&lt;double&gt; ivec_var(ivector_dim);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  extractor.GetIvectorDistribution(utt_stats,</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                   &amp;ivec_mean,</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                   &amp;ivec_var);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a18c486385e691223b803d03d6c728cc5">compute_auxf</a>)</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a> += extractor.GetAuxf(utt_stats, ivec_mean, &amp;ivec_var);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#adb26637ad57afd8d625397218637ca9e">CommitStatsForM</a>(extractor, utt_stats, ivec_mean, ivec_var);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span> (extractor.IvectorDependentWeights())</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a825292fa4cb109e468fd6301cdf610d7">CommitStatsForW</a>(extractor, utt_stats, ivec_mean, ivec_var);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a968ca5ee8e1eb1c145956a8c7b5a6098">CommitStatsForPrior</a>(ivec_mean, ivec_var);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.empty())</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ad779e613a2ac7ab9fd2b4811e1981e7a">CommitStatsForSigma</a>(extractor, utt_stats);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1IvectorExtractorStatsOptions_html_a18c486385e691223b803d03d6c728cc5"><div class="ttname"><a href="structkaldi_1_1IvectorExtractorStatsOptions.html#a18c486385e691223b803d03d6c728cc5">kaldi::IvectorExtractorStatsOptions::compute_auxf</a></div><div class="ttdeci">bool compute_auxf</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00423">ivector-extractor.h:423</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ad779e613a2ac7ab9fd2b4811e1981e7a"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ad779e613a2ac7ab9fd2b4811e1981e7a">kaldi::IvectorExtractorStats::CommitStatsForSigma</a></div><div class="ttdeci">void CommitStatsForSigma(const IvectorExtractor &amp;extractor, const IvectorExtractorUtteranceStats &amp;utt_stats)</div><div class="ttdoc">Commit the stats used to update the variance. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00887">ivector-extractor.cc:887</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a825292fa4cb109e468fd6301cdf610d7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a825292fa4cb109e468fd6301cdf610d7">kaldi::IvectorExtractorStats::CommitStatsForW</a></div><div class="ttdeci">void CommitStatsForW(const IvectorExtractor &amp;extractor, const IvectorExtractorUtteranceStats &amp;utt_stats, const VectorBase&lt; double &gt; &amp;ivec_mean, const SpMatrix&lt; double &gt; &amp;ivec_var)</div><div class="ttdoc">Commit the stats used to update the weight-projection w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00937">ivector-extractor.cc:937</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a968ca5ee8e1eb1c145956a8c7b5a6098"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a968ca5ee8e1eb1c145956a8c7b5a6098">kaldi::IvectorExtractorStats::CommitStatsForPrior</a></div><div class="ttdeci">void CommitStatsForPrior(const VectorBase&lt; double &gt; &amp;ivec_mean, const SpMatrix&lt; double &gt; &amp;ivec_var)</div><div class="ttdoc">Commit the stats used to update the prior distribution. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00966">ivector-extractor.cc:966</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_adb26637ad57afd8d625397218637ca9e"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#adb26637ad57afd8d625397218637ca9e">kaldi::IvectorExtractorStats::CommitStatsForM</a></div><div class="ttdeci">void CommitStatsForM(const IvectorExtractor &amp;extractor, const IvectorExtractorUtteranceStats &amp;utt_stats, const VectorBase&lt; double &gt; &amp;ivec_mean, const SpMatrix&lt; double &gt; &amp;ivec_var)</div><div class="ttdoc">This is called by CommitStatsForUtterance. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00825">ivector-extractor.cc:825</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a825292fa4cb109e468fd6301cdf610d7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForW </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;&#160;</td>
          <td class="paramname"><em>utt_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_mean</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivec_var</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit the stats used to update the weight-projection w_. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00937">937</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-matrix_8h_source.html#l00644">MatrixBase&lt; Real &gt;::AddMatTp()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00704">VectorBase&lt; Real &gt;::AddRowSumMat()</a>, <a class="el" href="tp-matrix_8cc_source.html#l00088">TpMatrix&lt; Real &gt;::Cholesky()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00902">IvectorExtractorStats::CommitStatsForWPoint()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00596">IvectorExtractorStats::config_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="ivector-extractor_8h_source.html#l00424">IvectorExtractorStatsOptions::num_samples_for_weights</a>, and <a class="el" href="kaldi-matrix_8cc_source.html#l01202">MatrixBase&lt; Real &gt;::SetRandn()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>.</p>
<div class="fragment"><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                                      {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> &gt; 1);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  Matrix&lt;double&gt; rand(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a>, extractor.IvectorDim());</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  rand.SetRandn();</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  TpMatrix&lt;double&gt; ivec_stddev(extractor.IvectorDim());</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  ivec_stddev.Cholesky(ivec_var);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  Matrix&lt;double&gt; ivecs(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a>, extractor.IvectorDim());</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  ivecs.AddMatTp(1.0, rand, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, ivec_stddev, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Now make the ivecs zero-mean</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  Vector&lt;double&gt; avg_ivec(extractor.IvectorDim());</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  avg_ivec.AddRowSumMat(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a>, ivecs);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  ivecs.AddVecToRows(-1.0, avg_ivec);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">// Correct the variance for what we just did, so the expected</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// variance still has the correct value.</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  ivecs.Scale(sqrt(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> / (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a> - 1.0)));</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">// Add the mean of the distribution to &quot;ivecs&quot;.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  ivecs.AddVecToRows(1.0, ivec_mean);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// &quot;ivecs&quot; is now a sample from the iVector distribution.</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> samp = 0; samp &lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a>; samp++)</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a66b2b3ac11229f325a4ab2993971004e">CommitStatsForWPoint</a>(extractor, utt_stats,</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                         ivecs.Row(samp),</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                         1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">config_</a>.<a class="code" href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">num_samples_for_weights</a>);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ef1d9fef5999d5b41712230a376108c"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ef1d9fef5999d5b41712230a376108c">kaldi::IvectorExtractorStats::config_</a></div><div class="ttdeci">IvectorExtractorStatsOptions config_</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00596">ivector-extractor.h:596</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a66b2b3ac11229f325a4ab2993971004e"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a66b2b3ac11229f325a4ab2993971004e">kaldi::IvectorExtractorStats::CommitStatsForWPoint</a></div><div class="ttdeci">void CommitStatsForWPoint(const IvectorExtractor &amp;extractor, const IvectorExtractorUtteranceStats &amp;utt_stats, const VectorBase&lt; double &gt; &amp;ivector, double weight)</div><div class="ttdoc">Commit the stats used to update the weight-projection w_– this one takes a point sample, it&#39;s called from CommitStatsForW(). </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00902">ivector-extractor.cc:902</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1IvectorExtractorStatsOptions_html_a3c55a1bf921bffe681780fb909f375fb"><div class="ttname"><a href="structkaldi_1_1IvectorExtractorStatsOptions.html#a3c55a1bf921bffe681780fb909f375fb">kaldi::IvectorExtractorStatsOptions::num_samples_for_weights</a></div><div class="ttdeci">int32 num_samples_for_weights</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00424">ivector-extractor.h:424</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66b2b3ac11229f325a4ab2993971004e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void CommitStatsForWPoint </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorUtteranceStats.html">IvectorExtractorUtteranceStats</a> &amp;&#160;</td>
          <td class="paramname"><em>utt_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>ivector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>weight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Commit the stats used to update the weight-projection w_&ndash; this one takes a point sample, it's called from <a class="el" href="classkaldi_1_1IvectorExtractorStats.html#a825292fa4cb109e468fd6301cdf610d7" title="Commit the stats used to update the weight-projection w_. ">CommitStatsForW()</a>. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00902">902</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l00091">VectorBase&lt; Real &gt;::AddMatVec()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00970">SpMatrix&lt; Real &gt;::AddVec2()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00119">MatrixBase&lt; Real &gt;::AddVecVec()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00840">VectorBase&lt; Real &gt;::ApplySoftMax()</a>, <a class="el" href="packed-matrix_8h_source.html#l00102">PackedMatrix&lt; Real &gt;::Data()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00101">IvectorExtractorUtteranceStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00056">Mutex::Lock()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00077">Mutex::Unlock()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00264">IvectorExtractor::w_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00639">IvectorExtractorStats::weight_stats_lock_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00937">IvectorExtractorStats::CommitStatsForW()</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                   {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_gauss = extractor.NumGauss();</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// Compare this function with GetIvectorDistWeight(), from which it</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="comment">// was derived.</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  Vector&lt;double&gt; logw_unnorm(num_gauss);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  logw_unnorm.AddMatVec(1.0, extractor.w_, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, ivector, 0.0);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  Vector&lt;double&gt; w(logw_unnorm);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  w.ApplySoftMax(); <span class="comment">// now w is the weights.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  Vector&lt;double&gt; linear_coeff(num_gauss);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  Vector&lt;double&gt; quadratic_coeff(num_gauss);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="keywordtype">double</span> gamma = utt_stats.gamma_.Sum();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_gauss; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordtype">double</span> gamma_i = utt_stats.gamma_(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordtype">double</span> max_term = std::max(gamma_i, gamma * w(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    linear_coeff(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = gamma_i - gamma * w(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) + max_term * logw_unnorm(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    quadratic_coeff(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = max_term;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0d7ede213a100c69107a6e4868c660be">weight_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afa203346a8e27a11925c60d784f11acb">AddVecVec</a>(weight, linear_coeff, Vector&lt;double&gt;(ivector));</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = extractor.IvectorDim();</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  SpMatrix&lt;double&gt; outer_prod(ivector_dim);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  outer_prod.AddVec2(1.0, ivector);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  SubVector&lt;double&gt; outer_prod_vec(outer_prod.Data(),</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                                   ivector_dim * (ivector_dim + 1) / 2);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afa203346a8e27a11925c60d784f11acb">AddVecVec</a>(weight, quadratic_coeff, outer_prod_vec);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0d7ede213a100c69107a6e4868c660be">weight_stats_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0d7ede213a100c69107a6e4868c660be"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0d7ede213a100c69107a6e4868c660be">kaldi::IvectorExtractorStats::weight_stats_lock_</a></div><div class="ttdeci">Mutex weight_stats_lock_</div><div class="ttdoc">This mutex guards Q_ and G_ (for multi-threaded update) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00639">ivector-extractor.h:639</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a74d183962cfb39d8c50382b496c82703"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">kaldi::Mutex::Lock</a></div><div class="ttdeci">void Lock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00056">kaldi-mutex.cc:56</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">kaldi::Mutex::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00077">kaldi-mutex.cc:77</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afa203346a8e27a11925c60d784f11acb"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afa203346a8e27a11925c60d784f11acb">kaldi::MatrixBase::AddVecVec</a></div><div class="ttdeci">void AddVecVec(const Real alpha, const VectorBase&lt; OtherReal &gt; &amp;a, const VectorBase&lt; OtherReal &gt; &amp;b)</div><div class="ttdoc">*this += alpha * a * b^T </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l00119">kaldi-matrix.cc:119</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4bca9f5d3b106f8c412e17cba441c7ef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FlushCache </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flushes the cache for the R_ stats. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l00862">862</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-matrix_8cc_source.html#l00161">MatrixBase&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="kaldi-mutex_8cc_source.html#l00056">Mutex::Lock()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00628">IvectorExtractorStats::R_cache_lock_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00634">IvectorExtractorStats::R_gamma_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00636">IvectorExtractorStats::R_ivec_scatter_cache_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00617">IvectorExtractorStats::R_lock_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00632">IvectorExtractorStats::R_num_cached_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00196">MatrixBase&lt; Real &gt;::Range()</a>, and <a class="el" href="kaldi-mutex_8cc_source.html#l00077">Mutex::Unlock()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01098">IvectorExtractorStats::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                       {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a> &gt; 0) {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Flushing cache for IvectorExtractorStats&quot;</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">// Store these quantities as copies in memory so other threads can use the</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">// cache while we update R_ from the cache.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    Matrix&lt;double&gt; R_gamma_cache(</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a61250fd5d121edfdbf5ef05314b18375">Range</a>(0, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>,</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                             0, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">R_gamma_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>()));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    Matrix&lt;double&gt; R_ivec_scatter_cache(</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a61250fd5d121edfdbf5ef05314b18375">Range</a>(0, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a>,</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                                    0, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">R_ivec_scatter_cache_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>()));</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a> = 0; <span class="comment">// As far as other threads are concerned, the cache is</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                       <span class="comment">// cleared and they may write to it.</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a49017afa7dc30fd2cb91cbebd57102aa">R_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">Lock</a>();</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a2b021269071bd3a943e4cec397aca2d1">AddMatMat</a>(1.0, R_gamma_cache, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                 R_ivec_scatter_cache, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 1.0);</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a49017afa7dc30fd2cb91cbebd57102aa">R_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">R_cache_lock_</a>.<a class="code" href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">Unlock</a>();</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a33fe7be89c94c2541badd2d004134388"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a33fe7be89c94c2541badd2d004134388">kaldi::IvectorExtractorStats::R_cache_lock_</a></div><div class="ttdeci">Mutex R_cache_lock_</div><div class="ttdoc">This mutex guards R_num_cached_, R_gamma_cache_, R_ivec_cache_ (for multi-threaded update) ...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00628">ivector-extractor.h:628</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0827fd9bd6c2a3b0f602ab98cfa45990"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0827fd9bd6c2a3b0f602ab98cfa45990">kaldi::IvectorExtractorStats::R_ivec_scatter_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_ivec_scatter_cache_</div><div class="ttdoc">dimension: [num-to-cache][S*(S+1)/2] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00636">ivector-extractor.h:636</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab0b0f0a3b8809bbfd635c8f068e5e1c7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab0b0f0a3b8809bbfd635c8f068e5e1c7">kaldi::IvectorExtractorStats::R_gamma_cache_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_gamma_cache_</div><div class="ttdoc">dimension: [num-to-cache][I] </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00634">ivector-extractor.h:634</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a74d183962cfb39d8c50382b496c82703"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a74d183962cfb39d8c50382b496c82703">kaldi::Mutex::Lock</a></div><div class="ttdeci">void Lock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00056">kaldi-mutex.cc:56</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html_a91b88a5d5517cb042431c4ea24d8ecb7"><div class="ttname"><a href="classkaldi_1_1Mutex.html#a91b88a5d5517cb042431c4ea24d8ecb7">kaldi::Mutex::Unlock</a></div><div class="ttdeci">void Unlock()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8cc_source.html#l00077">kaldi-mutex.cc:77</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a2b021269071bd3a943e4cec397aca2d1"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a2b021269071bd3a943e4cec397aca2d1">kaldi::MatrixBase::AddMatMat</a></div><div class="ttdeci">void AddMatMat(const Real alpha, const MatrixBase&lt; Real &gt; &amp;A, MatrixTransposeType transA, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType transB, const Real beta)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l00161">kaldi-matrix.cc:161</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a61250fd5d121edfdbf5ef05314b18375"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a61250fd5d121edfdbf5ef05314b18375">kaldi::MatrixBase::Range</a></div><div class="ttdeci">SubMatrix&lt; Real &gt; Range(const MatrixIndexT row_offset, const MatrixIndexT num_rows, const MatrixIndexT col_offset, const MatrixIndexT num_cols) const </div><div class="ttdoc">Return a sub-part of matrix. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00196">kaldi-matrix.h:196</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::MatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdoc">Returns number of columns (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a49017afa7dc30fd2cb91cbebd57102aa"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a49017afa7dc30fd2cb91cbebd57102aa">kaldi::IvectorExtractorStats::R_lock_</a></div><div class="ttdeci">Mutex R_lock_</div><div class="ttdoc">This mutex guards R_ (for multi-threaded update) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00617">ivector-extractor.h:617</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa27f0e56d6ba2aeb151091a10bf7385d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void GetOrthogonalIvectorTransform </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1SubMatrix.html">SubMatrix</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes an orthogonal matrix A from the iVector transform T such that T' = A*T is an alternative transform which diagonalizes the quadratic_term_ in the iVector estimation objective function. </p>
<p>This reorders the dimensions of the iVector from most to least important, which may be more convenient to view. The transform should not affect the performance of systems which use iVectors. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01252">1252</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-matrix_8cc_source.html#l00346">MatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00091">VectorBase&lt; Real &gt;::AddMatVec()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00182">IvectorExtractor::ComputeDerivedVars()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00033">MatrixBase&lt; Real &gt;::Invert()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00245">IvectorExtractor::IvectorDependentWeights()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00692">Matrix&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01177">MatrixBase&lt; Real &gt;::SetZero()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l02347">kaldi::SortSvd()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00298">IvectorExtractor::U_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00270">IvectorExtractor::w_vec_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>.</p>
<div class="fragment"><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                                       {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  extractor-&gt;ComputeDerivedVars(); <span class="comment">// Update the extractor-&gt;U_ matrix.</span></div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = extractor-&gt;IvectorDim(),</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;        num_gauss = extractor-&gt;NumGauss();</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> quad_dim = ivector_dim*(ivector_dim + 1)/2;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  <span class="comment">// Each row of extractor-&gt;U_ is an SpMatrix. We can compute the weighted</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="comment">// avg of these rows in a SubVector that updates the data of the SpMatrix</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <span class="comment">// Uavg.</span></div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  SpMatrix&lt;double&gt; Uavg(ivector_dim), Vavg(ivector_dim - 1);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  SubVector&lt;double&gt; uavg_vec(Uavg.Data(), quad_dim);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keywordflow">if</span> (extractor-&gt;IvectorDependentWeights()) {</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    Vector&lt;double&gt; w_uniform(num_gauss);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_gauss; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) w_uniform(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = 1.0;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    uavg_vec.AddMatVec(1.0/num_gauss, extractor-&gt;U_, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, w_uniform, 0.0);</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    uavg_vec.AddMatVec(1.0, extractor-&gt;U_, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, extractor-&gt;w_vec_, 0.0);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  Matrix&lt;double&gt; Tinv(T);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  Tinv.Invert();</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;  Matrix&lt;double&gt; Vavg_temp(Vavg), Uavg_temp(Uavg);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  Vavg_temp.AddMatMatMat(1.0, Tinv, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, SubMatrix&lt;double&gt;(Uavg_temp,</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                           1, ivector_dim-1, 1, ivector_dim-1),</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                         <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, Tinv, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 0.0);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  Vavg.CopyFromMat(Vavg_temp);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  Vector&lt;double&gt; s(ivector_dim-1);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  Matrix&lt;double&gt; P(ivector_dim-1, ivector_dim-1);</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  Vavg.Eig(&amp;s, &amp;P);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  <a class="code" href="group__matrix__funcs__misc.html#ga4318e745ace6367bd00b2911089e9e79">SortSvd</a>(&amp;s, &amp;P);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  A-&gt;Resize(P.NumCols(), P.NumRows());</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  A-&gt;SetZero();</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;  A-&gt;AddMat(1.0, P, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Eigenvalues of Vavg: &quot;</span> &lt;&lt; s;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="group__matrix__funcs__misc_html_ga4318e745ace6367bd00b2911089e9e79"><div class="ttname"><a href="group__matrix__funcs__misc.html#ga4318e745ace6367bd00b2911089e9e79">kaldi::SortSvd</a></div><div class="ttdeci">void SortSvd(VectorBase&lt; Real &gt; *s, MatrixBase&lt; Real &gt; *U, MatrixBase&lt; Real &gt; *Vt, bool sort_on_absolute_value)</div><div class="ttdoc">Function to ensure that SVD is sorted. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02347">kaldi-matrix.cc:2347</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3df83e12b5913d5ff087591a9219ded2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IvectorVarianceDiagnostic </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> &amp;&#160;</td>
          <td class="paramname"><em>extractor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the proportion of the variance explained by the Ivector model versus the Gaussians. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01196">1196</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l00028">IvectorExtractor::FeatDim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00049">IvectorExtractor::InvertWithFlooring()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="ivector-extractor_8h_source.html#l00276">IvectorExtractor::M_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="packed-matrix_8cc_source.html#l00033">PackedMatrix&lt; Real &gt;::Scale()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00279">IvectorExtractor::Sigma_inv_</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>.</p>
<div class="fragment"><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                     {</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="comment">// W is an estimate of the total residual variance explained by the</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="comment">// speaker-adapated model.  B is an estimate of the total variance</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="comment">// explained by the Ivector-subspace.</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  SpMatrix&lt;double&gt; W(extractor.Sigma_inv_[0].NumRows()),</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                      B(extractor.M_[0].NumRows());</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  Vector&lt;double&gt; w(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  w.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>());</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; extractor.NumGauss(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    SpMatrix&lt;double&gt; Sigma_i(extractor.FeatDim());</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    extractor.InvertWithFlooring(extractor.Sigma_inv_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;Sigma_i);</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    W.AddSp(w(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>), Sigma_i);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    B.AddMat2(w(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>), extractor.M_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 1.0);</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  }</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordtype">double</span> trace_W = W.Trace(),</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;         trace_B = B.Trace();</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;The proportion of within-Gaussian variance explained by &quot;</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;the iVectors is &quot;</span> &lt;&lt; trace_B / (trace_B + trace_W) &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addbcf588eba97d93d9e4612be3dcb4f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a>&amp; operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="acee3688cee9aed69e95240efbc0fd4d7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double PriorDiagnostics </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>old_prior_offset</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01501">1501</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="sp-matrix_8cc_source.html#l00970">SpMatrix&lt; Real &gt;::AddVec2()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="sp-matrix_8cc_source.html#l00036">SpMatrix&lt; Real &gt;::LogPosDefDet()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="packed-matrix_8cc_source.html#l00033">PackedMatrix&lt; Real &gt;::Scale()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00936">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="sp-matrix_8cc_source.html#l00197">SpMatrix&lt; Real &gt;::Trace()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>.</p>
<div class="fragment"><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                                                            {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">// The iVectors had a centered covariance &quot;covar&quot;; we want to figure out</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="comment">// the objective-function change from rescaling.  It&#39;s as if we were</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="comment">// formerly modeling &quot;covar&quot; with the unit matrix, and we&#39;re now modeling</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="comment">// it with &quot;covar&quot; itself.  This is ignoring flooring issues.  Of course,</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="comment">// we implement it through rescaling the space, but it has the same effect.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="comment">// We also need to take into account that before the rescaling etc., the</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  <span class="comment">// old mean might have been wrong.</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>();</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  Vector&lt;double&gt; sum(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  sum.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  SpMatrix&lt;double&gt; covar(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  covar.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>);</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  covar.AddVec2(-1.0, sum); <span class="comment">// Get the centered covariance.</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="comment">// Now work out the offset from the old prior&#39;s mean.</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  Vector&lt;double&gt; mean_offset(sum);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  mean_offset(0) -= old_prior_offset;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  SpMatrix&lt;double&gt; old_covar(covar); <span class="comment">// the covariance around the old mean.</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  old_covar.AddVec2(1.0, mean_offset);</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;  <span class="comment">// old likelihood = -0.5 * (Trace(I old_covar) + logdet(I) + [ignored])</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keywordtype">double</span> old_like = -0.5 * old_covar.Trace();</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="comment">// new likelihood is if we updated the variance to equal &quot;covar&quot;... this isn&#39;t</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;  <span class="comment">// how we did it (we use rescaling of the ivectors) but it has the same</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;  <span class="comment">// effect.  -0.5 * (Trace(covar^{-1} covar)  + logdet(covar))</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;  <span class="keywordtype">double</span> new_like = -0.5 * (ivector_dim + covar.LogPosDefDet()),</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      like_change = new_like - old_like,</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      like_change_per_frame = like_change * <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall auxf improvement from prior is &quot;</span> &lt;&lt; like_change_per_frame</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; per frame, or &quot;</span> &lt;&lt; like_change &lt;&lt; <span class="stringliteral">&quot; per iVector.&quot;</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">return</span> like_change_per_frame; <span class="comment">// we&#39;ll be adding this to other per-frame</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                                <span class="comment">// quantities.</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e0bf83c9362bc2a8f732c6f5e50ffdd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Read </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>add</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01139">1139</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="io-funcs_8cc_source.html#l00188">kaldi::ExpectToken()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="packed-matrix_8cc_source.html#l00298">PackedMatrix&lt; Real &gt;::Read()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01082">Vector&lt; Real &gt;::Read()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01297">Matrix&lt; Real &gt;::Read()</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00054">kaldi::ReadBasicType()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor-test_8cc_source.html#l00039">kaldi::TestIvectorExtractorStatsIO()</a>.</p>
<div class="fragment"><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                                                                      {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;IvectorExtractorStats&gt;&quot;</span>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;TotAuxf&gt;&quot;</span>);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a>, add);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;gamma&gt;&quot;</span>);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1Vector.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;Y&gt;&quot;</span>);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;size);</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.resize(size);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a4e0bf83c9362bc2a8f732c6f5e50ffdd">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;R&gt;&quot;</span>);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;Q&gt;&quot;</span>);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;G&gt;&quot;</span>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1Matrix.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;S&gt;&quot;</span>);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;size);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.resize(size);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a4e0bf83c9362bc2a8f732c6f5e50ffdd">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;NumIvectors&gt;&quot;</span>);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>, add);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;IvectorSum&gt;&quot;</span>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1Vector.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;IvectorScatter&gt;&quot;</span>);</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1PackedMatrix.html#aee763dab434f2d24c20edf16dada3abc">Read</a>(is, binary, add);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;/IvectorExtractorStats&gt;&quot;</span>);</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1PackedMatrix_html_aee763dab434f2d24c20edf16dada3abc"><div class="ttname"><a href="classkaldi_1_1PackedMatrix.html#aee763dab434f2d24c20edf16dada3abc">kaldi::PackedMatrix::Read</a></div><div class="ttdeci">void Read(std::istream &amp;in, bool binary, bool add=false)</div><div class="ttdef"><b>Definition:</b> <a href="packed-matrix_8cc_source.html#l00298">packed-matrix.cc:298</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00054">io-funcs-inl.h:54</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a4e0bf83c9362bc2a8f732c6f5e50ffdd"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a4e0bf83c9362bc2a8f732c6f5e50ffdd">kaldi::IvectorExtractorStats::Read</a></div><div class="ttdeci">void Read(std::istream &amp;is, bool binary, bool add=false)</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01139">ivector-extractor.cc:1139</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html_aee763dab434f2d24c20edf16dada3abc"><div class="ttname"><a href="classkaldi_1_1Matrix.html#aee763dab434f2d24c20edf16dada3abc">kaldi::Matrix::Read</a></div><div class="ttdeci">void Read(std::istream &amp;in, bool binary, bool add=false)</div><div class="ttdoc">read from stream. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l01297">kaldi-matrix.cc:1297</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga4c7a80f758e878578e78b667f62463a5"><div class="ttname"><a href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">kaldi::ExpectToken</a></div><div class="ttdeci">void ExpectToken(std::istream &amp;is, bool binary, const char *token)</div><div class="ttdoc">ExpectToken tries to read in the given token, and throws an exception on failure. ...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00188">io-funcs.cc:188</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html_aee763dab434f2d24c20edf16dada3abc"><div class="ttname"><a href="classkaldi_1_1Vector.html#aee763dab434f2d24c20edf16dada3abc">kaldi::Vector::Read</a></div><div class="ttdeci">void Read(std::istream &amp;in, bool binary, bool add=false)</div><div class="ttdoc">Read function using C++ streams. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01082">kaldi-vector.cc:1082</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab98cd0287389f6faf1acc29f5b4111fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Update </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the objf improvement per frame. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01171">1171</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00182">IvectorExtractor::ComputeDerivedVars()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00245">IvectorExtractor::IvectorDependentWeights()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01315">IvectorExtractorStats::UpdateProjections()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01336">IvectorExtractorStats::UpdateVariances()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01477">IvectorExtractorStats::UpdateWeights()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor-test_8cc_source.html#l00145">kaldi::UnitTestIvectorExtractor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                       {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a9ce553a30c834384555bc0f10024b7d2">CheckDims</a>(*extractor);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a> != 0.0) {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall auxf/frame on training data was &quot;</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;              &lt;&lt; (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a>/<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>()) &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;              &lt;&lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>() &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordtype">double</span> ans = 0.0;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  ans += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a324c315bad7b1c422c702a33404adc93">UpdateProjections</a>(opts, extractor);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">if</span> (extractor-&gt;IvectorDependentWeights())</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    ans += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#adbeb51570be96507c7ca9a7f08ee76fa">UpdateWeights</a>(opts, extractor);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.empty())</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    ans += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1e670dee665f61c7fa9fa1d6b010fed1">UpdateVariances</a>(opts, extractor);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  ans += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ad33f0978df21eb0d8168d556fd76de54">UpdatePrior</a>(opts, extractor); <span class="comment">// This will also transform the ivector</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                       <span class="comment">// space.  Note: this must be done as the</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                                       <span class="comment">// last stage, because it will make the</span></div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                       <span class="comment">// stats invalid for that model.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall objective-function improvement per frame was &quot;</span> &lt;&lt; ans;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  extractor-&gt;ComputeDerivedVars();</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_adbeb51570be96507c7ca9a7f08ee76fa"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#adbeb51570be96507c7ca9a7f08ee76fa">kaldi::IvectorExtractorStats::UpdateWeights</a></div><div class="ttdeci">double UpdateWeights(const IvectorExtractorEstimationOptions &amp;opts, IvectorExtractor *extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01477">ivector-extractor.cc:1477</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a324c315bad7b1c422c702a33404adc93"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a324c315bad7b1c422c702a33404adc93">kaldi::IvectorExtractorStats::UpdateProjections</a></div><div class="ttdeci">double UpdateProjections(const IvectorExtractorEstimationOptions &amp;opts, IvectorExtractor *extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01315">ivector-extractor.cc:1315</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ad33f0978df21eb0d8168d556fd76de54"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ad33f0978df21eb0d8168d556fd76de54">kaldi::IvectorExtractorStats::UpdatePrior</a></div><div class="ttdeci">double UpdatePrior(const IvectorExtractorEstimationOptions &amp;opts, IvectorExtractor *extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01539">ivector-extractor.cc:1539</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a9ce553a30c834384555bc0f10024b7d2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a9ce553a30c834384555bc0f10024b7d2">kaldi::IvectorExtractorStats::CheckDims</a></div><div class="ttdeci">void CheckDims(const IvectorExtractor &amp;extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01003">ivector-extractor.cc:1003</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1e670dee665f61c7fa9fa1d6b010fed1"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1e670dee665f61c7fa9fa1d6b010fed1">kaldi::IvectorExtractorStats::UpdateVariances</a></div><div class="ttdeci">double UpdateVariances(const IvectorExtractorEstimationOptions &amp;opts, IvectorExtractor *extractor) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01336">ivector-extractor.cc:1336</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad33f0978df21eb0d8168d556fd76de54"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdatePrior </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01539">1539</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="sp-matrix_8cc_source.html#l01006">SpMatrix&lt; Real &gt;::AddMat2Sp()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00161">MatrixBase&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00091">VectorBase&lt; Real &gt;::AddMatVec()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00970">SpMatrix&lt; Real &gt;::AddVec2()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00119">MatrixBase&lt; Real &gt;::AddVecVec()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00802">VectorBase&lt; Real &gt;::ApplyFloor()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00448">VectorBase&lt; Real &gt;::ApplyPow()</a>, <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00451">IvectorExtractorEstimationOptions::diagonalize</a>, <a class="el" href="qr_8cc_source.html#l00433">SpMatrix&lt; Real &gt;::Eig()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01252">IvectorExtractorStats::GetOrthogonalIvectorTransform()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00504">SpMatrix&lt; Real &gt;::IsUnit()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="kaldi-math_8h_source.html#l00048">M_SQRT2</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00566">VectorBase&lt; Real &gt;::Max()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00606">VectorBase&lt; Real &gt;::Min()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01082">MatrixBase&lt; Real &gt;::MulRowsVec()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00508">VectorBase&lt; Real &gt;::Norm()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00284">IvectorExtractor::prior_offset_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01501">IvectorExtractorStats::PriorDiagnostics()</a>, <a class="el" href="packed-matrix_8cc_source.html#l00033">PackedMatrix&lt; Real &gt;::Scale()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00936">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01195">MatrixBase&lt; Real &gt;::SetUnit()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l00508">IvectorExtractor::TransformIvectors()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                                       {</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a> &gt; 0.0);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  Vector&lt;double&gt; sum(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;  sum.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  SpMatrix&lt;double&gt; covar(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  covar.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  covar.AddVec2(-1.0, sum); <span class="comment">// Get the centered covariance.</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = extractor-&gt;IvectorDim();</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;  Vector&lt;double&gt; s(ivector_dim);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  Matrix&lt;double&gt; P(ivector_dim, ivector_dim);</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="comment">// decompose covar = P diag(s) P^T:</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  covar.Eig(&amp;s, &amp;P);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Eigenvalues of iVector covariance range from &quot;</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            &lt;&lt; s.Min() &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; s.Max();</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_floored = s.ApplyFloor(1.0e-07);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordflow">if</span> (num_floored &gt; 0)</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Floored &quot;</span> &lt;&lt; num_floored &lt;&lt; <span class="stringliteral">&quot; eigenvalues of covar &quot;</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;of iVectors.&quot;</span>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  Matrix&lt;double&gt; T(P, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  { <span class="comment">// set T to a transformation that makes covar unit</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">// (modulo floored eigenvalues).</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    Vector&lt;double&gt; scales(s);</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    scales.ApplyPow(-0.5);</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    T.MulRowsVec(scales);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordflow">if</span> (num_floored == 0) { <span class="comment">// a check..</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      SpMatrix&lt;double&gt; Tproj(ivector_dim);</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      Tproj.AddMat2Sp(1.0, T, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, covar, 0.0);</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(Tproj.IsUnit(1.0e-06));</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    }</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  }</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  Vector&lt;double&gt; sum_proj(ivector_dim);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  sum_proj.AddMatVec(1.0, T, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, sum, 0.0);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sum_proj.Norm(2.0) != 0.0);</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="comment">// We need a projection that (like T) makes &quot;covar&quot; unit,</span></div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="comment">// but also that sends &quot;sum&quot; to a multiple of the vector e0 = [ 1 0 0 0 .. ].</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  <span class="comment">// We&#39;ll do this by a transform that follows T, of the form</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="comment">// (I - 2 a a^T), where a is unit.  [i.e. a Householder reflection].</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="comment">// Firstly, let x equal sum_proj normalized to unit length.</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  <span class="comment">// We&#39;ll let a = alpha x + beta e0, for suitable coefficients alpha and beta,</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  <span class="comment">// To project sum_proj (or equivalenty, x) to a multiple of e0, we&#39;ll need that</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;  <span class="comment">// the x term in</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  <span class="comment">//  (I - 2(alpha x + beta e0)(alpha x + beta e0)  x</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <span class="comment">// equals zero., i.e. 1 - 2 alpha (alpha x^T x + beta e0^T x) == 0,</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="comment">//    (1 - 2 alpha^2 - 2 alpha beta x0) = 0</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;  <span class="comment">// To ensure that a is unit, we require that</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;  <span class="comment">// (alpha x + beta e0).(alpha x + beta e0) = 1, i.e.</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="comment">//    alpha^2 + beta^2 + 2 alpha beta x0 = 1</span></div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  <span class="comment">// at wolframalpha.com,</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="comment">// Solve[ {a^2 + b^2 + 2 a b x = 1}, {1 - 2 a^2 - 2 a b x = 0}, {a, b} ]</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="comment">// gives different solutions, but the one that keeps the offset positive</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="comment">// after projection seems to be:</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="comment">//    alpha = 1/(sqrt(2)sqrt(1 - x0)), beta = -alpha</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  Matrix&lt;double&gt; U(ivector_dim, ivector_dim);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;  U.SetUnit();</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  Vector&lt;double&gt; x(sum_proj);</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  x.Scale(1.0 / x.Norm(2.0));</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keywordtype">double</span> x0 = x(0), alpha, beta;</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  alpha = 1.0 / (<a class="code" href="kaldi-math_8h.html#a66b3ab30f1332874326ed93969e496e0">M_SQRT2</a> * sqrt(1.0 - x0));</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  beta = -alpha;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  Vector&lt;double&gt; a(x);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  a.Scale(alpha);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;  a(0) += beta;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  U.AddVecVec(-2.0, a, a);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  Matrix&lt;double&gt; V(ivector_dim, ivector_dim);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  V.AddMatMat(1.0, U, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, T, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 0.0);</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="comment">// Optionally replace transform V with V&#39; such that V&#39; makes the</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="comment">// covariance unit and additionally diagonalizes the quadratic</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="comment">// term.</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="keywordflow">if</span> (opts.diagonalize) {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    SubMatrix&lt;double&gt; Vsub(V, 1, V.NumRows()-1, 0, V.NumCols());</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    Matrix&lt;double&gt; Vtemp(SubMatrix&lt;double&gt;(V, 1, V.NumRows()-1,</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                         0, V.NumCols())),</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                   A;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#aa27f0e56d6ba2aeb151091a10bf7385d">GetOrthogonalIvectorTransform</a>(SubMatrix&lt;double&gt;(Vtemp, 0,</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                                  Vtemp.NumRows(), 1, Vtemp.NumCols()-1),</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                                  extractor, &amp;A);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="comment">// It is necessary to exclude the first row of V in this transformation</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="comment">// so that the sum_vproj has the form [ x 0 0 0 .. ], where x &gt; 0.</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    Vsub.AddMatMat(1.0, A, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, Vtemp, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, 0.0);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  }</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="keywordflow">if</span> (num_floored == 0) { <span class="comment">// a check..</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    SpMatrix&lt;double&gt; Vproj(ivector_dim);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    Vproj.AddMat2Sp(1.0, V, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, covar, 0.0);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(Vproj.IsUnit(1.0e-04));</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;  }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;  Vector&lt;double&gt; sum_vproj(ivector_dim);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  sum_vproj.AddMatVec(1.0, V, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, sum, 0.0);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;  <span class="comment">// Make sure sum_vproj is of the form [ x 0 0 0 .. ] with x &gt; 0.</span></div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;  <span class="comment">// (the x &gt; 0 part isn&#39;t really necessary, it&#39;s just nice to know.)</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(sum_vproj(0), sum_vproj.Norm(2.0)));</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="keywordtype">double</span> ans = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acee3688cee9aed69e95240efbc0fd4d7">PriorDiagnostics</a>(extractor-&gt;prior_offset_);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  extractor-&gt;TransformIvectors(V, sum_vproj(0));</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_aa27f0e56d6ba2aeb151091a10bf7385d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#aa27f0e56d6ba2aeb151091a10bf7385d">kaldi::IvectorExtractorStats::GetOrthogonalIvectorTransform</a></div><div class="ttdeci">void GetOrthogonalIvectorTransform(const SubMatrix&lt; double &gt; &amp;T, IvectorExtractor *extractor, Matrix&lt; double &gt; *A) const </div><div class="ttdoc">Computes an orthogonal matrix A from the iVector transform T such that T&#39; = A*T is an alternative tra...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01252">ivector-extractor.cc:1252</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acee3688cee9aed69e95240efbc0fd4d7"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acee3688cee9aed69e95240efbc0fd4d7">kaldi::IvectorExtractorStats::PriorDiagnostics</a></div><div class="ttdeci">double PriorDiagnostics(double old_prior_offset) const </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01501">ivector-extractor.cc:1501</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="kaldi-math_8h_html_a66b3ab30f1332874326ed93969e496e0"><div class="ttname"><a href="kaldi-math_8h.html#a66b3ab30f1332874326ed93969e496e0">M_SQRT2</a></div><div class="ttdeci">#define M_SQRT2</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00048">kaldi-math.h:48</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8effcbfb888765a258a3141e9b29de0d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdateProjection </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td>
          <td class="paramname"><em>gaussian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01218">1218</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l00227">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="sp-matrix_8h_source.html#l00458">SolverOptions::diagonal_precondition</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00449">IvectorExtractorEstimationOptions::gaussian_min_count</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="matrix-common_8h_source.html#l00037">kaldi::kUndefined</a>, <a class="el" href="ivector-extractor_8h_source.html#l00276">IvectorExtractor::M_</a>, <a class="el" href="sp-matrix_8h_source.html#l00456">SolverOptions::name</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00279">IvectorExtractor::Sigma_inv_</a>, <a class="el" href="sp-matrix_8cc_source.html#l00753">kaldi::SolveQuadraticMatrixProblem()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01302">IvectorExtractorUpdateProjectionClass::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                                       {</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> I = extractor-&gt;NumGauss(), S = extractor-&gt;IvectorDim();</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= 0 &amp;&amp; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">    For Gaussian index i, maximize the auxiliary function</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">       Q_i(x) = tr(M_i^T Sigma_i^{-1} Y_i)  - 0.5 tr(Sigma_i^{-1} M_i R_i M_i^T)</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; opts.gaussian_min_count) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Skipping Gaussian index &quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; because count &quot;</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;               &lt;&lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; is below min-count.&quot;</span>;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;  SpMatrix&lt;double&gt; R(S, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>), SigmaInv(extractor-&gt;Sigma_inv_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;  SubVector&lt;double&gt; R_vec(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>); <span class="comment">// i&#39;th row of R; vectorized form of SpMatrix.</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  SubVector&lt;double&gt; R_sp(R.Data(), S * (S+1) / 2);</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  R_sp.CopyFromVec(R_vec); <span class="comment">// copy to SpMatrix&#39;s memory.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  Matrix&lt;double&gt; M(extractor-&gt;M_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  SolverOptions solver_opts;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  solver_opts.name = <span class="stringliteral">&quot;M&quot;</span>;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  solver_opts.diagonal_precondition = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <span class="keywordtype">double</span> impr = <a class="code" href="group__matrix__funcs__misc.html#gae6eded79725fb0ed1307d30476f419ee">SolveQuadraticMatrixProblem</a>(R, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], SigmaInv, solver_opts, &amp;M),</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      gamma = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Objf impr for M for Gaussian index &quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                  &lt;&lt; (impr / gamma) &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span> &lt;&lt; gamma &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  extractor-&gt;M_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].CopyFromMat(M);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="keywordflow">return</span> impr;</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00037">matrix-common.h:37</a></div></div>
<div class="ttc" id="group__matrix__funcs__misc_html_gae6eded79725fb0ed1307d30476f419ee"><div class="ttname"><a href="group__matrix__funcs__misc.html#gae6eded79725fb0ed1307d30476f419ee">kaldi::SolveQuadraticMatrixProblem</a></div><div class="ttdeci">Real SolveQuadraticMatrixProblem(const SpMatrix&lt; Real &gt; &amp;Q, const MatrixBase&lt; Real &gt; &amp;Y, const SpMatrix&lt; Real &gt; &amp;SigmaInv, const SolverOptions &amp;opts, MatrixBase&lt; Real &gt; *M)</div><div class="ttdoc">Maximizes the auxiliary function :  Like a numerically stable version of . </div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8cc_source.html#l00753">sp-matrix.cc:753</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a324c315bad7b1c422c702a33404adc93"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdateProjections </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01315">1315</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="arpa-file-parser-test_8cc_source.html#l00065">count</a>, <a class="el" href="kaldi-thread_8cc_source.html#l00025">kaldi::g_num_threads</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-task-sequence_8h_source.html#l00061">TaskSequencerConfig::num_threads</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-task-sequence_8h_source.html#l00093">TaskSequencer&lt; C &gt;::Run()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                                       {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> I = extractor-&gt;NumGauss();</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keywordtype">double</span> tot_impr = 0.0;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    TaskSequencerConfig sequencer_opts;</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    sequencer_opts.num_threads = <a class="code" href="namespacekaldi.html#a68c81349230513ef8553df7b1f685cee">g_num_threads</a>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    TaskSequencer&lt;IvectorExtractorUpdateProjectionClass&gt; sequencer(</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        sequencer_opts);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;      sequencer.Run(<span class="keyword">new</span> <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a30a4f520516ebbf6ad4ee67bdfe76b1f">IvectorExtractorUpdateProjectionClass</a>(</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;          *<span class="keyword">this</span>, opts, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>, extractor, &amp;tot_impr));</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a> = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall objective function improvement for M (mean projections) &quot;</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;was &quot;</span> &lt;&lt; (tot_impr / <a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a>) &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;  <span class="keywordflow">return</span> tot_impr / <a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a68c81349230513ef8553df7b1f685cee"><div class="ttname"><a href="namespacekaldi.html#a68c81349230513ef8553df7b1f685cee">kaldi::g_num_threads</a></div><div class="ttdeci">int32 g_num_threads</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-thread_8cc_source.html#l00025">kaldi-thread.cc:25</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_a951345011b75d2e8d9bfc18ca63510d2"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a></div><div class="ttdeci">const size_t count</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00065">arpa-file-parser-test.cc:65</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a30a4f520516ebbf6ad4ee67bdfe76b1f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a30a4f520516ebbf6ad4ee67bdfe76b1f">kaldi::IvectorExtractorStats::IvectorExtractorUpdateProjectionClass</a></div><div class="ttdeci">friend class IvectorExtractorUpdateProjectionClass</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00518">ivector-extractor.h:518</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1e670dee665f61c7fa9fa1d6b010fed1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdateVariances </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01336">1336</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-matrix_8cc_source.html#l00346">MatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="sp-matrix_8cc_source.html#l01006">SpMatrix&lt; Real &gt;::AddMat2Sp()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00161">MatrixBase&lt; Real &gt;::AddMatMat()</a>, <a class="el" href="sp-matrix_8h_source.html#l00221">SpMatrix&lt; Real &gt;::AddSp()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00560">SpMatrix&lt; Real &gt;::ApplyFloor()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00227">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="packed-matrix_8h_source.html#l00102">PackedMatrix&lt; Real &gt;::Data()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00028">IvectorExtractor::FeatDim()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00449">IvectorExtractorEstimationOptions::gaussian_min_count</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="sp-matrix_8cc_source.html#l00245">SpMatrix&lt; Real &gt;::Invert()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00045">kaldi::kTakeMeanAndCheck</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="sp-matrix_8cc_source.html#l00036">SpMatrix&lt; Real &gt;::LogPosDefDet()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00276">IvectorExtractor::M_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="packed-matrix_8h_source.html#l00104">PackedMatrix&lt; Real &gt;::NumRows()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="packed-matrix_8cc_source.html#l00033">PackedMatrix&lt; Real &gt;::Scale()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00279">IvectorExtractor::Sigma_inv_</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00350">kaldi::TraceSpSp()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00448">IvectorExtractorEstimationOptions::variance_floor_factor</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                       {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_gauss = extractor-&gt;NumGauss(),</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      feat_dim = extractor-&gt;FeatDim(),</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      ivector_dim = extractor-&gt;IvectorDim();</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.empty());</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;  <span class="keywordtype">double</span> tot_objf_impr = 0.0;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <span class="comment">// &quot;raw_variances&quot; will be the variances directly from</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;  <span class="comment">// the stats, without any flooring.</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;  std::vector&lt;SpMatrix&lt;double&gt; &gt; raw_variances(num_gauss);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  SpMatrix&lt;double&gt; var_floor(feat_dim);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;  <span class="keywordtype">double</span> var_floor_count = 0.0;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_gauss; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; opts.gaussian_min_count) <span class="keywordflow">continue</span>; <span class="comment">// warned in UpdateProjections</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    SpMatrix&lt;double&gt; &amp;S(raw_variances[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    S = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]; <span class="comment">// Set it to the raw scatter statistics.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="comment">// The equations for estimating the variance are similar to</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">// those used in SGMMs.  We need to convert it to a centered</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">// covariance, and for this we can use a combination of other</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="comment">// stats and the model parameters.</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    Matrix&lt;double&gt; M(extractor-&gt;M_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="comment">// Y * M^T.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    Matrix&lt;double&gt; YM(feat_dim, feat_dim);</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    YM.AddMatMat(1.0, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    Matrix&lt;double&gt; YMMY(YM, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    YMMY.AddMat(1.0, YM);</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">// Now, YMMY = Y * M^T + M * Y^T.  This is a kind of cross-term</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="comment">// between the mean and the data, which we subtract.</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    SpMatrix&lt;double&gt; YMMY_sp(YMMY, <a class="code" href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90a9b23664a21e2e3077455db2d031aeb3b">kTakeMeanAndCheck</a>);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    S.AddSp(-1.0, YMMY_sp);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// Add in a mean-squared term.</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    SpMatrix&lt;double&gt; R(ivector_dim); <span class="comment">// will be scatter of iVectors, weighted</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                                     <span class="comment">// by count for this Gaussian.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    SubVector&lt;double&gt; R_vec(R.Data(),</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                            ivector_dim * (ivector_dim + 1) / 2);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    R_vec.CopyFromVec(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(i)); <span class="comment">//</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    S.AddMat2Sp(1.0, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, R, 1.0);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    var_floor.AddSp(1.0, S);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    var_floor_count += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(i);</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    S.Scale(1.0 / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(i));</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  }</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(var_floor_count &gt; 0.0);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(opts.variance_floor_factor &gt; 0.0 &amp;&amp;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;               opts.variance_floor_factor &lt;= 1.0);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  var_floor.Scale(opts.variance_floor_factor / var_floor_count);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tot_num_floored = 0;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0; i &lt; num_gauss; i++) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    SpMatrix&lt;double&gt; &amp;S(raw_variances[i]); <span class="comment">// un-floored variance.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="keywordflow">if</span> (S.NumRows() == 0) <span class="keywordflow">continue</span>; <span class="comment">// due to low count.</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    SpMatrix&lt;double&gt; floored_var(S);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    SpMatrix&lt;double&gt; old_inv_var(extractor-&gt;Sigma_inv_[i]);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_floored = floored_var.ApplyFloor(var_floor);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    tot_num_floored += num_floored;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    <span class="keywordflow">if</span> (num_floored &gt; 0)</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;For Gaussian index &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;, floored &quot;</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                &lt;&lt; num_floored &lt;&lt; <span class="stringliteral">&quot; eigenvalues of variance.&quot;</span>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// this objf is per frame;</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordtype">double</span> old_objf = -0.5 * (<a class="code" href="group__matrix__funcs__scalar.html#ga8bee82d44b3d0b8e546fd48a5a68deb4">TraceSpSp</a>(S, old_inv_var) -</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                              old_inv_var.LogPosDefDet());</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    SpMatrix&lt;double&gt; new_inv_var(floored_var);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    new_inv_var.Invert();</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordtype">double</span> new_objf = -0.5 * (<a class="code" href="group__matrix__funcs__scalar.html#ga8bee82d44b3d0b8e546fd48a5a68deb4">TraceSpSp</a>(S, new_inv_var) -</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                                 new_inv_var.LogPosDefDet());</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (i &lt; 4) {</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Objf impr/frame for variance for Gaussian index &quot;</span></div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                    &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; was &quot;</span> &lt;&lt; (new_objf - old_objf);</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    tot_objf_impr += <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(i) * (new_objf - old_objf);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    extractor-&gt;Sigma_inv_[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].CopyFromSp(new_inv_var);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  }</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <span class="keywordtype">double</span> floored_percent = tot_num_floored * 100.0 / (num_gauss * feat_dim);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Floored &quot;</span> &lt;&lt; floored_percent &lt;&lt; <span class="stringliteral">&quot;% of all Gaussian eigenvalues&quot;</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall objf impr/frame for variances was &quot;</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            &lt;&lt; (tot_objf_impr / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>()) &lt;&lt; <span class="stringliteral">&quot; over &quot;</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            &lt;&lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>() &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;  <span class="keywordflow">return</span> tot_objf_impr / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a29c8fdd802482a5c58eaa224a4fdb170"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">kaldi::MatrixBase::Row</a></div><div class="ttdeci">const SubVector&lt; Real &gt; Row(MatrixIndexT i) const </div><div class="ttdoc">Return specific row of matrix [const]. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00182">kaldi-matrix.h:182</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_a1e7deac168cc2b1002cc25ab544d0f90a9b23664a21e2e3077455db2d031aeb3b"><div class="ttname"><a href="namespacekaldi.html#a1e7deac168cc2b1002cc25ab544d0f90a9b23664a21e2e3077455db2d031aeb3b">kaldi::kTakeMeanAndCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00045">matrix-common.h:45</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga8bee82d44b3d0b8e546fd48a5a68deb4"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga8bee82d44b3d0b8e546fd48a5a68deb4">kaldi::TraceSpSp</a></div><div class="ttdeci">double TraceSpSp(const SpMatrix&lt; double &gt; &amp;A, const SpMatrix&lt; double &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8cc_source.html#l00350">sp-matrix.cc:350</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6b95556f077a55cc7691ccd0cf5d7e8b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdateWeight </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td>
          <td class="paramname"><em>gaussian</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01428">1428</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l00227">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="packed-matrix_8h_source.html#l00102">PackedMatrix&lt; Real &gt;::Data()</a>, <a class="el" href="sp-matrix_8h_source.html#l00458">SolverOptions::diagonal_precondition</a>, <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00033">IvectorExtractor::IvectorDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="sp-matrix_8h_source.html#l00456">SolverOptions::name</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="sp-matrix_8cc_source.html#l00659">kaldi::SolveQuadraticProblem()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00264">IvectorExtractor::w_</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01464">IvectorExtractorUpdateWeightClass::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                                       {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_gauss = extractor-&gt;NumGauss(),</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      ivector_dim = extractor-&gt;IvectorDim();</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt;= 0 &amp;&amp; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_gauss);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  SolverOptions solver_opts;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  solver_opts.diagonal_precondition = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  solver_opts.name = <span class="stringliteral">&quot;w&quot;</span>;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  SubVector&lt;double&gt; w_i(extractor-&gt;w_, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  SubVector&lt;double&gt; g_i(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  SpMatrix&lt;double&gt; Q(ivector_dim);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  SubVector&lt;double&gt; Q_vec(Q.Data(), ivector_dim * (ivector_dim + 1) / 2);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  Q_vec.CopyFromVec(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <span class="keywordtype">double</span> objf_impr = <a class="code" href="namespacekaldi.html#a941b06a30750affb2e1d42d5ab78fd99">SolveQuadraticProblem</a>(Q, g_i, solver_opts, &amp;w_i);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4 &amp;&amp; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) != 0.0) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Auxf impr/frame for Gaussian index &quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; for weights is &quot;</span> &lt;&lt; (objf_impr / <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>))</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; over &quot;</span> &lt;&lt; <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  <span class="keywordflow">return</span> objf_impr;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a941b06a30750affb2e1d42d5ab78fd99"><div class="ttname"><a href="namespacekaldi.html#a941b06a30750affb2e1d42d5ab78fd99">kaldi::SolveQuadraticProblem</a></div><div class="ttdeci">double SolveQuadraticProblem(const SpMatrix&lt; double &gt; &amp;H, const VectorBase&lt; double &gt; &amp;g, const SolverOptions &amp;opts, VectorBase&lt; double &gt; *x)</div><div class="ttdef"><b>Definition:</b> <a href="sp-matrix_8cc_source.html#l00659">sp-matrix.cc:659</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a29c8fdd802482a5c58eaa224a4fdb170"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">kaldi::MatrixBase::Row</a></div><div class="ttdeci">const SubVector&lt; Real &gt; Row(MatrixIndexT i) const </div><div class="ttdoc">Return specific row of matrix [const]. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00182">kaldi-matrix.h:182</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adbeb51570be96507c7ca9a7f08ee76fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double UpdateWeights </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1IvectorExtractorEstimationOptions.html">IvectorExtractorEstimationOptions</a> &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a> *&#160;</td>
          <td class="paramname"><em>extractor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01477">1477</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="kaldi-thread_8cc_source.html#l00025">kaldi::g_num_threads</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-task-sequence_8h_source.html#l00061">TaskSequencerConfig::num_threads</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00038">IvectorExtractor::NumGauss()</a>, <a class="el" href="kaldi-task-sequence_8h_source.html#l00093">TaskSequencer&lt; C &gt;::Run()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>.</p>
<div class="fragment"><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                                       {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> I = extractor-&gt;NumGauss();</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  <span class="keywordtype">double</span> tot_impr = 0.0;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    TaskSequencerConfig sequencer_opts;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    sequencer_opts.num_threads = <a class="code" href="namespacekaldi.html#a68c81349230513ef8553df7b1f685cee">g_num_threads</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    TaskSequencer&lt;IvectorExtractorUpdateWeightClass&gt; sequencer(</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        sequencer_opts);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      sequencer.Run(<span class="keyword">new</span> <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a12d337d4dabccc9c1ce3d676a03a494e">IvectorExtractorUpdateWeightClass</a>(</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;          *<span class="keyword">this</span>, opts, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>, extractor, &amp;tot_impr));</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  }</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  <span class="keywordtype">double</span> num_frames = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Overall auxf impr/frame from weight update is &quot;</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            &lt;&lt; (tot_impr / num_frames) &lt;&lt; <span class="stringliteral">&quot; over &quot;</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            &lt;&lt; num_frames &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="keywordflow">return</span> tot_impr / num_frames;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a68c81349230513ef8553df7b1f685cee"><div class="ttname"><a href="namespacekaldi.html#a68c81349230513ef8553df7b1f685cee">kaldi::g_num_threads</a></div><div class="ttdeci">int32 g_num_threads</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-thread_8cc_source.html#l00025">kaldi-thread.cc:25</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a12d337d4dabccc9c1ce3d676a03a494e"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a12d337d4dabccc9c1ce3d676a03a494e">kaldi::IvectorExtractorStats::IvectorExtractorUpdateWeightClass</a></div><div class="ttdeci">friend class IvectorExtractorUpdateWeightClass</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00519">ivector-extractor.h:519</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5d27e841639bdc831576ed1c690fe08"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Write </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01098">1098</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor-acc-stats_8cc_source.html#l00062">main()</a>, <a class="el" href="ivector-extractor-test_8cc_source.html#l00039">kaldi::TestIvectorExtractorStatsIO()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                                                             {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a4bca9f5d3b106f8c412e17cba441c7ef">FlushCache</a>(); <span class="comment">// for R stats.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  ((<span class="keyword">const</span> <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a7ff848c79112a21887c7d9f275b2a62a">IvectorExtractorStats</a>&amp;)(*<span class="keyword">this</span>)).<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">Write</a>(os, binary); <span class="comment">// call const version.</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a7ff848c79112a21887c7d9f275b2a62a"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a7ff848c79112a21887c7d9f275b2a62a">kaldi::IvectorExtractorStats::IvectorExtractorStats</a></div><div class="ttdeci">IvectorExtractorStats()</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00478">ivector-extractor.h:478</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a4bca9f5d3b106f8c412e17cba441c7ef"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a4bca9f5d3b106f8c412e17cba441c7ef">kaldi::IvectorExtractorStats::FlushCache</a></div><div class="ttdeci">void FlushCache()</div><div class="ttdoc">Flushes the cache for the R_ stats. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l00862">ivector-extractor.cc:862</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ad5d27e841639bdc831576ed1c690fe08"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">kaldi::IvectorExtractorStats::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;os, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01098">ivector-extractor.cc:1098</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad5da0494b3a3f4bc33ff83c9b5ff5b40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Write </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8cc_source.html#l01104">1104</a> of file <a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a>.</p>

<p>References <a class="el" href="ivector-extractor_8h_source.html#l00648">IvectorExtractorStats::G_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00610">IvectorExtractorStats::gamma_</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="ivector-extractor_8h_source.html#l00670">IvectorExtractorStats::ivector_scatter_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00667">IvectorExtractorStats::ivector_sum_</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="ivector-extractor_8h_source.html#l00664">IvectorExtractorStats::num_ivectors_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00644">IvectorExtractorStats::Q_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00624">IvectorExtractorStats::R_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00632">IvectorExtractorStats::R_num_cached_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00655">IvectorExtractorStats::S_</a>, <a class="el" href="ivector-extractor_8h_source.html#l00603">IvectorExtractorStats::tot_auxf_</a>, <a class="el" href="packed-matrix_8cc_source.html#l00236">PackedMatrix&lt; Real &gt;::Write()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01198">VectorBase&lt; Real &gt;::Write()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01098">IvectorExtractorStats::Write()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01226">MatrixBase&lt; Real &gt;::Write()</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00033">kaldi::WriteBasicType()</a>, <a class="el" href="io-funcs_8cc_source.html#l00134">kaldi::WriteToken()</a>, and <a class="el" href="ivector-extractor_8h_source.html#l00614">IvectorExtractorStats::Y_</a>.</p>
<div class="fragment"><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                                                   {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">R_num_cached_</a> == 0 &amp;&amp; <span class="stringliteral">&quot;Please use the non-const Write().&quot;</span>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;IvectorExtractorStats&gt;&quot;</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;TotAuxf&gt;&quot;</span>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">tot_auxf_</a>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;gamma&gt;&quot;</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">gamma_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#a72d8cbc6d65f2bb9213c6a56a5c759b4">Write</a>(os, binary);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;Y&gt;&quot;</span>);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>.size();</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, size);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">Y_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">Write</a>(os, binary);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;R&gt;&quot;</span>);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  Matrix&lt;BaseFloat&gt; R_float(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">R_</a>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  R_float.Write(os, binary);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;Q&gt;&quot;</span>);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  Matrix&lt;BaseFloat&gt; Q_float(<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">Q_</a>);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  Q_float.Write(os, binary);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;G&gt;&quot;</span>);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">G_</a>.<a class="code" href="classkaldi_1_1MatrixBase.html#a8d3cc6aefcbbff55a6164308014791a6">Write</a>(os, binary);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;S&gt;&quot;</span>);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  size = <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>.size();</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, size);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">S_</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">Write</a>(os, binary);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;NumIvectors&gt;&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">num_ivectors_</a>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;IvectorSum&gt;&quot;</span>);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">ivector_sum_</a>.<a class="code" href="classkaldi_1_1VectorBase.html#a72d8cbc6d65f2bb9213c6a56a5c759b4">Write</a>(os, binary);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;IvectorScatter&gt;&quot;</span>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <a class="code" href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">ivector_scatter_</a>.<a class="code" href="classkaldi_1_1PackedMatrix.html#a8d3cc6aefcbbff55a6164308014791a6">Write</a>(os, binary);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;/IvectorExtractorStats&gt;&quot;</span>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0ee54470df81f1c790f4c6c4edf517f0"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0ee54470df81f1c790f4c6c4edf517f0">kaldi::IvectorExtractorStats::R_num_cached_</a></div><div class="ttdeci">int32 R_num_cached_</div><div class="ttdoc">To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00632">ivector-extractor.h:632</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_a72d8cbc6d65f2bb9213c6a56a5c759b4"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#a72d8cbc6d65f2bb9213c6a56a5c759b4">kaldi::VectorBase::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;Out, bool binary) const </div><div class="ttdoc">Writes to C++ stream (option to write in binary). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l01198">kaldi-vector.cc:1198</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab9584d93c3d3f36ae1b654fe4ea0fe2d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab9584d93c3d3f36ae1b654fe4ea0fe2d">kaldi::IvectorExtractorStats::tot_auxf_</a></div><div class="ttdeci">double tot_auxf_</div><div class="ttdoc">Caution: if we read from disk, this. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00603">ivector-extractor.h:603</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a23c49a3df61b3447865b86ff695b87df"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a23c49a3df61b3447865b86ff695b87df">kaldi::IvectorExtractorStats::ivector_sum_</a></div><div class="ttdeci">Vector&lt; double &gt; ivector_sum_</div><div class="ttdoc">Sum of all the iVector means. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00667">ivector-extractor.h:667</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ac04e6ac0138efc552fa6ca3c688c5fe2"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ac04e6ac0138efc552fa6ca3c688c5fe2">kaldi::IvectorExtractorStats::G_</a></div><div class="ttdeci">Matrix&lt; double &gt; G_</div><div class="ttdoc">G_ is the linear term in the weight projection matrix w_. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00648">ivector-extractor.h:648</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a04c5bee6d676aee6c5a98bd103e3154f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a04c5bee6d676aee6c5a98bd103e3154f">kaldi::IvectorExtractorStats::R_</a></div><div class="ttdeci">Matrix&lt; double &gt; R_</div><div class="ttdoc">R_i, quadratic term for ivector subspace (M matrix)estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00624">ivector-extractor.h:624</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a90659470063b71ea93d07e7432d8437f"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a90659470063b71ea93d07e7432d8437f">kaldi::IvectorExtractorStats::Q_</a></div><div class="ttdeci">Matrix&lt; double &gt; Q_</div><div class="ttdoc">Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is w...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00644">ivector-extractor.h:644</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_acc2459b63a0e449a545b18a393998b9b"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#acc2459b63a0e449a545b18a393998b9b">kaldi::IvectorExtractorStats::ivector_scatter_</a></div><div class="ttdeci">SpMatrix&lt; double &gt; ivector_scatter_</div><div class="ttdoc">Second-order stats for the iVectors. Needed for prior re-estimation. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00670">ivector-extractor.h:670</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ab6cc4dd6805e9e5cb5bed8dc2e974b28"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ab6cc4dd6805e9e5cb5bed8dc2e974b28">kaldi::IvectorExtractorStats::num_ivectors_</a></div><div class="ttdeci">double num_ivectors_</div><div class="ttdoc">Count of the number of iVectors we trained on. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00664">ivector-extractor.h:664</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a8d3cc6aefcbbff55a6164308014791a6"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a8d3cc6aefcbbff55a6164308014791a6">kaldi::MatrixBase::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;out, bool binary) const </div><div class="ttdoc">write to stream. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l01226">kaldi-matrix.cc:1226</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga87f1638ef3c0a3ee117178b202c2d02a"><div class="ttname"><a href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">kaldi::WriteToken</a></div><div class="ttdeci">void WriteToken(std::ostream &amp;os, bool binary, const char *token)</div><div class="ttdoc">The WriteToken functions are for writing nonempty sequences of non-space characters. </div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00134">io-funcs.cc:134</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1PackedMatrix_html_a8d3cc6aefcbbff55a6164308014791a6"><div class="ttname"><a href="classkaldi_1_1PackedMatrix.html#a8d3cc6aefcbbff55a6164308014791a6">kaldi::PackedMatrix::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;out, bool binary) const </div><div class="ttdef"><b>Definition:</b> <a href="packed-matrix_8cc_source.html#l00236">packed-matrix.cc:236</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a0b5993cde86bc844e4967d63b7f2364d"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a0b5993cde86bc844e4967d63b7f2364d">kaldi::IvectorExtractorStats::Y_</a></div><div class="ttdeci">std::vector&lt; Matrix&lt; double &gt; &gt; Y_</div><div class="ttdoc">Stats Y_i for estimating projections M. </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00614">ivector-extractor.h:614</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00033">io-funcs-inl.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a1de396bc25cd2a22f046fad7c5ce2d36"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a1de396bc25cd2a22f046fad7c5ce2d36">kaldi::IvectorExtractorStats::gamma_</a></div><div class="ttdeci">Vector&lt; double &gt; gamma_</div><div class="ttdoc">Total occupation count for each Gaussian index (zeroth-order stats) </div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00610">ivector-extractor.h:610</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_ad5d27e841639bdc831576ed1c690fe08"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#ad5d27e841639bdc831576ed1c690fe08">kaldi::IvectorExtractorStats::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;os, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8cc_source.html#l01098">ivector-extractor.cc:1098</a></div></div>
<div class="ttc" id="classkaldi_1_1IvectorExtractorStats_html_a3e4cc17a0737faace498025a5afe4552"><div class="ttname"><a href="classkaldi_1_1IvectorExtractorStats.html#a3e4cc17a0737faace498025a5afe4552">kaldi::IvectorExtractorStats::S_</a></div><div class="ttdeci">std::vector&lt; SpMatrix&lt; double &gt; &gt; S_</div><div class="ttdoc">S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_...</div><div class="ttdef"><b>Definition:</b> <a href="ivector-extractor_8h_source.html#l00655">ivector-extractor.h:655</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a570adb0fce688854d96dea3b01464b9f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1IvectorExtractor.html">IvectorExtractor</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00476">476</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

</div>
</div>
<a class="anchor" id="a30a4f520516ebbf6ad4ee67bdfe76b1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1IvectorExtractorUpdateProjectionClass.html">IvectorExtractorUpdateProjectionClass</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00518">518</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

</div>
</div>
<a class="anchor" id="a12d337d4dabccc9c1ce3d676a03a494e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classkaldi_1_1IvectorExtractorUpdateWeightClass.html">IvectorExtractorUpdateWeightClass</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00519">519</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9ef1d9fef5999d5b41712230a376108c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structkaldi_1_1IvectorExtractorStatsOptions.html">IvectorExtractorStatsOptions</a> config_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00596">596</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00937">IvectorExtractorStats::CommitStatsForW()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>.</p>

</div>
</div>
<a class="anchor" id="ac04e6ac0138efc552fa6ca3c688c5fe2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; G_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>G_ is the linear term in the weight projection matrix w_. </p>
<p>It has the same dim as w_, i.e. [I][S] </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00648">648</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00902">IvectorExtractorStats::CommitStatsForWPoint()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01428">IvectorExtractorStats::UpdateWeight()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a1de396bc25cd2a22f046fad7c5ce2d36"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;double&gt; gamma_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total occupation count for each Gaussian index (zeroth-order stats) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00610">610</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00508">IvectorExtractorStats::AuxfPerFrame()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01196">IvectorExtractorStats::IvectorVarianceDiagnostic()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01501">IvectorExtractorStats::PriorDiagnostics()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01218">IvectorExtractorStats::UpdateProjection()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01315">IvectorExtractorStats::UpdateProjections()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01336">IvectorExtractorStats::UpdateVariances()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01428">IvectorExtractorStats::UpdateWeight()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01477">IvectorExtractorStats::UpdateWeights()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="af78986e36e6a8f2e249fbe9801f3ee75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> gamma_Y_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards gamma_ and Y_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00607">607</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>.</p>

</div>
</div>
<a class="anchor" id="acc2459b63a0e449a545b18a393998b9b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt;double&gt; ivector_scatter_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Second-order stats for the iVectors. Needed for prior re-estimation. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00670">670</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00966">IvectorExtractorStats::CommitStatsForPrior()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01501">IvectorExtractorStats::PriorDiagnostics()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a23c49a3df61b3447865b86ff695b87df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt;double&gt; ivector_sum_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sum of all the iVector means. Needed for prior re-estimation. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00667">667</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00966">IvectorExtractorStats::CommitStatsForPrior()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01501">IvectorExtractorStats::PriorDiagnostics()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="ab6cc4dd6805e9e5cb5bed8dc2e974b28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double num_ivectors_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Count of the number of iVectors we trained on. </p>
<p>Need for prior re-estimation. (make it double not int64 to more easily support weighting later.) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00664">664</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00966">IvectorExtractorStats::CommitStatsForPrior()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01501">IvectorExtractorStats::PriorDiagnostics()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01539">IvectorExtractorStats::UpdatePrior()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a77101ca2b796aab9e9c1fa0ea521d5ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> prior_stats_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards num_ivectors_, ivector_sum_ and ivector_scatter_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00660">660</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00966">IvectorExtractorStats::CommitStatsForPrior()</a>.</p>

</div>
</div>
<a class="anchor" id="a90659470063b71ea93d07e7432d8437f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; Q_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Q_ is like R_ (with same dimensions), except used for weight estimation; the scatter of ivectors is weighted by the coefficient of the quadratic term in the expansion for w (the "safe" one, with the max expression). </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00644">644</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00902">IvectorExtractorStats::CommitStatsForWPoint()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01428">IvectorExtractorStats::UpdateWeight()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a04c5bee6d676aee6c5a98bd103e3154f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; R_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>R_i, quadratic term for ivector subspace (M matrix)estimation. </p>
<p>This is a kind of scatter of ivectors of training speakers, weighted by count for each Gaussian. Conceptually vector&lt;<a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix&lt;double&gt;</a> &gt;, but we store each <a class="el" href="classkaldi_1_1SpMatrix.html" title="Packed symetric matrix class. ">SpMatrix</a> as a row of R_. Conceptually, the dim is [I][S][S]; the actual dim is [I][S*(S+1)/2]. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00624">624</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01218">IvectorExtractorStats::UpdateProjection()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01336">IvectorExtractorStats::UpdateVariances()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a33fe7be89c94c2541badd2d004134388"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> R_cache_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards R_num_cached_, R_gamma_cache_, R_ivec_cache_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00628">628</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>.</p>

</div>
</div>
<a class="anchor" id="ab0b0f0a3b8809bbfd635c8f068e5e1c7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; R_gamma_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>dimension: [num-to-cache][I] </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00634">634</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>.</p>

</div>
</div>
<a class="anchor" id="a0827fd9bd6c2a3b0f602ab98cfa45990"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; R_ivec_scatter_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>dimension: [num-to-cache][S*(S+1)/2] </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00636">636</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>.</p>

</div>
</div>
<a class="anchor" id="a49017afa7dc30fd2cb91cbebd57102aa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> R_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards R_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00617">617</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ee54470df81f1c790f4c6c4edf517f0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> R_num_cached_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>To avoid too-frequent rank-1 update of R, which is slow, we cache some quantities here. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00632">632</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00862">IvectorExtractorStats::FlushCache()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e4cc17a0737faace498025a5afe4552"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classkaldi_1_1SpMatrix.html">SpMatrix</a>&lt;double&gt; &gt; S_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>S_{i}, raw second-order stats per Gaussian which we will use to update the variances Sigma_inv_. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00655">655</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01031">IvectorExtractorStats::AccStatsForUtterance()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00887">IvectorExtractorStats::CommitStatsForSigma()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01336">IvectorExtractorStats::UpdateVariances()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="ab9584d93c3d3f36ae1b654fe4ea0fe2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double tot_auxf_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Caution: if we read from disk, this. </p>
<p>is not recovered. Options will not be used during the update phase anyway, so this should not matter. Total auxiliary function over the training data&ndash; can be used to check convergence, etc. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00603">603</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8h_source.html#l00508">IvectorExtractorStats::AuxfPerFrame()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00979">IvectorExtractorStats::CommitStatsForUtterance()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01171">IvectorExtractorStats::Update()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<a class="anchor" id="aa19c3f94a4f9a633906cbdc38c31f942"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> variance_stats_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards S_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00651">651</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00887">IvectorExtractorStats::CommitStatsForSigma()</a>.</p>

</div>
</div>
<a class="anchor" id="a0d7ede213a100c69107a6e4868c660be"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1Mutex.html">Mutex</a> weight_stats_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This mutex guards Q_ and G_ (for multi-threaded update) </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00639">639</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l00902">IvectorExtractorStats::CommitStatsForWPoint()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b5993cde86bc844e4967d63b7f2364d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt;double&gt; &gt; Y_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Stats Y_i for estimating projections M. </p>
<p>Dimension is [I][D][S]. The linear term in M. </p>

<p>Definition at line <a class="el" href="ivector-extractor_8h_source.html#l00614">614</a> of file <a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a>.</p>

<p>Referenced by <a class="el" href="ivector-extractor_8cc_source.html#l01077">IvectorExtractorStats::Add()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01003">IvectorExtractorStats::CheckDims()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00825">IvectorExtractorStats::CommitStatsForM()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l00790">IvectorExtractorStats::IvectorExtractorStats()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01139">IvectorExtractorStats::Read()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01218">IvectorExtractorStats::UpdateProjection()</a>, <a class="el" href="ivector-extractor_8cc_source.html#l01336">IvectorExtractorStats::UpdateVariances()</a>, and <a class="el" href="ivector-extractor_8cc_source.html#l01104">IvectorExtractorStats::Write()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>ivector/<a class="el" href="ivector-extractor_8h_source.html">ivector-extractor.h</a></li>
<li>ivector/<a class="el" href="ivector-extractor_8cc_source.html">ivector-extractor.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="classkaldi_1_1IvectorExtractorStats.html">IvectorExtractorStats</a></li>
    <li class="footer">Generated on Tue Apr 26 2016 14:54:52 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
