<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: kaldi::nnet3 Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespacekaldi_1_1nnet3.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">kaldi::nnet3 Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespacekaldi_1_1nnet3_1_1computation__graph"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html">computation_graph</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespacekaldi_1_1nnet3_1_1compute__computation__steps"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html">compute_computation_steps</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html">AmNnetSimple</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html">OnlineNaturalGradientSimple</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keywords for search: natural gradient, naturalgradient, NG-SGD.  <a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetSimpleComputationOptions.html">NnetSimpleComputationOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetDecodableBase.html">NnetDecodableBase</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1DecodableAmNnetSimple.html">DecodableAmNnetSimple</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html">ComputationVariables</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class relates the matrices and sub-matrices in the computation to imaginary "variables", such that we can think of the operations as operating on sets of individual variables, and we can then do analysis that lets us do optimization.  <a href="classkaldi_1_1nnet3_1_1ComputationVariables.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1Access.html">Access</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1Analyzer.html">Analyzer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This struct exists to set up various pieces of analysis; it helps avoid the repetition of code where we compute all these things in sequence.  <a href="structkaldi_1_1nnet3_1_1Analyzer.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationAnalysis.html">ComputationAnalysis</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class performs various kinds of specific analysis on top of what class <a class="el" href="structkaldi_1_1nnet3_1_1Analyzer.html" title="This struct exists to set up various pieces of analysis; it helps avoid the repetition of code where ...">Analyzer</a> gives you immediately.  <a href="classkaldi_1_1nnet3_1_1ComputationAnalysis.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetCombineConfig.html">NnetCombineConfig</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration class that controls neural net combination, where we combine a number of neural nets.  <a href="structkaldi_1_1nnet3_1_1NnetCombineConfig.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetCombiner.html">NnetCombiner</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structkaldi_1_1nnet3_1_1Index.html" title="struct Index is intended to represent the various indexes by which we number the rows of the matrices...">Index</a> is intended to represent the various indexes by which we number the rows of the matrices that the Components process: mainly 'n', the index of the member of the minibatch, 't', used for the frame index in speech recognition, and 'x', which is a catch-all extra index which we might use in convolutional setups or for other reasons.  <a href="structkaldi_1_1nnet3_1_1Index.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1IndexHasher.html">IndexHasher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1CindexHasher.html">CindexHasher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ComparePair.html">ComparePair</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1PairIsEqualComparator.html">PairIsEqualComparator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1FirstElementComparator.html">FirstElementComparator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1FirstElementIsEqualComparator.html">FirstElementIsEqualComparator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class creates an initial version of the <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a>, without any optimization or sharing of matrices.  <a href="classkaldi_1_1nnet3_1_1Compiler.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abstract base-class for neural-net components.  <a href="classkaldi_1_1nnet3_1_1Component.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html" title="Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...">UpdatableComponent</a> is a <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> which has trainable parameters; it extends the interface of <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a>.  <a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NonlinearComponent.html">NonlinearComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This kind of <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> is a base-class for things like sigmoid, softmax and ReLU: nonlinearities that don't change the dimension.  <a href="classkaldi_1_1nnet3_1_1NonlinearComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The first step in compilation is to turn the ComputationSpecification into a <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html" title="The first step in compilation is to turn the ComputationSpecification into a ComputationGraph, where for each Cindex we have a list of other Cindexes that it depends on. ">ComputationGraph</a>, where for each Cindex we have a list of other Cindexes that it depends on.  <a href="structkaldi_1_1nnet3_1_1ComputationGraph.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationGraphBuilder.html">ComputationGraphBuilder</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An abstract representation of a set of Cindexes.  <a href="classkaldi_1_1nnet3_1_1ComputationGraphBuilder.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1CindexSet.html">CindexSet</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1IndexSet.html">IndexSet</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">An abstract representation of a set of Indexes.  <a href="classkaldi_1_1nnet3_1_1IndexSet.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1MiscComputationInfo.html">MiscComputationInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1IoSpecification.html">IoSpecification</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">NnetComputeOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">class <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html" title="class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...">NnetComputer</a> is responsible for executing the computation described in the "computation" object.  <a href="classkaldi_1_1nnet3_1_1NnetComputer.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ForwardingDescriptor.html">ForwardingDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SimpleForwardingDescriptor.html">SimpleForwardingDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1OffsetForwardingDescriptor.html">OffsetForwardingDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SwitchingForwardingDescriptor.html">SwitchingForwardingDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RoundingForwardingDescriptor.html">RoundingForwardingDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">For use in clockwork RNNs and the like, this forwarding-descriptor rounds the time-index t down to the the closest t' &lt;= t that is an exact multiple of t_modulus_.  <a href="classkaldi_1_1nnet3_1_1RoundingForwardingDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ReplaceIndexForwardingDescriptor.html">ReplaceIndexForwardingDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This <a class="el" href="classkaldi_1_1nnet3_1_1ForwardingDescriptor.html">ForwardingDescriptor</a> modifies the indexes (n, t, x) by replacing one of them (normally t) with a constant value and keeping the rest.  <a href="classkaldi_1_1nnet3_1_1ReplaceIndexForwardingDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html">SumDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an abstract base-class.  <a href="classkaldi_1_1nnet3_1_1SumDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1OptionalSumDescriptor.html">OptionalSumDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the case of class <a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html" title="This is an abstract base-class. ">SumDescriptor</a>, in which we contain just one term, and that term is optional (an IfDefined() expression).  <a href="classkaldi_1_1nnet3_1_1OptionalSumDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SimpleSumDescriptor.html">SimpleSumDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1BinarySumDescriptor.html">BinarySumDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1BinarySumDescriptor.html" title="BinarySumDescriptor can represent either A + B, or (A if defined, else B). ">BinarySumDescriptor</a> can represent either A + B, or (A if defined, else B).  <a href="classkaldi_1_1nnet3_1_1BinarySumDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html">GeneralDescriptor</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is only used when parsing Descriptors.  <a href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1SimpleObjectiveInfo.html">SimpleObjectiveInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetComputeProbOptions.html">NnetComputeProbOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetComputeProb.html">NnetComputeProb</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is for computing cross-entropy and accuracy values in a neural network, for diagnostics.  <a href="classkaldi_1_1nnet3_1_1NnetComputeProb.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a> is the input data and corresponding label (or labels) for one or more frames of input, used for standard cross-entropy training of neural nets (and possibly for other objective functions).  <a href="structkaldi_1_1nnet3_1_1NnetExample.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1DistributeComponentPrecomputedIndexes.html">DistributeComponentPrecomputedIndexes</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1DistributeComponent.html">DistributeComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> takes a larger input-dim than output-dim, where the input-dim must be a multiple of the output-dim, and distributes different blocks of the input dimension to different 'x' values.  <a href="classkaldi_1_1nnet3_1_1DistributeComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1TarjanNode.html">TarjanNode</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html">NetworkNode</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html" title="NetworkNode is used to represent, three types of thing: either an input of the network (which pretty ...">NetworkNode</a> is used to represent, three types of thing: either an input of the network (which pretty much just states the dimension of the input vector); a <a class="el" href="classkaldi_1_1nnet3_1_1Component.html" title="Abstract base-class for neural-net components. ">Component</a> (e.g.  <a href="structkaldi_1_1nnet3_1_1NetworkNode.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1VariableMergingOptimizer.html">VariableMergingOptimizer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is responsible for merging matrices, although you probably want to access it via the the function <a class="el" href="namespacekaldi_1_1nnet3.html#a7464172a2f27484596c2d374bb1adcd6" title="This wraps class VariableMergingOptimizer in a simplified interface. ">VariableMergingOptimization()</a>.  <a href="classkaldi_1_1nnet3_1_1VariableMergingOptimizer.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ModelUpdateConsolidator.html">ModelUpdateConsolidator</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is responsible for consolidating the model-update part of backprop commands, for components in (e.g.) recurrent networks that need to have many separate backprop commands, into more efficient single commands operating on consolidated data in larger matrices.  <a href="classkaldi_1_1nnet3_1_1ModelUpdateConsolidator.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ComputationRenumberer.html">ComputationRenumberer</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1DerivativeTimeLimiter.html">DerivativeTimeLimiter</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequestHasher.html">ComputationRequestHasher</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequestPtrEqual.html">ComputationRequestPtrEqual</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html">CachingOptimizingCompiler</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class enables you to do the compilation and optimization in one call, and also ensures that if the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> is identical to the previous one, the compilation process is not repeated.  <a href="classkaldi_1_1nnet3_1_1CachingOptimizingCompiler.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is responsible for parsing input xx=yyy a=b c empty= f-oo=bar ba_z=123 bing='a b c' baz="a b c d='a b' e" and giving you access to the fields, in this case.  <a href="classkaldi_1_1nnet3_1_1ConfigLine.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1PnormComponent.html">PnormComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ElementwiseProductComponent.html">ElementwiseProductComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NormalizeComponent.html">NormalizeComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SigmoidComponent.html">SigmoidComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1TanhComponent.html">TanhComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RectifiedLinearComponent.html">RectifiedLinearComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SumReduceComponent.html">SumReduceComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This component is a fixed (non-trainable) nonlinearity that sums its inputs to produce outputs.  <a href="classkaldi_1_1nnet3_1_1SumReduceComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1AffineComponent.html">AffineComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1RepeatedAffineComponent.html">RepeatedAffineComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientRepeatedAffineComponent.html">NaturalGradientRepeatedAffineComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1BlockAffineComponent.html">BlockAffineComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class implements an affine transform using a block diagonal matrix e.g., one whose weight matrix is all zeros except for blocks on the diagonal.  <a href="classkaldi_1_1nnet3_1_1BlockAffineComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SoftmaxComponent.html">SoftmaxComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1LogSoftmaxComponent.html">LogSoftmaxComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html">NaturalGradientAffineComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Keywords: natural gradient descent, NG-SGD, naturalgradient.  <a href="classkaldi_1_1nnet3_1_1NaturalGradientAffineComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1FixedAffineComponent.html">FixedAffineComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1FixedAffineComponent.html" title="FixedAffineComponent is an affine transform that is supplied at network initialization time and is no...">FixedAffineComponent</a> is an affine transform that is supplied at network initialization time and is not trainable.  <a href="classkaldi_1_1nnet3_1_1FixedAffineComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1SumGroupComponent.html">SumGroupComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1SumGroupComponent.html" title="SumGroupComponent is used to sum up groups of posteriors. ">SumGroupComponent</a> is used to sum up groups of posteriors.  <a href="classkaldi_1_1nnet3_1_1SumGroupComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1FixedScaleComponent.html">FixedScaleComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1FixedScaleComponent.html" title="FixedScaleComponent applies a fixed per-element scale; it&#39;s similar to the Rescale component in the n...">FixedScaleComponent</a> applies a fixed per-element scale; it's similar to the Rescale component in the <a class="el" href="namespacekaldi_1_1nnet1.html">nnet1</a> setup (and only needed for <a class="el" href="namespacekaldi_1_1nnet1.html">nnet1</a> model conversion).  <a href="classkaldi_1_1nnet3_1_1FixedScaleComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1FixedBiasComponent.html">FixedBiasComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1FixedBiasComponent.html" title="FixedBiasComponent applies a fixed per-element bias; it&#39;s similar to the AddShift component in the nn...">FixedBiasComponent</a> applies a fixed per-element bias; it's similar to the AddShift component in the <a class="el" href="namespacekaldi_1_1nnet1.html">nnet1</a> setup (and only needed for <a class="el" href="namespacekaldi_1_1nnet1.html">nnet1</a> model conversion.  <a href="classkaldi_1_1nnet3_1_1FixedBiasComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NoOpComponent.html">NoOpComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ClipGradientComponent.html">ClipGradientComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1PermuteComponent.html">PermuteComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1PermuteComponent.html" title="PermuteComponent changes the order of the columns (i.e. ">PermuteComponent</a> changes the order of the columns (i.e.  <a href="classkaldi_1_1nnet3_1_1PermuteComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1PerElementScaleComponent.html">PerElementScaleComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1PerElementOffsetComponent.html">PerElementOffsetComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NaturalGradientPerElementScaleComponent.html">NaturalGradientPerElementScaleComponent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1ConvolutionComponent.html">ConvolutionComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">ConvolutionalComponent implements 2d-convolution.  <a href="classkaldi_1_1nnet3_1_1ConvolutionComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1Convolutional1dComponent.html">Convolutional1dComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1Convolutional1dComponent.html" title="Convolutional1dComponent implements convolution over frequency axis. ">Convolutional1dComponent</a> implements convolution over frequency axis.  <a href="classkaldi_1_1nnet3_1_1Convolutional1dComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1MaxpoolingComponent.html">MaxpoolingComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">MaxPoolingComponent : Maxpooling component was firstly used in ConvNet for selecting an representative activation in an area.  <a href="classkaldi_1_1nnet3_1_1MaxpoolingComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1CompositeComponent.html">CompositeComponent</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classkaldi_1_1nnet3_1_1CompositeComponent.html" title="CompositeComponent is components representing a sequence of [simple] components. ">CompositeComponent</a> is components representing a sequence of [simple] components.  <a href="classkaldi_1_1nnet3_1_1CompositeComponent.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1NnetTrainerOptions.html">NnetTrainerOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1nnet3_1_1ObjectiveFunctionInfo.html">ObjectiveFunctionInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetTrainer.html">NnetTrainer</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is for single-threaded training of neural nets using standard objective functions such as cross-entropy (implemented with logsoftmax nonlinearity and a linear objective function) and quadratic loss.  <a href="classkaldi_1_1nnet3_1_1NnetTrainer.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetLdaStatsAccumulator.html">NnetLdaStatsAccumulator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1nnet3_1_1NnetComputerFromEg.html">NnetComputerFromEg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ac8344e7587df9247d6cc492874901d4d"><td class="memItemLeft" align="right" valign="top">typedef std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a></td></tr>
<tr class="separator:ac8344e7587df9247d6cc492874901d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2246cc04a2596de3c09fad3c3513671"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classkaldi_1_1TableWriter.html">TableWriter</a><br class="typebreak"/>
&lt; <a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a><br class="typebreak"/>
&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a></td></tr>
<tr class="separator:af2246cc04a2596de3c09fad3c3513671"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a206084ee5d66f24aeb8828c6bf8cb13d"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classkaldi_1_1SequentialTableReader.html">SequentialTableReader</a><br class="typebreak"/>
&lt; <a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a><br class="typebreak"/>
&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a206084ee5d66f24aeb8828c6bf8cb13d">SequentialNnetExampleReader</a></td></tr>
<tr class="separator:a206084ee5d66f24aeb8828c6bf8cb13d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96242234768bbde2864c47396903675e"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
<a class="el" href="classkaldi_1_1RandomAccessTableReader.html">RandomAccessTableReader</a><br class="typebreak"/>
&lt; <a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a><br class="typebreak"/>
&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a96242234768bbde2864c47396903675e">RandomAccessNnetExampleReader</a></td></tr>
<tr class="separator:a96242234768bbde2864c47396903675e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad8aff9e545a5f496a179a16667431478"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478">AccessType</a> { <a class="el" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>
 }</td></tr>
<tr class="separator:ad8aff9e545a5f496a179a16667431478"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36da016976f88292c0d31653a20cbfe3"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3">ComponentProperties</a> { <br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127">kSimpleComponent</a> = 0x001, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a> = 0x002, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778">kLinearInInput</a> = 0x004, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0">kLinearInParameters</a> = 0x008, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d">kPropagateInPlace</a> = 0x010, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a> = 0x020, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kReordersIndexes</a> = 0x040, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a> = 0x080, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a> = 0x100, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kBackpropNeedsOutput</a> = 0x200, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df">kBackpropInPlace</a> = 0x400, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kStoresStats</a> = 0x800
<br/>
 }</td></tr>
<tr class="separator:a36da016976f88292c0d31653a20cbfe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e038f5b8958e203d28bc4f18472352"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352">CommandType</a> { <br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kPropagate</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kStoreStats</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a>, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kBackpropNoModelUpdate</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kNoOperationMarker</a>
<br/>
 }</td></tr>
<tr class="memdesc:a21e038f5b8958e203d28bc4f18472352"><td class="mdescLeft">&#160;</td><td class="mdescRight">CommandType is an enum that describes the category of the command used in the NnetComputation.  <a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352">More...</a><br/></td></tr>
<tr class="separator:a21e038f5b8958e203d28bc4f18472352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45660f9909187129a953fa05e664576e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">ObjectiveType</a> { <a class="el" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d">kLinear</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2">kQuadratic</a>
 }</td></tr>
<tr class="memdesc:a45660f9909187129a953fa05e664576e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This enum is for a kind of annotation we associate with output nodes of the network; it's for the convenience of calling code so that if the objective is one of a few standard types, we can compute it directly and know how to interpret the supervision labels.  <a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">More...</a><br/></td></tr>
<tr class="separator:a45660f9909187129a953fa05e664576e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac9cbaeea226ed297804c012dc12b16"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16">NodeType</a> { <br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kInput</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>, 
<a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kDimRange</a>, 
<br/>
&#160;&#160;<a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a634ee767a8e90ff4d56e140459cca31f">kNone</a>
<br/>
 }</td></tr>
<tr class="separator:acac9cbaeea226ed297804c012dc12b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7012eb43a414f870091986ffeec55aea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7012eb43a414f870091986ffeec55aea">UnitTestPreconditionDirectionsOnline</a> ()</td></tr>
<tr class="separator:a7012eb43a414f870091986ffeec55aea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add0941dcac8fe7e6bfe5d65979c9d388"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">PrintCommand</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> command)</td></tr>
<tr class="separator:add0941dcac8fe7e6bfe5d65979c9d388"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc6a3d60ce5fb425830d97903d51aa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4cc6a3d60ce5fb425830d97903d51aa2">UnitTestNnetAnalyze</a> ()</td></tr>
<tr class="separator:a4cc6a3d60ce5fb425830d97903d51aa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79ed08ad0dcf1b82a23e4e3c96967502"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a79ed08ad0dcf1b82a23e4e3c96967502">IndexesMultiToSubmatrixIndexes</a> (const std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;indexes_multi, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *submatrix_indexes)</td></tr>
<tr class="memdesc:a79ed08ad0dcf1b82a23e4e3c96967502"><td class="mdescLeft">&#160;</td><td class="mdescRight">given a vector of pairs from computation.indexes_multi_indexes containing paris (submatrix-index, row-index), this function outputs to "submatrix_indexes" all (unique) submatrix indexes that appear; and it outputs to "contains_null_marker" true if the pair (-1, -1) appears anywhere in indexes_multi, and false otherwise.  <a href="#a79ed08ad0dcf1b82a23e4e3c96967502">More...</a><br/></td></tr>
<tr class="separator:a79ed08ad0dcf1b82a23e4e3c96967502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa02a576b6e9aa0977f3eb52471742b85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa02a576b6e9aa0977f3eb52471742b85">ComputeCommandAttributes</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, const <a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html">ComputationVariables</a> &amp;vars, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> &gt; *attributes)</td></tr>
<tr class="separator:aa02a576b6e9aa0977f3eb52471742b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a474b6a19fd42f428dd178f9af05150a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a474b6a19fd42f428dd178f9af05150a8">ComputeVariableAccesses</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html">ComputationVariables</a> &amp;variables, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> &gt; &amp;command_attributes, std::vector&lt; std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Access.html">Access</a> &gt; &gt; *variable_accesses)</td></tr>
<tr class="memdesc:a474b6a19fd42f428dd178f9af05150a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">After the command-level attributes have been computed, this function organizes them per variable (see class <a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html" title="This class relates the matrices and sub-matrices in the computation to imaginary &quot;variables&quot;, such that we can think of the operations as operating on sets of individual variables, and we can then do analysis that lets us do optimization. ">ComputationVariables</a> for how a variable is defined; it is part of a matrix).  <a href="#a474b6a19fd42f428dd178f9af05150a8">More...</a><br/></td></tr>
<tr class="separator:a474b6a19fd42f428dd178f9af05150a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f107eabc73f1b70436ed117375778c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2f107eabc73f1b70436ed117375778c1">ComputeMatrixAccesses</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, const <a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html">ComputationVariables</a> &amp;variables, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> &gt; &amp;command_attributes, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a> &gt; *matrix_accesses)</td></tr>
<tr class="memdesc:a2f107eabc73f1b70436ed117375778c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function organizes information in the <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> in a way that is convenient to access per matrix.  <a href="#a2f107eabc73f1b70436ed117375778c1">More...</a><br/></td></tr>
<tr class="separator:a2f107eabc73f1b70436ed117375778c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28797c2cdd8990a88b55e122b2b2931a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, bool check_rewrite=false)</td></tr>
<tr class="memdesc:a28797c2cdd8990a88b55e122b2b2931a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a convenience interface for class <a class="el" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a>.  <a href="#a28797c2cdd8990a88b55e122b2b2931a">More...</a><br/></td></tr>
<tr class="separator:a28797c2cdd8990a88b55e122b2b2931a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7468a5d6108f9a2f81b9b79b82866354"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7468a5d6108f9a2f81b9b79b82866354">ComputeMatrixToSubmatrix</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *mat_to_submat)</td></tr>
<tr class="memdesc:a7468a5d6108f9a2f81b9b79b82866354"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes a vector 'mat_to_submat', indexed by matrix index, such that (*mat_to_submat)[m] is a list of all the submatrix indexes that refer to matrix m.  <a href="#a7468a5d6108f9a2f81b9b79b82866354">More...</a><br/></td></tr>
<tr class="separator:a7468a5d6108f9a2f81b9b79b82866354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa09a3995a6335eb986c2fb6432ff785c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa09a3995a6335eb986c2fb6432ff785c">PrintMatrixAccesses</a> (std::ostream &amp;os, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a> &gt; &amp;matrix_accesses)</td></tr>
<tr class="memdesc:aa09a3995a6335eb986c2fb6432ff785c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is to be used in debugging; it produces human-readable output.  <a href="#aa09a3995a6335eb986c2fb6432ff785c">More...</a><br/></td></tr>
<tr class="separator:aa09a3995a6335eb986c2fb6432ff785c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f9689026c0962fecfe5cc56194840d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa4f9689026c0962fecfe5cc56194840d">PrintCommandAttributes</a> (std::ostream &amp;os, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> &gt; &amp;attributes)</td></tr>
<tr class="memdesc:aa4f9689026c0962fecfe5cc56194840d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is to be used in debugging; it produces human-readable output.  <a href="#aa4f9689026c0962fecfe5cc56194840d">More...</a><br/></td></tr>
<tr class="separator:aa4f9689026c0962fecfe5cc56194840d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82b64d14f92892efd68998d19e012c1c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a82b64d14f92892efd68998d19e012c1c">MaxMemoryUsage</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation)</td></tr>
<tr class="memdesc:a82b64d14f92892efd68998d19e012c1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total memory, in bytes, used by the computation (just the temporary memory, not counting the memory used by the nnet itself).  <a href="#a82b64d14f92892efd68998d19e012c1c">More...</a><br/></td></tr>
<tr class="separator:a82b64d14f92892efd68998d19e012c1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a839780fb74682622f06524a99a653f88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a839780fb74682622f06524a99a653f88">UnitTestIndexIo</a> ()</td></tr>
<tr class="separator:a839780fb74682622f06524a99a653f88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aebb785e5823e55aa1d45d473f13a8e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2aebb785e5823e55aa1d45d473f13a8e">WriteIndexVectorElementBinary</a> (std::ostream &amp;os, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;vec, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i)</td></tr>
<tr class="separator:a2aebb785e5823e55aa1d45d473f13a8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada744dcd7dc25034e74e7a1f076fa05b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ada744dcd7dc25034e74e7a1f076fa05b">ReadIndexVectorElementBinary</a> (std::istream &amp;is, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *vec)</td></tr>
<tr class="separator:ada744dcd7dc25034e74e7a1f076fa05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d9bd2f8bc49b5d2d7dec9b2d354ffc9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6d9bd2f8bc49b5d2d7dec9b2d354ffc9">WriteIndexVector</a> (std::ostream &amp;os, bool binary, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;vec)</td></tr>
<tr class="separator:a6d9bd2f8bc49b5d2d7dec9b2d354ffc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2069492e6a46f0c6b003a52cf87e2f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af2069492e6a46f0c6b003a52cf87e2f7">ReadIndexVector</a> (std::istream &amp;is, bool binary, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; *vec)</td></tr>
<tr class="separator:af2069492e6a46f0c6b003a52cf87e2f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5001f1f230fce8994722a8d211ab0b81"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a5001f1f230fce8994722a8d211ab0b81">operator&lt;&lt;</a> (std::ostream &amp;ostream, const <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &amp;index)</td></tr>
<tr class="separator:a5001f1f230fce8994722a8d211ab0b81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f4752f24d0cdba07dd92e93430b965"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af4f4752f24d0cdba07dd92e93430b965">operator&lt;&lt;</a> (std::ostream &amp;ostream, const <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &amp;cindex)</td></tr>
<tr class="separator:af4f4752f24d0cdba07dd92e93430b965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b506b12f6ee61fbe53115f474df376"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ab5b506b12f6ee61fbe53115f474df376">PrintCindex</a> (std::ostream &amp;os, const <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &amp;cindex, const std::vector&lt; std::string &gt; &amp;node_names)</td></tr>
<tr class="separator:ab5b506b12f6ee61fbe53115f474df376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af952225c01896b2850ffdb09ea2f0ba6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af952225c01896b2850ffdb09ea2f0ba6">PrintIndexes</a> (std::ostream &amp;ostream, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;indexes)</td></tr>
<tr class="memdesc:af952225c01896b2850ffdb09ea2f0ba6"><td class="mdescLeft">&#160;</td><td class="mdescRight">this will only be used for pretty-printing.  <a href="#af952225c01896b2850ffdb09ea2f0ba6">More...</a><br/></td></tr>
<tr class="separator:af952225c01896b2850ffdb09ea2f0ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610537b433bd5824688a70413c9905c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a610537b433bd5824688a70413c9905c6">PrintCindexes</a> (std::ostream &amp;ostream, const std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; &amp;cindexes, const std::vector&lt; std::string &gt; &amp;node_names)</td></tr>
<tr class="memdesc:a610537b433bd5824688a70413c9905c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">this will only be used for pretty-printing.  <a href="#a610537b433bd5824688a70413c9905c6">More...</a><br/></td></tr>
<tr class="separator:a610537b433bd5824688a70413c9905c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ad7b2e440d9b50c196a361f559a427"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a91ad7b2e440d9b50c196a361f559a427">PrintIntegerVector</a> (std::ostream &amp;os, const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;ints)</td></tr>
<tr class="separator:a91ad7b2e440d9b50c196a361f559a427"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbaeb0c690e96bd285e79a287882f13e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#adbaeb0c690e96bd285e79a287882f13e">AppendCindexes</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node, const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;indexes, std::vector&lt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> &gt; *out)</td></tr>
<tr class="memdesc:adbaeb0c690e96bd285e79a287882f13e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends to 'out' the pairs (node, indexes[0]), (node, indexes[1]), ...  <a href="#adbaeb0c690e96bd285e79a287882f13e">More...</a><br/></td></tr>
<tr class="separator:adbaeb0c690e96bd285e79a287882f13e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c5b8e70a4f632063af6c4a8c397189"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a68c5b8e70a4f632063af6c4a8c397189">UnitTestNnetCompile</a> ()</td></tr>
<tr class="separator:a68c5b8e70a4f632063af6c4a8c397189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2fee0700fd475dc0d6b4a9d618e9a72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">PrintVectorVectorPair</a> (std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; vec_vec_pair)</td></tr>
<tr class="separator:ab2fee0700fd475dc0d6b4a9d618e9a72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8d72d1c711cbf1c6cb14e49fa474a51"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae8d72d1c711cbf1c6cb14e49fa474a51">UnitTestSplitLocationsBackward</a> (bool verbose)</td></tr>
<tr class="separator:ae8d72d1c711cbf1c6cb14e49fa474a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07e09944d36b367d8e7b5978184826c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a07e09944d36b367d8e7b5978184826c2">UnitTestHasContiguousProperty</a> ()</td></tr>
<tr class="separator:a07e09944d36b367d8e7b5978184826c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26164e97ad97a37e3401b95d0d82098b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a26164e97ad97a37e3401b95d0d82098b">UnitTestEnsureContiguousProperty</a> ()</td></tr>
<tr class="separator:a26164e97ad97a37e3401b95d0d82098b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6242a8c5b093373663b9ec8210946b8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6242a8c5b093373663b9ec8210946b8a">UnitTestSplitLocations</a> (bool verbose)</td></tr>
<tr class="separator:a6242a8c5b093373663b9ec8210946b8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcccae5ab2f658419cedbd126f574f0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#adfcccae5ab2f658419cedbd126f574f0">SecondElementComparator</a> (const std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;first_pair, const std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;second_pair)</td></tr>
<tr class="separator:adfcccae5ab2f658419cedbd126f574f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1893395273c5cb53ea3606c2bad94a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aed1893395273c5cb53ea3606c2bad94a">SortSubmatLists</a> (const std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *sorted_submat_lists, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *max_submat_list_size)</td></tr>
<tr class="separator:aed1893395273c5cb53ea3606c2bad94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a602adf8e3c912ce0b74cbc5700255867"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a602adf8e3c912ce0b74cbc5700255867">ComputeSubmatIndexHistogram</a> (const std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; sorted_submat_lists, unordered_map&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *submat_histogram)</td></tr>
<tr class="separator:a602adf8e3c912ce0b74cbc5700255867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abff8a093b516f579b1bce94a954f6e7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#abff8a093b516f579b1bce94a954f6e7c">FindSubmatIndexInSubmatLists</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submat_index, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt;::iterator &gt; *output_iterator_list, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *max_remaining_submat_list_size)</td></tr>
<tr class="separator:abff8a093b516f579b1bce94a954f6e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3395b82092a47a75b581f5f4a55a503"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac3395b82092a47a75b581f5f4a55a503">ExtractGivenPairsFromSubmatLists</a> (std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt;::iterator &gt; &amp;input_iterator_list, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *list_of_pairs)</td></tr>
<tr class="separator:ac3395b82092a47a75b581f5f4a55a503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a078fe7414bf11ee4f33567cb85b2b202"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a078fe7414bf11ee4f33567cb85b2b202">ExtractLastPairFromSubmatLists</a> (std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *list_of_pairs)</td></tr>
<tr class="separator:a078fe7414bf11ee4f33567cb85b2b202"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45cba0a2a0446179a2741e19949afcd"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ab45cba0a2a0446179a2741e19949afcd">SplitLocationsUsingSubmatHistogram</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_submat_list_size, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *submat_histogram_vector, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *split_lists)</td></tr>
<tr class="separator:ab45cba0a2a0446179a2741e19949afcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c81548b4f8146cd3447b10d556978a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8">SplitLocations</a> (const std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; &amp;submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *split_lists)</td></tr>
<tr class="memdesc:a7c81548b4f8146cd3447b10d556978a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The input to this function is a vector of lists of pairs, and this function splits it up into a list of vectors of pairs.  <a href="#a7c81548b4f8146cd3447b10d556978a8">More...</a><br/></td></tr>
<tr class="separator:a7c81548b4f8146cd3447b10d556978a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae99488174e8dde27f8f30d91d61c0cd2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">ConvertToIndexes</a> (const std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;location_vector, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *first_value, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *second_values)</td></tr>
<tr class="memdesc:ae99488174e8dde27f8f30d91d61c0cd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">If it is the case for some i &gt;= 0 that all the .first elements of "location_vector" are either i or -1, then output i to first_value and the .second elements into "second_values", and return true.  <a href="#ae99488174e8dde27f8f30d91d61c0cd2">More...</a><br/></td></tr>
<tr class="separator:ae99488174e8dde27f8f30d91d61c0cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ff5e289907fa63155ee9bec0f9c631"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">EnsureContiguousProperty</a> (const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;indexes, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *indexes_out)</td></tr>
<tr class="memdesc:a84ff5e289907fa63155ee9bec0f9c631"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a vector of indexes and splits it up into as separate vectors of the same size, as needed to ensure that the 'contiguous property' holds.  <a href="#a84ff5e289907fa63155ee9bec0f9c631">More...</a><br/></td></tr>
<tr class="separator:a84ff5e289907fa63155ee9bec0f9c631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1df4b00a6ceed8cc071e249ed8c931d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a1df4b00a6ceed8cc071e249ed8c931d0">SplitPairList</a> (std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;list, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *split_lists)</td></tr>
<tr class="separator:a1df4b00a6ceed8cc071e249ed8c931d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230b979419515f453ee5c8f2bc87a4dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a230b979419515f453ee5c8f2bc87a4dd">SplitLocationsBackward</a> (const std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; &amp;submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &gt; *split_lists)</td></tr>
<tr class="memdesc:a230b979419515f453ee5c8f2bc87a4dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function has the same interface as <a class="el" href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8" title="The input to this function is a vector of lists of pairs, and this function splits it up into a list ...">SplitLocations()</a>; however, it ensures certain additional properties of the output "split_lists", which are necessary because of the way it is used in backprop code.  <a href="#a230b979419515f453ee5c8f2bc87a4dd">More...</a><br/></td></tr>
<tr class="separator:a230b979419515f453ee5c8f2bc87a4dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae892457066e9b2ac1632188de1aa06f1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">HasContiguousProperty</a> (const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;indexes, std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *reverse_indexes)</td></tr>
<tr class="memdesc:ae892457066e9b2ac1632188de1aa06f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns true if for each integer i != -1, all the indexes j at which indexes[j] == i are consecutive with no gaps (more formally: if j1 &lt; j2 &lt; j3 and indexes[j1] != -1 and indexes[j1] == indexes[j3], then indexes[j1] == indexes[j2]).  <a href="#ae892457066e9b2ac1632188de1aa06f1">More...</a><br/></td></tr>
<tr class="separator:ae892457066e9b2ac1632188de1aa06f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a375de0015e95f4f495e8c367c76c50c0"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a> (const std::string &amp;a, const std::string &amp;b)</td></tr>
<tr class="separator:a375de0015e95f4f495e8c367c76c50c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee5e219c905cd82d682bc00a0de72d74"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aee5e219c905cd82d682bc00a0de72d74">TestNnetComponentIo</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c)</td></tr>
<tr class="separator:aee5e219c905cd82d682bc00a0de72d74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7d4b74958e0a63a4e52bef63e71f394"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af7d4b74958e0a63a4e52bef63e71f394">TestNnetComponentCopy</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c)</td></tr>
<tr class="separator:af7d4b74958e0a63a4e52bef63e71f394"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a554b097cfc8c22c7fe43dec7ceca8839"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a554b097cfc8c22c7fe43dec7ceca8839">TestNnetComponentAddScale</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c)</td></tr>
<tr class="separator:a554b097cfc8c22c7fe43dec7ceca8839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a179079a64f06a09c80c757753016b094"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a179079a64f06a09c80c757753016b094">TestNnetComponentVectorizeUnVectorize</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c)</td></tr>
<tr class="separator:a179079a64f06a09c80c757753016b094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace60719eb494447690bfb8e77e02a2e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ace60719eb494447690bfb8e77e02a2e4">TestStringsApproxEqual</a> ()</td></tr>
<tr class="separator:ace60719eb494447690bfb8e77e02a2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b28b95264b6db2e9ce5658f8f939a8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a0b28b95264b6db2e9ce5658f8f939a8b">TestNnetComponentUpdatable</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c)</td></tr>
<tr class="separator:a0b28b95264b6db2e9ce5658f8f939a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d2f85463a6a7b714692a2e84160f137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3d2f85463a6a7b714692a2e84160f137">TestSimpleComponentPropagateProperties</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;c)</td></tr>
<tr class="separator:a3d2f85463a6a7b714692a2e84160f137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a1dc9b5063b680db3bb5e8ce670a21"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">TestSimpleComponentDataDerivative</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;c, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> perturb_delta)</td></tr>
<tr class="separator:ac1a1dc9b5063b680db3bb5e8ce670a21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72a20443febb349c12d3f34ea6d5bdc5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;c, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> perturb_delta, bool test_derivative)</td></tr>
<tr class="separator:a72a20443febb349c12d3f34ea6d5bdc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b068b357bfea7bf051d6f644e1912d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a32b068b357bfea7bf051d6f644e1912d">UnitTestNnetComponent</a> ()</td></tr>
<tr class="separator:a32b068b357bfea7bf051d6f644e1912d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a170051dd847dd17ea4826fe55635fb72"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a170051dd847dd17ea4826fe55635fb72">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="classkaldi_1_1nnet3_1_1ComputationGraphBuilder.html#a4da89c69c9a5840ecaa70959af36c492">ComputationGraphBuilder::ComputableInfo</a> &amp;info)</td></tr>
<tr class="memdesc:a170051dd847dd17ea4826fe55635fb72"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is to be used in logging only.  <a href="#a170051dd847dd17ea4826fe55635fb72">More...</a><br/></td></tr>
<tr class="separator:a170051dd847dd17ea4826fe55635fb72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a9dab13d6db9f89fb2693d37b08ebe1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9a9dab13d6db9f89fb2693d37b08ebe1">ComputeComputationGraph</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *graph)</td></tr>
<tr class="separator:a9a9dab13d6db9f89fb2693d37b08ebe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49f9f182fa8dc05d6672c4b7fcad737f"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a49f9f182fa8dc05d6672c4b7fcad737f">SumVectorSizes</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;vec)</td></tr>
<tr class="separator:a49f9f182fa8dc05d6672c4b7fcad737f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa057ac8d68abd82e005a2e0df6644f22"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa057ac8d68abd82e005a2e0df6644f22">ComputeComputationPhasesForEpoch</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;graph, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;dependencies_subset, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;depend_on_subset, const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;this_epoch, bool epoch_is_trivial, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *phase_index, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *phases)</td></tr>
<tr class="separator:aa057ac8d68abd82e005a2e0df6644f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb066857e6cd5f7839f8403ac734c11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2fb066857e6cd5f7839f8403ac734c11">ComputeComputationPhases</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> &amp;computation_graph, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *phases)</td></tr>
<tr class="memdesc:a2fb066857e6cd5f7839f8403ac734c11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the phases in which we can compute each cindex in the computation; the cindexes will be grouped into phases.  <a href="#a2fb066857e6cd5f7839f8403ac734c11">More...</a><br/></td></tr>
<tr class="separator:a2fb066857e6cd5f7839f8403ac734c11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e0cb29ecc50f5275d89e4962156ea4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a83e0cb29ecc50f5275d89e4962156ea4">ComputeComputationSteps</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;phases, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationGraph.html">ComputationGraph</a> *computation_graph, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *steps)</td></tr>
<tr class="memdesc:a83e0cb29ecc50f5275d89e4962156ea4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function arranges the cindex_ids of the computation into a sequence of lists called "steps", which will correspond roughly to the commands in the compiled computation.  <a href="#a83e0cb29ecc50f5275d89e4962156ea4">More...</a><br/></td></tr>
<tr class="separator:a83e0cb29ecc50f5275d89e4962156ea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c7aa23d0e3d87413ce4de4be66f7a6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a69c7aa23d0e3d87413ce4de4be66f7a6">GetIndexesStrings</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, std::vector&lt; std::string &gt; *indexes_strings)</td></tr>
<tr class="separator:a69c7aa23d0e3d87413ce4de4be66f7a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3228381d1a400e113f12dffce84ec0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2e3228381d1a400e113f12dffce84ec0">GetIndexesMultiStrings</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, std::vector&lt; std::string &gt; *indexes_multi_strings)</td></tr>
<tr class="separator:a2e3228381d1a400e113f12dffce84ec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace8b522d1ba98e1b9f16d48c7951eac1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ace8b522d1ba98e1b9f16d48c7951eac1">PrintCommand</a> (std::ostream &amp;os, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> command_index, const std::vector&lt; std::string &gt; &amp;submatrix_strings, const std::vector&lt; std::string &gt; &amp;indexes_strings, const std::vector&lt; std::string &gt; &amp;indexes_multi_strings)</td></tr>
<tr class="separator:ace8b522d1ba98e1b9f16d48c7951eac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e0b21f2d4f6d5eaf3edb65595b417c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a84e0b21f2d4f6d5eaf3edb65595b417c">PrintComputationPreamble</a> (std::ostream &amp;os, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;c, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const std::vector&lt; std::string &gt; &amp;submatrix_strings, const std::vector&lt; std::string &gt; &amp;indexes_strings, const std::vector&lt; std::string &gt; &amp;indexes_multi_strings)</td></tr>
<tr class="separator:a84e0b21f2d4f6d5eaf3edb65595b417c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63bbb226b5063936684810e9cc6f830a"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a63bbb226b5063936684810e9cc6f830a">operator&lt;&lt;</a> (std::ostream &amp;os, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation)</td></tr>
<tr class="separator:a63bbb226b5063936684810e9cc6f830a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade08d6728a35e80cbf187c6da2d28596"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ade08d6728a35e80cbf187c6da2d28596">TestNnetDecodable</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const std::vector&lt; <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &gt; &amp;inputs, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;reference_output)</td></tr>
<tr class="separator:ade08d6728a35e80cbf187c6da2d28596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72aa26595d9be2bf06aa61db33ed362f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a72aa26595d9be2bf06aa61db33ed362f">UnitTestNnetCompute</a> ()</td></tr>
<tr class="separator:a72aa26595d9be2bf06aa61db33ed362f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12fab71b9fb0d11733b8d9e452da5eda"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a12fab71b9fb0d11733b8d9e452da5eda">ComputeMinAndMaxTimes</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;indexes, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *min_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *max_t)</td></tr>
<tr class="separator:a12fab71b9fb0d11733b8d9e452da5eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfc29da249703fa1e9c54cf85f6f0ef1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#abfc29da249703fa1e9c54cf85f6f0ef1">SetDerivTimesOptions</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> *opt_config)</td></tr>
<tr class="separator:abfc29da249703fa1e9c54cf85f6f0ef1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a557038a07d45e34088f4943c2a668b2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a557038a07d45e34088f4943c2a668b2b">UnitTestNnetModelDerivatives</a> ()</td></tr>
<tr class="separator:a557038a07d45e34088f4943c2a668b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8666ffad3ea0232ebaa3cff139a32629"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a8666ffad3ea0232ebaa3cff139a32629">UnitTestNnetInputDerivatives</a> ()</td></tr>
<tr class="separator:a8666ffad3ea0232ebaa3cff139a32629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdefaf0453649dae0c96bf6cd516bd69"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1ForwardingDescriptor.html">ForwardingDescriptor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes)</td></tr>
<tr class="separator:afdefaf0453649dae0c96bf6cd516bd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9b08e079998e1eea6db1c2b5a403a28"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html">SumDescriptor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">GenRandSumDescriptor</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes)</td></tr>
<tr class="separator:ae9b08e079998e1eea6db1c2b5a403a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2465e8e47256304999d4cd892e7162b9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2465e8e47256304999d4cd892e7162b9">GenRandDescriptor</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes, <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> *desc)</td></tr>
<tr class="separator:a2465e8e47256304999d4cd892e7162b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84775bbab03ebc20020d57dbefb2586"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa84775bbab03ebc20020d57dbefb2586">UnitTestDescriptorIo</a> ()</td></tr>
<tr class="separator:aa84775bbab03ebc20020d57dbefb2586"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3fd435407cfc4dec9e51a07d3c4f26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2e3fd435407cfc4dec9e51a07d3c4f26">UnitTestGeneralDescriptor</a> ()</td></tr>
<tr class="separator:a2e3fd435407cfc4dec9e51a07d3c4f26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59f9bf54d192e760e406499f997327be"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a> (const std::vector&lt; std::string &gt; &amp;node_names, const std::string &amp;desc_str)</td></tr>
<tr class="separator:a59f9bf54d192e760e406499f997327be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ae443db1f79c1de816ace0cee8706f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac9ae443db1f79c1de816ace0cee8706f">UnitTestGeneralDescriptorSpecial</a> ()</td></tr>
<tr class="separator:ac9ae443db1f79c1de816ace0cee8706f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3fbd67899f39d18e85c03f06e0c69bf"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa3fbd67899f39d18e85c03f06e0c69bf">ParsingContext</a> (const std::string *token_ptr)</td></tr>
<tr class="separator:aa3fbd67899f39d18e85c03f06e0c69bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41114607233f11aab89539abf08cf922"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a41114607233f11aab89539abf08cf922">ExpectToken</a> (const std::string &amp;token, const std::string &amp;what_we_are_parsing, const std::string **next_token)</td></tr>
<tr class="separator:a41114607233f11aab89539abf08cf922"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a556f73d99d4fcebed0e0bde2c2d34094"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a556f73d99d4fcebed0e0bde2c2d34094">ReadIntegerToken</a> (const std::string &amp;what_we_are_parsing, const std::string **next_token)</td></tr>
<tr class="separator:a556f73d99d4fcebed0e0bde2c2d34094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ba032c2d77e71f7c64ea5a165cc1dcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4ba032c2d77e71f7c64ea5a165cc1dcf">ComputeAccuracy</a> (const <a class="el" href="classkaldi_1_1GeneralMatrix.html">GeneralMatrix</a> &amp;supervision, const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;nnet_output, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *tot_weight, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *tot_accuracy)</td></tr>
<tr class="memdesc:a4ba032c2d77e71f7c64ea5a165cc1dcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the frame accuracy for this minibatch.  <a href="#a4ba032c2d77e71f7c64ea5a165cc1dcf">More...</a><br/></td></tr>
<tr class="separator:a4ba032c2d77e71f7c64ea5a165cc1dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60b81dcaa89e17f1f362e45f559d734c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a60b81dcaa89e17f1f362e45f559d734c">UnitTestNnetExample</a> ()</td></tr>
<tr class="separator:a60b81dcaa89e17f1f362e45f559d734c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc5c658def484ea9be939487a4b60465"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#acc5c658def484ea9be939487a4b60465">UnitTestNnetMergeExamples</a> ()</td></tr>
<tr class="separator:acc5c658def484ea9be939487a4b60465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2093173e902d1445fcd80def82ea4b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2f2093173e902d1445fcd80def82ea4b">GetIoNames</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &amp;src, std::vector&lt; std::string &gt; *names_vec)</td></tr>
<tr class="separator:a2f2093173e902d1445fcd80def82ea4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cffcda7d561b7a342c1e268364e7583"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9cffcda7d561b7a342c1e268364e7583">GetIoSizes</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &amp;src, const std::vector&lt; std::string &gt; &amp;names, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *sizes)</td></tr>
<tr class="separator:a9cffcda7d561b7a342c1e268364e7583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1308684fa0a80a9163906b4cdbf0c04"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af1308684fa0a80a9163906b4cdbf0c04">MergeIo</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &amp;src, const std::vector&lt; std::string &gt; &amp;names, const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;sizes, bool compress, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *merged_eg)</td></tr>
<tr class="separator:af1308684fa0a80a9163906b4cdbf0c04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ceebc46ef1be292f6b2ff71cc1128ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4ceebc46ef1be292f6b2ff71cc1128ee">MergeExamples</a> (const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &amp;src, bool compress, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *dest)</td></tr>
<tr class="memdesc:a4ceebc46ef1be292f6b2ff71cc1128ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge a set of input examples into a single example (typically the size of "src" will be the minibatch size).  <a href="#a4ceebc46ef1be292f6b2ff71cc1128ee">More...</a><br/></td></tr>
<tr class="separator:a4ceebc46ef1be292f6b2ff71cc1128ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a372bbe2bbd902e2f572a04d4c5e80f06"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a372bbe2bbd902e2f572a04d4c5e80f06">ShiftExampleTimes</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t_offset, const std::vector&lt; std::string &gt; &amp;exclude_names, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *eg)</td></tr>
<tr class="memdesc:a372bbe2bbd902e2f572a04d4c5e80f06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shifts the time-index t of everything in the "eg" by adding "t_offset" to all "t" values.  <a href="#a372bbe2bbd902e2f572a04d4c5e80f06">More...</a><br/></td></tr>
<tr class="separator:a372bbe2bbd902e2f572a04d4c5e80f06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f879097cf9cba7482bad03a4030f72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a66f879097cf9cba7482bad03a4030f72">GetComputationRequest</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, bool need_model_derivative, bool store_component_stats, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> *computation_request)</td></tr>
<tr class="memdesc:a66f879097cf9cba7482bad03a4030f72"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a> (which should already have been frame-selected, if desired, and merged into a minibatch) and produces a <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>.  <a href="#a66f879097cf9cba7482bad03a4030f72">More...</a><br/></td></tr>
<tr class="separator:a66f879097cf9cba7482bad03a4030f72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b9cf952746776c000ad16fcc9a9f990"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">AssertGraphEqual</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph1, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph2)</td></tr>
<tr class="separator:a1b9cf952746776c000ad16fcc9a9f990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60bde0a269254ed7c2471823ba362d75"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a60bde0a269254ed7c2471823ba362d75">AssertVectorEqual</a> (const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;vec1, const std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &amp;vec2)</td></tr>
<tr class="separator:a60bde0a269254ed7c2471823ba362d75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cf1ba5597d79505ed5fd378338740bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">BuildTestGraph</a> (std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *graph)</td></tr>
<tr class="separator:a2cf1ba5597d79505ed5fd378338740bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d0ace1de8245a113abc6674f184a19f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a0d0ace1de8245a113abc6674f184a19f">BuildTestGraphTranspose</a> (std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *graph)</td></tr>
<tr class="separator:a0d0ace1de8245a113abc6674f184a19f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0081c3d0993ad39f10df0eb4857188f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a0081c3d0993ad39f10df0eb4857188f5">BuildTestSccs</a> (std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *sccs)</td></tr>
<tr class="separator:a0081c3d0993ad39f10df0eb4857188f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa97309456d46852962866b097697c6b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa97309456d46852962866b097697c6b7">BuildTestSccGraph</a> (std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *scc_graph)</td></tr>
<tr class="separator:aa97309456d46852962866b097697c6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8af0bfaf3239fc5f740444edc92874"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a1a8af0bfaf3239fc5f740444edc92874">BuildTestTopSortOrder</a> (std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *node_to_order)</td></tr>
<tr class="separator:a1a8af0bfaf3239fc5f740444edc92874"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63c8dc97af58bac620a4754a6dcc49ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a63c8dc97af58bac620a4754a6dcc49ec">UnitTestComputeGraphTranspose</a> ()</td></tr>
<tr class="separator:a63c8dc97af58bac620a4754a6dcc49ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af092740ce1ecc4592e3d5c70425baf7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af092740ce1ecc4592e3d5c70425baf7b">UnitTestFindSccs</a> ()</td></tr>
<tr class="separator:af092740ce1ecc4592e3d5c70425baf7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8bfac0b4fadf2d70853d050f21bb2db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af8bfac0b4fadf2d70853d050f21bb2db">UnitTestMakeSccGraph</a> ()</td></tr>
<tr class="separator:af8bfac0b4fadf2d70853d050f21bb2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c05c0131617f375bfa70bc5a88ef6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a09c05c0131617f375bfa70bc5a88ef6c">UnitTestComputeTopSortOrder</a> ()</td></tr>
<tr class="separator:a09c05c0131617f375bfa70bc5a88ef6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679a6d66a5e4a3993124bc35597dd06b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a679a6d66a5e4a3993124bc35597dd06b">NnetToDirectedGraph</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *graph)</td></tr>
<tr class="memdesc:a679a6d66a5e4a3993124bc35597dd06b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes an nnet and turns it to a directed graph on nodes.  <a href="#a679a6d66a5e4a3993124bc35597dd06b">More...</a><br/></td></tr>
<tr class="separator:a679a6d66a5e4a3993124bc35597dd06b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4457943f315ab2e900b1f81606404f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">ComputeGraphTranspose</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *graph_transpose)</td></tr>
<tr class="memdesc:ac4457943f315ab2e900b1f81606404f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outputs a graph in which the order of arcs is reversed.  <a href="#ac4457943f315ab2e900b1f81606404f8">More...</a><br/></td></tr>
<tr class="separator:ac4457943f315ab2e900b1f81606404f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a145f09473f55df6f338ac4d69cff8bf1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a145f09473f55df6f338ac4d69cff8bf1">TarjanSccRecursive</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *global_index, std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1TarjanNode.html">TarjanNode</a> &gt; *tarjan_nodes, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *tarjan_stack, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *sccs)</td></tr>
<tr class="separator:a145f09473f55df6f338ac4d69cff8bf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee48ed6add62e6cef7918e3f6a94ffc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aee48ed6add62e6cef7918e3f6a94ffc7">FindSccsTarjan</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *sccs)</td></tr>
<tr class="separator:aee48ed6add62e6cef7918e3f6a94ffc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae72c79fbb6ec81b69aaee02701fa23e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae72c79fbb6ec81b69aaee02701fa23e5">FindSccs</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *sccs)</td></tr>
<tr class="memdesc:ae72c79fbb6ec81b69aaee02701fa23e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a directed graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming from the current node), partition it into strongly connected components (i.e.  <a href="#ae72c79fbb6ec81b69aaee02701fa23e5">More...</a><br/></td></tr>
<tr class="separator:ae72c79fbb6ec81b69aaee02701fa23e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efe2804eba8c2da73af3aa4eff4a2fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9efe2804eba8c2da73af3aa4eff4a2fc">MakeSccGraph</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;sccs, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *scc_graph)</td></tr>
<tr class="memdesc:a9efe2804eba8c2da73af3aa4eff4a2fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a list of sccs of a graph (e.g.  <a href="#a9efe2804eba8c2da73af3aa4eff4a2fc">More...</a><br/></td></tr>
<tr class="separator:a9efe2804eba8c2da73af3aa4eff4a2fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f6120092b06acc2556c7b9e40c990e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a76f6120092b06acc2556c7b9e40c990e">ComputeTopSortOrderRecursive</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node, const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, std::vector&lt; bool &gt; *cycle_detector, std::vector&lt; bool &gt; *is_visited, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *reversed_orders)</td></tr>
<tr class="separator:a76f6120092b06acc2556c7b9e40c990e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c2ac8a9e96d220776910b2a9ae2971"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae4c2ac8a9e96d220776910b2a9ae2971">ComputeTopSortOrder</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *node_to_order)</td></tr>
<tr class="memdesc:ae4c2ac8a9e96d220776910b2a9ae2971"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given an acyclic graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming from the current node), compute a topological ordering of the graph nodes.  <a href="#ae4c2ac8a9e96d220776910b2a9ae2971">More...</a><br/></td></tr>
<tr class="separator:ae4c2ac8a9e96d220776910b2a9ae2971"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a794312260c52d2eb93f30302ee0a7173"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a794312260c52d2eb93f30302ee0a7173">PrintGraphToString</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;graph)</td></tr>
<tr class="memdesc:a794312260c52d2eb93f30302ee0a7173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints a graph to a string in a pretty way for human readability, e.g.  <a href="#a794312260c52d2eb93f30302ee0a7173">More...</a><br/></td></tr>
<tr class="separator:a794312260c52d2eb93f30302ee0a7173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380175b61aef188f214827ad6c2faca2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a380175b61aef188f214827ad6c2faca2">ComputeNnetComputationEpochs</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *node_to_epoch)</td></tr>
<tr class="memdesc:a380175b61aef188f214827ad6c2faca2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the order in which we need to compute each node in the graph, where each node-index n maps to an order-index t = 0, 1, ...  <a href="#a380175b61aef188f214827ad6c2faca2">More...</a><br/></td></tr>
<tr class="separator:a380175b61aef188f214827ad6c2faca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4b0e8d73b17875e8bc5cc492e79b71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2b4b0e8d73b17875e8bc5cc492e79b71">UnitTestNnetIo</a> ()</td></tr>
<tr class="separator:a2b4b0e8d73b17875e8bc5cc492e79b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03a8d81b9d815de3d77efb9b0cfff36d"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> opt_config)</td></tr>
<tr class="separator:a03a8d81b9d815de3d77efb9b0cfff36d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d3983f63fe3e84e488bc3e27a67e540"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a0d3983f63fe3e84e488bc3e27a67e540">UnitTestNnetOptimize</a> ()</td></tr>
<tr class="separator:a0d3983f63fe3e84e488bc3e27a67e540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ec833031232462f45b425a8a5503489"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2ec833031232462f45b425a8a5503489">IdentifySubmatrixArgs</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> *command, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *submatrix_args)</td></tr>
<tr class="memdesc:a2ec833031232462f45b425a8a5503489"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "submatrix_args" the addresses of a subset of arguments arg1 through arg6 in "command", that correspond to the indexes of submatrices.  <a href="#a2ec833031232462f45b425a8a5503489">More...</a><br/></td></tr>
<tr class="separator:a2ec833031232462f45b425a8a5503489"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac8664deabb618f4c3dc3d99d8462ea1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aac8664deabb618f4c3dc3d99d8462ea1">IdentifySubmatrixArgs</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> &gt; *commands, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *submatrix_args)</td></tr>
<tr class="memdesc:aac8664deabb618f4c3dc3d99d8462ea1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "submatrix_args" the addresses of the args (arguments arg1 through arg6) in the vector "commands", that correspond to the indexes of submatrices.  <a href="#aac8664deabb618f4c3dc3d99d8462ea1">More...</a><br/></td></tr>
<tr class="separator:aac8664deabb618f4c3dc3d99d8462ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada08c40c80a54a8a851448af83ada561"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ada08c40c80a54a8a851448af83ada561">IdentifyMatrixArgs</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> &gt; *command, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *matrix_args)</td></tr>
<tr class="memdesc:ada08c40c80a54a8a851448af83ada561"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "matrix_args" the addresses of a subset of the arguments arg1 through arg6 in commands in "commands", that correspond to the indexes of matrices.  <a href="#ada08c40c80a54a8a851448af83ada561">More...</a><br/></td></tr>
<tr class="separator:ada08c40c80a54a8a851448af83ada561"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e9698625c65ed53a8fb2eadc416110"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a77e9698625c65ed53a8fb2eadc416110">IdentifyMatrixArgsInComputation</a> (bool include_from_submatrices, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *matrix_args)</td></tr>
<tr class="memdesc:a77e9698625c65ed53a8fb2eadc416110"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "matrix_args" the addresses of indexes inside 'computation' that correspond to matrices.  <a href="#a77e9698625c65ed53a8fb2eadc416110">More...</a><br/></td></tr>
<tr class="separator:a77e9698625c65ed53a8fb2eadc416110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96b480d0b6d2b5890e1490f8c2e6ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af96b480d0b6d2b5890e1490f8c2e6ac0">IdentifyIndexesMultiArgs</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> &gt; *commands, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *indexes_multi_args)</td></tr>
<tr class="memdesc:af96b480d0b6d2b5890e1490f8c2e6ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies in the vector of commands, arguments that correspond to indexes into the computation's indexes_multi array, and outputs a list of pointers to those arguments to 'indexes_multi_args'.  <a href="#af96b480d0b6d2b5890e1490f8c2e6ac0">More...</a><br/></td></tr>
<tr class="separator:af96b480d0b6d2b5890e1490f8c2e6ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17acd598bf1ced7e83e0c8a8569d224f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a17acd598bf1ced7e83e0c8a8569d224f">IdentifyIndexesRangesArgs</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> &gt; *commands, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *indexes_ranges_args)</td></tr>
<tr class="memdesc:a17acd598bf1ced7e83e0c8a8569d224f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies in the vector of commands, arguments that correspond to indexes into the computation's 'indexes_ranges' array, and outputs a list of pointers to those arguments to 'indexes_ranges_args'.  <a href="#a17acd598bf1ced7e83e0c8a8569d224f">More...</a><br/></td></tr>
<tr class="separator:a17acd598bf1ced7e83e0c8a8569d224f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6950699c83d835e55f003f89bb92bc80"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6950699c83d835e55f003f89bb92bc80">IdentifyIndexesArgs</a> (std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> &gt; *commands, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *indexes_args)</td></tr>
<tr class="memdesc:a6950699c83d835e55f003f89bb92bc80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Identifies in the vector of commands, arguments that correspond to indexes into the computation's 'indexes' array, and outputs a list of pointers to those arguments to 'indexes_args'.  <a href="#a6950699c83d835e55f003f89bb92bc80">More...</a><br/></td></tr>
<tr class="separator:a6950699c83d835e55f003f89bb92bc80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15dd851f919e180bea3c3a1f60218d46"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a15dd851f919e180bea3c3a1f60218d46">IdentifyMatrixArgs</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1Command.html">NnetComputation::Command</a> *command, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *matrix_args)</td></tr>
<tr class="memdesc:a15dd851f919e180bea3c3a1f60218d46"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "matrix_args" the addresses of a subset of the arguments arg1 through arg6 in "command", that correspond to the indexes of matrices.  <a href="#a15dd851f919e180bea3c3a1f60218d46">More...</a><br/></td></tr>
<tr class="separator:a15dd851f919e180bea3c3a1f60218d46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af87da4e8a0e1880438bf77e8a34b4143"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#af87da4e8a0e1880438bf77e8a34b4143">IdentifySubmatrixArgsInComputation</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> * &gt; *submatrix_args)</td></tr>
<tr class="memdesc:af87da4e8a0e1880438bf77e8a34b4143"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function outputs to "submatrix_args" the addresses of integers in 'computation' that correspond to submatrices.  <a href="#af87da4e8a0e1880438bf77e8a34b4143">More...</a><br/></td></tr>
<tr class="separator:af87da4e8a0e1880438bf77e8a34b4143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6828e427bd8883455705e0c9b99b5f2f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6828e427bd8883455705e0c9b99b5f2f">RenumberComputation</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a6828e427bd8883455705e0c9b99b5f2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function detects submatrices, matrices, and members of indexes_multi and indexes that are never used (e.g.  <a href="#a6828e427bd8883455705e0c9b99b5f2f">More...</a><br/></td></tr>
<tr class="separator:a6828e427bd8883455705e0c9b99b5f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1146f4efa141a56210f9dbf1090b20f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a1146f4efa141a56210f9dbf1090b20f0">RemoveNoOps</a> (<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a1146f4efa141a56210f9dbf1090b20f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes commands of type kNoOperation in the computation.  <a href="#a1146f4efa141a56210f9dbf1090b20f0">More...</a><br/></td></tr>
<tr class="separator:a1146f4efa141a56210f9dbf1090b20f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94e3ce52963d290fbf0595dea3b126c6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a94e3ce52963d290fbf0595dea3b126c6">ReplaceInInput</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> orig_matrix_index, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> new_matrix_index, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a94e3ce52963d290fbf0595dea3b126c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wherever matrix orig_matrix_index appears in the input of the network (i.e.  <a href="#a94e3ce52963d290fbf0595dea3b126c6">More...</a><br/></td></tr>
<tr class="separator:a94e3ce52963d290fbf0595dea3b126c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2efea0af361ac9b6981f605d7e616028"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2efea0af361ac9b6981f605d7e616028">ReplaceInOutput</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> orig_matrix_index, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> new_matrix_index, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a2efea0af361ac9b6981f605d7e616028"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wherever matrix orig_matrix_index appears in the output of the network (i.e.  <a href="#a2efea0af361ac9b6981f605d7e616028">More...</a><br/></td></tr>
<tr class="separator:a2efea0af361ac9b6981f605d7e616028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86704308a1467b6000867cc9ed198482"><td class="memItemLeft" align="right" valign="top">static <br class="typebreak"/>
<a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1SubMatrixInfo.html">NnetComputation::SubMatrixInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a86704308a1467b6000867cc9ed198482">GetSubMatrixOfSubMatrix</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> &amp;computation, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submat_a, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submat_b)</td></tr>
<tr class="memdesc:a86704308a1467b6000867cc9ed198482"><td class="mdescLeft">&#160;</td><td class="mdescRight">This static function returns a SubMatrixInfo corresponding to replacing the matrix-index in a's "matrix_index" with, essentially, sub-matrix b.  <a href="#a86704308a1467b6000867cc9ed198482">More...</a><br/></td></tr>
<tr class="separator:a86704308a1467b6000867cc9ed198482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ed9b871bd28649b80165dc1af5d1a98"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6ed9b871bd28649b80165dc1af5d1a98">LimitDerivativeTimes</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_deriv_time, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_deriv_time, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="separator:a6ed9b871bd28649b80165dc1af5d1a98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e1e086f75487fe19752fd2b34ca627"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a20e1e086f75487fe19752fd2b34ca627">MoveSizingCommands</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a20e1e086f75487fe19752fd2b34ca627"><td class="mdescLeft">&#160;</td><td class="mdescRight">This optimization moves commands that initialize matrices to as late as possible, and commands that empty matrices to as early as possible.  <a href="#a20e1e086f75487fe19752fd2b34ca627">More...</a><br/></td></tr>
<tr class="separator:a20e1e086f75487fe19752fd2b34ca627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae053839b5ed781f2f7408489a1528dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aae053839b5ed781f2f7408489a1528dd">RemoveUnnecessaryZeroing</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:aae053839b5ed781f2f7408489a1528dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This optimization function changes, where possible, matrix initializations of type kAllocMatrixZeroed to kAllocMatrixUndefined.  <a href="#aae053839b5ed781f2f7408489a1528dd">More...</a><br/></td></tr>
<tr class="separator:aae053839b5ed781f2f7408489a1528dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4874b04bb051028a1b6cb08cff2d1994"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4874b04bb051028a1b6cb08cff2d1994">ComputeCommandPairs</a> (const std::pair&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt;, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;lists, std::vector&lt; std::pair&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *pairs)</td></tr>
<tr class="separator:a4874b04bb051028a1b6cb08cff2d1994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92c251003c3f612c5cfbcbd72cbd030b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a92c251003c3f612c5cfbcbd72cbd030b">RemoveUnnecessaryAllocation</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a92c251003c3f612c5cfbcbd72cbd030b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This optimization detects cases where we deallocate a matrix, and then later allocate another matrix of the same size; and replaces them with commands of type kAllocFromOther or kAllocFromOtherZeroed.  <a href="#a92c251003c3f612c5cfbcbd72cbd030b">More...</a><br/></td></tr>
<tr class="separator:a92c251003c3f612c5cfbcbd72cbd030b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7464172a2f27484596c2d374bb1adcd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7464172a2f27484596c2d374bb1adcd6">VariableMergingOptimization</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> &amp;config, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a7464172a2f27484596c2d374bb1adcd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This wraps class <a class="el" href="classkaldi_1_1nnet3_1_1VariableMergingOptimizer.html" title="This class is responsible for merging matrices, although you probably want to access it via the the f...">VariableMergingOptimizer</a> in a simplified interface.  <a href="#a7464172a2f27484596c2d374bb1adcd6">More...</a><br/></td></tr>
<tr class="separator:a7464172a2f27484596c2d374bb1adcd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad35855c00662ec8d8b2cf5e14569db0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ad35855c00662ec8d8b2cf5e14569db0a">ConsolidateModelUpdate</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:ad35855c00662ec8d8b2cf5e14569db0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This consolidates the model-update parts of the backprop into larger operations (applicable mostly to recurrent setups)&ndash; internally it uses class <a class="el" href="classkaldi_1_1nnet3_1_1ModelUpdateConsolidator.html" title="This class is responsible for consolidating the model-update part of backprop commands, for components in (e.g.) recurrent networks that need to have many separate backprop commands, into more efficient single commands operating on consolidated data in larger matrices. ">ModelUpdateConsolidator</a>.  <a href="#ad35855c00662ec8d8b2cf5e14569db0a">More...</a><br/></td></tr>
<tr class="separator:ad35855c00662ec8d8b2cf5e14569db0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac759ea60772df625784bcc714f7a41da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac759ea60772df625784bcc714f7a41da">ConvertAdditionToAssignment</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:ac759ea60772df625784bcc714f7a41da"><td class="mdescLeft">&#160;</td><td class="mdescRight">This converts addition operations (things with Add in their names) to copy operations (things with Copy in their names).  <a href="#ac759ea60772df625784bcc714f7a41da">More...</a><br/></td></tr>
<tr class="separator:ac759ea60772df625784bcc714f7a41da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96e8c7c5766b9f5c698ce7195489efba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">Optimize</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> &amp;config, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:a96e8c7c5766b9f5c698ce7195489efba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the top-level function for optimizing a computation.  <a href="#a96e8c7c5766b9f5c698ce7195489efba">More...</a><br/></td></tr>
<tr class="separator:a96e8c7c5766b9f5c698ce7195489efba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc06e3c26b68f19c01aad13eeb95205"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#adbc06e3c26b68f19c01aad13eeb95205">LimitDerivativeTimes</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> &amp;opts, <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> *computation)</td></tr>
<tr class="memdesc:adbc06e3c26b68f19c01aad13eeb95205"><td class="mdescLeft">&#160;</td><td class="mdescRight">This optimization, which has no effect unless you set &ndash;min-deriv-time or &ndash;max-deriv-time, modifies the backprop operations for efficiency based on the assumption that derivatives for any Cindex with t &lt; min_deriv_time or t &gt; max_deriv_time are zero.  <a href="#adbc06e3c26b68f19c01aad13eeb95205">More...</a><br/></td></tr>
<tr class="separator:adbc06e3c26b68f19c01aad13eeb95205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a013e6098460707cee578712638ce37dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a013e6098460707cee578712638ce37dd">UnitTestConfigLineParse</a> ()</td></tr>
<tr class="separator:a013e6098460707cee578712638ce37dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad179bd30fedc76b302f19fb2cb1e6a60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ad179bd30fedc76b302f19fb2cb1e6a60">UnitTestReadConfig</a> ()</td></tr>
<tr class="separator:ad179bd30fedc76b302f19fb2cb1e6a60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac447841fa736f8af0f8c64e8cd415644"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac447841fa736f8af0f8c64e8cd415644">UnitTestDescriptorTokenize</a> ()</td></tr>
<tr class="separator:ac447841fa736f8af0f8c64e8cd415644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7353c9f73e07a4f64149e67d737482"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a1a7353c9f73e07a4f64149e67d737482">UnitTestSummarizeVector</a> ()</td></tr>
<tr class="separator:a1a7353c9f73e07a4f64149e67d737482"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d34dcbb48b22bb0c34f699721b33bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac9d34dcbb48b22bb0c34f699721b33bc">ExpectOneOrTwoTokens</a> (std::istream &amp;is, bool binary, const std::string &amp;token1, const std::string &amp;token2)</td></tr>
<tr class="memdesc:ac9d34dcbb48b22bb0c34f699721b33bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is like ExpectToken but for two tokens, and it will either accept token1 and then token2, or just token2.  <a href="#ac9d34dcbb48b22bb0c34f699721b33bc">More...</a><br/></td></tr>
<tr class="separator:ac9d34dcbb48b22bb0c34f699721b33bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e18825b4c5b0834e638296b2f5bb35a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a0e18825b4c5b0834e638296b2f5bb35a">ParseFromString</a> (const std::string &amp;name, std::string *string, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *param)</td></tr>
<tr class="memdesc:a0e18825b4c5b0834e638296b2f5bb35a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function used in Init routines.  <a href="#a0e18825b4c5b0834e638296b2f5bb35a">More...</a><br/></td></tr>
<tr class="separator:a0e18825b4c5b0834e638296b2f5bb35a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c170854db9a3b5bb3915dfb52380c2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a06c170854db9a3b5bb3915dfb52380c2">ParseFromString</a> (const std::string &amp;name, std::string *string, bool *param)</td></tr>
<tr class="memdesc:a06c170854db9a3b5bb3915dfb52380c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version of ParseFromString is for parameters of type bool, which can appear as any string beginning with f, F, t or T.  <a href="#a06c170854db9a3b5bb3915dfb52380c2">More...</a><br/></td></tr>
<tr class="separator:a06c170854db9a3b5bb3915dfb52380c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eac951c4af19775f3ba550efa12f385"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7eac951c4af19775f3ba550efa12f385">ParseFromString</a> (const std::string &amp;name, std::string *string, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *param)</td></tr>
<tr class="memdesc:a7eac951c4af19775f3ba550efa12f385"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version of ParseFromString is for parameters of type BaseFloat.  <a href="#a7eac951c4af19775f3ba550efa12f385">More...</a><br/></td></tr>
<tr class="separator:a7eac951c4af19775f3ba550efa12f385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd5f31afe3e5137b700d0af4fbb13211"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#afd5f31afe3e5137b700d0af4fbb13211">ParseFromString</a> (const std::string &amp;name, std::string *string, std::string *param)</td></tr>
<tr class="memdesc:afd5f31afe3e5137b700d0af4fbb13211"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version of ParseFromString is for parsing strings.  <a href="#afd5f31afe3e5137b700d0af4fbb13211">More...</a><br/></td></tr>
<tr class="separator:afd5f31afe3e5137b700d0af4fbb13211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f7f50f1457000af31efe2ecd53f983a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7f7f50f1457000af31efe2ecd53f983a">ParseFromString</a> (const std::string &amp;name, std::string *string, std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; *param)</td></tr>
<tr class="memdesc:a7f7f50f1457000af31efe2ecd53f983a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version of ParseFromString handles colon-separated or comma-separated lists of integers.  <a href="#a7f7f50f1457000af31efe2ecd53f983a">More...</a><br/></td></tr>
<tr class="separator:a7f7f50f1457000af31efe2ecd53f983a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b64008b19bbb6e8769769cbf96fa68"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a> (const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</td></tr>
<tr class="memdesc:ac6b64008b19bbb6e8769769cbf96fa68"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function tokenizes input when parsing <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> configuration values.  <a href="#ac6b64008b19bbb6e8769769cbf96fa68">More...</a><br/></td></tr>
<tr class="separator:ac6b64008b19bbb6e8769769cbf96fa68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30e2d3a7507084b838f420b5e10b37f9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a30e2d3a7507084b838f420b5e10b37f9">IsValidName</a> (const std::string &amp;name)</td></tr>
<tr class="memdesc:a30e2d3a7507084b838f420b5e10b37f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if 'name' would be a valid name for a component or node in a <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>.  <a href="#a30e2d3a7507084b838f420b5e10b37f9">More...</a><br/></td></tr>
<tr class="separator:a30e2d3a7507084b838f420b5e10b37f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace63d2b2d7c79e9881204ea52366e48c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ace63d2b2d7c79e9881204ea52366e48c">ReadConfigFile</a> (std::istream &amp;is, std::vector&lt; std::string &gt; *lines)</td></tr>
<tr class="memdesc:ace63d2b2d7c79e9881204ea52366e48c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads in a config file and *appends* its contents to a vector of lines; it is responsible for removing comments (anything after '#') and stripping out any lines that contain only whitespace after comment removal.  <a href="#ace63d2b2d7c79e9881204ea52366e48c">More...</a><br/></td></tr>
<tr class="separator:ace63d2b2d7c79e9881204ea52366e48c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c1330ecd1ee31afb2214977a2a88e10"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4c1330ecd1ee31afb2214977a2a88e10">ErrorContext</a> (std::istream &amp;is)</td></tr>
<tr class="memdesc:a4c1330ecd1ee31afb2214977a2a88e10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a string used in error messages.  <a href="#a4c1330ecd1ee31afb2214977a2a88e10">More...</a><br/></td></tr>
<tr class="separator:a4c1330ecd1ee31afb2214977a2a88e10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2904394bf025a2757bd2ab32f2caea36"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2904394bf025a2757bd2ab32f2caea36">ErrorContext</a> (const std::string &amp;str)</td></tr>
<tr class="separator:a2904394bf025a2757bd2ab32f2caea36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b3c5fd7a70b59070dfec3be993ff80"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a55b3c5fd7a70b59070dfec3be993ff80">PrintFloatSuccinctly</a> (std::ostream &amp;os, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> f)</td></tr>
<tr class="separator:a55b3c5fd7a70b59070dfec3be993ff80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9edff78ae3a66646a203ad49ab320347"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9edff78ae3a66646a203ad49ab320347">SummarizeVector</a> (const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;vec)</td></tr>
<tr class="separator:a9edff78ae3a66646a203ad49ab320347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e044557c8e48dce3feeb79c8402ff2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a14e044557c8e48dce3feeb79c8402ff2">PrintParameterStats</a> (std::ostringstream &amp;os, const std::string &amp;name, const <a class="el" href="classkaldi_1_1CuVector.html">CuVector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;params, bool include_mean=false)</td></tr>
<tr class="memdesc:a14e044557c8e48dce3feeb79c8402ff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print to 'os' some information about the mean and standard deviation of some parameters, used in Info() functions in <a class="el" href="nnet-simple-component_8cc.html">nnet-simple-component.cc</a>.  <a href="#a14e044557c8e48dce3feeb79c8402ff2">More...</a><br/></td></tr>
<tr class="separator:a14e044557c8e48dce3feeb79c8402ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0100db7fe73351b449fa77ddc46b0c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3e0100db7fe73351b449fa77ddc46b0c">PrintParameterStats</a> (std::ostringstream &amp;os, const std::string &amp;name, const <a class="el" href="classkaldi_1_1CuMatrix.html">CuMatrix</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;params, bool include_mean=false)</td></tr>
<tr class="memdesc:a3e0100db7fe73351b449fa77ddc46b0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print to 'os' some information about the mean and standard deviation of some parameters, used in Info() functions in <a class="el" href="nnet-simple-component_8cc.html">nnet-simple-component.cc</a>.  <a href="#a3e0100db7fe73351b449fa77ddc46b0c">More...</a><br/></td></tr>
<tr class="separator:a3e0100db7fe73351b449fa77ddc46b0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a264b986f95f2cb1e5bc7032967c69a27"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a264b986f95f2cb1e5bc7032967c69a27">YzxVectorIndex</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> x, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> y, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> z, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_x_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_y_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_z_dim)</td></tr>
<tr class="separator:a264b986f95f2cb1e5bc7032967c69a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b3b76367d2844fb0f48334f1bd5691"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a25b3b76367d2844fb0f48334f1bd5691">ZyxVectorIndex</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> x, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> y, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> z, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_x_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_y_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_z_dim)</td></tr>
<tr class="separator:a25b3b76367d2844fb0f48334f1bd5691"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac37caf62dbe225383341d770509b2d55"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac37caf62dbe225383341d770509b2d55">RearrangeIndexes</a> (const std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; &amp;in, std::vector&lt; std::vector&lt; <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> &gt; &gt; *out)</td></tr>
<tr class="separator:ac37caf62dbe225383341d770509b2d55"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3855432311c60a3aba3f3ef77871a9eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3855432311c60a3aba3f3ef77871a9eb">GenerateConfigSequenceSimplest</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a3855432311c60a3aba3f3ef77871a9eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a020e04f5594e00affc4c2bf231687e65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a020e04f5594e00affc4c2bf231687e65">GenerateConfigSequenceSimpleContext</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a020e04f5594e00affc4c2bf231687e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51af5c2c6da3b32c75666de9852dc74c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a51af5c2c6da3b32c75666de9852dc74c">GenerateConfigSequenceSimple</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a51af5c2c6da3b32c75666de9852dc74c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a380783b4b5f4a192930cb5e5b00d0143"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a380783b4b5f4a192930cb5e5b00d0143">GenerateConfigSequenceRnn</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a380783b4b5f4a192930cb5e5b00d0143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a410289847ba049a50141e38f95d4a3c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a410289847ba049a50141e38f95d4a3c5">GenerateConfigSequenceRnnClockwork</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a410289847ba049a50141e38f95d4a3c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50641f28c6aecba5e74d7604b4ef650"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa50641f28c6aecba5e74d7604b4ef650">GenerateConfigSequenceLstm</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:aa50641f28c6aecba5e74d7604b4ef650"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a151e0713f1dd005df56e3c3c5bad845e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a151e0713f1dd005df56e3c3c5bad845e">GenerateConfigSequenceLstmType2</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a151e0713f1dd005df56e3c3c5bad845e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44d5ec3eab77bbbf0f6a9140db62e0bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a44d5ec3eab77bbbf0f6a9140db62e0bd">GenerateConfigSequenceCnn</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a44d5ec3eab77bbbf0f6a9140db62e0bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25050645b405ce2101222c55aaa3154f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a25050645b405ce2101222c55aaa3154f">GenerateConfigSequenceCnn2d</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a25050645b405ce2101222c55aaa3154f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3855b8fdbe81b37928ccc530d22b91a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3855b8fdbe81b37928ccc530d22b91a3">GenerateConfigSequenceDistribute</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="separator:a3855b8fdbe81b37928ccc530d22b91a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a6ec6b257d100e7dab22ce3feac226f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> &amp;opts, std::vector&lt; std::string &gt; *configs)</td></tr>
<tr class="memdesc:a9a6ec6b257d100e7dab22ce3feac226f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a sequence of at least one config files, output as strings, where the first in the sequence is the initial nnet, and the remaining ones may do things like add layers.  <a href="#a9a6ec6b257d100e7dab22ce3feac226f">More...</a><br/></td></tr>
<tr class="separator:a9a6ec6b257d100e7dab22ce3feac226f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2370ad59bd8f6a9f348193b491d88d8a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> *request, std::vector&lt; <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &gt; *inputs)</td></tr>
<tr class="memdesc:a2370ad59bd8f6a9f348193b491d88d8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes an example computation request, for testing purposes.  <a href="#a2370ad59bd8f6a9f348193b491d88d8a">More...</a><br/></td></tr>
<tr class="separator:a2370ad59bd8f6a9f348193b491d88d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb5a70eadfcda218c3833859bf7ceb27"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#afb5a70eadfcda218c3833859bf7ceb27">GenerateRandomComponentConfig</a> (std::string *component_type, std::string *config)</td></tr>
<tr class="separator:afb5a70eadfcda218c3833859bf7ceb27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dccdf514f810b334ee5baa954eb88f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3dccdf514f810b334ee5baa954eb88f8">GenerateRandomSimpleComponent</a> ()</td></tr>
<tr class="memdesc:a3dccdf514f810b334ee5baa954eb88f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates random simple component for testing.  <a href="#a3dccdf514f810b334ee5baa954eb88f8">More...</a><br/></td></tr>
<tr class="separator:a3dccdf514f810b334ee5baa954eb88f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac25c4eeb172565878e12ca4355ad9147"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac25c4eeb172565878e12ca4355ad9147">NnetParametersAreIdentical</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet1, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet2, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> threshold)</td></tr>
<tr class="memdesc:ac25c4eeb172565878e12ca4355ad9147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used for testing that the updatable parameters in two networks are the same.  <a href="#ac25c4eeb172565878e12ca4355ad9147">More...</a><br/></td></tr>
<tr class="separator:ac25c4eeb172565878e12ca4355ad9147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8263b0802f12a823d6c072b53c4ee236"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a8263b0802f12a823d6c072b53c4ee236">GenerateSimpleNnetTrainingExample</a> (<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_supervised_frames, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> right_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *example)</td></tr>
<tr class="memdesc:a8263b0802f12a823d6c072b53c4ee236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low-level function that generates an nnet training example.  <a href="#a8263b0802f12a823d6c072b53c4ee236">More...</a><br/></td></tr>
<tr class="separator:a8263b0802f12a823d6c072b53c4ee236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a54fa7479670b5b34951fdacd2c9b1d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a7a54fa7479670b5b34951fdacd2c9b1d">ExampleApproxEqual</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg1, const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg2, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> delta)</td></tr>
<tr class="memdesc:a7a54fa7479670b5b34951fdacd2c9b1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the examples are approximately equal (only intended to be used in testing).  <a href="#a7a54fa7479670b5b34951fdacd2c9b1d">More...</a><br/></td></tr>
<tr class="separator:a7a54fa7479670b5b34951fdacd2c9b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2fefdb7c8c1cc2fd30b5e102e8e979"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2f2fefdb7c8c1cc2fd30b5e102e8e979">ComputeObjectiveFunction</a> (const <a class="el" href="classkaldi_1_1GeneralMatrix.html">GeneralMatrix</a> &amp;supervision, <a class="el" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">ObjectiveType</a> objective_type, const std::string &amp;output_name, bool supply_deriv, <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> *computer, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *tot_weight, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *tot_objf)</td></tr>
<tr class="memdesc:a2f2fefdb7c8c1cc2fd30b5e102e8e979"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the objective function, and if supply_deriv = true, supplies its derivative to the <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> object.  <a href="#a2f2fefdb7c8c1cc2fd30b5e102e8e979">More...</a><br/></td></tr>
<tr class="separator:a2f2fefdb7c8c1cc2fd30b5e102e8e979"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666e24f4c79af6ec57eeaf005b00b5dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a666e24f4c79af6ec57eeaf005b00b5dd">UnitTestNnetContext</a> ()</td></tr>
<tr class="separator:a666e24f4c79af6ec57eeaf005b00b5dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0c3bad5386ea02d61e9596ba76b77eb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ab0c3bad5386ea02d61e9596ba76b77eb">NumOutputNodes</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet)</td></tr>
<tr class="memdesc:ab0c3bad5386ea02d61e9596ba76b77eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the number of output nodes of this nnet.  <a href="#ab0c3bad5386ea02d61e9596ba76b77eb">More...</a><br/></td></tr>
<tr class="separator:ab0c3bad5386ea02d61e9596ba76b77eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ce1aea23a558c0461ff1ab72f41ebb6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2ce1aea23a558c0461ff1ab72f41ebb6">NumInputNodes</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet)</td></tr>
<tr class="memdesc:a2ce1aea23a558c0461ff1ab72f41ebb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the number of input nodes of this nnet.  <a href="#a2ce1aea23a558c0461ff1ab72f41ebb6">More...</a><br/></td></tr>
<tr class="separator:a2ce1aea23a558c0461ff1ab72f41ebb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672e127a288d02b4a8e292b86aadfc04"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">IsSimpleNnet</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet)</td></tr>
<tr class="memdesc:a672e127a288d02b4a8e292b86aadfc04"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns true if the nnet has the following properties: It has one output, called "output".  <a href="#a672e127a288d02b4a8e292b86aadfc04">More...</a><br/></td></tr>
<tr class="separator:a672e127a288d02b4a8e292b86aadfc04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5683058729bb42a5e8462f9912484050"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a5683058729bb42a5e8462f9912484050">EvaluateComputationRequest</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;request, std::vector&lt; std::vector&lt; bool &gt; &gt; *is_computable)</td></tr>
<tr class="memdesc:a5683058729bb42a5e8462f9912484050"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given an nnet and a computation request, this function works out which requested outputs in the computation request are computable; it outputs this information as a vector "is_computable" indexed by the same indexes as request.outputs.  <a href="#a5683058729bb42a5e8462f9912484050">More...</a><br/></td></tr>
<tr class="separator:a5683058729bb42a5e8462f9912484050"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77531474c07694bc42e0ee70a0918e1f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a77531474c07694bc42e0ee70a0918e1f">ComputeSimpleNnetContextForShift</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_start, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> window_size, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *right_context)</td></tr>
<tr class="separator:a77531474c07694bc42e0ee70a0918e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88aa85d232ba1ad6e430f6f6dcda29c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">ComputeSimpleNnetContext</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *right_context)</td></tr>
<tr class="memdesc:a88aa85d232ba1ad6e430f6f6dcda29c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">ComputeNnetContext computes the left-context and right-context of a nnet.  <a href="#a88aa85d232ba1ad6e430f6f6dcda29c1">More...</a><br/></td></tr>
<tr class="separator:a88aa85d232ba1ad6e430f6f6dcda29c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f63e4d60600b08466b42e409dd6253d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a> (bool is_gradient, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="memdesc:a9f63e4d60600b08466b42e409dd6253d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet.  <a href="#a9f63e4d60600b08466b42e409dd6253d">More...</a><br/></td></tr>
<tr class="separator:a9f63e4d60600b08466b42e409dd6253d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca498bb15fc664236fdd7316a1b8831"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2ca498bb15fc664236fdd7316a1b8831">PerturbParams</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> stddev, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="memdesc:a2ca498bb15fc664236fdd7316a1b8831"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls PerturbParams (with the given stddev) on all updatable components of the nnet.  <a href="#a2ca498bb15fc664236fdd7316a1b8831">More...</a><br/></td></tr>
<tr class="separator:a2ca498bb15fc664236fdd7316a1b8831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa155fe7eed7775fce35d644ca845dd9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa155fe7eed7775fce35d644ca845dd9d">ComponentDotProducts</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet1, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet2, <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *dot_prod)</td></tr>
<tr class="memdesc:aa155fe7eed7775fce35d644ca845dd9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns dot products between two networks of the same structure (calls the DotProduct functions of the Updatable components and fill in the output vector).  <a href="#aa155fe7eed7775fce35d644ca845dd9d">More...</a><br/></td></tr>
<tr class="separator:aa155fe7eed7775fce35d644ca845dd9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cbf9817f25ef1302ede1ed03897394a"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a6cbf9817f25ef1302ede1ed03897394a">PrintVectorPerUpdatableComponent</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet, const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;vec)</td></tr>
<tr class="memdesc:a6cbf9817f25ef1302ede1ed03897394a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is for printing, to a string, a vector with one element per updatable component of the nnet (e.g.  <a href="#a6cbf9817f25ef1302ede1ed03897394a">More...</a><br/></td></tr>
<tr class="separator:a6cbf9817f25ef1302ede1ed03897394a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4dc8f245e845514d33d24ecf1a054406"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4dc8f245e845514d33d24ecf1a054406">DotProduct</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet1, const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet2)</td></tr>
<tr class="memdesc:a4dc8f245e845514d33d24ecf1a054406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns dot product between two networks of the same structure (calls the DotProduct functions of the Updatable components and sums up the return values).  <a href="#a4dc8f245e845514d33d24ecf1a054406">More...</a><br/></td></tr>
<tr class="separator:a4dc8f245e845514d33d24ecf1a054406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca9d819d3ed85b506db090905d4c1cea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aca9d819d3ed85b506db090905d4c1cea">ZeroComponentStats</a> (<a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="memdesc:aca9d819d3ed85b506db090905d4c1cea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Zeroes the component stats in all nonlinear components in the nnet.  <a href="#aca9d819d3ed85b506db090905d4c1cea">More...</a><br/></td></tr>
<tr class="separator:aca9d819d3ed85b506db090905d4c1cea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3936ad79463d7cfd23ba1efd54f56084"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3936ad79463d7cfd23ba1efd54f56084">SetLearningRate</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> learning_rate, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="memdesc:a3936ad79463d7cfd23ba1efd54f56084"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the learning rate for all the components in the nnet to this value.  <a href="#a3936ad79463d7cfd23ba1efd54f56084">More...</a><br/></td></tr>
<tr class="separator:a3936ad79463d7cfd23ba1efd54f56084"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62b3a3e7be6ebc2a2af34bdb347ec76a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a62b3a3e7be6ebc2a2af34bdb347ec76a">ScaleNnet</a> (<a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> scale, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *nnet)</td></tr>
<tr class="memdesc:a62b3a3e7be6ebc2a2af34bdb347ec76a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales the nnet parameters and stats by this scale.  <a href="#a62b3a3e7be6ebc2a2af34bdb347ec76a">More...</a><br/></td></tr>
<tr class="separator:a62b3a3e7be6ebc2a2af34bdb347ec76a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9680bf4ad4dd4fd305f913ff398c14e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ac9680bf4ad4dd4fd305f913ff398c14e">AddNnet</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;src, <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> alpha, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *dest)</td></tr>
<tr class="memdesc:ac9680bf4ad4dd4fd305f913ff398c14e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does *dest += alpha * src (affects nnet parameters and stored stats).  <a href="#ac9680bf4ad4dd4fd305f913ff398c14e">More...</a><br/></td></tr>
<tr class="separator:ac9680bf4ad4dd4fd305f913ff398c14e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96164bd20d5a66c3c0ca62e30250d46a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a96164bd20d5a66c3c0ca62e30250d46a">NumParameters</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;src)</td></tr>
<tr class="memdesc:a96164bd20d5a66c3c0ca62e30250d46a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total of the number of parameters in the updatable components of the nnet.  <a href="#a96164bd20d5a66c3c0ca62e30250d46a">More...</a><br/></td></tr>
<tr class="separator:a96164bd20d5a66c3c0ca62e30250d46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b9bd865f19f604b00235336168c3ee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ad9b9bd865f19f604b00235336168c3ee">VectorizeNnet</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;src, <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *params)</td></tr>
<tr class="memdesc:ad9b9bd865f19f604b00235336168c3ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the nnet parameters to *params, whose dimension must be equal to NumParameters(src).  <a href="#ad9b9bd865f19f604b00235336168c3ee">More...</a><br/></td></tr>
<tr class="separator:ad9b9bd865f19f604b00235336168c3ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aded8b769020aeb041c148c931c44a040"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aded8b769020aeb041c148c931c44a040">UnVectorizeNnet</a> (const <a class="el" href="classkaldi_1_1VectorBase.html">VectorBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;params, <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> *dest)</td></tr>
<tr class="memdesc:aded8b769020aeb041c148c931c44a040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies the parameters from params to *dest.  <a href="#aded8b769020aeb041c148c931c44a040">More...</a><br/></td></tr>
<tr class="separator:aded8b769020aeb041c148c931c44a040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25df665b8f7a712a34469e53fc875851"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a25df665b8f7a712a34469e53fc875851">NumUpdatableComponents</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;dest)</td></tr>
<tr class="memdesc:a25df665b8f7a712a34469e53fc875851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of updatable components in the nnet.  <a href="#a25df665b8f7a712a34469e53fc875851">More...</a><br/></td></tr>
<tr class="separator:a25df665b8f7a712a34469e53fc875851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81eeaabd042c236a1e0276c353a7d450"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a81eeaabd042c236a1e0276c353a7d450">NnetInfo</a> (const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;nnet)</td></tr>
<tr class="memdesc:a81eeaabd042c236a1e0276c353a7d450"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns various info about the neural net.  <a href="#a81eeaabd042c236a1e0276c353a7d450">More...</a><br/></td></tr>
<tr class="separator:a81eeaabd042c236a1e0276c353a7d450"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04165cf9403194c5a77e922f8f14d5f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a04165cf9403194c5a77e922f8f14d5f9">KlDivergence</a> (const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;p, const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;q)</td></tr>
<tr class="separator:a04165cf9403194c5a77e922f8f14d5f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a1184cd1146007ebf5403444309b69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#aa1a1184cd1146007ebf5403444309b69">PrintPriorDiagnostics</a> (const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;old_priors, const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;new_priors)</td></tr>
<tr class="separator:aa1a1184cd1146007ebf5403444309b69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad96e7aef845800f1dc88fa2ad1aade28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ad96e7aef845800f1dc88fa2ad1aade28">SetPriors</a> (const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;tmodel, const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; double &gt; &amp;transition_accs, double prior_floor, <a class="el" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html">AmNnetSimple</a> *am_nnet)</td></tr>
<tr class="separator:ad96e7aef845800f1dc88fa2ad1aade28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a270955c18c82f5de1e707ec094998283"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a270955c18c82f5de1e707ec094998283">GetCount</a> (double expected_count)</td></tr>
<tr class="separator:a270955c18c82f5de1e707ec094998283"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d106dafc23aa3dc2359adc0bb2a94bd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a9d106dafc23aa3dc2359adc0bb2a94bd">ContainsSingleExample</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *min_input_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *max_input_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *min_output_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> *max_output_t)</td></tr>
<tr class="memdesc:a9d106dafc23aa3dc2359adc0bb2a94bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the "eg" contains just a single example, meaning that all the "n" values in the indexes are zero, and the example has <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> members named both "input" and "output".  <a href="#a9d106dafc23aa3dc2359adc0bb2a94bd">More...</a><br/></td></tr>
<tr class="separator:a9d106dafc23aa3dc2359adc0bb2a94bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae235076d32848d3ce99ecd4a763e0961"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#ae235076d32848d3ce99ecd4a763e0961">FilterExample</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_input_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_input_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_output_t, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_output_t, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *eg_out)</td></tr>
<tr class="memdesc:ae235076d32848d3ce99ecd4a763e0961"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function filters the indexes (and associated feature rows) in a <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a>, removing any index/row in an <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> named "input" with t &lt; min_input_t or t &gt; max_input_t and any index/row in an <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> named "output" with t &lt; min_output_t or t &gt; max_output_t.  <a href="#ae235076d32848d3ce99ecd4a763e0961">More...</a><br/></td></tr>
<tr class="separator:ae235076d32848d3ce99ecd4a763e0961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1cb3ecc86f15353f90fab03073c77d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a3c1cb3ecc86f15353f90fab03073c77d">SelectFromExample</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg, std::string frame_str, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> right_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> frame_shift, <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *eg_out)</td></tr>
<tr class="memdesc:a3c1cb3ecc86f15353f90fab03073c77d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is responsible for possibly selecting one frame from multiple supervised frames, and reducing the left and right context as specified.  <a href="#a3c1cb3ecc86f15353f90fab03073c77d">More...</a><br/></td></tr>
<tr class="separator:a3c1cb3ecc86f15353f90fab03073c77d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f43129423ce5f470437ce2b0972715b"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a4f43129423ce5f470437ce2b0972715b">ProcessFile</a> (const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;feats, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *ivector_feats, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;targets, const std::string &amp;utt_id, bool compress, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_targets, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> right_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> frames_per_eg, <a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *num_frames_written, <a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *num_egs_written, <a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a> *example_writer)</td></tr>
<tr class="separator:a4f43129423ce5f470437ce2b0972715b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91ea84b2938a661d4b98daa3cfc51606"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a91ea84b2938a661d4b98daa3cfc51606">ProcessFile</a> (const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; &amp;feats, const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; <a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> &gt; *ivector_feats, const <a class="el" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> &amp;pdf_post, const std::string &amp;utt_id, bool compress, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_pdfs, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> right_context, <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> frames_per_eg, <a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *num_frames_written, <a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *num_egs_written, <a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a> *example_writer)</td></tr>
<tr class="separator:a91ea84b2938a661d4b98daa3cfc51606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aaea01bc54e382c47d9a0a205489a97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a2aaea01bc54e382c47d9a0a205489a97">NumOutputIndexes</a> (const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;eg)</td></tr>
<tr class="separator:a2aaea01bc54e382c47d9a0a205489a97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a661a5133ac17b002930d5eea66d9632c"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacekaldi_1_1nnet3.html#a661a5133ac17b002930d5eea66d9632c">computation_checker_warned_unused_input</a> = false</td></tr>
<tr class="memdesc:a661a5133ac17b002930d5eea66d9632c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks that we never use variables before they are allocated or after they are deallocated, and some other checks that can be done from the <a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a>.  <a href="#a661a5133ac17b002930d5eea66d9632c">More...</a><br/></td></tr>
<tr class="separator:a661a5133ac17b002930d5eea66d9632c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ac8344e7587df9247d6cc492874901d4d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::pair&lt;<a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a>&gt; <a class="el" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8h_source.html#l00085">85</a> of file <a class="el" href="nnet-common_8h_source.html">nnet-common.h</a>.</p>

</div>
</div>
<a class="anchor" id="af2246cc04a2596de3c09fad3c3513671"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classkaldi_1_1TableWriter.html">TableWriter</a>&lt;<a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a>&lt;<a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt; <a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-example_8h_source.html#l00107">107</a> of file <a class="el" href="nnet3_2nnet-example_8h_source.html">nnet-example.h</a>.</p>

</div>
</div>
<a class="anchor" id="a96242234768bbde2864c47396903675e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classkaldi_1_1RandomAccessTableReader.html">RandomAccessTableReader</a>&lt;<a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a>&lt;<a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt; <a class="el" href="namespacekaldi_1_1nnet3.html#a96242234768bbde2864c47396903675e">RandomAccessNnetExampleReader</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-example_8h_source.html#l00109">109</a> of file <a class="el" href="nnet3_2nnet-example_8h_source.html">nnet-example.h</a>.</p>

</div>
</div>
<a class="anchor" id="a206084ee5d66f24aeb8828c6bf8cb13d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classkaldi_1_1SequentialTableReader.html">SequentialTableReader</a>&lt;<a class="el" href="classkaldi_1_1KaldiObjectHolder.html">KaldiObjectHolder</a>&lt;<a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &gt; &gt; <a class="el" href="namespacekaldi_1_1nnet3.html#a206084ee5d66f24aeb8828c6bf8cb13d">SequentialNnetExampleReader</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-example_8h_source.html#l00108">108</a> of file <a class="el" href="nnet3_2nnet-example_8h_source.html">nnet-example.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="ad8aff9e545a5f496a179a16667431478"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478">AccessType</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"></a>kReadAccess</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"></a>kWriteAccess</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e"></a>kReadWriteAccess</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="nnet-analyze_8h_source.html#l00076">76</a> of file <a class="el" href="nnet-analyze_8h_source.html">nnet-analyze.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;};</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kaldi::nnet3::kReadAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00077">nnet-analyze.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kaldi::nnet3::kReadWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00079">nnet-analyze.h:79</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a21e038f5b8958e203d28bc4f18472352"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352">CommandType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CommandType is an enum that describes the category of the command used in the <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a>. </p>
<p>We declare it outside that class because it's so frequently used and we got tired of typing <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a>:: everywhere. We document the commands here.</p>
<ul>
<li>kAllocMatrixUndefined: Allocate a matrix. arg1 = index of matrix.</li>
<li>kAllocMatrixZeroed: Allocate and zero a matrix. arg1 = index of matrix.</li>
<li>kDeallocMatrix: Deallocate a matrix. arg1 = index of matrix.</li>
<li>kAllocMatrixFromOther: initialize matrix indexed arg1 using memory from matrix indexed arg2 (using shallow swap).</li>
<li>kAllocMatrixFromOtherZeroed: initialize matrix indexed arg1 using memory from matrix indexed arg2 (using shallow swap), then zero the matrix we just allocated.</li>
<li>kPropagate: Forward computation of neural net, see <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada" title="Propagate function. ">Component::Propagate()</a><ul>
<li>arg1 is is component-index in neural net</li>
<li>arg2 is index into <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> (0 if NULL; always 0 for simple Components)</li>
<li>arg3 is sub-matrix index of input</li>
<li>arg4 is sub-matrix index of output</li>
</ul>
</li>
<li>kStoreStats: Call <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a6f53af63ed7691d05d0b715bf27c4b0e" title="This function may store stats on average activation values, and for some component types...">Component::StoreStats()</a> (used for computing diagnostics such as average activations; called after Propagate).<ul>
<li>arg1 is component-index in neural net</li>
<li>arg2 is sub-matrix index of the output of the Propagate function</li>
</ul>
</li>
<li>kBackprop: Do the back-propagation operation, see <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8" title="Backprop function; depending on which of the arguments &#39;to_update&#39; and &#39;in_deriv&#39; are non-NULL...">Component::Backprop()</a><ul>
<li>arg1 is index of component in neural net</li>
<li>arg2 is index into <a class="el" href="classkaldi_1_1nnet3_1_1ComponentPrecomputedIndexes.html">ComponentPrecomputedIndexes</a> (0 if NULL; always 0 for simple Components)</li>
<li>arg3 is submatrix-index of input value (input to Propagate()); 0 if unused</li>
<li>arg4 is submatrix-index of output value (output of Propagate()); 0 if unused</li>
<li>arg5 is submatrix-index of output derivative</li>
<li>arg6 is submatrix-index of input derivative; 0 if unused.</li>
</ul>
</li>
<li>kBackpropNoModelUpdate: as kBackprop, but does not set the 'to_update' argument to the Backprop call, even if the model is updatable, so it skips the model-update phase of backprop.</li>
<li>kMatrixCopy: Copy contents of sub-matrix arg2 to sub-matrix arg1</li>
<li>kMatrixAdd: Add contents of sub-matrix arg2 to sub-matrix arg1</li>
<li>kCopyRows: call <a class="el" href="classkaldi_1_1CuMatrixBase.html#a9ceafbe7da9b4ec36999757f8befc48a">CopyRows()</a> on sub-matrix arg1 with sub-matrix arg2 and indexes[arg3] as arguments.</li>
<li>kAddRows: call <a class="el" href="classkaldi_1_1CuMatrixBase.html#a80c13771ad314fdd939dc9d4f71d4502">AddRows()</a> on sub-matrix arg1 with sub-matrix arg2 and indexes[arg3] as arguments.</li>
<li>kAddRowsMulti, kAddToRowsMulti, kCopyRowsMulti, kCopyToRowsMulti: Call the corresponding function in class <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>.<ul>
<li>arg1 is sub-matrix index of *this matrix in operation</li>
<li>arg2 is index into "indexes_multi", of which each pair is (sub-matrix index, row index) (or (-1,-1) for NULL marker), which is turned into a vector of BaseFloat* (pointers to matrix rows) before being given as the argument to the function.</li>
</ul>
</li>
<li>kAddRowRanges: call <a class="el" href="classkaldi_1_1CuMatrixBase.html#a9a2eba3e93cc7d1fac4f10aaf6e7db1a">AddRowRanges()</a> on sub-matrix arg1, with arg2 as source sub-matrix, and indexes given indexes_ranges[arg3].</li>
<li>kNoOperation: does nothing (sometimes useful during optimization)</li>
<li>kNoOperationMarker: does nothing, but used to mark end of forward commands. </li>
</ul>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"></a>kAllocMatrixUndefined</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"></a>kAllocMatrixZeroed</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"></a>kDeallocMatrix</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"></a>kAllocMatrixFromOther</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"></a>kAllocMatrixFromOtherZeroed</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69"></a>kPropagate</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb"></a>kStoreStats</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83"></a>kBackprop</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241"></a>kBackpropNoModelUpdate</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"></a>kMatrixCopy</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"></a>kMatrixAdd</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"></a>kCopyRows</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"></a>kAddRows</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"></a>kCopyRowsMulti</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"></a>kCopyToRowsMulti</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"></a>kAddRowsMulti</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"></a>kAddToRowsMulti</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"></a>kAddRowRanges</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"></a>kNoOperation</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4"></a>kNoOperationMarker</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="nnet-computation_8h_source.html#l00201">201</a> of file <a class="el" href="nnet-computation_8h_source.html">nnet-computation.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                 {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kPropagate</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kStoreStats</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kBackpropNoModelUpdate</a>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kNoOperationMarker</a> };</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kaldi::nnet3::kMatrixCopy</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kaldi::nnet3::kMatrixAdd</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kaldi::nnet3::kNoOperationMarker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kaldi::nnet3::kBackpropNoModelUpdate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kaldi::nnet3::kBackprop</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kaldi::nnet3::kPropagate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kaldi::nnet3::kStoreStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kaldi::nnet3::kAddRowRanges</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a36da016976f88292c0d31653a20cbfe3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3">ComponentProperties</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127"></a>kSimpleComponent</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"></a>kUpdatableComponent</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778"></a>kLinearInInput</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0"></a>kLinearInParameters</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d"></a>kPropagateInPlace</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"></a>kPropagateAdds</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67"></a>kReordersIndexes</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"></a>kBackpropAdds</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"></a>kBackpropNeedsInput</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841"></a>kBackpropNeedsOutput</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df"></a>kBackpropInPlace</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827"></a>kStoresStats</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="nnet-component-itf_8h_source.html#l00037">37</a> of file <a class="el" href="nnet-component-itf_8h_source.html">nnet-component-itf.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                         {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127">kSimpleComponent</a> = 0x001,  <span class="comment">// true if number of rows of input equals number of rows</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                             <span class="comment">// of output and this component doesn&#39;t care about the indexes</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                             <span class="comment">// (i.e. it maps each row of input to each row of output without</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                             <span class="comment">// regard to the index values).  Will normally be true.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a> = 0x002,  <span class="comment">// true if the component has parameters that can</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                                <span class="comment">// be updated.  Components that return this flag</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                <span class="comment">// must be dynamic_castable to type</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                <span class="comment">// UpdatableComponent (but components of type</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                <span class="comment">// UpdatableComponent do not have to return this</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                <span class="comment">// flag, e.g.  if this instance is not really</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                                <span class="comment">// updatable).</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778">kLinearInInput</a> = 0x004,    <span class="comment">// true if the component&#39;s output is always a</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                             <span class="comment">// linear function of its input, i.e. alpha times</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                             <span class="comment">// input gives you alpha times output.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0">kLinearInParameters</a> = 0x008, <span class="comment">// true if an updatable component&#39;s output is always a</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                               <span class="comment">// linear function of its parameters, i.e. alpha times</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                               <span class="comment">// parameters gives you alpha times output.  This is true</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                               <span class="comment">// for all updatable components we envisage.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d">kPropagateInPlace</a> = 0x010,  <span class="comment">// true if we can do the propagate operation in-place</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                              <span class="comment">// (input and output matrices are the same).</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                              <span class="comment">// Note: if doing backprop, you&#39;d also need to check</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                              <span class="comment">// that the kBackpropNeedsInput property is not true.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a> = 0x020,  <span class="comment">// true if the Propagate function adds to, rather</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                           <span class="comment">// than setting, its output.  The Component chooses</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                           <span class="comment">// whether to add or set, and the calling code has to</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                           <span class="comment">// accommodate it.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kReordersIndexes</a> = 0x040,  <span class="comment">// true if the ReorderIndexes function might reorder</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                             <span class="comment">// the indexes (otherwise we can skip calling it).</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                             <span class="comment">// Must not be set for simple components.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a> = 0x080,   <span class="comment">// true if the Backprop function adds to, rather than</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                           <span class="comment">// setting, the &quot;in_deriv&quot; output.  The Component chooses</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                           <span class="comment">// whether to add or set, and the calling code has to</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                           <span class="comment">// accommodate it.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a> = 0x100,  <span class="comment">// true if backprop operation needs access to</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                <span class="comment">// forward-pass input.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kBackpropNeedsOutput</a> = 0x200,  <span class="comment">// true if backprop operation needs access to</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                 <span class="comment">// forward-pass output (e.g. true for Sigmoid).</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df">kBackpropInPlace</a> = 0x400,   <span class="comment">// true if we can do the backprop operation in-place</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                             <span class="comment">// (input and output matrices may be the same).</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kStoresStats</a> = 0x800       <span class="comment">// true if the StoreStats operation stores</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                             <span class="comment">// statistics e.g. on average node activations and</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                             <span class="comment">// derivatives of the nonlinearity, (as it does for</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                             <span class="comment">// Tanh, Sigmoid, ReLU and Softmax).</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;};</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0">kaldi::nnet3::kLinearInParameters</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00052">nnet-component-itf.h:52</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kaldi::nnet3::kBackpropNeedsOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00073">nnet-component-itf.h:73</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d">kaldi::nnet3::kPropagateInPlace</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00056">nnet-component-itf.h:56</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5530b2f8f01fac9e6e73fd29a65d4127">kaldi::nnet3::kSimpleComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00038">nnet-component-itf.h:38</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3affff5abfeafd5643bee15f1daafe6827">kaldi::nnet3::kStoresStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00077">nnet-component-itf.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kaldi::nnet3::kPropagateAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00060">nnet-component-itf.h:60</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df">kaldi::nnet3::kBackpropInPlace</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00075">nnet-component-itf.h:75</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a6c12dbc12f9d02024f66b4b0d160ee67">kaldi::nnet3::kReordersIndexes</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00064">nnet-component-itf.h:64</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kaldi::nnet3::kBackpropAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00067">nnet-component-itf.h:67</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778">kaldi::nnet3::kLinearInInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00049">nnet-component-itf.h:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acac9cbaeea226ed297804c012dc12b16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16">NodeType</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c"></a>kInput</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b"></a>kDescriptor</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"></a>kComponent</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db"></a>kDimRange</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="acac9cbaeea226ed297804c012dc12b16a634ee767a8e90ff4d56e140459cca31f"></a>kNone</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="_2nnet-nnet_8h_source.html#l00055">55</a> of file <a class="el" href="_2nnet-nnet_8h_source.html">nnet-nnet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{ <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kInput</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kDimRange</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a634ee767a8e90ff4d56e140459cca31f">kNone</a> };</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a634ee767a8e90ff4d56e140459cca31f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a634ee767a8e90ff4d56e140459cca31f">kaldi::nnet3::kNone</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kaldi::nnet3::kComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kaldi::nnet3::kInput</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kaldi::nnet3::kDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kaldi::nnet3::kDimRange</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a45660f9909187129a953fa05e664576e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576e">ObjectiveType</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This enum is for a kind of annotation we associate with output nodes of the network; it's for the convenience of calling code so that if the objective is one of a few standard types, we can compute it directly and know how to interpret the supervision labels. </p>
<p>However, the core of the framework never makes use of the objective types, other than making them available to calling code which then supplies the derivatives.</p>
<ul>
<li>Objective type kLinear is intended for Neural nets where the final component is a <a class="el" href="classkaldi_1_1nnet3_1_1LogSoftmaxComponent.html">LogSoftmaxComponent</a>, so the log-prob (negative cross-entropy) objective is just a linear function of the input.</li>
<li>Objective type kQuadratic is used to mean the objective function f(x, y) = -0.5 (x-y).(x-y), which is to be maximized, as in the kLinear case. </li>
</ul>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d"></a>kLinear</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2"></a>kQuadratic</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="_2nnet-nnet_8h_source.html#l00052">52</a> of file <a class="el" href="_2nnet-nnet_8h_source.html">nnet-nnet.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{ <a class="code" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d">kLinear</a>, <a class="code" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2">kQuadratic</a> };</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d">kaldi::nnet3::kLinear</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00052">nnet-nnet.h:52</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2">kaldi::nnet3::kQuadratic</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00052">nnet-nnet.h:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac9680bf4ad4dd4fd305f913ff398c14e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AddNnet </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Does *dest += alpha * src (affects nnet parameters and stored stats). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00279">279</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-component-itf_8h_source.html#l00328">Component::Add()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-average_8cc_source.html#l00057">main()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00047">NnetTrainer::Train()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                           {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keywordflow">if</span> (src.NumComponents() != dest-&gt;NumComponents())</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Trying to add incompatible nnets.&quot;</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; src.NumComponents(); c++) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">const</span> Component *src_comp = src.GetComponent(c);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    Component *dest_comp = dest-&gt;GetComponent(c);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    dest_comp-&gt;Add(alpha, *src_comp);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adbaeb0c690e96bd285e79a287882f13e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AppendCindexes </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Index &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Cindex &gt; *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends to 'out' the pairs (node, indexes[0]), (node, indexes[1]), ... </p>

<p>Definition at line <a class="el" href="nnet-compile_8cc_source.html#l00966">966</a> of file <a class="el" href="nnet-compile_8cc_source.html">nnet-compile.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00938">Compiler::OutputDebugInfo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                            {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordtype">size_t</span> indexes_size = indexes.size();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">if</span> (indexes_size &gt; out-&gt;size())</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    out-&gt;reserve(out-&gt;size() + indexes_size);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indexes_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    out-&gt;push_back(<a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a>(node, indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac8344e7587df9247d6cc492874901d4d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">kaldi::nnet3::Cindex</a></div><div class="ttdeci">std::pair&lt; int32, Index &gt; Cindex</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00085">nnet-common.h:85</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b9cf952746776c000ad16fcc9a9f990"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::AssertGraphEqual </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00026">26</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00148">UnitTestComputeGraphTranspose()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00160">UnitTestFindSccs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00172">UnitTestMakeSccGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                                                  {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">if</span> (graph1.size() != graph2.size()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; graph1.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (graph1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size() != graph2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; graph1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); ++<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      <span class="keywordflow">if</span> (graph1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] != graph2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  }</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a60bde0a269254ed7c2471823ba362d75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::AssertVectorEqual </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00038">38</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00187">UnitTestComputeTopSortOrder()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                                                     {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (vec1.size() != vec2.size()) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vec1.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keywordflow">if</span> (vec1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != vec2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2cf1ba5597d79505ed5fd378338740bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::BuildTestGraph </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>graph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00047">47</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00148">UnitTestComputeGraphTranspose()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00160">UnitTestFindSccs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00172">UnitTestMakeSccGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                         {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(graph != NULL);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  graph-&gt;clear();</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  graph-&gt;resize(8);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// We create the following graph for testing.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// 0 --&gt; 4</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// 1 --&gt; 0</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// 2 --&gt; 1 3</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="comment">// 3 --&gt; 2</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// 4 --&gt; 1</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// 5 --&gt; 1 4 6</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="comment">// 6 --&gt; 5</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">// 7 --&gt; 7 3 6</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  std::vector&lt;int32&gt; tmp;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  tmp.resize(1); tmp[0] = 4; (*graph)[0] = tmp;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  tmp.resize(1); tmp[0] = 0; (*graph)[1] = tmp;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  tmp.resize(2); tmp[0] = 1; tmp[1] = 3; (*graph)[2] = tmp;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  tmp.resize(1); tmp[0] = 2; (*graph)[3] = tmp;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  tmp.resize(1); tmp[0] = 1; (*graph)[4] = tmp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  tmp.resize(3); tmp[0] = 1; tmp[1] = 4; tmp[2] = 6; (*graph)[5] = tmp;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  tmp.resize(1); tmp[0] = 5; (*graph)[6] = tmp;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  tmp.resize(3); tmp[0] = 7; tmp[1] = 3; tmp[2] = 6; (*graph)[7] = tmp;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0d0ace1de8245a113abc6674f184a19f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::BuildTestGraphTranspose </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>graph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00072">72</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00148">UnitTestComputeGraphTranspose()</a>.</p>
<div class="fragment"><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                                                  {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(graph != NULL);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  graph-&gt;clear();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  graph-&gt;resize(8);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// We create the following graph for testing.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// 0 --&gt; 1</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// 1 --&gt; 2 4 5</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// 2 --&gt; 3</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// 3 --&gt; 2 7</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">// 4 --&gt; 0 5</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// 5 --&gt; 6</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// 6 --&gt; 5 7</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// 7 --&gt; 7</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  std::vector&lt;int32&gt; tmp;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  tmp.resize(1); tmp[0] = 1; (*graph)[0] = tmp;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  tmp.resize(3); tmp[0] = 2; tmp[1] = 4; tmp[2] = 5; (*graph)[1] = tmp;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  tmp.resize(1); tmp[0] = 3; (*graph)[2] = tmp;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  tmp.resize(2); tmp[0] = 2; tmp[1] = 7; (*graph)[3] = tmp;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  tmp.resize(2); tmp[0] = 0; tmp[1] = 5; (*graph)[4] = tmp;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  tmp.resize(1); tmp[0] = 6; (*graph)[5] = tmp;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  tmp.resize(2); tmp[0] = 5; tmp[1] = 7; (*graph)[6] = tmp;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  tmp.resize(1); tmp[0] = 7; (*graph)[7] = tmp;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa97309456d46852962866b097697c6b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::BuildTestSccGraph </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>scc_graph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00114">114</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00187">UnitTestComputeTopSortOrder()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00172">UnitTestMakeSccGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                                                {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(scc_graph != NULL);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  scc_graph-&gt;clear();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  scc_graph-&gt;resize(4);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// We create the following SCC graph for testing.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// 0 --&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// 1 --&gt; 0</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// 2 --&gt; 0</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// 3 --&gt; 1 2</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  std::vector&lt;int32&gt; tmp;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  tmp.resize(0); (*scc_graph)[0] = tmp;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  tmp.resize(1); tmp[0] = 0; (*scc_graph)[1] = tmp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  tmp.resize(1); tmp[0] = 0; (*scc_graph)[2] = tmp;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  tmp.resize(2); tmp[0] = 1; tmp[1] = 2; (*scc_graph)[3] = tmp;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0081c3d0993ad39f10df0eb4857188f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::BuildTestSccs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sccs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00097">97</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00160">UnitTestFindSccs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00172">UnitTestMakeSccGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                       {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sccs != NULL);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  sccs-&gt;clear();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  sccs-&gt;resize(4);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// We create the following SCCs for testing.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="comment">// 0 --&gt; 1 4 0</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// 1 --&gt; 3 2</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// 2 --&gt; 6 5</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">// 3 --&gt; 7</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  std::vector&lt;int32&gt; tmp;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  tmp.resize(3); tmp[0] = 1; tmp[1] = 4; tmp[2] = 0; (*sccs)[0] = tmp;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  tmp.resize(2); tmp[0] = 3; tmp[1] = 2; (*sccs)[1] = tmp;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  tmp.resize(2); tmp[0] = 6; tmp[1] = 5; (*sccs)[2] = tmp;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  tmp.resize(1); tmp[0] = 7; (*sccs)[3] = tmp;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a8af0bfaf3239fc5f740444edc92874"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::BuildTestTopSortOrder </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>node_to_order</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00131">131</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00187">UnitTestComputeTopSortOrder()</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                            {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_to_order != NULL);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  node_to_order-&gt;clear();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  node_to_order-&gt;resize(4);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// The topological sorting order of the above SCC graph is as follows (from</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// our particular algorithm):</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// 0 --&gt; 3</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <span class="comment">// 1 --&gt; 2</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="comment">// 2 --&gt; 1</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="comment">// 3 --&gt; 0</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  (*node_to_order)[0] = 3;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  (*node_to_order)[1] = 2;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  (*node_to_order)[2] = 1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  (*node_to_order)[3] = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28797c2cdd8990a88b55e122b2b2931a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CheckComputation </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>check_rewrite</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is a convenience interface for class <a class="el" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a>. </p>
<p>Call it with check_rewrite = true only if the optimization is pre-optimization. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00975">975</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                          {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  CheckComputationOptions opts;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  opts.check_rewrite = check_rewrite;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  ComputationChecker checker(opts, nnet, computation);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  checker.Check();</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa155fe7eed7775fce35d644ca845dd9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComponentDotProducts </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorBase&lt; BaseFloat &gt; *&#160;</td>
          <td class="paramname"><em>dot_prod</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns dot products between two networks of the same structure (calls the DotProduct functions of the Updatable components and fill in the output vector). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00186">186</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00065">VectorBase&lt; Real &gt;::Data()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-show-progress_8cc_source.html#l00027">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                           {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet1.NumComponents() == nnet2.NumComponents());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> updatable_c = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet1.NumComponents(); c++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> Component *comp1 = nnet1.GetComponent(c),</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    *comp2 = nnet2.GetComponent(c);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">if</span> (comp1-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">const</span> UpdatableComponent</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;          *u_comp1 = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>UpdatableComponent*<span class="keyword">&gt;</span>(comp1),</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;          *u_comp2 = dynamic_cast&lt;const UpdatableComponent*&gt;(comp2);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(u_comp1 != NULL &amp;&amp; u_comp2 != NULL);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      dot_prod-&gt;<a class="code" href="classkaldi_1_1VectorBase.html#abda573212fad06ec61fd3f428a0992c7">Data</a>()[updatable_c] = u_comp1-&gt;DotProduct(*u_comp2);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      updatable_c++;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(updatable_c == dot_prod-&gt;<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_abda573212fad06ec61fd3f428a0992c7"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#abda573212fad06ec61fd3f428a0992c7">kaldi::VectorBase::Data</a></div><div class="ttdeci">Real * Data()</div><div class="ttdoc">Returns a pointer to the start of the vector&#39;s data. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00065">kaldi-vector.h:65</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ba032c2d77e71f7c64ea5a165cc1dcf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeAccuracy </td>
          <td>(</td>
          <td class="paramtype">const GeneralMatrix &amp;&#160;</td>
          <td class="paramname"><em>supervision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CuMatrixBase&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>nnet_output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat *&#160;</td>
          <td class="paramname"><em>tot_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat *&#160;</td>
          <td class="paramname"><em>tot_accuracy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the frame accuracy for this minibatch. </p>
<p>It interprets the supervision information in "supervision" as labels or soft labels; it picks the maximum element in each row and treats that as the label for purposes of computing the accuracy (in situations where you would care about the accuracy, there will normally be just one nonzero label). The hypothesized labels are computed by taking the neural net output (supplied as a <a class="el" href="classkaldi_1_1CuMatrix.html" title="This class represents a matrix that&#39;s stored on the GPU if we have one, and in memory if not...">CuMatrix</a>), and finding the maximum element in each row. See also the function ComputeObjectiveFunction, declared in <a class="el" href="nnet-training_8h.html">nnet-training.h</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">supervision</td><td>The supervision information (no elements may be negative); only the maximum in each row matters (although we expect that usually there will be just one nonzero element in each row); and the sum of each row is interpreted as a weighting factor (although we expect that this sum will usually be one).</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nnet_output</td><td>The neural net output must have the same dimensions as the supervision. Only the index of the maximum value in each row matters. Ties will be broken in an unspecified way. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tot_weight</td><td>The sum of the values in the supervision matrix </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tot_accuracy</td><td>The total accuracy, equal to the sum over all row indexes r such that the maximum column index of row r of supervision and nnet_output is the same, of the sum of the r'th row of supervision (i.e. the row's weight). </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nnet-diagnostics_8cc_source.html#l00156">156</a> of file <a class="el" href="nnet-diagnostics_8cc_source.html">nnet-diagnostics.cc</a>.</p>

<p>References <a class="el" href="cu-matrix_8cc_source.html#l01508">CuMatrixBase&lt; Real &gt;::FindRowMaxId()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00767">GeneralMatrix::GetFullMatrix()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00722">GeneralMatrix::GetMatrix()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00749">GeneralMatrix::GetSparseMatrix()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="sparse-matrix_8h_source.html#l00218">kaldi::kCompressedMatrix</a>, <a class="el" href="sparse-matrix_8h_source.html#l00217">kaldi::kFullMatrix</a>, <a class="el" href="sparse-matrix_8h_source.html#l00219">kaldi::kSparseMatrix</a>, <a class="el" href="sparse-matrix_8cc_source.html#l01056">SparseVector&lt; Real &gt;::Max()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00566">VectorBase&lt; Real &gt;::Max()</a>, <a class="el" href="cu-matrix_8h_source.html#l00196">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00697">GeneralMatrix::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00195">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00687">GeneralMatrix::NumRows()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00516">SparseMatrix&lt; Real &gt;::Row()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00047">SparseVector&lt; Real &gt;::Sum()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="sparse-matrix_8cc_source.html#l00678">GeneralMatrix::Type()</a>.</p>

<p>Referenced by <a class="el" href="nnet-diagnostics_8cc_source.html#l00078">NnetComputeProb::ProcessOutputs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                                  {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_rows = nnet_output.<a class="code" href="classkaldi_1_1CuMatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>(),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      num_cols = nnet_output.<a class="code" href="classkaldi_1_1CuMatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(supervision.NumRows() == num_rows &amp;&amp;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;               supervision.NumCols() == num_cols);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  CuArray&lt;int32&gt; best_index(num_rows);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  nnet_output.<a class="code" href="classkaldi_1_1CuMatrixBase.html#aa0cd92c9777266acc3db5dfb401db53a">FindRowMaxId</a>(&amp;best_index);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  std::vector&lt;int32&gt; best_index_cpu;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">// wasteful copy, but doesn&#39;t dominate.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  best_index.CopyToVec(&amp;best_index_cpu);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">double</span> tot_weight = 0.0,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      tot_accuracy = 0.0;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="comment">// note: we expect that in most cases where this code is called,</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// supervision.Type() will be kSparseMatrix.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">switch</span> (supervision.Type()) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kCompressedMatrix</a>: {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      Matrix&lt;BaseFloat&gt; mat;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      supervision.GetMatrix(&amp;mat);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = 0; r &lt; num_rows; r++) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        SubVector&lt;BaseFloat&gt; vec(mat, r);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> row_sum = vec.Sum();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_sum &gt;= 0.0);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> best_index;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        vec.Max(&amp;best_index);  <span class="comment">// discard max value.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        tot_weight += row_sum;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (best_index == best_index_cpu[r])</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          tot_accuracy += row_sum;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kFullMatrix</a>: {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">const</span> Matrix&lt;BaseFloat&gt; &amp;mat = supervision.GetFullMatrix();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = 0; r &lt; num_rows; r++) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        SubVector&lt;BaseFloat&gt; vec(mat, r);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> row_sum = vec.Sum();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(row_sum &gt;= 0.0);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> best_index;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        vec.Max(&amp;best_index);  <span class="comment">// discard max value.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        tot_weight += row_sum;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (best_index == best_index_cpu[r])</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          tot_accuracy += row_sum;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kSparseMatrix</a>: {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keyword">const</span> SparseMatrix&lt;BaseFloat&gt; &amp;smat = supervision.GetSparseMatrix();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = 0; r &lt; num_rows; r++) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keyword">const</span> SparseVector&lt;BaseFloat&gt; &amp;row = smat.Row(r);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> row_sum = row.Sum();</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> best_index;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        row.Max(&amp;best_index);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(best_index &lt; num_cols);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        tot_weight += row_sum;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (best_index == best_index_cpu[r])</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          tot_accuracy += row_sum;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">default</span>: <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad general-matrix type.&quot;</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  *tot_weight_out = tot_weight;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  *tot_accuracy_out = tot_accuracy;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;}</div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kaldi::kFullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00217">sparse-matrix.h:217</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_aa0cd92c9777266acc3db5dfb401db53a"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#aa0cd92c9777266acc3db5dfb401db53a">kaldi::CuMatrixBase::FindRowMaxId</a></div><div class="ttdeci">void FindRowMaxId(CuArray&lt; int32 &gt; *id) const </div><div class="ttdoc">Find the id of the maximal element for each row. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l01508">cu-matrix.cc:1508</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00196">cu-matrix.h:196</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kaldi::kSparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00219">sparse-matrix.h:219</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kaldi::kCompressedMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00218">sparse-matrix.h:218</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00195">cu-matrix.h:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa02a576b6e9aa0977f3eb52471742b85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeCommandAttributes </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationVariables &amp;&#160;</td>
          <td class="paramname"><em>vars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; CommandAttributes &gt; *&#160;</td>
          <td class="paramname"><em>attributes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00267">267</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8cc_source.html#l00156">ComputationVariables::AppendVariablesForMatrix()</a>, <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00244">NnetComputation::Command::arg3</a>, <a class="el" href="nnet-computation_8h_source.html#l00245">NnetComputation::Command::arg4</a>, <a class="el" href="nnet-computation_8h_source.html#l00246">NnetComputation::Command::arg5</a>, <a class="el" href="nnet-computation_8h_source.html#l00247">NnetComputation::Command::arg6</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="arpa-file-parser-test_8cc_source.html#l00065">count</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00066">CommandAttributes::has_side_effects</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00284">NnetComputation::indexes</a>, <a class="el" href="nnet-computation_8h_source.html#l00289">NnetComputation::indexes_multi</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00247">IndexesMultiToSubmatrixIndexes()</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kAddRowRanges</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kAddRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddToRowsMulti</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackprop</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00067">kBackpropAdds</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackpropNoModelUpdate</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kCopyRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyToRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixAdd</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixCopy</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperation</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperationMarker</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kPropagate</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00060">kPropagateAdds</a>, <a class="el" href="nnet-analyze_8h_source.html#l00077">kReadAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00079">kReadWriteAccess</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kStoreStats</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="nnet-analyze_8h_source.html#l00078">kWriteAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00060">CommandAttributes::matrices_read</a>, <a class="el" href="nnet-analyze_8h_source.html#l00062">CommandAttributes::matrices_written</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00168">ComputationVariables::RecordAccessForSubmatrix()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00055">CommandAttributes::submatrices_read</a>, <a class="el" href="nnet-analyze_8h_source.html#l00057">CommandAttributes::submatrices_written</a>, <a class="el" href="nnet-analyze_8h_source.html#l00050">CommandAttributes::variables_read</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00052">CommandAttributes::variables_written</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00028">MoveSizingCommands()</a>, and <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00028">NnetComputer::NnetComputer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                              {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands = computation.commands.size();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  attributes-&gt;clear();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  attributes-&gt;resize(num_commands);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> command_index = 0; command_index &lt; num_commands; command_index++) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">const</span> NnetComputation::Command &amp;c = computation.commands[command_index];</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    CommandAttributes &amp;attr = (*attributes)[command_index];</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">switch</span> (c.command_type) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>:</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>:</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        vars.AppendVariablesForMatrix(c.arg1, &amp;attr.variables_written);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        attr.matrices_written.push_back(c.arg1);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>: <span class="comment">// nothing is written here.</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>: <span class="comment">// ditto.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>: <span class="comment">// ditto.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kPropagate</a>:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        vars.RecordAccessForSubmatrix(c.arg3, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (nnet.GetComponent(c.arg1)-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a>)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;          vars.RecordAccessForSubmatrix(c.arg4, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          vars.RecordAccessForSubmatrix(c.arg4, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kStoreStats</a>:</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a>:</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kBackpropNoModelUpdate</a>:</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        vars.RecordAccessForSubmatrix(c.arg3, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        vars.RecordAccessForSubmatrix(c.arg4, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        vars.RecordAccessForSubmatrix(c.arg5, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span> (nnet.GetComponent(c.arg1)-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          vars.RecordAccessForSubmatrix(c.arg6, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;          vars.RecordAccessForSubmatrix(c.arg6, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (c.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a> &amp;&amp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            nnet.GetComponent(c.arg1)-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;          attr.has_side_effects = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>:</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>:</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>: {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;indexes = computation.indexes[c.arg3];</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// if there are -1&#39;s in &quot;indexes&quot;, then the result of the operation</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="comment">// will depend on the initial value of the matrix, so it&#39;s</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="comment">// a &quot;rw&quot; operation, not a &quot;write&quot; operation.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">std::count</a>(indexes.begin(), indexes.end(), -1) &gt; 0)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;          vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>: {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        std::vector&lt;int32&gt; submatrix_indexes;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a79ed08ad0dcf1b82a23e4e3c96967502">IndexesMultiToSubmatrixIndexes</a>(computation.indexes_multi[c.arg2],</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                       &amp;submatrix_indexes);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; submatrix_indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          vars.RecordAccessForSubmatrix(submatrix_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                        <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>: {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        std::vector&lt;int32&gt; submatrix_indexes;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a79ed08ad0dcf1b82a23e4e3c96967502">IndexesMultiToSubmatrixIndexes</a>(computation.indexes_multi[c.arg2],</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                       &amp;submatrix_indexes);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// note: the CopyRows command assigns zero in cases where</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// there is no source for some row</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; submatrix_indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          vars.RecordAccessForSubmatrix(submatrix_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                        <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>:</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>: {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// if the submatrixes we&#39;re writing to (in kCopyToRowsMulti) had all</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// rows covered, it would be a pure write operation.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        std::vector&lt;int32&gt; submatrix_indexes;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a79ed08ad0dcf1b82a23e4e3c96967502">IndexesMultiToSubmatrixIndexes</a>(computation.indexes_multi[c.arg2],</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                                       &amp;submatrix_indexes);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; submatrix_indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          vars.RecordAccessForSubmatrix(submatrix_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>,</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                        &amp;attr);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>: {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        vars.RecordAccessForSubmatrix(c.arg1, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        vars.RecordAccessForSubmatrix(c.arg2, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>, &amp;attr);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>:</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kNoOperationMarker</a>:</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unknown command type.&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.variables_read);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.variables_written);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.submatrices_read);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.submatrices_written);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.matrices_read);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;attr.matrices_written);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kaldi::nnet3::kMatrixCopy</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kaldi::nnet3::kReadAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00077">nnet-analyze.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a79ed08ad0dcf1b82a23e4e3c96967502"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a79ed08ad0dcf1b82a23e4e3c96967502">kaldi::nnet3::IndexesMultiToSubmatrixIndexes</a></div><div class="ttdeci">static void IndexesMultiToSubmatrixIndexes(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;indexes_multi, std::vector&lt; int32 &gt; *submatrix_indexes)</div><div class="ttdoc">given a vector of pairs from computation.indexes_multi_indexes containing paris (submatrix-index, row-index), this function outputs to &quot;submatrix_indexes&quot; all (unique) submatrix indexes that appear; and it outputs to &quot;contains_null_marker&quot; true if the pair (-1, -1) appears anywhere in indexes_multi, and false otherwise. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l00247">nnet-analyze.cc:247</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kaldi::nnet3::kMatrixAdd</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kaldi::nnet3::kNoOperationMarker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_a951345011b75d2e8d9bfc18ca63510d2"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a></div><div class="ttdeci">const size_t count</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00065">arpa-file-parser-test.cc:65</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kaldi::nnet3::kReadWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00079">nnet-analyze.h:79</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kaldi::nnet3::kPropagateAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00060">nnet-component-itf.h:60</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kaldi::nnet3::kBackpropNoModelUpdate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kaldi::nnet3::kBackprop</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kaldi::nnet3::kBackpropAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00067">nnet-component-itf.h:67</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kaldi::nnet3::kPropagate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kaldi::nnet3::kStoreStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kaldi::nnet3::kAddRowRanges</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4874b04bb051028a1b6cb08cff2d1994"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ComputeCommandPairs </td>
          <td>(</td>
          <td class="paramtype">const std::pair&lt; std::vector&lt; int32 &gt;, std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>pairs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00158">158</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00186">kaldi::CopyVectorToSet()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, and <a class="el" href="kaldi-error_8h_source.html#l00156">KALDI_PARANOID_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00185">RemoveUnnecessaryAllocation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                             {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  std::vector&lt;int32&gt; d_list = lists.first;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  std::set&lt;int32&gt; a_set;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="namespacekaldi.html#a3197e8bd3abedae8ba7ea37c38b08225">CopyVectorToSet</a>(lists.second, &amp;a_set);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  std::vector&lt;int32&gt;::reverse_iterator iter = d_list.rbegin(),</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      end = d_list.rend();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <span class="comment">// from the latest to the earliest deallocation command...</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = *iter;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    std::set&lt;int32&gt;::iterator a_iter = a_set.upper_bound(d);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// a_iter is an iterator to the first element a of the set &#39;a_set&#39; such</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// that a &gt; d, or a_set.end() if no such element exists.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">if</span> (a_iter == a_set.end())</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// we will output no pair for this d.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> a = *a_iter;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a>(a &gt; d);  <span class="comment">// or code error</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    a_set.erase(a_iter);  <span class="comment">// remove this a from &#39;a_set&#39; so it doesn&#39;t get used</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                          <span class="comment">// twice</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    pairs-&gt;push_back(std::pair&lt;int32,int32&gt;(d, a));</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3197e8bd3abedae8ba7ea37c38b08225"><div class="ttname"><a href="namespacekaldi.html#a3197e8bd3abedae8ba7ea37c38b08225">kaldi::CopyVectorToSet</a></div><div class="ttdeci">void CopyVectorToSet(const std::vector&lt; A &gt; &amp;v, std::set&lt; A &gt; *s)</div><div class="ttdoc">Copies the contents of a vector to a set. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00186">stl-utils.h:186</a></div></div>
<div class="ttc" id="group__error__group_html_ga2c852c1a15c7f195ec8021de2ab119a0"><div class="ttname"><a href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a></div><div class="ttdeci">#define KALDI_PARANOID_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00156">kaldi-error.h:156</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a9dab13d6db9f89fb2693d37b08ebe1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::ComputeComputationGraph </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComputationGraph *&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01058">1058</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-computation-graph_8cc_source.html#l00927">kaldi::nnet3::computation_graph::AddInputToGraph()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l00904">kaldi::nnet3::computation_graph::AddOutputToGraph()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00087">NetworkNode::component_index</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00063">ComputationGraph::dependencies</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00084">NetworkNode::descriptor</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l00028">ComputationGraph::GetCindexId()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00068">Descriptor::GetDependencies()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00125">Component::GetInputIndexes()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00135">Nnet::GetNode()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00055">ComputationGraph::is_input</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kDescriptor</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kDimRange</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kInput</a>, <a class="el" href="nnet-computation_8h_source.html#l00119">ComputationRequest::misc_info</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00090">NetworkNode::node_index</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00082">NetworkNode::node_type</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a59b26a99fb5f5a9a7dfdcf5b50bf86c7">NetworkNode::u</a>.</p>
<div class="fragment"><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                                      {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="keyword">using namespace </span>computation_graph;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">// make sure graph is empty at the start.</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(graph-&gt;cindexes.empty());</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#ade326e1f7b5aed9de211eb7327ecde6b">AddInputToGraph</a>(request, nnet, graph);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#abcf4ea50e642bf894660a735b0fa3f5c">AddOutputToGraph</a>(request, nnet, graph);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <span class="comment">// queue of cindex_ids to process.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  std::vector&lt;int32&gt; queue(graph-&gt;cindexes.size());</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; graph-&gt;cindexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    queue.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  <span class="keywordflow">while</span> (!queue.empty()) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cindex_id = queue.back();</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    queue.pop_back();</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">if</span> (static_cast&lt;int32&gt;(graph-&gt;dependencies.size()) &lt;= cindex_id)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      graph-&gt;dependencies.resize(cindex_id + 1);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordflow">if</span> (graph-&gt;is_input[cindex_id])</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a> cindex = graph-&gt;cindexes[cindex_id];</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">// find the dependencies of this cindex.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = cindex.first;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keyword">const</span> Index &amp;index = cindex.second;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="keyword">const</span> NetworkNode &amp;node = nnet.GetNode(n);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    std::vector&lt;Cindex&gt; input_cindexes;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// the following switch statement sets up &quot;input_cindexes&quot;.</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">switch</span> (node.node_type) {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a>: {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="comment">// desc describes how this node obtains its input from other nodes.</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        <span class="keyword">const</span> Descriptor &amp;desc = node.descriptor;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        desc.GetDependencies(index, &amp;input_cindexes);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>: {</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = node.u.component_index;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keyword">const</span> Component *component = nnet.GetComponent(c);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        std::vector&lt;Index&gt; input_indexes;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        component-&gt;GetInputIndexes(request.misc_info, index,</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                   &amp;input_indexes);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">// each Component node should be preceded by a node that describes its</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="comment">// input, of type kDescriptor</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet.GetNode(n-1).node_type ==</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                     <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        input_cindexes.resize(input_indexes.size());</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input_indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;          input_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first = n - 1;  <span class="comment">// preceding node.</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;          input_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second = input_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kDimRange</a>: {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        input_cindexes.resize(1);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        input_cindexes[0] = <a class="code" href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">Cindex</a>(node.u.node_index, index);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kInput</a>: <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="comment">// for kInput, you should have hit the &quot;continue&quot; statement above.</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid node type&quot;</span>;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    std::vector&lt;int32&gt; &amp;this_dep = graph-&gt;dependencies[cindex_id];</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_dependencies = input_cindexes.size();</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    this_dep.resize(num_dependencies);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_dependencies; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      <span class="keywordtype">bool</span> is_input = <span class="keyword">false</span>, is_new;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dep_cindex_id = graph-&gt;GetCindexId(input_cindexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                                               is_input, &amp;is_new);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      this_dep[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = dep_cindex_id;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keywordflow">if</span> (is_new)</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        queue.push_back(dep_cindex_id);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    }</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="comment">// remove duplicates of dependencies.</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;this_dep);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  }</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1computation__graph_html_ade326e1f7b5aed9de211eb7327ecde6b"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1computation__graph.html#ade326e1f7b5aed9de211eb7327ecde6b">kaldi::nnet3::computation_graph::AddInputToGraph</a></div><div class="ttdeci">void AddInputToGraph(const ComputationRequest &amp;request, const Nnet &amp;nnet, ComputationGraph *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00927">nnet-computation-graph.cc:927</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac8344e7587df9247d6cc492874901d4d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac8344e7587df9247d6cc492874901d4d">kaldi::nnet3::Cindex</a></div><div class="ttdeci">std::pair&lt; int32, Index &gt; Cindex</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00085">nnet-common.h:85</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1computation__graph_html_abcf4ea50e642bf894660a735b0fa3f5c"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1computation__graph.html#abcf4ea50e642bf894660a735b0fa3f5c">kaldi::nnet3::computation_graph::AddOutputToGraph</a></div><div class="ttdeci">void AddOutputToGraph(const ComputationRequest &amp;request, const Nnet &amp;nnet, ComputationGraph *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00904">nnet-computation-graph.cc:904</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kaldi::nnet3::kComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kaldi::nnet3::kInput</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kaldi::nnet3::kDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kaldi::nnet3::kDimRange</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2fb066857e6cd5f7839f8403ac734c11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeComputationPhases </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationGraph &amp;&#160;</td>
          <td class="paramname"><em>computation_graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>phases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the phases in which we can compute each cindex in the computation; the cindexes will be grouped into phases. </p>
<p>This is a prelude to computing the steps of the computation (ComputeComputationSteps), and gives a coarser ordering than the steps. All input cindexes go to phase 0, and in general a phase contains all cindexes not in previous phases that can be computed immediately from cindexes in previous phases. It is an error if some cindexes cannot be computed (we assume that you have called PruneComputationGraph before this function), and it is an error if the computation graph contains cycles. Each element of *phases will be sorted numerically. </p>

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01252">1252</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01162">ComputeComputationPhasesForEpoch()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l00955">kaldi::nnet3::computation_graph::ComputeDependenciesSubset()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01001">kaldi::nnet3::computation_graph::ComputeEpochInfo()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00063">ComputeGraphTranspose()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01144">SumVectorSizes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                          {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="keyword">using namespace </span>computation_graph;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_cindex_ids = graph.cindexes.size();</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  std::vector&lt;int32&gt; cindex_id_to_epoch;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  std::vector&lt;std::vector&lt;int32 &gt; &gt; epochs;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  std::vector&lt;bool&gt; epoch_is_trivial;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#a3767518aebb1ba1be4b3d1a8a63c28c6">ComputeEpochInfo</a>(nnet, graph, &amp;cindex_id_to_epoch,</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                        &amp;epochs, &amp;epoch_is_trivial);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a49f9f182fa8dc05d6672c4b7fcad737f">SumVectorSizes</a>(epochs) == num_cindex_ids);</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// dependencies_subset contains just the subset of dependencies</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// of each cindex_id, that have the same epoch index as</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// cindex_id itself.  This will be used to correctly order</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// cindexes that have a certain epoch index (i.e. they</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// likely come from the same strongly connected component of</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// the graph of nodes).</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; dependencies_subset;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1computation__graph.html#afe3fe7f2d1635667eb3376768bacc8bf">ComputeDependenciesSubset</a>(graph, cindex_id_to_epoch,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                            &amp;dependencies_subset);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="comment">// depend_on_subset is a subset of the normal &quot;depend_on&quot; list (i.e. a list of</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;  <span class="comment">// all cindex_ids that depend on the current cindex_id), limited to just those</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="comment">// cindex_ids that have the same epoch index.</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; depend_on_subset;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">ComputeGraphTranspose</a>(dependencies_subset, &amp;depend_on_subset);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_epoch_indexes = epoch_is_trivial.size();</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <span class="comment">// &quot;phase_index&quot; is used inside ComputeComputationPhasesForEpoch.</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  std::vector&lt;int32&gt; phase_index(num_cindex_ids, -1);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">if</span> (phases) {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    phases-&gt;clear();</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    phases-&gt;reserve(50);  <span class="comment">// minimize unnecessary copies.  50 is very</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                            <span class="comment">// arbitrarily chosen.</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> epoch = 0;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;       epoch &lt; num_epoch_indexes;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;       epoch++)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aa057ac8d68abd82e005a2e0df6644f22">ComputeComputationPhasesForEpoch</a>(nnet, graph,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                     dependencies_subset,</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                     depend_on_subset,</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                     epochs[epoch],</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                     epoch_is_trivial[epoch],</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                                     &amp;phase_index, phases);</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">// make sure everything was computable.  If the next assert fails it&#39;s likely</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="comment">// a bug in this function or in PruneComputataionGraph.</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a49f9f182fa8dc05d6672c4b7fcad737f">SumVectorSizes</a>(*phases) == num_cindex_ids);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1computation__graph_html_afe3fe7f2d1635667eb3376768bacc8bf"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1computation__graph.html#afe3fe7f2d1635667eb3376768bacc8bf">kaldi::nnet3::computation_graph::ComputeDependenciesSubset</a></div><div class="ttdeci">static void ComputeDependenciesSubset(const ComputationGraph &amp;graph, const std::vector&lt; int32 &gt; &amp;cindex_id_to_phase, std::vector&lt; std::vector&lt; int32 &gt; &gt; *dependencies_subset)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l00955">nnet-computation-graph.cc:955</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac4457943f315ab2e900b1f81606404f8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">kaldi::nnet3::ComputeGraphTranspose</a></div><div class="ttdeci">void ComputeGraphTranspose(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph_transpose)</div><div class="ttdoc">Outputs a graph in which the order of arcs is reversed. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00063">nnet-graph.cc:63</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a49f9f182fa8dc05d6672c4b7fcad737f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a49f9f182fa8dc05d6672c4b7fcad737f">kaldi::nnet3::SumVectorSizes</a></div><div class="ttdeci">static int32 SumVectorSizes(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01144">nnet-computation-graph.cc:1144</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa057ac8d68abd82e005a2e0df6644f22"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa057ac8d68abd82e005a2e0df6644f22">kaldi::nnet3::ComputeComputationPhasesForEpoch</a></div><div class="ttdeci">static void ComputeComputationPhasesForEpoch(const Nnet &amp;nnet, const ComputationGraph &amp;graph, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;dependencies_subset, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;depend_on_subset, const std::vector&lt; int32 &gt; &amp;this_epoch, bool epoch_is_trivial, std::vector&lt; int32 &gt; *phase_index, std::vector&lt; std::vector&lt; int32 &gt; &gt; *phases)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01162">nnet-computation-graph.cc:1162</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1computation__graph_html_a3767518aebb1ba1be4b3d1a8a63c28c6"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1computation__graph.html#a3767518aebb1ba1be4b3d1a8a63c28c6">kaldi::nnet3::computation_graph::ComputeEpochInfo</a></div><div class="ttdeci">static void ComputeEpochInfo(const Nnet &amp;nnet, const ComputationGraph &amp;graph, std::vector&lt; int32 &gt; *cindex_id_to_epoch, std::vector&lt; std::vector&lt; int32 &gt; &gt; *epochs, std::vector&lt; bool &gt; *epoch_is_trivial)</div><div class="ttdoc">This function computes certain information about &quot;epochs&quot; of cindex_ids. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01001">nnet-computation-graph.cc:1001</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa057ac8d68abd82e005a2e0df6644f22"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ComputeComputationPhasesForEpoch </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationGraph &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>dependencies_subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>depend_on_subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>this_epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>epoch_is_trivial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>phase_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>phases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01162">1162</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01252">ComputeComputationPhases()</a>.</p>
<div class="fragment"><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                                          {</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  std::vector&lt;int32&gt; this_phase, next_phase_candidates;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordflow">if</span> (this_epoch.empty())</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (epoch_is_trivial) { <span class="comment">// an optimization</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    this_phase = this_epoch;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">//  Start out with all elements of this epoch that have no</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// dependencies within the same epoch</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    std::vector&lt;int32&gt;::const_iterator iter = this_epoch.begin(),</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        end = this_epoch.end();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cindex_id = *iter;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">if</span> (dependencies_subset[cindex_id].empty())</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        this_phase.push_back(cindex_id);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    }</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="comment">// if the next assert fails, the graph at the level of cindex_ids is not acyclic.</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!this_phase.empty() &amp;&amp;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;               <span class="stringliteral">&quot;Trying to process computation with cycles&quot;</span>);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordflow">while</span> (!this_phase.empty()) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    phases-&gt;push_back(this_phase);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="comment">// The next if-statement is an optimization: if for this epoch index</span></div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="comment">// there is just one node, there will be just one order-index for this</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">// epoch, so we can skip the rest of this loop.  Note: if</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="comment">// epoch == 0, even if there is just one node, cindex_ids from</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="comment">// multiple nodes may be put here because of the rule that cindex_ids which</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="comment">// are inputs always get epoch 0.  But it&#39;s still true that they</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="comment">// will have no dependencies, so we can still skip the code below.</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">if</span> (epoch_is_trivial)</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_phase_index = phases-&gt;size() - 1;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="comment">// next_phases_candidates is a list of cindexes that we should check</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// whether they are computable now, because one of the things they depend</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// on just became computable.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    next_phase_candidates.clear();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = this_phase.size();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = this_phase[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];  <span class="comment">// c is a cindex_id with phase cur_phase_index.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      (*phase_index)[c] = cur_phase_index;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      std::vector&lt;int32&gt;::const_iterator iter = depend_on_subset[c].begin(),</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          end = depend_on_subset[c].end();</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = *iter;  <span class="comment">// cindex_id that depends on c.</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        next_phase_candidates.push_back(d);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;next_phase_candidates);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    this_phase.clear();</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// now check the candidates that might be in the next phase, and put any</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// members that we are currently able to compute into &quot;this_phase&quot;.</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    std::vector&lt;int32&gt;::const_iterator iter = next_phase_candidates.begin(),</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        end = next_phase_candidates.end();</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = *iter;</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      std::vector&lt;int32&gt;::const_iterator</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;          dep_iter = dependencies_subset[c].begin(),</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          dep_end = dependencies_subset[c].end();</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">for</span> (; dep_iter != dep_end; ++dep_iter) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = *dep_iter;  <span class="comment">// d is cindex_id that c depends on.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">if</span> ((*phase_index)[d] &lt; 0)  <span class="comment">// we can&#39;t compute c yet as something we depend</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;          <span class="keywordflow">break</span>;              <span class="comment">// on is not yet computed.</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="keywordflow">if</span> (dep_iter == dep_end) {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="comment">// we reached the end and did not break -&gt; all dependencies satisfied</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        this_phase.push_back(c);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (!next_phase_candidates.empty() &amp;&amp; this_phase.empty())  {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="comment">// this should have been caught earlier so likely a code error rather than</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="comment">// a problem with user input.</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Possibly some cindexes were not reachable (code error?)&quot;</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a83e0cb29ecc50f5275d89e4962156ea4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeComputationSteps </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComputationGraph *&#160;</td>
          <td class="paramname"><em>computation_graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function arranges the cindex_ids of the computation into a sequence of lists called "steps", which will correspond roughly to the commands in the compiled computation. </p>
<p>The steps are finer than phases. (See <a class="el" href="dnn3_code_compilation.html#dnn3_compile_steps">Organizing the computation into steps</a> for more info). To summarize the properties that these steps will satisfy:</p>
<ul>
<li>All cindex_ids within a given step correspond to the same node in the graph</li>
<li>All dependencies of cindex_ids within a given step have been computed in earlier steps.</li>
</ul>
<p>There are also some extra, more obscure properties that the sequence of steps must satisfy:</p>
<ul>
<li>Any input or output in the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> must be in one step, with the Indexes in the same order as specified in the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>. (Note: inputs can be for nodes of type kComponent as well as kInput).</li>
<li>If a step corresponds to a node of type kComponent (and does not correspond to an input in the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>), then the immediately preceding step must correspond to a node of type kDescriptor, and the sequence of Indexes in the two steps must be identical.</li>
<li>If a step corresponds to a node of type kDimRange, then there must be another step corresponding to the source node, with exactly the same Indexes appearing in the same order. (This lets us use a sub-matrix for the kDimRange node).</li>
</ul>
<p>The reason why <a class="el" href="namespacekaldi_1_1nnet3_1_1computation__graph.html">computation_graph</a> is not provided as a const argument is that in order to ensure the final property we may have to add a few new cindex_ids. </p>

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01763">1763</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-computation-graph_8cc_source.html#l01525">kaldi::nnet3::compute_computation_steps::AddComponentInputSteps()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01467">kaldi::nnet3::compute_computation_steps::AddComponentSteps()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01620">kaldi::nnet3::compute_computation_steps::AddDimRangeSteps()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01372">kaldi::nnet3::compute_computation_steps::AddInputSteps()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l01410">kaldi::nnet3::compute_computation_steps::AddOutputSteps()</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00046">ComputationGraph::cindexes</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l01706">kaldi::nnet3::compute_computation_steps::ReorderIndexes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                                         {</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="keyword">using namespace </span>compute_computation_steps;</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  steps-&gt;clear();</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a7097241ff38efdc19a12ff8f710a8d47">AddInputSteps</a>(nnet, request, *graph, steps);</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    std::vector&lt;std::vector&lt;int32&gt; &gt; component_steps;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a0042e072cd4a3244fe595534db8c9392">AddComponentSteps</a>(nnet, *graph, phases, &amp;component_steps);</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a99ec798a701dc7e5d115267aa2fdb173">AddComponentInputSteps</a>(*graph, &amp;component_steps, steps);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  <span class="comment">// output steps don&#39;t get reordered so we do the reordering before adding</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="comment">// them.</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a528aef1b8eedf012c43f002c56204599">ReorderIndexes</a>(nnet, request, *graph, steps);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#ab64bfddc852cc4143782cb7ba1432cd3">AddDimRangeSteps</a>(nnet, graph, steps);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a5e98138365913329d832053de3c95f1f">AddOutputSteps</a>(nnet, request, *graph, steps);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_cindexes = 0;</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; steps-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    num_cindexes += (*steps)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// The next line has &quot;&gt;=&quot; not &quot;==&quot; because it is possible (although unlikely</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="comment">// in normal setups) that some cindexes of Descriptors which are at the inputs</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="comment">// of Components,</span></div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_cindexes &gt;= graph-&gt;cindexes.size());</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_ab64bfddc852cc4143782cb7ba1432cd3"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#ab64bfddc852cc4143782cb7ba1432cd3">kaldi::nnet3::compute_computation_steps::AddDimRangeSteps</a></div><div class="ttdeci">static void AddDimRangeSteps(const Nnet &amp;nnet, ComputationGraph *graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *all_steps)</div><div class="ttdoc">This function inserts into &quot;all_steps&quot;, which at this point should contain all but the output steps...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01620">nnet-computation-graph.cc:1620</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_a0042e072cd4a3244fe595534db8c9392"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a0042e072cd4a3244fe595534db8c9392">kaldi::nnet3::compute_computation_steps::AddComponentSteps</a></div><div class="ttdeci">static void AddComponentSteps(const Nnet &amp;nnet, const ComputationGraph &amp;graph, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phases, std::vector&lt; std::vector&lt; int32 &gt; &gt; *component_steps)</div><div class="ttdoc">Outputs into component_steps, steps corresponding to all Cindexes that correspond to Component nodes ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01467">nnet-computation-graph.cc:1467</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_a5e98138365913329d832053de3c95f1f"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a5e98138365913329d832053de3c95f1f">kaldi::nnet3::compute_computation_steps::AddOutputSteps</a></div><div class="ttdeci">void AddOutputSteps(const Nnet &amp;nnet, const ComputationRequest &amp;request, const ComputationGraph &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *steps)</div><div class="ttdoc">Adds a &quot;step&quot; for each of the outputs in the ComputationRequest. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01410">nnet-computation-graph.cc:1410</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_a7097241ff38efdc19a12ff8f710a8d47"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a7097241ff38efdc19a12ff8f710a8d47">kaldi::nnet3::compute_computation_steps::AddInputSteps</a></div><div class="ttdeci">int32 AddInputSteps(const Nnet &amp;nnet, const ComputationRequest &amp;request, const ComputationGraph &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *steps)</div><div class="ttdoc">Adds a &quot;step&quot; for each of the inputs in the ComputationRequest. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01372">nnet-computation-graph.cc:1372</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_a99ec798a701dc7e5d115267aa2fdb173"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a99ec798a701dc7e5d115267aa2fdb173">kaldi::nnet3::compute_computation_steps::AddComponentInputSteps</a></div><div class="ttdeci">static void AddComponentInputSteps(const ComputationGraph &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *component_steps, std::vector&lt; std::vector&lt; int32 &gt; &gt; *all_steps)</div><div class="ttdoc">You call this function after calling AddInputSteps to add steps for inputs to &quot;all_steps&quot;, then calling AddComponentSteps to output steps for components to &quot;component_steps&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01525">nnet-computation-graph.cc:1525</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_1_1compute__computation__steps_html_a528aef1b8eedf012c43f002c56204599"><div class="ttname"><a href="namespacekaldi_1_1nnet3_1_1compute__computation__steps.html#a528aef1b8eedf012c43f002c56204599">kaldi::nnet3::compute_computation_steps::ReorderIndexes</a></div><div class="ttdeci">void ReorderIndexes(const Nnet &amp;nnet, const ComputationRequest &amp;request, const ComputationGraph &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *steps)</div><div class="ttdoc">This function would not be necessary if we had not added the ReorderIndexes function to class Compone...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation-graph_8cc_source.html#l01706">nnet-computation-graph.cc:1706</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2370ad59bd8f6a9f348193b491d88d8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeExampleComputationRequestSimple </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComputationRequest *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *&#160;</td>
          <td class="paramname"><em>inputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes an example computation request, for testing purposes. </p>
<p>The "Simple" in the name means that it currently only supports neural nets that satisfy IsSimple(nnet) (defined in nnet-utils.h). If there are 2 inputs, the "input" will be first, followed by "ivector". </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00778">778</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-utils_8cc_source.html#l00129">ComputeSimpleNnetContext()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00635">Nnet::InputDim()</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="nnet-utils_8cc_source.html#l00042">IsSimpleNnet()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8h_source.html#l00110">ComputationRequest::need_model_derivative</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="nnet-computation_8h_source.html#l00115">ComputationRequest::store_component_stats</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze-test_8cc_source.html#l00039">UnitTestNnetAnalyze()</a>, <a class="el" href="nnet-compile-test_8cc_source.html#l00028">UnitTestNnetCompile()</a>, <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00040">UnitTestNnetCompute()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00258">UnitTestNnetInputDerivatives()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>, and <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                           {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">IsSimpleNnet</a>(nnet));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, right_context;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">ComputeSimpleNnetContext</a>(nnet, &amp;left_context, &amp;right_context);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_output_frames = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      output_start_frame = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      num_examples = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      output_end_frame = output_start_frame + num_output_frames,</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      input_start_frame = output_start_frame - left_context - (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3),</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      input_end_frame = output_end_frame + right_context + (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3),</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      n_offset = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordtype">bool</span> need_deriv = (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  request-&gt;inputs.clear();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  request-&gt;outputs.clear();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  inputs-&gt;clear();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  std::vector&lt;Index&gt; input_indexes, ivector_indexes, output_indexes;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = n_offset; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; n_offset + num_examples; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = input_start_frame; t &lt; input_end_frame; t++)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      input_indexes.push_back(Index(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>, t, 0));</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = output_start_frame; t &lt; output_end_frame; t++)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      output_indexes.push_back(Index(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>, t, 0));</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    ivector_indexes.push_back(Index(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>, 0, 0));</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  request-&gt;outputs.push_back(IoSpecification(<span class="stringliteral">&quot;output&quot;</span>, output_indexes));</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  <span class="keywordflow">if</span> (need_deriv || (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0))</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    request-&gt;outputs.back().has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  request-&gt;inputs.push_back(IoSpecification(<span class="stringliteral">&quot;input&quot;</span>, input_indexes));</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="keywordflow">if</span> (need_deriv &amp;&amp; (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0))</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    request-&gt;inputs.back().has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = nnet.InputDim(<span class="stringliteral">&quot;input&quot;</span>);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(input_dim &gt; 0);</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  inputs-&gt;push_back(</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      Matrix&lt;BaseFloat&gt;((input_end_frame - input_start_frame) * num_examples,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                        input_dim));</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  inputs-&gt;back().SetRandn();</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ivector_dim = nnet.InputDim(<span class="stringliteral">&quot;ivector&quot;</span>);  <span class="comment">// may not exist.</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="keywordflow">if</span> (ivector_dim != -1) {</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    request-&gt;inputs.push_back(IoSpecification(<span class="stringliteral">&quot;ivector&quot;</span>, ivector_indexes));</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    inputs-&gt;push_back(Matrix&lt;BaseFloat&gt;(num_examples, ivector_dim));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    inputs-&gt;back().SetRandn();</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">if</span> (need_deriv &amp;&amp; (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0))</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      request-&gt;inputs.back().has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    request-&gt;need_model_derivative = need_deriv;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0)</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    request-&gt;store_component_stats = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a88aa85d232ba1ad6e430f6f6dcda29c1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">kaldi::nnet3::ComputeSimpleNnetContext</a></div><div class="ttdeci">void ComputeSimpleNnetContext(const Nnet &amp;nnet, int32 *left_context, int32 *right_context)</div><div class="ttdoc">ComputeNnetContext computes the left-context and right-context of a nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00129">nnet-utils.cc:129</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a672e127a288d02b4a8e292b86aadfc04"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">kaldi::nnet3::IsSimpleNnet</a></div><div class="ttdeci">bool IsSimpleNnet(const Nnet &amp;nnet)</div><div class="ttdoc">This function returns true if the nnet has the following properties: It has one output, called &quot;output&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00042">nnet-utils.cc:42</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac4457943f315ab2e900b1f81606404f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeGraphTranspose </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>graph_transpose</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Outputs a graph in which the order of arcs is reversed. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00063">63</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01252">ComputeComputationPhases()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00148">UnitTestComputeGraphTranspose()</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                                                          {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = graph.size();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  graph_transpose-&gt;clear();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  graph_transpose-&gt;resize(size);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; size; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;nodes = graph[<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>];</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    std::vector&lt;int32&gt;::const_iterator iter = nodes.begin(), end = nodes.end();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dest = *iter;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      (*graph_transpose)[dest].push_back(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f107eabc73f1b70436ed117375778c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeMatrixAccesses </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationVariables &amp;&#160;</td>
          <td class="paramname"><em>variables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; CommandAttributes &gt; &amp;&#160;</td>
          <td class="paramname"><em>command_attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; MatrixAccesses &gt; *&#160;</td>
          <td class="paramname"><em>matrix_accesses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function organizes information in the <a class="el" href="structkaldi_1_1nnet3_1_1CommandAttributes.html">CommandAttributes</a> in a way that is convenient to access per matrix. </p>
<p>See struct <a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a> for the output format; the output "matrix_accesses" is indexed by the matrix index (the same index as computation.matrices). </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00436">436</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-computation_8h_source.html#l00300">NnetComputation::input_output_info</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00107">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>, <a class="el" href="nnet-analyze_8h_source.html#l00077">kReadAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00079">kReadWriteAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00078">kWriteAccess</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, <a class="el" href="nnet-analyze_8h_source.html#l00060">CommandAttributes::matrices_read</a>, <a class="el" href="nnet-analyze_8h_source.html#l00062">CommandAttributes::matrices_written</a>, and <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, and <a class="el" href="nnet-optimize_8cc_source.html#l00028">MoveSizingCommands()</a>.</p>
<div class="fragment"><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                                                {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = computation.matrices.size(),</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      num_commands = command_attributes.size();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  matrix_accesses-&gt;clear();</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  matrix_accesses-&gt;resize(num_matrices);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_commands; c++) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keyword">const</span> CommandAttributes &amp;attr = command_attributes[c];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(attr.matrices_read));</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(attr.matrices_written));</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    std::vector&lt;int32&gt; all_matrices;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    all_matrices.reserve(attr.matrices_read.size() +</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                          attr.matrices_written.size());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    all_matrices.insert(all_matrices.end(), attr.matrices_read.begin(),</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                         attr.matrices_read.end());</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    all_matrices.insert(all_matrices.end(), attr.matrices_written.begin(),</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                         attr.matrices_written.end());</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;all_matrices);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    std::vector&lt;int32&gt;::const_iterator iter = all_matrices.begin(),</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        end = all_matrices.end();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> matrix_index = *iter;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordtype">bool</span> is_read = std::binary_search(attr.matrices_read.begin(),</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                                        attr.matrices_read.end(),</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                        matrix_index),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;          is_written = (!is_read ? <span class="keyword">true</span> :</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        std::binary_search(attr.matrices_written.begin(),</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                           attr.matrices_written.end(),</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                           matrix_index));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">if</span> (is_read &amp;&amp; is_written) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        (*matrix_accesses)[matrix_index].accesses.push_back(</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>));</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_read) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        (*matrix_accesses)[matrix_index].accesses.push_back(</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>));</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        (*matrix_accesses)[matrix_index].accesses.push_back(</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>));</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// Now set up allocate_command and deallocate_command.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keyword">const</span> NnetComputation::Command &amp;command = computation.commands[c];</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> matrix_index = command.arg1,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        matrix_index2 = command.arg2;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">switch</span> (command.command_type) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>:</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>:</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">if</span> ((*matrix_accesses)[matrix_index].allocate_command != -1)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Matrix &quot;</span> &lt;&lt; matrix_index &lt;&lt; <span class="stringliteral">&quot; initialized twice.&quot;</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        (*matrix_accesses)[matrix_index].allocate_command = c;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>:</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>:</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">if</span> ((*matrix_accesses)[matrix_index].allocate_command != -1)</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Matrix &quot;</span> &lt;&lt; matrix_index &lt;&lt; <span class="stringliteral">&quot; initialized twice.&quot;</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        (*matrix_accesses)[matrix_index].allocate_command = c;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <span class="keywordflow">if</span> ((*matrix_accesses)[matrix_index2].deallocate_command != -1)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Matrix &quot;</span> &lt;&lt; matrix_index &lt;&lt; <span class="stringliteral">&quot; destroyed twice.&quot;</span>;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        (*matrix_accesses)[matrix_index2].deallocate_command = c;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>:</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordflow">if</span> ((*matrix_accesses)[matrix_index].deallocate_command != -1)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Matrix &quot;</span> &lt;&lt; matrix_index &lt;&lt; <span class="stringliteral">&quot; destroyed twice.&quot;</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        (*matrix_accesses)[matrix_index].deallocate_command = c;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        ;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// now set up the is_input and is_output fields.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  unordered_map&lt;int32, std::pair&lt;int32, int32&gt; &gt;::const_iterator</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      iter = computation.input_output_info.begin(),</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      end = computation.input_output_info.end();</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node_index = iter-&gt;first,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        value_matrix_index = iter-&gt;second.first,</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        deriv_matrix_index = iter-&gt;second.second;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(value_matrix_index &gt; 0 &amp;&amp; value_matrix_index &lt; num_matrices);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (nnet.IsInputNode(node_index)) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="comment">// the assert checks for repeats</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!(*matrix_accesses)[value_matrix_index].is_input);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      (*matrix_accesses)[value_matrix_index].is_input = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">if</span> (deriv_matrix_index != 0) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">// the derivatives, if requested, would be outputs of the computation,</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// even though the node is an input node.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!(*matrix_accesses)[deriv_matrix_index].is_output);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        (*matrix_accesses)[deriv_matrix_index].is_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet.IsOutputNode(node_index));</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="comment">// the assert checks for repeats</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!(*matrix_accesses)[value_matrix_index].is_output);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      (*matrix_accesses)[value_matrix_index].is_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span> (deriv_matrix_index != 0) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">// the derivatives, if provided, would be inputs to the computation,</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="comment">// even though the node is an output node.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!(*matrix_accesses)[deriv_matrix_index].is_input);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        (*matrix_accesses)[deriv_matrix_index].is_input = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kaldi::nnet3::kReadAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00077">nnet-analyze.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kaldi::nnet3::kReadWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00079">nnet-analyze.h:79</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7468a5d6108f9a2f81b9b79b82866354"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeMatrixToSubmatrix </td>
          <td>(</td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>mat_to_submat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes a vector 'mat_to_submat', indexed by matrix index, such that (*mat_to_submat)[m] is a list of all the submatrix indexes that refer to matrix m. </p>
<p>Note, (*mat_to_submat)[0] will be the empty vector. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00985">985</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, and <a class="el" href="nnet-computation_8h_source.html#l00273">NnetComputation::submatrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00693">VariableMergingOptimizer::VariableMergingOptimizer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                                 {</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = computation.matrices.size(),</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      num_submatrices = computation.submatrices.size();</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  mat_to_submat-&gt;clear();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  mat_to_submat-&gt;resize(num_matrices);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submatrix_index = 1;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;       submatrix_index &lt; num_submatrices;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;       submatrix_index++) {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> matrix_index = computation.submatrices[submatrix_index].matrix_index;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(matrix_index &gt; 0 &amp;&amp; matrix_index &lt; num_matrices);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    (*mat_to_submat)[matrix_index].push_back(submatrix_index);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a12fab71b9fb0d11733b8d9e452da5eda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::ComputeMinAndMaxTimes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>min_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>max_t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-derivative-test_8cc_source.html#l00031">31</a> of file <a class="el" href="nnet-derivative-test_8cc_source.html">nnet-derivative-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>.</p>

<p>Referenced by <a class="el" href="nnet-derivative-test_8cc_source.html#l00046">SetDerivTimesOptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                         {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!indexes.empty());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  *min_t = indexes[0].t;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  *max_t = *min_t;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 1; n &lt; static_cast&lt;int32&gt;(indexes.size()); <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    *min_t = std::min(*min_t, indexes[<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>].t);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    *max_t = std::max(*max_t, indexes[<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>].t);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a380175b61aef188f214827ad6c2faca2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeNnetComputationEpochs </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>node_to_epoch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the order in which we need to compute each node in the graph, where each node-index n maps to an order-index t = 0, 1, ... </p>
<p>that says when we should compute it. Nodes that are part of a strongly connected component (SCC) will all be computed at the same time, but any two nodes that are not part of an SCC will have different order-index, and these order-indexes will be such that a node computed at a larger order-index may depend on a node computed at a smaller order-index, but not vice versa.</p>
<p>Internally it calls NnetToDirectedGraph, FindSccs, MakeSccGraph and ComputeTopSortOrder. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00265">265</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-graph_8cc_source.html#l00063">ComputeGraphTranspose()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00223">ComputeTopSortOrder()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00156">FindSccs()</a>, <a class="el" href="kaldi-error_8h_source.html#l00060">kaldi::GetVerboseLevel()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="nnet-graph_8cc_source.html#l00164">MakeSccGraph()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00030">NnetToDirectedGraph()</a>, and <a class="el" href="nnet-graph_8cc_source.html#l00248">PrintGraphToString()</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01001">kaldi::nnet3::computation_graph::ComputeEpochInfo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                                   {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_to_epoch != NULL);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; graph;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a679a6d66a5e4a3993124bc35597dd06b">NnetToDirectedGraph</a>(nnet, &amp;graph);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(6) &lt;&lt; <span class="stringliteral">&quot;graph is: &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a794312260c52d2eb93f30302ee0a7173">PrintGraphToString</a>(graph);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; sccs;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ae72c79fbb6ec81b69aaee02701fa23e5">FindSccs</a>(graph, &amp;sccs);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; scc_graph;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a9efe2804eba8c2da73af3aa4eff4a2fc">MakeSccGraph</a>(graph, sccs, &amp;scc_graph);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(6) &lt;&lt; <span class="stringliteral">&quot;scc graph is: &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a794312260c52d2eb93f30302ee0a7173">PrintGraphToString</a>(scc_graph);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; scc_graph_transpose;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// compute transpose because we actually want the reverse of the topological</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// order so inputs come first and then outputs.</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">ComputeGraphTranspose</a>(scc_graph, &amp;scc_graph_transpose);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  std::vector&lt;int32&gt; scc_node_to_epoch;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ae4c2ac8a9e96d220776910b2a9ae2971">ComputeTopSortOrder</a>(scc_graph, &amp;scc_node_to_epoch);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 6) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; scc_node_to_epoch.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      os &lt;&lt; scc_node_to_epoch[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(6) &lt;&lt; <span class="stringliteral">&quot;scc_node_to_epoch is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  node_to_epoch-&gt;clear();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  node_to_epoch-&gt;resize(graph.size());</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sccs.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); ++<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node = sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node &gt;= 0 &amp;&amp; node &lt; graph.size());</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      (*node_to_epoch)[node] = scc_node_to_epoch[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a679a6d66a5e4a3993124bc35597dd06b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a679a6d66a5e4a3993124bc35597dd06b">kaldi::nnet3::NnetToDirectedGraph</a></div><div class="ttdeci">void NnetToDirectedGraph(const Nnet &amp;nnet, std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph)</div><div class="ttdoc">This function takes an nnet and turns it to a directed graph on nodes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00030">nnet-graph.cc:30</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gae77f5cf98f18f8cbe207690e49da166e"><div class="ttname"><a href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">kaldi::GetVerboseLevel</a></div><div class="ttdeci">int32 GetVerboseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00060">kaldi-error.h:60</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac4457943f315ab2e900b1f81606404f8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">kaldi::nnet3::ComputeGraphTranspose</a></div><div class="ttdeci">void ComputeGraphTranspose(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph_transpose)</div><div class="ttdoc">Outputs a graph in which the order of arcs is reversed. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00063">nnet-graph.cc:63</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae4c2ac8a9e96d220776910b2a9ae2971"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae4c2ac8a9e96d220776910b2a9ae2971">kaldi::nnet3::ComputeTopSortOrder</a></div><div class="ttdeci">void ComputeTopSortOrder(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; int32 &gt; *node_to_order)</div><div class="ttdoc">Given an acyclic graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming f...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00223">nnet-graph.cc:223</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae72c79fbb6ec81b69aaee02701fa23e5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae72c79fbb6ec81b69aaee02701fa23e5">kaldi::nnet3::FindSccs</a></div><div class="ttdeci">void FindSccs(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdoc">Given a directed graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming f...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00156">nnet-graph.cc:156</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9efe2804eba8c2da73af3aa4eff4a2fc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9efe2804eba8c2da73af3aa4eff4a2fc">kaldi::nnet3::MakeSccGraph</a></div><div class="ttdeci">void MakeSccGraph(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;sccs, std::vector&lt; std::vector&lt; int32 &gt; &gt; *scc_graph)</div><div class="ttdoc">Given a list of sccs of a graph (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00164">nnet-graph.cc:164</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a794312260c52d2eb93f30302ee0a7173"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a794312260c52d2eb93f30302ee0a7173">kaldi::nnet3::PrintGraphToString</a></div><div class="ttdeci">std::string PrintGraphToString(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph)</div><div class="ttdoc">Prints a graph to a string in a pretty way for human readability, e.g. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00248">nnet-graph.cc:248</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f2fefdb7c8c1cc2fd30b5e102e8e979"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeObjectiveFunction </td>
          <td>(</td>
          <td class="paramtype">const GeneralMatrix &amp;&#160;</td>
          <td class="paramname"><em>supervision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectiveType&#160;</td>
          <td class="paramname"><em>objective_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>output_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>supply_deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputer *&#160;</td>
          <td class="paramname"><em>computer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat *&#160;</td>
          <td class="paramname"><em>tot_weight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat *&#160;</td>
          <td class="paramname"><em>tot_objf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the objective function, and if supply_deriv = true, supplies its derivative to the <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> object. </p>
<p>See also the function <a class="el" href="namespacekaldi_1_1nnet3.html#a4ba032c2d77e71f7c64ea5a165cc1dcf" title="This function computes the frame accuracy for this minibatch. ">ComputeAccuracy()</a>, declared in <a class="el" href="nnet-diagnostics_8h.html">nnet-diagnostics.h</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">supervision</td><td>A <a class="el" href="classkaldi_1_1GeneralMatrix.html" title="This class is a wrapper that enables you to store a matrix in one of three forms: either as a Matrix&lt;...">GeneralMatrix</a>, typically derived from a <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a>, containing the supervision posteriors or features. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">objective_type</td><td>The objective function type: kLinear = output * supervision, or kQuadratic = -0.5 * (output - supervision)^2. kLinear is used for softmax objectives; the network contains a LogSoftmax layer which correctly normalizes its output. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output_name</td><td>The name of the output node (e.g. "output"), used to look up the output in the <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html" title="class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...">NnetComputer</a> object.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">supply_deriv</td><td>If this is true, this function will compute the derivative of the objective function and supply it to the network using the function <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html#a10cb5d5e00ee5017d5a3a93450a9995f" title="e.g. AcceptOutputDeriv(&quot;output&quot;, &amp;output_deriv_mat). ">NnetComputer::AcceptOutputDeriv</a> </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">computer</td><td>The <a class="el" href="classkaldi_1_1nnet3_1_1NnetComputer.html" title="class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...">NnetComputer</a> object, from which we get the output using GetOutput and to which we may supply the derivatives using AcceptOutputDeriv. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tot_weight</td><td>The total weight of the training examples. In the kLinear case, this is the sum of the supervision matrix; in the kQuadratic case, it is the number of rows of the supervision matrix. In order to make it possible to weight samples with quadratic objective functions, we may at some point make it possible for the supervision matrix to have an extra column containing weights. At the moment, this is not supported. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tot_objf</td><td>The total objective function; divide this by the tot_weight to get the normalized objective function. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nnet-training_8cc_source.html#l00167">167</a> of file <a class="el" href="nnet-training_8cc_source.html">nnet-training.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00436">NnetComputer::AcceptOutputDeriv()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02495">CuMatrixBase&lt; Real &gt;::CopyFromGeneralMat()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00391">CuSparseMatrix&lt; Real &gt;::CopyToMat()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00767">GeneralMatrix::GetFullMatrix()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00722">GeneralMatrix::GetMatrix()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00415">NnetComputer::GetOutput()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00749">GeneralMatrix::GetSparseMatrix()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="sparse-matrix_8h_source.html#l00218">kaldi::kCompressedMatrix</a>, <a class="el" href="sparse-matrix_8h_source.html#l00217">kaldi::kFullMatrix</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00052">kLinear</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00052">kQuadratic</a>, <a class="el" href="sparse-matrix_8h_source.html#l00219">kaldi::kSparseMatrix</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00037">kaldi::kUndefined</a>, <a class="el" href="cu-matrix_8h_source.html#l00196">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00697">GeneralMatrix::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00195">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00687">GeneralMatrix::NumRows()</a>, <a class="el" href="cu-sparse-matrix_8cc_source.html#l00057">CuSparseMatrix&lt; Real &gt;::Sum()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02434">CuMatrixBase&lt; Real &gt;::Sum()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00113">CuMatrix&lt; Real &gt;::Swap()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00610">kaldi::TraceMatSmat()</a>, and <a class="el" href="sparse-matrix_8cc_source.html#l00678">GeneralMatrix::Type()</a>.</p>

<p>Referenced by <a class="el" href="nnet-diagnostics_8cc_source.html#l00078">NnetComputeProb::ProcessOutputs()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00087">NnetTrainer::ProcessOutputs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                                   {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">const</span> CuMatrixBase&lt;BaseFloat&gt; &amp;output = computer-&gt;GetOutput(output_name);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span> (output.NumCols() != supervision.NumCols())</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Nnet versus example output dimension (num-classes) &quot;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;mismatch for &#39;&quot;</span> &lt;&lt; output_name &lt;&lt; <span class="stringliteral">&quot;&#39;: &quot;</span> &lt;&lt; output.NumCols()</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; (nnet) vs. &quot;</span> &lt;&lt; supervision.NumCols() &lt;&lt; <span class="stringliteral">&quot; (egs)\n&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">switch</span> (objective_type) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d">kLinear</a>: {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">// objective is x * y.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">switch</span> (supervision.Type()) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kSparseMatrix</a>: {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="keyword">const</span> SparseMatrix&lt;BaseFloat&gt; &amp;post = supervision.GetSparseMatrix();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          CuSparseMatrix&lt;BaseFloat&gt; cu_post(post);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="comment">// The cross-entropy objective is computed by a simple dot product,</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;          <span class="comment">// because after the LogSoftmaxLayer, the output is already in the form</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          <span class="comment">// of log-likelihoods that are normalized to sum to one.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          *tot_weight = cu_post.Sum();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;          *tot_objf = <a class="code" href="group__matrix__group.html#ga488f773f3606a469f29a1df41d6debb7">TraceMatSmat</a>(output, cu_post, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <span class="keywordflow">if</span> (supply_deriv) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            CuMatrix&lt;BaseFloat&gt; output_deriv(output.NumRows(), output.NumCols(),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                             <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            cu_post.CopyToMat(&amp;output_deriv);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            computer-&gt;AcceptOutputDeriv(output_name, &amp;output_deriv);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kFullMatrix</a>: {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="comment">// there is a redundant matrix copy in here if we&#39;re not using a GPU</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;          <span class="comment">// but we don&#39;t anticipate this code branch being used in many cases.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          CuMatrix&lt;BaseFloat&gt; cu_post(supervision.GetFullMatrix());</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          *tot_weight = cu_post.Sum();</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;          *tot_objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output, cu_post, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;          <span class="keywordflow">if</span> (supply_deriv)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            computer-&gt;AcceptOutputDeriv(output_name, &amp;cu_post);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kCompressedMatrix</a>: {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          Matrix&lt;BaseFloat&gt; post;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          supervision.GetMatrix(&amp;post);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          CuMatrix&lt;BaseFloat&gt; cu_post;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          cu_post.Swap(&amp;post);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          *tot_weight = cu_post.Sum();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          *tot_objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output, cu_post, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          <span class="keywordflow">if</span> (supply_deriv)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            computer-&gt;AcceptOutputDeriv(output_name, &amp;cu_post);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2">kQuadratic</a>: {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">// objective is -0.5 (x - y)^2</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      CuMatrix&lt;BaseFloat&gt; diff(supervision.NumRows(),</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                               supervision.NumCols(),</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                               <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      diff.CopyFromGeneralMat(supervision);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      diff.AddMat(-1.0, output);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      *tot_weight = diff.NumRows();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      *tot_objf = -0.5 * <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(diff, diff, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (supply_deriv)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        computer-&gt;AcceptOutputDeriv(output_name, &amp;diff);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Objective function type &quot;</span> &lt;&lt; objective_type</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; not handled.&quot;</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3af872badd576ccf234e1bccf54f263863">kaldi::kFullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00217">sparse-matrix.h:217</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00037">matrix-common.h:37</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576eac188c019178783e5be55110601309d7d">kaldi::nnet3::kLinear</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00052">nnet-nnet.h:52</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3aef253b40b2456ff5af4ad398301f8aef">kaldi::kSparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00219">sparse-matrix.h:219</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="group__matrix__group_html_gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9"><div class="ttname"><a href="group__matrix__group.html#gga1b44c0ec7cf5c76c910fd41756787be3a87ea862fefb9f41cf20a2de202b4a9f9">kaldi::kCompressedMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8h_source.html#l00218">sparse-matrix.h:218</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a45660f9909187129a953fa05e664576ea7ec873b684c76347a4567ff59f649af2">kaldi::nnet3::kQuadratic</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00052">nnet-nnet.h:52</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="group__matrix__group_html_ga488f773f3606a469f29a1df41d6debb7"><div class="ttname"><a href="group__matrix__group.html#ga488f773f3606a469f29a1df41d6debb7">kaldi::TraceMatSmat</a></div><div class="ttdeci">Real TraceMatSmat(const MatrixBase&lt; Real &gt; &amp;A, const SparseMatrix&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8cc_source.html#l00610">sparse-matrix.cc:610</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a88aa85d232ba1ad6e430f6f6dcda29c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeSimpleNnetContext </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>right_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ComputeNnetContext computes the left-context and right-context of a nnet. </p>
<p>The nnet must satisfy IsSimpleNnet(nnet).</p>
<p>It does this by constructing a <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> with a certain number of inputs available, outputs can be computed.. It does the same after shifting the time index of the output to all values 0, 1, ... n-1, where n is the output of nnet.Modulus(). Then it returns the largest left context and the largest right context that it infers from any of these computation requests. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00129">129</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-utils_8cc_source.html#l00082">ComputeSimpleNnetContextForShift()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00042">IsSimpleNnet()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00624">Nnet::Modulus()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00027">NnetDecodableBase::NnetDecodableBase()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00362">NnetInfo()</a>, <a class="el" href="am-nnet-simple_8cc_source.html#l00096">AmNnetSimple::SetContext()</a>, and <a class="el" href="nnet-utils-test_8cc_source.html#l00027">UnitTestNnetContext()</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                                    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">IsSimpleNnet</a>(nnet));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> modulus = nnet.Modulus();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// modulus &gt;= 1 is a number such that the network ought to be</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// invariant to time shifts (of both the input and output) that</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// are a multiple of this number.  We need to test all shifts modulo</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="comment">// this number in case the left and right context vary at all within</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">// this range.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  std::vector&lt;int32&gt; left_contexts(modulus + 1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  std::vector&lt;int32&gt; right_contexts(modulus + 1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// This will crash if the total context (left + right) is greater</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// than window_size.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> window_size = 100;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// by going &quot;&lt;= modulus&quot; instead of &quot;&lt; modulus&quot; we do one more computation</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// than we really need; it becomes a sanity check.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_start = 0; input_start &lt;= modulus; input_start++)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a77531474c07694bc42e0ee70a0918e1f">ComputeSimpleNnetContextForShift</a>(nnet, input_start, window_size,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                     &amp;(left_contexts[input_start]),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                     &amp;(right_contexts[input_start]));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(left_contexts[0] == left_contexts[modulus] &amp;&amp;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;               <span class="stringliteral">&quot;nnet does not have the properties we expect.&quot;</span>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(right_contexts[0] == right_contexts[modulus] &amp;&amp;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;               <span class="stringliteral">&quot;nnet does not have the properties we expect.&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  *left_context =</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      *std::max_element(left_contexts.begin(), left_contexts.end());</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  *right_context =</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      *std::max_element(right_contexts.begin(), right_contexts.end());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a672e127a288d02b4a8e292b86aadfc04"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">kaldi::nnet3::IsSimpleNnet</a></div><div class="ttdeci">bool IsSimpleNnet(const Nnet &amp;nnet)</div><div class="ttdoc">This function returns true if the nnet has the following properties: It has one output, called &quot;output&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00042">nnet-utils.cc:42</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a77531474c07694bc42e0ee70a0918e1f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a77531474c07694bc42e0ee70a0918e1f">kaldi::nnet3::ComputeSimpleNnetContextForShift</a></div><div class="ttdeci">static void ComputeSimpleNnetContextForShift(const Nnet &amp;nnet, int32 input_start, int32 window_size, int32 *left_context, int32 *right_context)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00082">nnet-utils.cc:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a77531474c07694bc42e0ee70a0918e1f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ComputeSimpleNnetContextForShift </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>window_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>right_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00082">82</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-utils_8cc_source.html#l00064">EvaluateComputationRequest()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00444">Nnet::GetNodeIndex()</a>, <a class="el" href="nnet-computation_8h_source.html#l00071">IoSpecification::indexes</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8h_source.html#l00070">IoSpecification::name</a>, and <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00129">ComputeSimpleNnetContext()</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                          {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_end = input_start + window_size;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  IoSpecification input;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  input.name = <span class="stringliteral">&quot;input&quot;</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  IoSpecification output;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  output.name = <span class="stringliteral">&quot;output&quot;</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  IoSpecification ivector;  <span class="comment">// we might or might not use this.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  ivector.name = <span class="stringliteral">&quot;ivector&quot;</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = rand() % 10;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// in the IoSpecification for now we we will request all the same indexes at</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// output that we requested at input.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = input_start; t &lt; input_end; t++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    input.indexes.push_back(Index(n, t));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    output.indexes.push_back(Index(n, t));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// the assumption here is that the network just requires the ivector at time</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// t=0.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  ivector.indexes.push_back(Index(n, 0));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  ComputationRequest request;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  request.inputs.push_back(input);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  request.outputs.push_back(output);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (nnet.GetNodeIndex(<span class="stringliteral">&quot;ivector&quot;</span>) != -1)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    request.inputs.push_back(ivector);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  std::vector&lt;std::vector&lt;bool&gt; &gt; computable;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a5683058729bb42a5e8462f9912484050">EvaluateComputationRequest</a>(nnet, request, &amp;computable);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(computable.size() == 1);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  std::vector&lt;bool&gt; &amp;output_ok = computable[0];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  std::vector&lt;bool&gt;::iterator iter =</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      std::find(output_ok.begin(), output_ok.end(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_ok = iter - output_ok.begin();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_not_ok = std::find(iter, output_ok.end(), <span class="keyword">false</span>) -</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      output_ok.begin();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">if</span> (first_ok == window_size || first_not_ok &lt;= first_ok)</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No outputs were computable (perhaps not a simple nnet?)&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  *left_context = first_ok;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  *right_context = window_size - first_not_ok;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a5683058729bb42a5e8462f9912484050"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a5683058729bb42a5e8462f9912484050">kaldi::nnet3::EvaluateComputationRequest</a></div><div class="ttdeci">void EvaluateComputationRequest(const Nnet &amp;nnet, const ComputationRequest &amp;request, std::vector&lt; std::vector&lt; bool &gt; &gt; *is_computable)</div><div class="ttdoc">Given an nnet and a computation request, this function works out which requested outputs in the compu...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00064">nnet-utils.cc:64</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a602adf8e3c912ce0b74cbc5700255867"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::ComputeSubmatIndexHistogram </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt;&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unordered_map&lt; int32, std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>submat_histogram</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00113">113</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">SplitLocations()</a>.</p>
<div class="fragment"><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sorted_submat_lists.size() &gt; 0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// computing the submat_histogram</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// counting the occurrences of each element in the current submat_list;</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// each new occurrence of the same element, in this list, is counted</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// as a seperate symbol for frequency counts</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sorted_submat_lists.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    unordered_map&lt;int32, std::vector&lt;int32&gt; &gt;::iterator histogram_iterator</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        = submat_histogram-&gt;end();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> repetition_count = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">while</span> (j &lt; sorted_submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size()) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">if</span> ((histogram_iterator == submat_histogram-&gt;end()) ||</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;          (histogram_iterator-&gt;first != sorted_submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].first)) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        histogram_iterator =</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            submat_histogram-&gt;find(sorted_submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].first);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        repetition_count = 0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="comment">// if a histogram entry was not found for this submat_index, add one</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">if</span> (histogram_iterator == submat_histogram-&gt;end()) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          (*submat_histogram)[sorted_submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first];</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          histogram_iterator = submat_histogram-&gt;find(</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              sorted_submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][j].first);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (repetition_count &gt;= (histogram_iterator-&gt;second).size()) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="comment">// this is the first time the submat_index repeated this many times</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// so add an entry for this in the count vector</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        (histogram_iterator-&gt;second).push_back(1);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        (histogram_iterator-&gt;second)[repetition_count]++;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      repetition_count++;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      j++;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae4c2ac8a9e96d220776910b2a9ae2971"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeTopSortOrder </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>node_to_order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given an acyclic graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming from the current node), compute a topological ordering of the graph nodes. </p>
<p>The output format is that node_to_order[n] contains an integer t = 0, 1, ... which is the order of node n in a topological sorting. node_to_order should contain some permutation of the numbers 0 ... graph.size() - 1. This function should crash if the graph contains cycles. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00223">223</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-graph_8cc_source.html#l00196">ComputeTopSortOrderRecursive()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00187">UnitTestComputeTopSortOrder()</a>.</p>
<div class="fragment"><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                                          {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="comment">// Internally we use DFS, but we only put the node to &lt;node_to_order&gt; when all</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">// its parents have been visited.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_to_order != NULL);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  node_to_order-&gt;resize(graph.size());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  std::vector&lt;bool&gt; cycle_detector(graph.size(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  std::vector&lt;bool&gt; is_visited(graph.size(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  std::vector&lt;int32&gt; reversed_orders;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">for</span>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; graph.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> (!is_visited[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a76f6120092b06acc2556c7b9e40c990e">ComputeTopSortOrderRecursive</a>(i, graph, &amp;cycle_detector,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                   &amp;is_visited, &amp;reversed_orders);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node_to_order-&gt;size() == reversed_orders.size());</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; reversed_orders.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(reversed_orders[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] &gt;= 0 &amp;&amp; reversed_orders[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt; graph.size());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    (*node_to_order)[reversed_orders[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]] = graph.size() - <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - 1;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a76f6120092b06acc2556c7b9e40c990e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a76f6120092b06acc2556c7b9e40c990e">kaldi::nnet3::ComputeTopSortOrderRecursive</a></div><div class="ttdeci">void ComputeTopSortOrderRecursive(int32 node, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; bool &gt; *cycle_detector, std::vector&lt; bool &gt; *is_visited, std::vector&lt; int32 &gt; *reversed_orders)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00196">nnet-graph.cc:196</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a76f6120092b06acc2556c7b9e40c990e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::ComputeTopSortOrderRecursive </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; *&#160;</td>
          <td class="paramname"><em>cycle_detector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; *&#160;</td>
          <td class="paramname"><em>is_visited</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>reversed_orders</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00196">196</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00223">ComputeTopSortOrder()</a>.</p>
<div class="fragment"><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                                                     {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node &gt;= 0 &amp;&amp; node &lt; graph.size());</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cycle_detector != NULL);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(is_visited != NULL);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(reversed_orders != NULL);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span> ((*cycle_detector)[node]) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Cycle detected when computing the topological sorting order&quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">if</span> (!(*is_visited)[node]) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    (*cycle_detector)[node] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; graph[node].size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a76f6120092b06acc2556c7b9e40c990e">ComputeTopSortOrderRecursive</a>(graph[node][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], graph,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                   cycle_detector, is_visited, reversed_orders);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    (*cycle_detector)[node] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    (*is_visited)[node] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// At this point we have added all the children to &lt;reversed_orders&gt;, so we</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// can add the current now.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    reversed_orders-&gt;push_back(node);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a76f6120092b06acc2556c7b9e40c990e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a76f6120092b06acc2556c7b9e40c990e">kaldi::nnet3::ComputeTopSortOrderRecursive</a></div><div class="ttdeci">void ComputeTopSortOrderRecursive(int32 node, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; bool &gt; *cycle_detector, std::vector&lt; bool &gt; *is_visited, std::vector&lt; int32 &gt; *reversed_orders)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00196">nnet-graph.cc:196</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a474b6a19fd42f428dd178f9af05150a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ComputeVariableAccesses </td>
          <td>(</td>
          <td class="paramtype">const ComputationVariables &amp;&#160;</td>
          <td class="paramname"><em>variables</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; CommandAttributes &gt; &amp;&#160;</td>
          <td class="paramname"><em>command_attributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; Access &gt; &gt; *&#160;</td>
          <td class="paramname"><em>variable_accesses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>After the command-level attributes have been computed, this function organizes them per variable (see class <a class="el" href="classkaldi_1_1nnet3_1_1ComputationVariables.html" title="This class relates the matrices and sub-matrices in the computation to imaginary &quot;variables&quot;, such that we can think of the operations as operating on sets of individual variables, and we can then do analysis that lets us do optimization. ">ComputationVariables</a> for how a variable is defined; it is part of a matrix). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">variables</td><td>The definition of variables for this computation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command_attributes</td><td>A vector of attributes, one per command, as obtained from <a class="el" href="namespacekaldi_1_1nnet3.html#aa02a576b6e9aa0977f3eb52471742b85">ComputeCommandAttributes()</a>. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">variable_accesses</td><td>The output will have a size equal to the number of variables, and each element will be a vector of accesses, sorted by command index; each command will only be listed once in this vector. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00390">390</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-analyze_8h_source.html#l00077">kReadAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00079">kReadWriteAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00078">kWriteAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00155">ComputationVariables::NumVariables()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00050">CommandAttributes::variables_read</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00052">CommandAttributes::variables_written</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, and <a class="el" href="nnet-optimize_8cc_source.html#l00028">MoveSizingCommands()</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                                                      {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_variables = variables.NumVariables(),</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      num_commands = command_attributes.size();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  variable_accesses-&gt;clear();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  variable_accesses-&gt;resize(num_variables);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_commands; c++) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">const</span> CommandAttributes &amp;attr = command_attributes[c];</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(attr.variables_read));</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(attr.variables_written));</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    std::vector&lt;int32&gt; all_variables;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    all_variables.reserve(attr.variables_read.size() +</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                          attr.variables_written.size());</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    all_variables.insert(all_variables.end(), attr.variables_read.begin(),</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                         attr.variables_read.end());</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    all_variables.insert(all_variables.end(), attr.variables_written.begin(),</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                         attr.variables_written.end());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;all_variables);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    std::vector&lt;int32&gt;::const_iterator iter = all_variables.begin(),</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        end = all_variables.end();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> variable_index = *iter;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordtype">bool</span> is_read = std::binary_search(attr.variables_read.begin(),</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                        attr.variables_read.end(),</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                        variable_index),</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          is_written = (!is_read ? <span class="keyword">true</span> :</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                        std::binary_search(attr.variables_written.begin(),</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                           attr.variables_written.end(),</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                           variable_index));</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">if</span> (is_read &amp;&amp; is_written) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        (*variable_accesses)[variable_index].push_back(</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kReadWriteAccess</a>));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_read) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        (*variable_accesses)[variable_index].push_back(</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a>));</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        (*variable_accesses)[variable_index].push_back(</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            Access(c, <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>));</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      }</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kaldi::nnet3::kReadAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00077">nnet-analyze.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478af796329d6cdaaccf1b74d1811d17162e">kaldi::nnet3::kReadWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00079">nnet-analyze.h:79</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad35855c00662ec8d8b2cf5e14569db0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConsolidateModelUpdate </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This consolidates the model-update parts of the backprop into larger operations (applicable mostly to recurrent setups)&ndash; internally it uses class <a class="el" href="classkaldi_1_1nnet3_1_1ModelUpdateConsolidator.html" title="This class is responsible for consolidating the model-update part of backprop commands, for components in (e.g.) recurrent networks that need to have many separate backprop commands, into more efficient single commands operating on consolidated data in larger matrices. ">ModelUpdateConsolidator</a>. </p>
<p>Will fail if called a second time. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00266">266</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize-utils_8cc_source.html#l01157">ModelUpdateConsolidator::ConsolidateModelUpdate()</a>, and <a class="el" href="nnet-computation_8h_source.html#l00110">ComputationRequest::need_model_derivative</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                                          {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (!request.need_model_derivative)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">return</span>;   <span class="comment">// An optimization; there would be nothing to do in this case.</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  ModelUpdateConsolidator consolidator(nnet, computation);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  consolidator.ConsolidateModelUpdate();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9d106dafc23aa3dc2359adc0bb2a94bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::ContainsSingleExample </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>min_input_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>max_input_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>min_output_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>max_output_t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the "eg" contains just a single example, meaning that all the "n" values in the indexes are zero, and the example has <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> members named both "input" and "output". </p>
<p>Also computes the minimum and maximum "t" values in the "input" and "output" <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> members. </p>

<p>Definition at line <a class="el" href="nnet3-copy-egs_8cc_source.html#l00048">48</a> of file <a class="el" href="nnet3-copy-egs_8cc_source.html">nnet3-copy-egs.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, and <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>.</p>

<p>Referenced by <a class="el" href="nnet3-copy-egs_8cc_source.html#l00188">SelectFromExample()</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                                                {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">bool</span> done_input = <span class="keyword">false</span>, done_output = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_indexes = eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.size();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_indexes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> &amp;io = eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    std::vector&lt;Index&gt;::const_iterator iter = io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>.begin(),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                        end = io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>.end();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// Should not have an empty input/output type.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>.empty());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> (io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == <span class="stringliteral">&quot;input&quot;</span> || io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == <span class="stringliteral">&quot;output&quot;</span>) {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_t = iter-&gt;t, max_t = iter-&gt;t;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_t = iter-&gt;t;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        min_t = std::min(min_t, this_t);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        max_t = std::max(max_t, this_t);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">if</span> (iter-&gt;n != 0) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Example does not contain just a single example; &quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;too late to do frame selection or reduce context.&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == <span class="stringliteral">&quot;input&quot;</span>) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        done_input = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        *min_input_t = min_t;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        *max_input_t = max_t;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a> == <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        done_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        *min_output_t = min_t;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        *max_output_t = max_t;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">if</span> (iter-&gt;n != 0) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Example does not contain just a single example; &quot;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;too late to do frame selection or reduce context.&quot;</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">if</span> (!done_input) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Example does not have any input named &#39;input&#39;&quot;</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">if</span> (!done_output) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Example does not have any output named &#39;output&#39;&quot;</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html">kaldi::nnet3::NnetIo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00033">nnet-example.h:33</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html_aa3daaa77b972f8dace077e94b418aab1"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">kaldi::nnet3::NnetIo::indexes</a></div><div class="ttdeci">std::vector&lt; Index &gt; indexes</div><div class="ttdoc">&quot;indexes&quot; is a vector the same length as features.NumRows(), explaining the meaning of each row of th...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00042">nnet-example.h:42</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">kaldi::nnet3::NnetIo::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">the name of the input in the neural net; in simple setups it will just be &quot;input&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00036">nnet-example.h:36</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_acfc99ed8d51e6726a7c4e888afebc910"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">kaldi::nnet3::NnetExample::io</a></div><div class="ttdeci">std::vector&lt; NnetIo &gt; io</div><div class="ttdoc">&quot;io&quot; contains the input and output. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00087">nnet-example.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac759ea60772df625784bcc714f7a41da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertAdditionToAssignment </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This converts addition operations (things with Add in their names) to copy operations (things with Copy in their names). </p>
<p>This is both slightly more efficient, </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00276">276</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8h_source.html#l00293">Analyzer::command_attributes</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01001">ComputationAnalysis::FirstAccess()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kAddRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddToRowsMulti</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kCopyRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyToRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixAdd</a>, and <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixCopy</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                                               {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  Analyzer analyzer;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  analyzer.Init(nnet, *computation);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  ComputationAnalysis analysis(*computation, analyzer);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands = computation-&gt;commands.size();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> command = 0; command &lt; num_commands; command++) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    NnetComputation::Command &amp;c = computation-&gt;commands[command];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">switch</span> (c.command_type) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>: <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>:</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Cannot call ConvertAdditionToAssignment after &quot;</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;allowing undefined initialization.&quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>: <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>: <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>:</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>: {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;submatrices_written =</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            analyzer.command_attributes[command].submatrices_written;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!submatrices_written.empty());</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        std::vector&lt;int32&gt;::const_iterator iter = submatrices_written.begin(),</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            end = submatrices_written.end();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordtype">bool</span> can_convert = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submatrix_written = *iter;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_access_command = analysis.FirstAccess(submatrix_written);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;          <span class="comment">// first_access_command is first non-initialization command that</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          <span class="comment">// accesses this submatrix.  It can be assumed to be a write command,</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="comment">// since it makes no sense to read a variable before it&#39;s written to.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="comment">// If it&#39;s before this command then we need to add rather than copy,</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          <span class="comment">// we can&#39;t do the conversion to a copy command.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          <span class="keywordflow">if</span> (first_access_command != command) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            can_convert = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">if</span> (can_convert) {  <span class="comment">// convert to a copy command.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          <span class="keywordflow">switch</span> (c.command_type) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>: c.command_type = <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>: c.command_type = <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>: c.command_type = <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>: c.command_type = <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">default</span>: <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unexpected command type.&quot;</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kaldi::nnet3::kMatrixCopy</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kaldi::nnet3::kMatrixAdd</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae99488174e8dde27f8f30d91d61c0cd2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ConvertToIndexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>location_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>first_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>second_values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If it is the case for some i &gt;= 0 that all the .first elements of "location_vector" are either i or -1, then output i to first_value and the .second elements into "second_values", and return true. </p>
<p>Otherwise return false and the outputs are don't-cares. </p>

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00377">377</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00484">Compiler::DoForwardComputationFromSubmatLocations()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">SplitLocationsBackward()</a>, <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00275">UnitTestSplitLocations()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00070">UnitTestSplitLocationsBackward()</a>.</p>
<div class="fragment"><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                      {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  *first_value = -1;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  second_values-&gt;clear();</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  second_values-&gt;reserve(location_vector.size());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator iter;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">for</span> (iter = location_vector.begin(); iter &lt; location_vector.end(); ++iter)  {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (iter-&gt;first != -1) {</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="keywordflow">if</span> (*first_value == -1)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        *first_value = iter-&gt;first;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;first != *first_value)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      second_values-&gt;push_back(iter-&gt;second);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      second_values-&gt;push_back(-1);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac6b64008b19bbb6e8769769cbf96fa68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DescriptorTokenize </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>tokens</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function tokenizes input when parsing <a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> configuration values. </p>
<p>A token in this context is not the same as a generic Kaldi token, e.g. as defined in <a class="el" href="namespacekaldi.html#a30db4b2b32d39051a72d3eec42e819a8" title="Returns true if &quot;token&quot; is nonempty, and all characters are printable and whitespace-free. ">IsToken()</a> in util/text_utils.h, which just means a non-empty whitespace-free string. Here a token is more like a programming-language token, and currently the following are allowed as tokens: "(" ")" ","</p>
<ul>
<li>A nonempty string beginning with A-Za-z_, and containing only -_A-Za-z0-9.</li>
<li>An integer, optionally beginning with - or + and then a nonempty sequence of 0-9.</li>
</ul>
<p>This function should return false and print an informative error with local context if it can't tokenize the input. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00355">355</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="text-utils_8h_source.html#l00114">kaldi::ConvertStringToInteger()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00429">ErrorContext()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00403">IsValidName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00179">NormalizeTextDescriptor()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00264">Nnet::ProcessComponentNodeConfigLine()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00346">Nnet::ProcessOutputNodeConfigLine()</a>, <a class="el" href="nnet-descriptor-test_8cc_source.html#l00088">UnitTestDescriptorIo()</a>, <a class="el" href="nnet-parse-test_8cc_source.html#l00195">UnitTestDescriptorTokenize()</a>, and <a class="el" href="nnet-descriptor-test_8cc_source.html#l00134">UnitTestGeneralDescriptor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                      {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tokens != NULL);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordtype">size_t</span> start = input.find_first_not_of(<span class="stringliteral">&quot; \t&quot;</span>), size = input.size();</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  tokens-&gt;clear();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">while</span> (start &lt; size) {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!isspace(input[start]));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keywordflow">if</span> (input[start] == <span class="charliteral">&#39;(&#39;</span> || input[start] == <span class="charliteral">&#39;)&#39;</span> || input[start] == <span class="charliteral">&#39;,&#39;</span>) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      tokens-&gt;push_back(std::string(input, start, 1));</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      start = input.find_first_not_of(<span class="stringliteral">&quot; \t&quot;</span>, start + 1);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="keywordtype">size_t</span> found = input.find_first_of(<span class="stringliteral">&quot; \t(),&quot;</span>, start);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(found != start);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">if</span> (found == std::string::npos) {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        std::string str(input, start, input.size() - start);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tmp;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a30e2d3a7507084b838f420b5e10b37f9">IsValidName</a>(str) &amp;&amp; !<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(str, &amp;tmp)) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Could not parse line &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a2904394bf025a2757bd2ab32f2caea36">ErrorContext</a>(std::string(input, start));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        tokens-&gt;push_back(str);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">if</span> (input[found] == <span class="charliteral">&#39;(&#39;</span> || input[found] == <span class="charliteral">&#39;)&#39;</span> || input[found] == <span class="charliteral">&#39;,&#39;</span>) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          std::string str(input, start, found - start);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tmp;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a30e2d3a7507084b838f420b5e10b37f9">IsValidName</a>(str) &amp;&amp; !<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(str, &amp;tmp)) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Could not parse line &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a2904394bf025a2757bd2ab32f2caea36">ErrorContext</a>(std::string(input, start));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;          tokens-&gt;push_back(str);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          start = found;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          std::string str(input, start, found - start);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tmp;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;          <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a30e2d3a7507084b838f420b5e10b37f9">IsValidName</a>(str) &amp;&amp; !<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(str, &amp;tmp)) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Could not parse line &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a2904394bf025a2757bd2ab32f2caea36">ErrorContext</a>(std::string(input, start));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          tokens-&gt;push_back(str);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;          start = input.find_first_not_of(<span class="stringliteral">&quot; \t&quot;</span>, found);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a39eb3f7ce5fab6dbbcb396b3f8e196f4"><div class="ttname"><a href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">kaldi::ConvertStringToInteger</a></div><div class="ttdeci">bool ConvertStringToInteger(const std::string &amp;str, Int *out)</div><div class="ttdoc">Converts a string into an integer via strtoll and returns false if there was any kind of problem (i...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00114">text-utils.h:114</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2904394bf025a2757bd2ab32f2caea36"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2904394bf025a2757bd2ab32f2caea36">kaldi::nnet3::ErrorContext</a></div><div class="ttdeci">std::string ErrorContext(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00439">nnet-parse.cc:439</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a30e2d3a7507084b838f420b5e10b37f9"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a30e2d3a7507084b838f420b5e10b37f9">kaldi::nnet3::IsValidName</a></div><div class="ttdeci">bool IsValidName(const std::string &amp;name)</div><div class="ttdoc">Returns true if &#39;name&#39; would be a valid name for a component or node in a Nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00403">nnet-parse.cc:403</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dc8f245e845514d33d24ecf1a054406"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> DotProduct </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns dot product between two networks of the same structure (calls the DotProduct functions of the Updatable components and sums up the return values). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00225">225</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="nnet-training_8cc_source.html#l00047">NnetTrainer::Train()</a>, and <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                        {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet1.NumComponents() == nnet2.NumComponents());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> ans = 0.0;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet1.NumComponents(); c++) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">const</span> Component *comp1 = nnet1.GetComponent(c),</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    *comp2 = nnet2.GetComponent(c);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (comp1-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keyword">const</span> UpdatableComponent</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          *u_comp1 = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>UpdatableComponent*<span class="keyword">&gt;</span>(comp1),</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          *u_comp2 = dynamic_cast&lt;const UpdatableComponent*&gt;(comp2);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(u_comp1 != NULL &amp;&amp; u_comp2 != NULL);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      ans += u_comp1-&gt;DotProduct(*u_comp2);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84ff5e289907fa63155ee9bec0f9c631"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EnsureContiguousProperty </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>indexes_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a vector of indexes and splits it up into as separate vectors of the same size, as needed to ensure that the 'contiguous property' holds. </p>
<p>This is done via padding with -1's. An example will clarify this. Suppose the input is: [ -1 1 1 1 2 2 1 1 ] which lacks the contiguous property because 1's appear in 2 different places, it would split it up as [ -1 1 1 1 2 2 -1 -1 ] [ -1 -1 -1 -1 -1 -1 1 1 ] If 'indexes' is empty or only contains -1's, 'indexes_out' will be empty. </p>

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00401">401</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">SplitLocationsBackward()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00222">UnitTestEnsureContiguousProperty()</a>.</p>
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                               {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  indexes_out-&gt;clear();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  indexes_out-&gt;reserve(3);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordflow">if</span> (indexes.empty()) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_value = *std::max_element(indexes.begin(), indexes.end());</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">if</span> (max_value == -1) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  std::vector&lt;int32&gt; num_segments_seen(max_value + 1, 0);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dim = indexes.size(), num_output_vectors = 0;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim;) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// note, we increment i within the loop.</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == -1) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> value = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], start_index = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">for</span> (; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; dim &amp;&amp; indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == value; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> end_index = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;  <span class="comment">// one past the end.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// the input &#39;indexes&#39; contains a sequence of possibly-repeated instances of</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// the value &#39;value&#39;, starting at index &#39;start_index&#39;, with &#39;end_index&#39; as</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// one past the end.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_num_segments_seen = num_segments_seen[value]++;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (this_num_segments_seen &gt;= num_output_vectors) {  <span class="comment">// we have nowhere to</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                                                         <span class="comment">// put it.</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      indexes_out-&gt;resize(++num_output_vectors);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      indexes_out-&gt;back().resize(dim, -1);  <span class="comment">// fill newly added vector with -1&#39;s.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    std::vector&lt;int32&gt; &amp;this_out_vec((*indexes_out)[this_num_segments_seen]);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    std::vector&lt;int32&gt;::iterator iter = this_out_vec.begin() + start_index,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        end = this_out_vec.begin() + end_index;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// Fill the appropriate range of the output vector with &#39;value&#39;</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter) *iter = value;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4c1330ecd1ee31afb2214977a2a88e10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ErrorContext </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a string used in error messages. </p>
<p>Here, "is" will be from an istringstream derived from a single line or part of a line. If "is" is at EOF or in error state, this should just say "end of line", else if the contents of "is" before EOF is &lt;20 characters it should return it all, else it should return the first 20 characters followed by "...". </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00429">429</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                                       {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordflow">if</span> (!is.good()) <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of line&quot;</span>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">char</span> buf[21];</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  is.read(buf, 21);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordflow">if</span> (is) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">return</span> (std::string(buf, 20) + <span class="stringliteral">&quot;...&quot;</span>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordflow">return</span> std::string(buf, is.gcount());</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2904394bf025a2757bd2ab32f2caea36"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string ErrorContext </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00439">439</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                             {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordflow">if</span> (str.size() == 0) <span class="keywordflow">return</span> <span class="stringliteral">&quot;end of line&quot;</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">if</span> (str.size() &lt;= 20) <span class="keywordflow">return</span> str;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keywordflow">return</span> std::string(str, 0, 20) + <span class="stringliteral">&quot;...&quot;</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5683058729bb42a5e8462f9912484050"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EvaluateComputationRequest </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; bool &gt; &gt; *&#160;</td>
          <td class="paramname"><em>is_computable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given an nnet and a computation request, this function works out which requested outputs in the computation request are computable; it outputs this information as a vector "is_computable" indexed by the same indexes as request.outputs. </p>
<p>It does this by executing some of the early stages of compilation. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00064">64</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation-graph_8cc_source.html#l00428">ComputationGraphBuilder::Compute()</a>, <a class="el" href="nnet-computation-graph_8cc_source.html#l00723">ComputationGraphBuilder::GetComputableInfo()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00050">Nnet::GetNodeNames()</a>, <a class="el" href="kaldi-error_8h_source.html#l00060">kaldi::GetVerboseLevel()</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, and <a class="el" href="nnet-computation-graph_8cc_source.html#l00155">ComputationGraph::Print()</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00082">ComputeSimpleNnetContextForShift()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                                {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  ComputationGraph graph;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  ComputationGraphBuilder builder(nnet, request, &amp;graph);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  builder.Compute();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  builder.GetComputableInfo(is_computable);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 2) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    std::ostringstream graph_pretty;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    graph.Print(graph_pretty, nnet.GetNodeNames());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(2) &lt;&lt; <span class="stringliteral">&quot;Graph is &quot;</span> &lt;&lt; graph_pretty.str();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gae77f5cf98f18f8cbe207690e49da166e"><div class="ttname"><a href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">kaldi::GetVerboseLevel</a></div><div class="ttdeci">int32 GetVerboseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00060">kaldi-error.h:60</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7a54fa7479670b5b34951fdacd2c9b1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ExampleApproxEqual </td>
          <td>(</td>
          <td class="paramtype">const NnetExample &amp;&#160;</td>
          <td class="paramname"><em>eg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetExample &amp;&#160;</td>
          <td class="paramname"><em>eg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the examples are approximately equal (only intended to be used in testing). </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l01207">1207</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00722">GeneralMatrix::GetMatrix()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, and <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-test_8cc_source.html#l00035">UnitTestNnetExample()</a>.</p>
<div class="fragment"><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                         {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  <span class="keywordflow">if</span> (eg1.io.size() != eg2.io.size())</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; eg1.io.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    NnetIo io1 = eg1.io[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], io2 = eg2.io[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordflow">if</span> (io1.name != io2.name || io1.indexes != io2.indexes)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    Matrix&lt;BaseFloat&gt; feat1, feat2;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    io1.features.GetMatrix(&amp;feat1);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    io2.features.GetMatrix(&amp;feat2);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(feat1, feat2, delta))</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  }</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9d34dcbb48b22bb0c34f699721b33bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ExpectOneOrTwoTokens </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>token1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>token2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is like ExpectToken but for two tokens, and it will either accept token1 and then token2, or just token2. </p>
<p>This is useful in Read functions where the first token may already have been consumed. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00202">202</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor_8cc_source.html#l00045">ExpectToken()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="io-funcs_8cc_source.html#l00154">kaldi::ReadToken()</a>.</p>

<p>Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00072">PnormComponent::Read()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00234">DistributeComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00224">ElementwiseProductComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00264">NormalizeComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00144">SumReduceComponent::Read()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00293">NonlinearComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02357">FixedAffineComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02433">SumGroupComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02646">FixedScaleComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02719">FixedBiasComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00443">ClipGradientComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04325">PermuteComponent::Read()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l04230">MaxpoolingComponent::Read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                                   {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(token1 != token2);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  std::string temp;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="group__io__funcs__basic.html#gacbf9367cd910befefa0bc98055979bea">ReadToken</a>(is, binary, &amp;temp);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">if</span> (temp == token1) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, token2);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (temp != token2) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expecting token &quot;</span> &lt;&lt; token1 &lt;&lt; <span class="stringliteral">&quot; or &quot;</span> &lt;&lt; token2</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; but got &quot;</span> &lt;&lt; temp;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="ttc" id="group__io__funcs__basic_html_gacbf9367cd910befefa0bc98055979bea"><div class="ttname"><a href="group__io__funcs__basic.html#gacbf9367cd910befefa0bc98055979bea">kaldi::ReadToken</a></div><div class="ttdeci">void ReadToken(std::istream &amp;is, bool binary, std::string *str)</div><div class="ttdoc">ReadToken gets the next token and puts it in str (exception on failure). </div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00154">io-funcs.cc:154</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga4c7a80f758e878578e78b667f62463a5"><div class="ttname"><a href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">kaldi::ExpectToken</a></div><div class="ttdeci">void ExpectToken(std::istream &amp;is, bool binary, const char *token)</div><div class="ttdoc">ExpectToken tries to read in the given token, and throws an exception on failure. ...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00188">io-funcs.cc:188</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41114607233f11aab89539abf08cf922"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ExpectToken </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>what_we_are_parsing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string **&#160;</td>
          <td class="paramname"><em>next_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor_8cc_source.html#l00045">45</a> of file <a class="el" href="nnet-descriptor_8cc_source.html">nnet-descriptor.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00029">ParsingContext()</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse_8cc_source.html#l00202">ExpectOneOrTwoTokens()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00474">GeneralDescriptor::Parse()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00551">GeneralDescriptor::ParseFailover()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00544">GeneralDescriptor::ParseIfDefined()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00560">GeneralDescriptor::ParseOffset()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00586">GeneralDescriptor::ParseReplaceIndex()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00576">GeneralDescriptor::ParseRound()</a>, <a class="el" href="am-nnet-simple_8cc_source.html#l00047">AmNnetSimple::Read()</a>, <a class="el" href="nnet-common_8cc_source.html#l00036">Index::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00072">PnormComponent::Read()</a>, <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00038">NnetIo::Read()</a>, <a class="el" href="nnet-general-component_8cc_source.html#l00234">DistributeComponent::Read()</a>, <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00103">NnetExample::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00224">ElementwiseProductComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00264">NormalizeComponent::Read()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00565">Nnet::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00144">SumReduceComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00835">AffineComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01191">RepeatedAffineComponent::Read()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00293">NonlinearComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01585">BlockAffineComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01976">NaturalGradientAffineComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02357">FixedAffineComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02646">FixedScaleComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02719">FixedBiasComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00443">ClipGradientComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04325">PermuteComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01768">PerElementScaleComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01923">PerElementOffsetComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02726">NaturalGradientPerElementScaleComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03447">ConvolutionComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03955">Convolutional1dComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04230">MaxpoolingComponent::Read()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l04475">CompositeComponent::Read()</a>, and <a class="el" href="nnet-common_8cc_source.html#l00135">ReadIndexVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                      {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (**next_token != token)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected &#39;&quot;</span> &lt;&lt; token &lt;&lt; <span class="stringliteral">&quot;&#39; while parsing &quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;              &lt;&lt; what_we_are_parsing &lt;&lt; <span class="stringliteral">&quot;, got &quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;              &lt;&lt; **next_token &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#aa3fbd67899f39d18e85c03f06e0c69bf">ParsingContext</a>(*next_token);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">else</span>  <span class="comment">// advance token pointer.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    (*next_token)++;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa3fbd67899f39d18e85c03f06e0c69bf"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa3fbd67899f39d18e85c03f06e0c69bf">kaldi::nnet3::ParsingContext</a></div><div class="ttdeci">static std::string ParsingContext(const std::string *token_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00029">nnet-descriptor.cc:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3395b82092a47a75b581f5f4a55a503"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::ExtractGivenPairsFromSubmatLists </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt;::iterator &gt; &amp;&#160;</td>
          <td class="paramname"><em>input_iterator_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>list_of_pairs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00203">203</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">SplitLocationsUsingSubmatHistogram()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                      {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  list_of_pairs-&gt;reserve(sorted_submat_lists-&gt;size());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input_iterator_list.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordflow">if</span> (input_iterator_list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != (*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end()) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="comment">// there was an element with the submat_index in the current list</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      list_of_pairs-&gt;push_back(*input_iterator_list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      (*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].erase(input_iterator_list[i]);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">// insert a dummy element. Callers of this function expect the dummy</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="comment">// element to be (-1, -1)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      list_of_pairs-&gt;push_back(std::make_pair(-1, -1));</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a078fe7414bf11ee4f33567cb85b2b202"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ExtractLastPairFromSubmatLists </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>list_of_pairs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00224">224</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">SplitLocationsUsingSubmatHistogram()</a>.</p>
<div class="fragment"><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                                      {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  list_of_pairs-&gt;reserve(sorted_submat_lists-&gt;size());</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sorted_submat_lists-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> ((*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size() == 0)  {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// the value of the dummy has to be (-1, -1) as down stream code has</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="comment">// expects -1 values for dummies</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      list_of_pairs-&gt;push_back(std::make_pair(-1, -1));</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    list_of_pairs-&gt;push_back((*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].back());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    (*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].pop_back();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae235076d32848d3ce99ecd4a763e0961"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::FilterExample </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>min_input_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_input_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>min_output_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_output_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *&#160;</td>
          <td class="paramname"><em>eg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function filters the indexes (and associated feature rows) in a <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a>, removing any index/row in an <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> named "input" with t &lt; min_input_t or t &gt; max_input_t and any index/row in an <a class="el" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> named "output" with t &lt; min_output_t or t &gt; max_output_t. </p>
<p>Will crash if filtering removes all Indexes of "input" or "output". </p>

<p>Definition at line <a class="el" href="nnet3-copy-egs_8cc_source.html#l00111">111</a> of file <a class="el" href="nnet3-copy-egs_8cc_source.html">nnet3-copy-egs.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00990">kaldi::FilterGeneralMatrixRows()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>, and <a class="el" href="sparse-matrix_8cc_source.html#l00687">GeneralMatrix::NumRows()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-copy-egs_8cc_source.html#l00188">SelectFromExample()</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  eg_out-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.clear();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  eg_out-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.resize(eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.size());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">bool</span> is_input_or_output;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_t, max_t;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keyword">const</span> <a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> &amp;io_in = eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a> &amp;io_out = eg_out-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> std::string &amp;name = io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">name</a> = name;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;input&quot;</span>) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      min_t = min_input_t;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      max_t = max_input_t;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      is_input_or_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (name == <span class="stringliteral">&quot;output&quot;</span>) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      min_t = min_output_t;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      max_t = max_output_t;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      is_input_or_output = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      is_input_or_output = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (!is_input_or_output) {  <span class="comment">// Just copy everything.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a> = io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a> = io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;indexes_in = io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      std::vector&lt;Index&gt; &amp;indexes_out = io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">indexes</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      indexes_out.reserve(indexes_in.size());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_indexes = indexes_in.size(), num_kept = 0;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a>.<a class="code" href="classkaldi_1_1GeneralMatrix.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == num_indexes);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      std::vector&lt;bool&gt; keep(num_indexes, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      std::vector&lt;Index&gt;::const_iterator iter_in = indexes_in.begin(),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                          end_in = indexes_in.end();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      std::vector&lt;bool&gt;::iterator iter_out = keep.begin();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="keywordflow">for</span> (; iter_in != end_in; ++iter_in,++iter_out) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = iter_in-&gt;t;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordtype">bool</span> is_within_range = (t &gt;= min_t &amp;&amp; t &lt;= max_t);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        *iter_out = is_within_range;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (is_within_range) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;          indexes_out.push_back(*iter_in);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          num_kept++;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      }</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(iter_out == keep.end());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="keywordflow">if</span> (num_kept == 0)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;FilterExample removed all indexes for &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <a class="code" href="group__matrix__group.html#gad382f719d6c9fb0f63e78f686c8a04b8">FilterGeneralMatrixRows</a>(io_in.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a>, keep,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                              &amp;io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a>);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io_out.<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">features</a>.<a class="code" href="classkaldi_1_1GeneralMatrix.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == num_kept &amp;&amp;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                   indexes_out.size() == <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(num_kept));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  }</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html">kaldi::nnet3::NnetIo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00033">nnet-example.h:33</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html_a84345a57ee4e5dade232e7af464ea151"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html#a84345a57ee4e5dade232e7af464ea151">kaldi::nnet3::NnetIo::features</a></div><div class="ttdeci">GeneralMatrix features</div><div class="ttdoc">The features or labels. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00046">nnet-example.h:46</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html_aa3daaa77b972f8dace077e94b418aab1"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html#aa3daaa77b972f8dace077e94b418aab1">kaldi::nnet3::NnetIo::indexes</a></div><div class="ttdeci">std::vector&lt; Index &gt; indexes</div><div class="ttdoc">&quot;indexes&quot; is a vector the same length as features.NumRows(), explaining the meaning of each row of th...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00042">nnet-example.h:42</a></div></div>
<div class="ttc" id="group__matrix__group_html_gad382f719d6c9fb0f63e78f686c8a04b8"><div class="ttname"><a href="group__matrix__group.html#gad382f719d6c9fb0f63e78f686c8a04b8">kaldi::FilterGeneralMatrixRows</a></div><div class="ttdeci">void FilterGeneralMatrixRows(const GeneralMatrix &amp;in, const std::vector&lt; bool &gt; &amp;keep_rows, GeneralMatrix *out)</div><div class="ttdoc">Outputs a GeneralMatrix containing only the rows r of &quot;in&quot; such that keep_rows[r] == true...</div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8cc_source.html#l00990">sparse-matrix.cc:990</a></div></div>
<div class="ttc" id="classkaldi_1_1GeneralMatrix_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1GeneralMatrix.html#ab204078beff8151c95d1828544acf92c">kaldi::GeneralMatrix::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8cc_source.html#l00687">sparse-matrix.cc:687</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html_a9b45b3e13bd9167aab02e17e08916231"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html#a9b45b3e13bd9167aab02e17e08916231">kaldi::nnet3::NnetIo::name</a></div><div class="ttdeci">std::string name</div><div class="ttdoc">the name of the input in the neural net; in simple setups it will just be &quot;input&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00036">nnet-example.h:36</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_acfc99ed8d51e6726a7c4e888afebc910"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">kaldi::nnet3::NnetExample::io</a></div><div class="ttdeci">std::vector&lt; NnetIo &gt; io</div><div class="ttdoc">&quot;io&quot; contains the input and output. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00087">nnet-example.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae72c79fbb6ec81b69aaee02701fa23e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FindSccs </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sccs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a directed graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming from the current node), partition it into strongly connected components (i.e. </p>
<p>within each SCC, all nodes are reachable from all other nodes). </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00156">156</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-graph_8cc_source.html#l00138">FindSccsTarjan()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00160">UnitTestFindSccs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="comment">// Internally we call Tarjan&#39;s SCC algorithm, as it only requires one DFS. We</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <span class="comment">// can change this to other methods later on if necessary.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sccs != NULL);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aee48ed6add62e6cef7918e3f6a94ffc7">FindSccsTarjan</a>(graph, sccs);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aee48ed6add62e6cef7918e3f6a94ffc7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aee48ed6add62e6cef7918e3f6a94ffc7">kaldi::nnet3::FindSccsTarjan</a></div><div class="ttdeci">void FindSccsTarjan(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00138">nnet-graph.cc:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee48ed6add62e6cef7918e3f6a94ffc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::FindSccsTarjan </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sccs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00138">138</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, and <a class="el" href="nnet-graph_8cc_source.html#l00085">TarjanSccRecursive()</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00156">FindSccs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                                        {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sccs != NULL);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// Initialization.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  std::vector&lt;TarjanNode&gt; tarjan_nodes(graph.size());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  std::vector&lt;int32&gt; tarjan_stack;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> global_index = 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Calls the recursive function.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; graph.size(); ++<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">if</span> (tarjan_nodes[<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>].index == -1) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a145f09473f55df6f338ac4d69cff8bf1">TarjanSccRecursive</a>(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>, graph,</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                         &amp;global_index, &amp;tarjan_nodes, &amp;tarjan_stack, sccs);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a145f09473f55df6f338ac4d69cff8bf1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a145f09473f55df6f338ac4d69cff8bf1">kaldi::nnet3::TarjanSccRecursive</a></div><div class="ttdeci">void TarjanSccRecursive(int32 node, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, int32 *global_index, std::vector&lt; TarjanNode &gt; *tarjan_nodes, std::vector&lt; int32 &gt; *tarjan_stack, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00085">nnet-graph.cc:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abff8a093b516f579b1bce94a954f6e7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::FindSubmatIndexInSubmatLists </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>submat_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt;::iterator &gt; *&#160;</td>
          <td class="paramname"><em>output_iterator_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>max_remaining_submat_list_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00167">167</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">SplitLocationsUsingSubmatHistogram()</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                           {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  output_iterator_list-&gt;reserve(sorted_submat_lists-&gt;size());</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  *max_remaining_submat_list_size = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sorted_submat_lists-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    std::vector&lt; std::pair&lt;int32, int32&gt; &gt; &amp; submat_list =</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        (*sorted_submat_lists)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    output_iterator_list-&gt;push_back(</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        std::find_if(submat_list.begin(), submat_list.end(),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                     FirstElementIsEqualComparator(submat_index)));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> remaining_submat_list_size = submat_list.size();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span>  (output_iterator_list-&gt;back() != submat_list.end())  {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="comment">// since the submat_index is present in this submat_list</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="comment">// if submat_index was deleted from the list</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="comment">// the remaining submat_list&#39;s size is reduced by 1</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      remaining_submat_list_size--;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    *max_remaining_submat_list_size = remaining_submat_list_size</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                      &gt; *max_remaining_submat_list_size ? remaining_submat_list_size :</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                      *max_remaining_submat_list_size;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a6ec6b257d100e7dab22ce3feac226f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenerateConfigSequence </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a sequence of at least one config files, output as strings, where the first in the sequence is the initial nnet, and the remaining ones may do things like add layers. </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00717">717</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8h_source.html#l00034">NnetGenerationOptions::allow_context</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00035">NnetGenerationOptions::allow_nonlinearity</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00036">NnetGenerationOptions::allow_recursion</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00612">GenerateConfigSequenceCnn()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00644">GenerateConfigSequenceCnn2d()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00692">GenerateConfigSequenceDistribute()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00317">GenerateConfigSequenceLstm()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00166">GenerateConfigSequenceRnn()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00225">GenerateConfigSequenceRnnClockwork()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00093">GenerateConfigSequenceSimple()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00053">GenerateConfigSequenceSimpleContext()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00032">GenerateConfigSequenceSimplest()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze-test_8cc_source.html#l00039">UnitTestNnetAnalyze()</a>, <a class="el" href="nnet-compile-test_8cc_source.html#l00028">UnitTestNnetCompile()</a>, <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00040">UnitTestNnetCompute()</a>, <a class="el" href="nnet-utils-test_8cc_source.html#l00027">UnitTestNnetContext()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00258">UnitTestNnetInputDerivatives()</a>, <a class="el" href="nnet3_2nnet-nnet-test_8cc_source.html#l00027">UnitTestNnetIo()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>, and <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                                   {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;start:</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> network_type = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 9);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <span class="keywordflow">switch</span>(network_type) {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a3855432311c60a3aba3f3ef77871a9eb">GenerateConfigSequenceSimplest</a>(opts, configs);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_context)</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a020e04f5594e00affc4c2bf231687e65">GenerateConfigSequenceSimpleContext</a>(opts, configs);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_context || !opts.allow_nonlinearity)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a51af5c2c6da3b32c75666de9852dc74c">GenerateConfigSequenceSimple</a>(opts, configs);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_recursion || !opts.allow_context ||</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          !opts.allow_nonlinearity)</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a380783b4b5f4a192930cb5e5b00d0143">GenerateConfigSequenceRnn</a>(opts, configs);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_recursion || !opts.allow_context ||</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          !opts.allow_nonlinearity)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a410289847ba049a50141e38f95d4a3c5">GenerateConfigSequenceRnnClockwork</a>(opts, configs);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_recursion || !opts.allow_context ||</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;          !opts.allow_nonlinearity)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#aa50641f28c6aecba5e74d7604b4ef650">GenerateConfigSequenceLstm</a>(opts, configs);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_recursion || !opts.allow_context ||</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          !opts.allow_nonlinearity)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#aa50641f28c6aecba5e74d7604b4ef650">GenerateConfigSequenceLstm</a>(opts, configs);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">case</span> 7:</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_nonlinearity)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a44d5ec3eab77bbbf0f6a9140db62e0bd">GenerateConfigSequenceCnn</a>(opts, configs);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">case</span> 8:</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;      <span class="keywordflow">if</span> (!opts.allow_nonlinearity)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keywordflow">goto</span> start;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a25050645b405ce2101222c55aaa3154f">GenerateConfigSequenceCnn2d</a>(opts, configs);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">case</span> 9:</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a3855b8fdbe81b37928ccc530d22b91a3">GenerateConfigSequenceDistribute</a>(opts, configs);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error generating config sequence.&quot;</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa50641f28c6aecba5e74d7604b4ef650"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa50641f28c6aecba5e74d7604b4ef650">kaldi::nnet3::GenerateConfigSequenceLstm</a></div><div class="ttdeci">void GenerateConfigSequenceLstm(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00317">nnet-test-utils.cc:317</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a410289847ba049a50141e38f95d4a3c5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a410289847ba049a50141e38f95d4a3c5">kaldi::nnet3::GenerateConfigSequenceRnnClockwork</a></div><div class="ttdeci">void GenerateConfigSequenceRnnClockwork(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00225">nnet-test-utils.cc:225</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a020e04f5594e00affc4c2bf231687e65"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a020e04f5594e00affc4c2bf231687e65">kaldi::nnet3::GenerateConfigSequenceSimpleContext</a></div><div class="ttdeci">void GenerateConfigSequenceSimpleContext(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00053">nnet-test-utils.cc:53</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a25050645b405ce2101222c55aaa3154f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a25050645b405ce2101222c55aaa3154f">kaldi::nnet3::GenerateConfigSequenceCnn2d</a></div><div class="ttdeci">void GenerateConfigSequenceCnn2d(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00644">nnet-test-utils.cc:644</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a3855b8fdbe81b37928ccc530d22b91a3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a3855b8fdbe81b37928ccc530d22b91a3">kaldi::nnet3::GenerateConfigSequenceDistribute</a></div><div class="ttdeci">void GenerateConfigSequenceDistribute(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00692">nnet-test-utils.cc:692</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a380783b4b5f4a192930cb5e5b00d0143"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a380783b4b5f4a192930cb5e5b00d0143">kaldi::nnet3::GenerateConfigSequenceRnn</a></div><div class="ttdeci">void GenerateConfigSequenceRnn(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00166">nnet-test-utils.cc:166</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a44d5ec3eab77bbbf0f6a9140db62e0bd"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a44d5ec3eab77bbbf0f6a9140db62e0bd">kaldi::nnet3::GenerateConfigSequenceCnn</a></div><div class="ttdeci">void GenerateConfigSequenceCnn(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00612">nnet-test-utils.cc:612</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a3855432311c60a3aba3f3ef77871a9eb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a3855432311c60a3aba3f3ef77871a9eb">kaldi::nnet3::GenerateConfigSequenceSimplest</a></div><div class="ttdeci">void GenerateConfigSequenceSimplest(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00032">nnet-test-utils.cc:32</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a51af5c2c6da3b32c75666de9852dc74c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a51af5c2c6da3b32c75666de9852dc74c">kaldi::nnet3::GenerateConfigSequenceSimple</a></div><div class="ttdeci">void GenerateConfigSequenceSimple(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00093">nnet-test-utils.cc:93</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a44d5ec3eab77bbbf0f6a9140db62e0bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceCnn </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00612">612</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                   {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pool_stride = 5 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10, pool_size = 2 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        num_pools = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_patches = num_pools * pool_size;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> patch_step = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 4, patch_dim = 4 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a> () % 5,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        patch_stride = (num_patches - 1) * patch_step + patch_dim;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_splice = 5 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10, num_filters = pool_stride;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = patch_stride * num_splice,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        hidden_dim = num_patches * num_filters,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        output_dim = num_pools * pool_stride;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=conv type=Convolutional1dComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; patch-dim=&quot;</span> &lt;&lt; patch_dim &lt;&lt; <span class="stringliteral">&quot; patch-step=&quot;</span> &lt;&lt; patch_step</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; patch-stride=&quot;</span> &lt;&lt; patch_stride &lt;&lt; std::endl;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=maxpooling type=MaxpoolingComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; pool-size=&quot;</span> &lt;&lt; pool_size &lt;&lt; <span class="stringliteral">&quot; pool-stride=&quot;</span> &lt;&lt; pool_stride</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=conv_node component=conv input=input\n&quot;</span>;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=maxpooling_node component=maxpooling input=conv_node\n&quot;</span>;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=maxpooling_node\n&quot;</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25050645b405ce2101222c55aaa3154f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceCnn2d </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00644">644</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                   {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_x_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        input_y_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        input_z_dim = 3 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        filt_x_dim = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % input_x_dim,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        filt_y_dim = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % input_y_dim,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        num_filters = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        filt_x_step = (1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % filt_x_dim),</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        filt_y_step = (1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % filt_y_dim);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> remainder = (input_x_dim - filt_x_dim) % filt_x_step;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// adjusting input_x_dim to ensure divisibility</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  input_x_dim = input_x_dim - remainder;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  remainder = (input_y_dim - filt_y_dim) % filt_y_step;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="comment">// adjusting input_x_dim to ensure divisibility</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  input_y_dim = input_y_dim - remainder;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_vectorization = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  std::string vectorization;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">if</span> (input_vectorization == 0) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    vectorization = <span class="stringliteral">&quot;yzx&quot;</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    vectorization = <span class="stringliteral">&quot;zyx&quot;</span>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=conv type=ConvolutionComponent &quot;</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-x-dim=&quot;</span> &lt;&lt; input_x_dim</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-y-dim=&quot;</span> &lt;&lt; input_y_dim</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-z-dim=&quot;</span> &lt;&lt; input_z_dim</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; filt-x-dim=&quot;</span> &lt;&lt; filt_x_dim</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; filt-y-dim=&quot;</span> &lt;&lt; filt_y_dim</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; filt-x-step=&quot;</span> &lt;&lt; filt_x_step</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; filt-y-step=&quot;</span> &lt;&lt; filt_y_step</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; num-filters=&quot;</span> &lt;&lt; num_filters</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-vectorization-order=&quot;</span> &lt;&lt; vectorization</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; (input_x_dim * input_y_dim * input_z_dim) &lt;&lt; std::endl;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=conv_node component=conv input=input\n&quot;</span>;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=conv_node\n&quot;</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3855b8fdbe81b37928ccc530d22b91a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceDistribute </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00692">692</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                                   {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = (opts.output_dim &gt; 0 ? opts.output_dim : 100);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> x_expand = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 5), after_expand_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(10, 20),</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      input_dim = x_expand * after_expand_dim;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=distribute type=DistributeComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;     &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; after_expand_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=distribute component=distribute input=input\n&quot;</span>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine type=AffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;     &lt;&lt; after_expand_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine component=affine input=distribute\n&quot;</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=Sum(&quot;</span>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; x_expand; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; 0) os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;ReplaceIndex(affine, x, &quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa50641f28c6aecba5e74d7604b4ef650"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceLstm </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00317">317</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                   {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200),</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      cell_dim = 40 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      projection_dim = std::ceil(cell_dim / (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 1));</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">// Parameter Definitions W*(* replaced by - to have valid names)</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">// Input gate control : Wi* matrices</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wi-xr type=NaturalGradientAffineComponent&quot;</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; spliced_dim + projection_dim</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wic type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// Forget gate control : Wf* matrices</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wf-xr type=NaturalGradientAffineComponent&quot;</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; spliced_dim + projection_dim</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wfc type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// Output gate control : Wo* matrices</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wo-xr type=NaturalGradientAffineComponent&quot;</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; spliced_dim + projection_dim</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Woc type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// Cell input matrices : Wc* matrices</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wc-xr type=NaturalGradientAffineComponent&quot;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; spliced_dim + projection_dim</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">// projection matrices : Wrm and Wpm</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=W-m type=NaturalGradientAffineComponent &quot;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; cell_dim</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; 2 * projection_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">// Output : Wyr and Wyp</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wy- type=NaturalGradientAffineComponent &quot;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * projection_dim</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">// Defining the diagonal matrices</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">// Defining the final affine transform</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine type=NaturalGradientAffineComponent &quot;</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=LogSoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Defining the non-linearities</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">//  declare a no-op component so that we can use a sum descriptor&#39;s output</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">//  multiple times, and to make the config more readable given the equations</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=i type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=f type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=o type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=g type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=h type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=c1 type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=c2 type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=m type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="comment">// Defining the computations</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  std::ostringstream temp_string_stream;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    temp_string_stream &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      temp_string_stream &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  std::string spliced_input = temp_string_stream.str();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  std::string c_tminus1 = <span class="stringliteral">&quot;Sum(IfDefined(Offset(c1_t, -1)), IfDefined(Offset( c2_t, -1)))&quot;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// i_t</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=i1 component=Wi-xr input=Append(&quot;</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;     &lt;&lt; spliced_input &lt;&lt; <span class="stringliteral">&quot;, IfDefined(Offset(r_t, -1)))\n&quot;</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=i2 component=Wic &quot;</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input=&quot;</span> &lt;&lt; c_tminus1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=i_t component=i input=Sum(i1, i2)\n&quot;</span>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">// f_t</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=f1 component=Wf-xr input=Append(&quot;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;     &lt;&lt; spliced_input &lt;&lt; <span class="stringliteral">&quot;, IfDefined(Offset(r_t, -1)))\n&quot;</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=f2 component=Wfc &quot;</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input=&quot;</span> &lt;&lt; c_tminus1 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=f_t component=f input=Sum(f1, f2)\n&quot;</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// o_t</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=o1 component=Wo-xr input=Append(&quot;</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;     &lt;&lt; spliced_input &lt;&lt; <span class="stringliteral">&quot;, IfDefined(Offset(r_t, -1)))\n&quot;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=o2 component=Woc input=Sum(c1_t, c2_t)\n&quot;</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=o_t component=o input=Sum(o1, o2)\n&quot;</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// h_t</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=h_t component=h input=Sum(c1_t, c2_t)\n&quot;</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">// g_t</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=g1 component=Wc-xr input=Append(&quot;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;     &lt;&lt; spliced_input &lt;&lt; <span class="stringliteral">&quot;, IfDefined(Offset(r_t, -1)))\n&quot;</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=g_t component=g input=g1\n&quot;</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// parts of c_t</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=c1_t component=c1 &quot;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input=Append(f_t, &quot;</span> &lt;&lt; c_tminus1 &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=c2_t component=c2 input=Append(i_t, g_t)\n&quot;</span>;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="comment">// m_t</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=m_t component=m input=Append(o_t, h_t)\n&quot;</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// r_t and p_t</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=rp_t component=W-m input=m_t\n&quot;</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// Splitting outputs of Wy- node</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=r_t input-node=rp_t dim-offset=0 &quot;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; projection_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// y_t</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=y_t component=Wy- input=rp_t\n&quot;</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">// Final affine transform</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine component=final_affine input=y_t\n&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=posteriors component=logsoftmax input=final_affine\n&quot;</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=posteriors\n&quot;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a151e0713f1dd005df56e3c3c5bad845e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceLstmType2 </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00474">474</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                   {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Not Implemented&quot;</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200),</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      cell_dim = 40 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50,</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      projection_dim = std::ceil(cell_dim / (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 2));</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// Parameter Definitions W*(* replaced by - to have valid names)</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=W-x type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     &lt;&lt; spliced_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; 4 * cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=W-r type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;     &lt;&lt; projection_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; 4 * cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=W-m type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     &lt;&lt; cell_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; 2 * projection_dim  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wyr type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;     &lt;&lt; projection_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wyp type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;     &lt;&lt; projection_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// Defining the diagonal matrices</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wic type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Wfc type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=Woc type=PerElementScaleComponent &quot;</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// Defining the final affine transform</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine type=NaturalGradientAffineComponent &quot;</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=LogSoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;     &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// Defining the non-linearities</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//  declare a no-op component so that we can use a sum descriptor&#39;s output</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="comment">//  multiple times, and to make the config more readable given the equations</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=c_t type=NoOpComponent dim=&quot;</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=i_t type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=f_t type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=o_t type=SigmoidComponent dim=&quot;</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=g type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=h type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;     &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=f_t-c_tminus1 type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=i_t-g type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=m_t type=ElementwiseProductComponent &quot;</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; input-dim=&quot;</span> &lt;&lt; 2 * cell_dim</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// Defining the computations</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=W-x component=W-x input=Append(&quot;</span>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=W-r component=W-r input=IfDefined(Offset(r_t, -1))\n&quot;</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=W-m component=W-m input=m_t \n&quot;</span>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=Wic component=Wic input=IfDefined(Offset(c_t, -1))\n&quot;</span>;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=Wfc component=Wfc input=IfDefined(Offset(c_t, -1))\n&quot;</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=Woc component=Woc input=c_t\n&quot;</span>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="comment">// Splitting the outputs of W*m node</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=r_t input-node=W-m dim-offset=0 &quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; projection_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=p_t input-node=W-m dim-offset=&quot;</span> &lt;&lt; projection_dim</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;     &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span> &lt;&lt; projection_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="comment">// Splitting outputs of W*x node</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_ix-x_t input-node=W-x dim-offset=0 &quot;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_fx-x_t input-node=W-x &quot;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_cx-x_t input-node=W-x &quot;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; 2 * cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_ox-x_t input-node=W-x &quot;</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; 3 * cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="comment">// Splitting outputs of W*r node</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_ir-r_tminus1 input-node=W-r dim-offset=0 &quot;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_fr-r_tminus1 input-node=W-r &quot;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_cr-r_tminus1 input-node=W-r &quot;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; 2 * cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;dim-range-node name=W_or-r_tminus1 input-node=W-r &quot;</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;     &lt;&lt; <span class="stringliteral">&quot;dim-offset=&quot;</span> &lt;&lt; 3 * cell_dim &lt;&lt; <span class="stringliteral">&quot; dim=&quot;</span>&lt;&lt;cell_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">// Non-linear operations</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=c_t component=c_t input=Sum(f_t-c_tminus1, i_t-g)\n&quot;</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=h component=h input=c_t\n&quot;</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=i_t component=i_t input=Sum(W_ix-x_t, Sum(W_ir-r_tminus1, Wic))\n&quot;</span>;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=f_t component=f_t input=Sum(W_fx-x_t, Sum(W_fr-r_tminus1, Wfc))\n&quot;</span>;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=o_t component=o_t input=Sum(W_ox-x_t, Sum(W_or-r_tminus1, Woc))\n&quot;</span>;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=f_t-c_tminus1 component=f_t-c_tminus1 input=Append(f_t, Offset(c_t, -1))\n&quot;</span>;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=i_t-g component=i_t-g input=Append(i_t, g)\n&quot;</span>;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=m_t component=m_t input=Append(o_t, h)\n&quot;</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=g component=g input=Sum(W_cx-x_t, W_cr-r_tminus1)\n&quot;</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="comment">// Final affine transform</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=Wyr component=Wyr input=r_t\n&quot;</span>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=Wyp component=Wyp input=p_t\n&quot;</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine component=final_affine input=Sum(Wyr, Wyp)\n&quot;</span>;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=posteriors component=logsoftmax input=final_affine\n&quot;</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=posteriors\n&quot;</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a380783b4b5f4a192930cb5e5b00d0143"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceRnn </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00166">166</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                   {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200),</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      hidden_dim = 40 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;     &lt;&lt; spliced_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;component name=nonlin1 type=RectifiedLinearComponent dim=&quot;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;       &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;component name=nonlin1 type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=recurrent_affine1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine2 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=LogSoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;     &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine1_node component=affine1 input=Append(&quot;</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=recurrent_affine1 component=recurrent_affine1 &quot;</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="stringliteral">&quot;input=Offset(nonlin1, -1)\n&quot;</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=nonlin1 component=nonlin1 &quot;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="stringliteral">&quot;input=Sum(affine1_node, IfDefined(recurrent_affine1))\n&quot;</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine2 component=affine2 input=nonlin1\n&quot;</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=output_nonlin component=logsoftmax input=affine2\n&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=output_nonlin\n&quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a410289847ba049a50141e38f95d4a3c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceRnnClockwork </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00225">225</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                   {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200),</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      hidden_dim = 40 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     &lt;&lt; spliced_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=nonlin1 type=RectifiedLinearComponent dim=&quot;</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=recurrent_affine1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// the suffix _0, _1, _2 equals the index of the output-frame modulo 3; there</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">// are 3 versions of the final affine layer.  There was a paper by Vincent</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// Vanhoucke about something like this.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine_0 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine_1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine_2 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=LogSoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;     &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine1_node component=affine1 input=Append(&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=recurrent_affine1 component=recurrent_affine1 &quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="stringliteral">&quot;input=Offset(nonlin1, -1)\n&quot;</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=nonlin1 component=nonlin1 &quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="stringliteral">&quot;input=Sum(affine1_node, IfDefined(recurrent_affine1))\n&quot;</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine_0 component=final_affine_0 input=nonlin1\n&quot;</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine_1 component=final_affine_1 input=Offset(nonlin1, -1)\n&quot;</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine_2 component=final_affine_2 input=Offset(nonlin1, 1)\n&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=output_nonlin component=logsoftmax input=Switch(final_affine_0, final_affine_1, final_affine_2)\n&quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=output_nonlin\n&quot;</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51af5c2c6da3b32c75666de9852dc74c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceSimple </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00093">93</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8h_source.html#l00040">NnetGenerationOptions::allow_final_nonlinearity</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                   {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      hidden_dim = 40 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordtype">bool</span> use_final_nonlinearity = (opts.allow_final_nonlinearity &amp;&amp;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                 <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine1 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     &lt;&lt; spliced_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=relu1 type=RectifiedLinearComponent dim=&quot;</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=final_affine type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;     &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="keywordflow">if</span> (use_final_nonlinearity) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=SoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;         &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;component name=logsoftmax type=LogSoftmaxComponent dim=&quot;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;         &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine1_node component=affine1 input=Append(&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=nonlin1 component=relu1 input=affine1_node\n&quot;</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine component=final_affine input=nonlin1\n&quot;</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span> (use_final_nonlinearity) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;component-node name=output_nonlin component=logsoftmax input=final_affine\n&quot;</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=output_nonlin\n&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=final_affine\n&quot;</span>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2) == 0) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    std::ostringstream os2;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component name=affine2 type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component name=relu2 type=RectifiedLinearComponent dim=&quot;</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        &lt;&lt; hidden_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// regenerate the final_affine component when we add the new config.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component name=final_affine type=NaturalGradientAffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        &lt;&lt; hidden_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component-node name=affine2 component=affine2 input=nonlin1\n&quot;</span>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component-node name=relu2 component=relu2 input=affine2\n&quot;</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    os2 &lt;&lt; <span class="stringliteral">&quot;component-node name=final_affine component=final_affine input=relu2\n&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    configs-&gt;push_back(os2.str());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a020e04f5594e00affc4c2bf231687e65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceSimpleContext </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00053">53</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                   {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  std::vector&lt;int32&gt; splice_context;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = -5; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 4; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      splice_context.push_back(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">if</span> (splice_context.empty())</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    splice_context.push_back(0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      spliced_dim = input_dim * splice_context.size(),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine1 type=AffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;     &lt;&lt; spliced_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine1_node component=affine1 input=Append(&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; splice_context.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = splice_context[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Offset(input, &quot;</span> &lt;&lt; offset &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; splice_context.size())</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=affine1_node\n&quot;</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3855432311c60a3aba3f3ef77871a9eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenerateConfigSequenceSimplest </td>
          <td>(</td>
          <td class="paramtype">const NnetGenerationOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>configs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00032">32</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8h_source.html#l00043">NnetGenerationOptions::output_dim</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                   {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      output_dim = (opts.output_dim &gt; 0 ?</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                    opts.output_dim :</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                    100 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 200);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component name=affine1 type=AffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;     &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;input-node name=input dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; std::endl;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;component-node name=affine1_node component=affine1 input=input\n&quot;</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;output-node name=output input=affine1_node\n&quot;</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  configs-&gt;push_back(os.str());</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb5a70eadfcda218c3833859bf7ceb27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::GenerateRandomComponentConfig </td>
          <td>(</td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>component_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l00835">835</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l01110">GenerateRandomSimpleComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                                             {</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 27);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> learning_rate = 0.001 * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 3);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">switch</span>(n) {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">case</span> 0: {</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      *component_type = <span class="stringliteral">&quot;PnormComponent&quot;</span>;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50), group_size = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15),</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;          input_dim = output_dim * group_size;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> target_rms = (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 200) / 100.0);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      *component_type = <span class="stringliteral">&quot;NormalizeComponent&quot;</span>;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50)</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; target-rms=&quot;</span> &lt;&lt; target_rms;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      *component_type = <span class="stringliteral">&quot;SigmoidComponent&quot;</span>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      *component_type = <span class="stringliteral">&quot;TanhComponent&quot;</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="keywordflow">case</span> 4: {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      *component_type = <span class="stringliteral">&quot;RectifiedLinearComponent&quot;</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">case</span> 5: {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      *component_type = <span class="stringliteral">&quot;SoftmaxComponent&quot;</span>;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">case</span> 6: {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      *component_type = <span class="stringliteral">&quot;LogSoftmaxComponent&quot;</span>;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">case</span> 7: {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      *component_type = <span class="stringliteral">&quot;NoOpComponent&quot;</span>;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">case</span> 8: {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      *component_type = <span class="stringliteral">&quot;FixedAffineComponent&quot;</span>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50), output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">case</span> 9: {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      *component_type = <span class="stringliteral">&quot;AffineComponent&quot;</span>;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50), output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">case</span> 10: {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      *component_type = <span class="stringliteral">&quot;NaturalGradientAffineComponent&quot;</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50), output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">case</span> 11: {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      *component_type = <span class="stringliteral">&quot;SumGroupComponent&quot;</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      std::vector&lt;int32&gt; sizes;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_groups = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;sizes=&quot;</span>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_groups; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        os &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 5);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; num_groups)</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          os &lt;&lt; <span class="charliteral">&#39;,&#39;</span>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">case</span> 12: {</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      *component_type = <span class="stringliteral">&quot;FixedScaleComponent&quot;</span>;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    }</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">case</span> 13: {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      *component_type = <span class="stringliteral">&quot;FixedBiasComponent&quot;</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keywordflow">case</span> 14: {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;      *component_type = <span class="stringliteral">&quot;NaturalGradientPerElementScaleComponent&quot;</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">case</span> 15: {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      *component_type = <span class="stringliteral">&quot;PerElementScaleComponent&quot;</span>;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100)</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">case</span> 16: {</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      *component_type = <span class="stringliteral">&quot;ElementwiseProductComponent&quot;</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100), multiple = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(2, 4),</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          input_dim = output_dim * multiple;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordflow">case</span> 17: {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      *component_type = <span class="stringliteral">&quot;Convolutional1dComponent&quot;</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> patch_stride = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 50, patch_step = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 4,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            patch_dim = 4 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a> () % 5;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;      <span class="comment">// decrease patch_stride so that</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      <span class="comment">// (patch_stride - patch_dim) % patch_step == 0</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      patch_stride = patch_stride - ((patch_stride - patch_dim) % patch_step);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_patches = 1 + (patch_stride - patch_dim) / patch_step;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_splice = 5 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10, num_filters = 5 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = patch_stride * num_splice;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = num_patches * num_filters;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; patch-dim=&quot;</span> &lt;&lt; patch_dim &lt;&lt; <span class="stringliteral">&quot; patch-step=&quot;</span> &lt;&lt; patch_step</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; patch-stride=&quot;</span> &lt;&lt; patch_stride</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">case</span> 18: {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_vectorization = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      std::string vectorization;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;      <span class="keywordflow">if</span> (input_vectorization == 0) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        vectorization = <span class="stringliteral">&quot;yzx&quot;</span>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      } <span class="keywordflow">else</span>  {</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        vectorization = <span class="stringliteral">&quot;zyx&quot;</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;      *component_type = <span class="stringliteral">&quot;ConvolutionComponent&quot;</span>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_x_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            input_y_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20,</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            input_z_dim = 3 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            filt_x_dim = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % input_x_dim,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            filt_y_dim = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % input_y_dim,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            num_filters = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            filt_x_step = (1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % filt_x_dim),</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            filt_y_step = (1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % filt_y_dim);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> remainder = (input_x_dim - filt_x_dim) % filt_x_step;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      <span class="comment">// adjusting input_x_dim to ensure divisibility</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      input_x_dim = input_x_dim - remainder;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      remainder = (input_y_dim - filt_y_dim) % filt_y_step;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <span class="comment">// adjusting input_x_dim to ensure divisibility</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      input_y_dim = input_y_dim - remainder;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-x-dim=&quot;</span> &lt;&lt; input_x_dim</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; input-y-dim=&quot;</span> &lt;&lt; input_y_dim</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; input-z-dim=&quot;</span> &lt;&lt; input_z_dim</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; filt-x-dim=&quot;</span> &lt;&lt; filt_x_dim</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; filt-y-dim=&quot;</span> &lt;&lt; filt_y_dim</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; filt-x-step=&quot;</span> &lt;&lt; filt_x_step</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; filt-y-step=&quot;</span> &lt;&lt; filt_y_step</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; num-filters=&quot;</span> &lt;&lt; num_filters</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; input-vectorization-order=&quot;</span> &lt;&lt; vectorization</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      <span class="comment">// TODO : add test for file based initialization. But confirm how to write</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="comment">// a file which is not going to be overwritten by other components</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    }</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">case</span> 19: {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      *component_type = <span class="stringliteral">&quot;MaxpoolingComponent&quot;</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pool_stride = 5 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10,</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      pool_size = 2 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3,</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      num_pools = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = num_pools * pool_stride;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_patches = num_pools * pool_size;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = pool_stride * num_patches;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; pool-size=&quot;</span> &lt;&lt; pool_size &lt;&lt; <span class="stringliteral">&quot; pool-stride=&quot;</span> &lt;&lt; pool_stride;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keywordflow">case</span> 20: {</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      *component_type = <span class="stringliteral">&quot;PermuteComponent&quot;</span>;</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = 10 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 100;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      std::vector&lt;int32&gt; column_map(input_dim);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input_dim; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        column_map[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      std::random_shuffle(column_map.begin(), column_map.end());</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      std::ostringstream buffer;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; input_dim-1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        buffer &lt;&lt; column_map[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      buffer &lt;&lt; column_map.back();</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;column-map=&quot;</span> &lt;&lt; buffer.str();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">case</span> 21: {</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      *component_type = <span class="stringliteral">&quot;PerElementOffsetComponent&quot;</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      std::string param_config = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1)?</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                                 <span class="stringliteral">&quot; param-mean=0.0 param-stddev=0.0&quot;</span>:</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                 <span class="stringliteral">&quot; param-mean=0.0 param-stddev=1.0&quot;</span>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;dim=&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100)</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; learning-rate=&quot;</span> &lt;&lt; learning_rate &lt;&lt; param_config;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">case</span> 22: {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      *component_type = <span class="stringliteral">&quot;SumReduceComponent&quot;</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50), group_size = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15),</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;          input_dim = output_dim * group_size;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">case</span> 23: {</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;      *component_type = <span class="stringliteral">&quot;CompositeComponent&quot;</span>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(20, 30), num_components = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 3),</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;          max_rows_process = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 30);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;num-components=&quot;</span> &lt;&lt; num_components</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; max-rows-process=&quot;</span> &lt;&lt; max_rows_process;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      std::vector&lt;std::string&gt; sub_configs;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;= num_components; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 3) == 1) {</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot; component&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;=&#39;type=RectifiedLinearComponent dim=&quot;</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;             &lt;&lt; cur_dim &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 2) == 1) {</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot; component&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;=&#39;type=TanhComponent dim=&quot;</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;             &lt;&lt; cur_dim &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> next_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(20, 30);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot; component&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;=&#39;type=AffineComponent input-dim=&quot;</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;             &lt;&lt; cur_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; next_dim &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          cur_dim = next_dim;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        }</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      }</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="keywordflow">case</span> 24: {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      *component_type = <span class="stringliteral">&quot;SumGroupComponent&quot;</span>;</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_groups = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50),</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        input_dim = num_groups * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; num_groups;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    <span class="keywordflow">case</span> 25: {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;      *component_type = <span class="stringliteral">&quot;RepeatedAffineComponent&quot;</span>;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_repeats = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50),</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          input_dim = num_repeats * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15),</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;          output_dim = num_repeats * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; num-repeats=&quot;</span> &lt;&lt; num_repeats;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">case</span> 26: {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      *component_type = <span class="stringliteral">&quot;BlockAffineComponent&quot;</span>;</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_blocks = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50),</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;          input_dim = num_blocks * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15),</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;          output_dim = num_blocks * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; num-blocks=&quot;</span> &lt;&lt; num_blocks;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">case</span> 27: {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;      *component_type = <span class="stringliteral">&quot;NaturalGradientRepeatedAffineComponent&quot;</span>;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_repeats = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 50),</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;          input_dim = num_repeats * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15),</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          output_dim = num_repeats * <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 15);</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;input-dim=&quot;</span> &lt;&lt; input_dim &lt;&lt; <span class="stringliteral">&quot; output-dim=&quot;</span> &lt;&lt; output_dim</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; num-repeats=&quot;</span> &lt;&lt; num_repeats;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error generating random component&quot;</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  *config = os.str();</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3dccdf514f810b334ee5baa954eb88f8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> * GenerateRandomSimpleComponent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates random simple component for testing. </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l01110">1110</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l00835">GenerateRandomComponentConfig()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a1f7dc9cc61293d3c7decb5bd8ea3f4d5">Component::InitFromConfig()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00051">Component::NewComponentOfType()</a>, and <a class="el" href="nnet-parse_8cc_source.html#l00031">ConfigLine::ParseLine()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                           {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  std::string component_type, config;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#afb5a70eadfcda218c3833859bf7ceb27">GenerateRandomComponentConfig</a>(&amp;component_type, &amp;config);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  ConfigLine config_line;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="keywordflow">if</span> (!config_line.ParseLine(config))</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad config line &quot;</span> &lt;&lt; config;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  Component *c = Component::NewComponentOfType(component_type);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keywordflow">if</span> (c == NULL)</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid component type &quot;</span> &lt;&lt; component_type;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  c-&gt;InitFromConfig(&amp;config_line);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordflow">return</span> c;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_afb5a70eadfcda218c3833859bf7ceb27"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#afb5a70eadfcda218c3833859bf7ceb27">kaldi::nnet3::GenerateRandomComponentConfig</a></div><div class="ttdeci">static void GenerateRandomComponentConfig(std::string *component_type, std::string *config)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00835">nnet-test-utils.cc:835</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8263b0802f12a823d6c072b53c4ee236"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenerateSimpleNnetTrainingExample </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_supervised_frames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>right_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>output_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>ivector_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetExample *&#160;</td>
          <td class="paramname"><em>example</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Low-level function that generates an nnet training example. </p>
<p>By "simple" we mean there is one output named "output", an input named "input", and possibly also an input named "ivector" (this will be assumed absent if ivector_dim &lt;= 0). This function generates exactly "left_context" or "right_context" frames of context on the left and right respectively. </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l01154">1154</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="sparse-matrix_8cc_source.html#l00708">GeneralMatrix::Compress()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="kaldi-math_8h_source.html#l00151">kaldi::RandUniform()</a>, and <a class="el" href="kaldi-matrix_8cc_source.html#l01202">MatrixBase&lt; Real &gt;::SetRandn()</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-test_8cc_source.html#l00035">UnitTestNnetExample()</a>, and <a class="el" href="nnet-example-test_8cc_source.html#l00067">UnitTestNnetMergeExamples()</a>.</p>
<div class="fragment"><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;                          {</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_supervised_frames &gt; 0 &amp;&amp; left_context &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;               right_context &gt;= 0 &amp;&amp; output_dim &gt; 0 &amp;&amp; input_dim &gt; 0</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;               &amp;&amp; example != NULL);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  example-&gt;io.clear();</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> feature_t_begin = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 2);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_feat_frames = left_context + right_context + num_supervised_frames;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  Matrix&lt;BaseFloat&gt; input_mat(num_feat_frames, input_dim);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  input_mat.SetRandn();</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  NnetIo input_feat(<span class="stringliteral">&quot;input&quot;</span>, feature_t_begin, input_mat);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    input_feat.features.Compress();</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  example-&gt;io.push_back(input_feat);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">if</span> (ivector_dim &gt; 0) {</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// Create a feature for the iVectors.  iVectors always have t=0 in the</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="comment">// current framework.</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    Matrix&lt;BaseFloat&gt; ivector_mat(1, ivector_dim);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    ivector_mat.SetRandn();</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    NnetIo ivector_feat(<span class="stringliteral">&quot;ivector&quot;</span>, 0, ivector_mat);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      ivector_feat.features.Compress();</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    example-&gt;io.push_back(ivector_feat);</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  }</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  {  <span class="comment">// set up the output supervision.</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    <a class="code" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> labels(num_supervised_frames);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = 0; t &lt; num_supervised_frames; t++) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_labels = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 3);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> remaining_prob_mass = 1.0;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_labels; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> this_prob = (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1 == num_labels ? 1.0 : <a class="code" href="namespacekaldi.html#a0c4bcfc10bea5ed0d3e3cf6d74922121">RandUniform</a>()) *</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            remaining_prob_mass;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        remaining_prob_mass -= this_prob;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        labels[t].push_back(std::pair&lt;int32, BaseFloat&gt;(<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, output_dim-1),</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                                        this_prob));</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> supervision_t_begin = feature_t_begin + left_context;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    NnetIo output_sup(<span class="stringliteral">&quot;output&quot;</span>, output_dim, supervision_t_begin,</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                      labels);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    example-&gt;io.push_back(output_sup);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a0c4bcfc10bea5ed0d3e3cf6d74922121"><div class="ttname"><a href="namespacekaldi.html#a0c4bcfc10bea5ed0d3e3cf6d74922121">kaldi::RandUniform</a></div><div class="ttdeci">float RandUniform(struct RandomState *state=NULL)</div><div class="ttdoc">Returns a random number strictly between 0 and 1. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00151">kaldi-math.h:151</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__posterior__group_html_ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><div class="ttname"><a href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">kaldi::Posterior</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &gt; Posterior</div><div class="ttdoc">Posterior is a typedef for storing acoustic-state (actually, transition-id) posteriors over an uttera...</div><div class="ttdef"><b>Definition:</b> <a href="posterior_8h_source.html#l00042">posterior.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2465e8e47256304999d4cd892e7162b9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::GenRandDescriptor </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> *&#160;</td>
          <td class="paramname"><em>desc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00075">75</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor-test_8cc_source.html#l00057">GenRandSumDescriptor()</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00088">UnitTestDescriptorIo()</a>, and <a class="el" href="nnet-descriptor-test_8cc_source.html#l00134">UnitTestGeneralDescriptor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                         {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_parts = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  std::vector&lt;SumDescriptor*&gt; parts;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> part = 0; part &lt; num_parts; part++)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    parts.push_back(<a class="code" href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">GenRandSumDescriptor</a>(num_nodes));</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  *desc = <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a>(parts);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html">kaldi::nnet3::Descriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00429">nnet-descriptor.h:429</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae9b08e079998e1eea6db1c2b5a403a28"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">kaldi::nnet3::GenRandSumDescriptor</a></div><div class="ttdeci">SumDescriptor * GenRandSumDescriptor(int32 num_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00057">nnet-descriptor-test.cc:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afdefaf0453649dae0c96bf6cd516bd69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1ForwardingDescriptor.html">ForwardingDescriptor</a>* kaldi::nnet3::GenRandForwardingDescriptor </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00025">25</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00235">ReplaceIndexForwardingDescriptor::kT</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00235">ReplaceIndexForwardingDescriptor::kX</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00057">GenRandSumDescriptor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                                                   {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 != 0) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1SimpleForwardingDescriptor.html">SimpleForwardingDescriptor</a>(<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % num_nodes);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 4;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span> (r == 0) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1Index.html">Index</a> offset;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      offset.<a class="code" href="structkaldi_1_1nnet3_1_1Index.html#a5aa18a99c28265c00e81554208124038">t</a> = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 5;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      offset.<a class="code" href="structkaldi_1_1nnet3_1_1Index.html#aade28f62e276833462f1b79c4e41ec7e">x</a> = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">return</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;          <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1OffsetForwardingDescriptor.html">OffsetForwardingDescriptor</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a>(num_nodes),</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;                                         offset);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r == 1) {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      std::vector&lt;ForwardingDescriptor*&gt; vec;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        vec.push_back(<a class="code" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a>(num_nodes));</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1SwitchingForwardingDescriptor.html">SwitchingForwardingDescriptor</a>(vec);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r == 2) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1RoundingForwardingDescriptor.html">RoundingForwardingDescriptor</a>(</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;          <a class="code" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a>(num_nodes), 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 4);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1ReplaceIndexForwardingDescriptor.html">ReplaceIndexForwardingDescriptor</a>(</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <a class="code" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a>(num_nodes),</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;          (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0 ? ReplaceIndexForwardingDescriptor::kT :</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;           ReplaceIndexForwardingDescriptor::kX),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;          -2 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 4);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1SimpleForwardingDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1SimpleForwardingDescriptor.html">kaldi::nnet3::SimpleForwardingDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00129">nnet-descriptor.h:129</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_afdefaf0453649dae0c96bf6cd516bd69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">kaldi::nnet3::GenRandForwardingDescriptor</a></div><div class="ttdeci">ForwardingDescriptor * GenRandForwardingDescriptor(int32 num_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00025">nnet-descriptor-test.cc:25</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1RoundingForwardingDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1RoundingForwardingDescriptor.html">kaldi::nnet3::RoundingForwardingDescriptor</a></div><div class="ttdoc">For use in clockwork RNNs and the like, this forwarding-descriptor rounds the time-index t down to th...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00205">nnet-descriptor.h:205</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Index_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Index.html">kaldi::nnet3::Index</a></div><div class="ttdoc">struct Index is intended to represent the various indexes by which we number the rows of the matrices...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00044">nnet-common.h:44</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Index_html_aade28f62e276833462f1b79c4e41ec7e"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Index.html#aade28f62e276833462f1b79c4e41ec7e">kaldi::nnet3::Index::x</a></div><div class="ttdeci">int32 x</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00047">nnet-common.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1SwitchingForwardingDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1SwitchingForwardingDescriptor.html">kaldi::nnet3::SwitchingForwardingDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00176">nnet-descriptor.h:176</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OffsetForwardingDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OffsetForwardingDescriptor.html">kaldi::nnet3::OffsetForwardingDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00150">nnet-descriptor.h:150</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ReplaceIndexForwardingDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ReplaceIndexForwardingDescriptor.html">kaldi::nnet3::ReplaceIndexForwardingDescriptor</a></div><div class="ttdoc">This ForwardingDescriptor modifies the indexes (n, t, x) by replacing one of them (normally t) with a...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00233">nnet-descriptor.h:233</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Index_html_a5aa18a99c28265c00e81554208124038"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Index.html#a5aa18a99c28265c00e81554208124038">kaldi::nnet3::Index::t</a></div><div class="ttdeci">int32 t</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8h_source.html#l00046">nnet-common.h:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae9b08e079998e1eea6db1c2b5a403a28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkaldi_1_1nnet3_1_1SumDescriptor.html">SumDescriptor</a>* kaldi::nnet3::GenRandSumDescriptor </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_nodes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00057">57</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor-test_8cc_source.html#l00025">GenRandForwardingDescriptor()</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00396">BinarySumDescriptor::kFailover</a>, <a class="el" href="nnet-descriptor_8h_source.html#l00395">BinarySumDescriptor::kSum</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00075">GenRandDescriptor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                     {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 != 0) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">bool</span> not_required = (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 5 == 0);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">if</span> (not_required)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1OptionalSumDescriptor.html">OptionalSumDescriptor</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">GenRandSumDescriptor</a>(num_nodes));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1SimpleSumDescriptor.html">SimpleSumDescriptor</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">GenRandForwardingDescriptor</a>(num_nodes));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classkaldi_1_1nnet3_1_1BinarySumDescriptor.html">BinarySumDescriptor</a>((<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0 ? BinarySumDescriptor::kSum:</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                    BinarySumDescriptor::kFailover),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                                   <a class="code" href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">GenRandSumDescriptor</a>(num_nodes),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                   <a class="code" href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">GenRandSumDescriptor</a>(num_nodes));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OptionalSumDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OptionalSumDescriptor.html">kaldi::nnet3::OptionalSumDescriptor</a></div><div class="ttdoc">This is the case of class SumDescriptor, in which we contain just one term, and that term is optional...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00330">nnet-descriptor.h:330</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1BinarySumDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1BinarySumDescriptor.html">kaldi::nnet3::BinarySumDescriptor</a></div><div class="ttdoc">BinarySumDescriptor can represent either A + B, or (A if defined, else B). </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00392">nnet-descriptor.h:392</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_afdefaf0453649dae0c96bf6cd516bd69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#afdefaf0453649dae0c96bf6cd516bd69">kaldi::nnet3::GenRandForwardingDescriptor</a></div><div class="ttdeci">ForwardingDescriptor * GenRandForwardingDescriptor(int32 num_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00025">nnet-descriptor-test.cc:25</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1SimpleSumDescriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1SimpleSumDescriptor.html">kaldi::nnet3::SimpleSumDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00360">nnet-descriptor.h:360</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae9b08e079998e1eea6db1c2b5a403a28"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae9b08e079998e1eea6db1c2b5a403a28">kaldi::nnet3::GenRandSumDescriptor</a></div><div class="ttdeci">SumDescriptor * GenRandSumDescriptor(int32 num_nodes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00057">nnet-descriptor-test.cc:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a66f879097cf9cba7482bad03a4030f72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetComputationRequest </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetExample &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>need_model_derivative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>store_component_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComputationRequest *&#160;</td>
          <td class="paramname"><em>computation_request</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html" title="NnetExample is the input data and corresponding label (or labels) for one or more frames of input...">NnetExample</a> (which should already have been frame-selected, if desired, and merged into a minibatch) and produces a <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a>. </p>
<p>It ssumes you don't want the derivatives w.r.t. the inputs; if you do, you can create/modify the <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> manually. Assumes that if need_model_derivative is true, you will be supplying derivatives w.r.t. all outputs. </p>

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00187">187</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00444">Nnet::GetNodeIndex()</a>, <a class="el" href="nnet-computation_8h_source.html#l00072">IoSpecification::has_deriv</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="nnet-computation_8h_source.html#l00071">IoSpecification::indexes</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00107">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>, <a class="el" href="nnet-computation_8h_source.html#l00070">IoSpecification::name</a>, <a class="el" href="nnet-computation_8h_source.html#l00110">ComputationRequest::need_model_derivative</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, and <a class="el" href="nnet-computation_8h_source.html#l00115">ComputationRequest::store_component_stats</a>.</p>

<p>Referenced by <a class="el" href="nnet3-acc-lda-stats_8cc_source.html#l00038">NnetLdaStatsAccumulator::AccStats()</a>, <a class="el" href="nnet3-compute-from-egs_8cc_source.html#l00039">NnetComputerFromEg::Compute()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00060">NnetComputeProb::Compute()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00047">NnetTrainer::Train()</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                        {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  request-&gt;inputs.clear();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  request-&gt;inputs.reserve(eg.io.size());</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  request-&gt;outputs.clear();</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  request-&gt;outputs.reserve(eg.io.size());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  request-&gt;need_model_derivative = need_model_derivative;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  request-&gt;store_component_stats = store_component_stats;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; eg.io.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">const</span> NnetIo &amp;io = eg.io[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">const</span> std::string &amp;name = io.name;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node_index = nnet.GetNodeIndex(name);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (node_index == -1 &amp;&amp;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        !nnet.IsInputNode(node_index) &amp;&amp; !nnet.IsOutputNode(node_index))</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Nnet example has input or output named &#39;&quot;</span> &lt;&lt; name</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;&#39;, but no such input or output node is in the network.&quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    std::vector&lt;IoSpecification&gt; &amp;dest =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        nnet.IsInputNode(node_index) ? request-&gt;inputs : request-&gt;outputs;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    dest.resize(dest.size() + 1);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    IoSpecification &amp;io_spec = dest.back();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    io_spec.name = name;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    io_spec.indexes = io.indexes;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    io_spec.has_deriv = nnet.IsOutputNode(node_index) &amp;&amp; need_model_derivative;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// check to see if something went wrong.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="keywordflow">if</span> (request-&gt;inputs.empty())</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No inputs in computation request.&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordflow">if</span> (request-&gt;outputs.empty())</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No outputs in computation request.&quot;</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a270955c18c82f5de1e707ec094998283"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::GetCount </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>expected_count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-copy-egs_8cc_source.html#l00032">32</a> of file <a class="el" href="nnet3-copy-egs_8cc_source.html">nnet3-copy-egs.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00076">kaldi::WithProb()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-copy-egs_8cc_source.html#l00250">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                      {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(expected_count &gt;= 0.0);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = floor(expected_count);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  expected_count -= ans;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a418c782c2df97dc179125ae5ad950338">WithProb</a>(expected_count))</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    ans++;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a418c782c2df97dc179125ae5ad950338"><div class="ttname"><a href="namespacekaldi.html#a418c782c2df97dc179125ae5ad950338">kaldi::WithProb</a></div><div class="ttdeci">bool WithProb(BaseFloat prob, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00076">kaldi-math.cc:76</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2e3228381d1a400e113f12dffce84ec0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::GetIndexesMultiStrings </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>indexes_multi_strings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation_8cc_source.html#l00189">189</a> of file <a class="el" href="nnet-computation_8cc_source.html">nnet-computation.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00231">NnetComputation::SubMatrixInfo::col_offset</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00289">NnetComputation::indexes_multi</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, <a class="el" href="nnet-computation_8h_source.html#l00228">NnetComputation::SubMatrixInfo::matrix_index</a>, <a class="el" href="nnet-computation_8h_source.html#l00216">NnetComputation::MatrixInfo::num_cols</a>, <a class="el" href="nnet-computation_8h_source.html#l00232">NnetComputation::SubMatrixInfo::num_cols</a>, <a class="el" href="nnet-computation_8h_source.html#l00215">NnetComputation::MatrixInfo::num_rows</a>, <a class="el" href="nnet-computation_8h_source.html#l00230">NnetComputation::SubMatrixInfo::num_rows</a>, <a class="el" href="nnet-computation_8h_source.html#l00229">NnetComputation::SubMatrixInfo::row_offset</a>, and <a class="el" href="nnet-computation_8h_source.html#l00273">NnetComputation::submatrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00416">NnetComputation::GetCommandStrings()</a>, and <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                 {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> indexes_multi_size = computation.indexes_multi.size();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  indexes_multi_strings-&gt;resize(indexes_multi_size);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indexes_multi_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keyword">const</span> std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &amp;vec =</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        computation.indexes_multi[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = vec.size();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; size; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submat_index = vec[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first, row_index = vec[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordflow">if</span> (submat_index == -1) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;NULL&quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keyword">const</span> NnetComputation::SubMatrixInfo &amp;submat =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            computation.submatrices[submat_index];</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keyword">const</span> NnetComputation::MatrixInfo &amp;mat =</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            computation.matrices[submat.matrix_index];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> row = row_index + submat.row_offset;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> col_start = submat.col_offset,</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            col_end = col_start + submat.num_cols;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (!(row_index &lt; submat.num_rows &amp;&amp;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              row &lt; mat.num_rows)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Invalid indexes in indexes-multi[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;: submatrix &quot;</span> &lt;&lt; submat_index &lt;&lt; <span class="stringliteral">&quot; = m&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                     &lt;&lt; submat.matrix_index &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; submat.row_offset</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                     &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; (submat.row_offset + submat.num_rows - 1)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                     &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; submat.col_offset &lt;&lt; <span class="charliteral">&#39;:&#39;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                     &lt;&lt; (submat.col_offset + submat.num_cols - 1) &lt;&lt; <span class="stringliteral">&quot;) has &quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                     &lt;&lt; submat.num_rows &lt;&lt; <span class="stringliteral">&quot; rows, but you access row &quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                     &lt;&lt; row_index;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">if</span> (col_start == 0 &amp;&amp; col_end == mat.num_cols)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;          os &lt;&lt; <span class="charliteral">&#39;m&#39;</span> &lt;&lt; submat.matrix_index &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; row &lt;&lt; <span class="stringliteral">&quot;,:)&quot;</span>;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;          os &lt;&lt; <span class="charliteral">&#39;m&#39;</span> &lt;&lt; submat.matrix_index &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; row &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; col_start</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;             &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; (col_end - 1) &lt;&lt; <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + 1 &lt; size) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    (*indexes_multi_strings)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = os.str();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69c7aa23d0e3d87413ce4de4be66f7a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::GetIndexesStrings </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>indexes_strings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation_8cc_source.html#l00175">175</a> of file <a class="el" href="nnet-computation_8cc_source.html">nnet-computation.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00284">NnetComputation::indexes</a>, and <a class="el" href="nnet-common_8cc_source.html#l00259">PrintIntegerVector()</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00416">NnetComputation::GetCommandStrings()</a>, and <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>.</p>
<div class="fragment"><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                                                                     {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = computation.indexes.size();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  indexes_strings-&gt;resize(size);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a91ad7b2e440d9b50c196a361f559a427">PrintIntegerVector</a>(os, computation.indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    (*indexes_strings)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = os.str();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a91ad7b2e440d9b50c196a361f559a427"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a91ad7b2e440d9b50c196a361f559a427">kaldi::nnet3::PrintIntegerVector</a></div><div class="ttdeci">void PrintIntegerVector(std::ostream &amp;os, const std::vector&lt; int32 &gt; &amp;ints)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00259">nnet-common.cc:259</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f2093173e902d1445fcd80def82ea4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::GetIoNames </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; NnetExample &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>names_vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00031">31</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00098">kaldi::CopySetToVector()</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-utils_8cc_source.html#l00147">MergeExamples()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                             {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  std::set&lt;std::string&gt; names;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  std::vector&lt;NnetExample&gt;::const_iterator iter = src.begin(), end = src.end();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    std::vector&lt;NnetIo&gt;::const_iterator iter2 = iter-&gt;io.begin(),</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                                         end2 = iter-&gt;io.end();</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordflow">for</span> (; iter2 != end2; ++iter2)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      names.insert(iter2-&gt;name);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="namespacekaldi.html#afaa2d6854352e931e19778f6f8608f2a">CopySetToVector</a>(names, names_vec);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_afaa2d6854352e931e19778f6f8608f2a"><div class="ttname"><a href="namespacekaldi.html#afaa2d6854352e931e19778f6f8608f2a">kaldi::CopySetToVector</a></div><div class="ttdeci">void CopySetToVector(const std::set&lt; T &gt; &amp;s, std::vector&lt; T &gt; *v)</div><div class="ttdoc">Copies the elements of a set to a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00098">stl-utils.h:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9cffcda7d561b7a342c1e268364e7583"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::GetIoSizes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; NnetExample &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>sizes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00047">47</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>, <a class="el" href="sparse-matrix_8cc_source.html#l00697">GeneralMatrix::NumCols()</a>, and <a class="el" href="sparse-matrix_8cc_source.html#l00687">GeneralMatrix::NumRows()</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-utils_8cc_source.html#l00147">MergeExamples()</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  std::vector&lt;int32&gt; dims(names.size(), -1);  <span class="comment">// just for consistency checking.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  sizes-&gt;clear();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  sizes-&gt;resize(names.size(), 0);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  std::vector&lt;std::string&gt;::const_iterator names_begin = names.begin(),</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                             names_end = names.end();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  std::vector&lt;NnetExample&gt;::const_iterator iter = src.begin(), end = src.end();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    std::vector&lt;NnetIo&gt;::const_iterator iter2 = iter-&gt;io.begin(),</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                                         end2 = iter-&gt;io.end();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">for</span> (; iter2 != end2; ++iter2) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keyword">const</span> NnetIo &amp;io = *iter2;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      std::vector&lt;std::string&gt;::const_iterator names_iter =</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          std::lower_bound(names_begin, names_end, io.name);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(*names_iter == io.name);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = names_iter - names_begin;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_dim = io.features.NumCols();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (dims[i] == -1)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        dims[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = this_dim;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dims[i] != this_dim) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Merging examples with inconsistent feature dims: &quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                  &lt;&lt; dims[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; this_dim &lt;&lt; <span class="stringliteral">&quot; for &#39;&quot;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                  &lt;&lt; io.name &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(io.features.NumRows() == io.indexes.size());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_size = io.indexes.size();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      (*sizes)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] += this_size;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86704308a1467b6000867cc9ed198482"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="structkaldi_1_1nnet3_1_1NnetComputation_1_1SubMatrixInfo.html">NnetComputation::SubMatrixInfo</a> kaldi::nnet3::GetSubMatrixOfSubMatrix </td>
          <td>(</td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>submat_a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>submat_b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This static function returns a SubMatrixInfo corresponding to replacing the matrix-index in a's "matrix_index" with, essentially, sub-matrix b. </p>
<p>Of course the matrix_index will be b's "matrix_index", but we may have to modify the row and column offsets. The idea is that sub-matrix submat_b should have the same dimensions as the matrix underlying submat_a. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00773">773</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00231">NnetComputation::SubMatrixInfo::col_offset</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, <a class="el" href="nnet-computation_8h_source.html#l00228">NnetComputation::SubMatrixInfo::matrix_index</a>, <a class="el" href="nnet-computation_8h_source.html#l00216">NnetComputation::MatrixInfo::num_cols</a>, <a class="el" href="nnet-computation_8h_source.html#l00232">NnetComputation::SubMatrixInfo::num_cols</a>, <a class="el" href="nnet-computation_8h_source.html#l00215">NnetComputation::MatrixInfo::num_rows</a>, <a class="el" href="nnet-computation_8h_source.html#l00230">NnetComputation::SubMatrixInfo::num_rows</a>, <a class="el" href="nnet-computation_8h_source.html#l00229">NnetComputation::SubMatrixInfo::row_offset</a>, and <a class="el" href="nnet-computation_8h_source.html#l00273">NnetComputation::submatrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00900">VariableMergingOptimizer::DoLeftMerge()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00803">VariableMergingOptimizer::DoRightMerge()</a>.</p>
<div class="fragment"><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                                                                        {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(submat_a) &lt; computation.submatrices.size());</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(submat_b) &lt; computation.submatrices.size());</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keyword">const</span> NnetComputation::SubMatrixInfo &amp;a = computation.submatrices[submat_a],</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                       &amp;b = computation.submatrices[submat_b];</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <span class="keyword">const</span> NnetComputation::MatrixInfo &amp;a_mat =</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      computation.matrices[a.matrix_index];</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(a_mat.num_rows == b.num_rows &amp;&amp; a_mat.num_cols == b.num_cols);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  NnetComputation::SubMatrixInfo ans;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  ans.matrix_index = b.matrix_index;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  ans.row_offset = a.row_offset + b.row_offset;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  ans.num_rows = a.num_rows;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  ans.col_offset = a.col_offset + b.col_offset;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  ans.num_cols = a.num_cols;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae892457066e9b2ac1632188de1aa06f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool HasContiguousProperty </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>reverse_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns true if for each integer i != -1, all the indexes j at which indexes[j] == i are consecutive with no gaps (more formally: if j1 &lt; j2 &lt; j3 and indexes[j1] != -1 and indexes[j1] == indexes[j3], then indexes[j1] == indexes[j2]). </p>
<p>For example, the vector [ 1 2 1 ] lacks the contiguous property because 1 appears in two places with a different number in the middle. If the vector has the contiguous property, this function also outputs to "reverse_indexes" the begin and end of these ranges, so that indexes[j] == i for all j such that (*reverse_indexes)[i].first &lt;= j &amp;&amp; j &lt; (*reverse_indexes)[i].second. </p>

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00523">523</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00618">Compiler::DoBackwardComputationFromIndexes()</a>, <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00222">UnitTestEnsureContiguousProperty()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00185">UnitTestHasContiguousProperty()</a>.</p>
<div class="fragment"><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                                                        {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  reverse_indexes-&gt;clear();</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_indexes = indexes.size();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">if</span> (num_indexes == 0)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_input_indexes =</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      *std::max_element(indexes.begin(), indexes.end()) + 1;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_input_indexes &gt;= 0);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="keywordflow">if</span> (num_input_indexes == 0) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// we don&#39;t really expect this input, filled with -1&#39;s.</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;HasContiguousProperty called on vector of -1&#39;s.&quot;</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  reverse_indexes-&gt;resize(num_input_indexes,</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                          std::pair&lt;int32,int32&gt;(-1, -1));</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// set each pair&#39;s &quot;first&quot; to the min index of all elements</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// of &quot;indexes&quot; with that value, and the &quot;second&quot; to the</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// max plus one.</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_indexes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> (j == -1) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(j &gt;= 0);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    std::pair&lt;int32, int32&gt; &amp;pair = (*reverse_indexes)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span> (pair.first == -1) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      pair.first = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      pair.second = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      pair.first = std::min(pair.first, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      pair.second = std::max(pair.second, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// check that the contiguous property holds.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_input_indexes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    std::pair&lt;int32, int32&gt; pair = (*reverse_indexes)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (pair.first != -1) {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = pair.first; j &lt; pair.second; j++)</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">if</span> (indexes[j] != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6950699c83d835e55f003f89bb92bc80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyIndexesArgs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NnetComputation::Command &gt; *&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>indexes_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies in the vector of commands, arguments that correspond to indexes into the computation's 'indexes' array, and outputs a list of pointers to those arguments to 'indexes_args'. </p>
<p>Useful in renumbering code. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00155">155</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00244">NnetComputation::Command::arg3</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kAddRows</a>, and <a class="el" href="nnet-computation_8h_source.html#l00205">kCopyRows</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00487">ComputationRenumberer::RenumberIndexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                                          {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  indexes_args-&gt;clear();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator iter = commands-&gt;begin(),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      end = commands-&gt;end();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    NnetComputation::Command &amp;command = *iter;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a> ||</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      indexes_args-&gt;push_back(&amp;(command.arg3));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af96b480d0b6d2b5890e1490f8c2e6ac0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyIndexesMultiArgs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NnetComputation::Command &gt; *&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>indexes_multi_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies in the vector of commands, arguments that correspond to indexes into the computation's indexes_multi array, and outputs a list of pointers to those arguments to 'indexes_multi_args'. </p>
<p>Useful in renumbering code. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00127">127</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddToRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyRowsMulti</a>, and <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyToRowsMulti</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00444">ComputationRenumberer::RemoveIndexesMultiDuplicates()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00408">ComputationRenumberer::RemoveUnusedIndexesMulti()</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                                                     {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  indexes_multi_args-&gt;clear();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator iter = commands-&gt;begin(),</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      end = commands-&gt;end();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    NnetComputation::Command &amp;command = *iter;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a> ||</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a> ||</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a> ||</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      indexes_multi_args-&gt;push_back(&amp;(command.arg2));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a17acd598bf1ced7e83e0c8a8569d224f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyIndexesRangesArgs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NnetComputation::Command &gt; *&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>indexes_ranges_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Identifies in the vector of commands, arguments that correspond to indexes into the computation's 'indexes_ranges' array, and outputs a list of pointers to those arguments to 'indexes_ranges_args'. </p>
<p>Useful in renumbering code. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00143">143</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00244">NnetComputation::Command::arg3</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, and <a class="el" href="nnet-computation_8h_source.html#l00207">kAddRowRanges</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00541">ComputationRenumberer::RenumberIndexesRanges()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                                                       {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  indexes_ranges_args-&gt;clear();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator iter = commands-&gt;begin(),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      end = commands-&gt;end();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    NnetComputation::Command &amp;command = *iter;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">if</span> (command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      indexes_ranges_args-&gt;push_back(&amp;(command.arg3));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kaldi::nnet3::kAddRowRanges</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada08c40c80a54a8a851448af83ada561"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyMatrixArgs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NnetComputation::Command &gt; *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>matrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "matrix_args" the addresses of a subset of the arguments arg1 through arg6 in commands in "commands", that correspond to the indexes of matrices. </p>
<p>This is useful in renumbering code. (Note: only a few types of command use matrix indexes). </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00090">90</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00105">IdentifyMatrixArgsInComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                                        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  matrix_args-&gt;clear();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator iter = commands-&gt;begin(),</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      end = commands-&gt;end();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  std::vector&lt;int32*&gt; this_matrix_args;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a15dd851f919e180bea3c3a1f60218d46">IdentifyMatrixArgs</a>(&amp;(*iter), &amp;this_matrix_args);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    matrix_args-&gt;insert(matrix_args-&gt;end(),</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        this_matrix_args.begin(),</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        this_matrix_args.end());</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a15dd851f919e180bea3c3a1f60218d46"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a15dd851f919e180bea3c3a1f60218d46">kaldi::nnet3::IdentifyMatrixArgs</a></div><div class="ttdeci">void IdentifyMatrixArgs(NnetComputation::Command *c, std::vector&lt; int32 * &gt; *matrix_args)</div><div class="ttdoc">This function outputs to &quot;matrix_args&quot; the addresses of a subset of the arguments arg1 through arg6 i...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l00170">nnet-optimize-utils.cc:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a15dd851f919e180bea3c3a1f60218d46"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyMatrixArgs </td>
          <td>(</td>
          <td class="paramtype">NnetComputation::Command *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>matrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "matrix_args" the addresses of a subset of the arguments arg1 through arg6 in "command", that correspond to the indexes of matrices. </p>
<p>This is useful in renumbering code. (Note: only a few types of command use matrix indexes). </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00170">170</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, and <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>.</p>
<div class="fragment"><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                                        {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  matrix_args-&gt;clear();</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">switch</span> (c-&gt;command_type) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>:</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>:</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      matrix_args-&gt;push_back(&amp;c-&gt;arg1);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>:</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>:</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      matrix_args-&gt;push_back(&amp;c-&gt;arg1);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      matrix_args-&gt;push_back(&amp;c-&gt;arg2);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a77e9698625c65ed53a8fb2eadc416110"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifyMatrixArgsInComputation </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_from_submatrices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>matrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "matrix_args" the addresses of indexes inside 'computation' that correspond to matrices. </p>
<p>These live inside computation-&gt;commands and computation-&gt;input_output_info; and if 'include_from_submatrices' is true, then the matrix-indexes present in computation-&gt;submatrices[*].matrix_index will be included too. Zeros may be present if there were optional arguments; we do include pointers to them, but you can just ignore them. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00105">105</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-optimize-utils_8cc_source.html#l00090">IdentifyMatrixArgs()</a>, <a class="el" href="nnet-computation_8h_source.html#l00300">NnetComputation::input_output_info</a>, and <a class="el" href="nnet-computation_8h_source.html#l00273">NnetComputation::submatrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00275">ComputationRenumberer::ComputeMatrixIsUsed()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00356">ComputationRenumberer::RenumberMatrices()</a>.</p>
<div class="fragment"><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                                                                     {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a15dd851f919e180bea3c3a1f60218d46">IdentifyMatrixArgs</a>(&amp;(computation-&gt;commands), matrix_args);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_submatrices = computation-&gt;submatrices.size();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  matrix_args-&gt;reserve(matrix_args-&gt;size() +</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                       (include_in_submatrices ?</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        computation-&gt;submatrices.size() : 0) +</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                       2 * computation-&gt;input_output_info.size());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">if</span> (include_in_submatrices)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> s = 1; s &lt; num_submatrices; s++)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      matrix_args-&gt;push_back(&amp;(computation-&gt;submatrices[s].matrix_index));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  unordered_map&lt;int32, std::pair&lt;int32, int32&gt; &gt;::iterator</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      iter = computation-&gt;input_output_info.begin(),</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      end = computation-&gt;input_output_info.end();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    matrix_args-&gt;push_back(&amp;(iter-&gt;second.first));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    matrix_args-&gt;push_back(&amp;(iter-&gt;second.second));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a15dd851f919e180bea3c3a1f60218d46"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a15dd851f919e180bea3c3a1f60218d46">kaldi::nnet3::IdentifyMatrixArgs</a></div><div class="ttdeci">void IdentifyMatrixArgs(NnetComputation::Command *c, std::vector&lt; int32 * &gt; *matrix_args)</div><div class="ttdoc">This function outputs to &quot;matrix_args&quot; the addresses of a subset of the arguments arg1 through arg6 i...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l00170">nnet-optimize-utils.cc:170</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ec833031232462f45b425a8a5503489"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifySubmatrixArgs </td>
          <td>(</td>
          <td class="paramtype">NnetComputation::Command *&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>submatrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "submatrix_args" the addresses of a subset of arguments arg1 through arg6 in "command", that correspond to the indexes of submatrices. </p>
<p>This is useful in renumbering code. Note: some of the pointers may point to a zero value, for optional submatrix args. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00029">29</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00244">NnetComputation::Command::arg3</a>, <a class="el" href="nnet-computation_8h_source.html#l00245">NnetComputation::Command::arg4</a>, <a class="el" href="nnet-computation_8h_source.html#l00246">NnetComputation::Command::arg5</a>, <a class="el" href="nnet-computation_8h_source.html#l00247">NnetComputation::Command::arg6</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kAddRowRanges</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kAddRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddToRowsMulti</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackprop</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackpropNoModelUpdate</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kCopyRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyToRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixAdd</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixCopy</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperation</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperationMarker</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kPropagate</a>, and <a class="el" href="nnet-computation_8h_source.html#l00204">kStoreStats</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00075">IdentifySubmatrixArgs()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00230">IdentifySubmatrixArgsInComputation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                                              {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  submatrix_args-&gt;clear();</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">switch</span> (c-&gt;command_type) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>:</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>:</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>:</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>:</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>:</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kPropagate</a>:</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg3);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg4);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kStoreStats</a>:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg2);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a>:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kBackpropNoModelUpdate</a>:</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg3);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg4);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg5);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg6);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>:</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>:</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>:</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg1);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg2);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>:</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>:</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>:</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      submatrix_args-&gt;push_back(&amp;c-&gt;arg1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>:</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kNoOperationMarker</a>:</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unknown command type.&quot;</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kaldi::nnet3::kMatrixCopy</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kaldi::nnet3::kMatrixAdd</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kaldi::nnet3::kNoOperationMarker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kaldi::nnet3::kBackpropNoModelUpdate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kaldi::nnet3::kBackprop</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kaldi::nnet3::kPropagate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kaldi::nnet3::kStoreStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kaldi::nnet3::kAddRowRanges</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aac8664deabb618f4c3dc3d99d8462ea1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifySubmatrixArgs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; NnetComputation::Command &gt; *&#160;</td>
          <td class="paramname"><em>commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>submatrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "submatrix_args" the addresses of the args (arguments arg1 through arg6) in the vector "commands", that correspond to the indexes of submatrices. </p>
<p>This is useful in renumbering code. Note: some of the pointers may point to a zero value, for optional submatrix args. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00075">75</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize-utils_8cc_source.html#l00029">IdentifySubmatrixArgs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                                                              {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  submatrix_args-&gt;clear();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator iter = commands-&gt;begin(),</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      end = commands-&gt;end();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  std::vector&lt;int32*&gt; this_submatrix_args;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aac8664deabb618f4c3dc3d99d8462ea1">IdentifySubmatrixArgs</a>(&amp;(*iter), &amp;this_submatrix_args);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    submatrix_args-&gt;insert(submatrix_args-&gt;end(),</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                           this_submatrix_args.begin(),</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                           this_submatrix_args.end());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aac8664deabb618f4c3dc3d99d8462ea1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aac8664deabb618f4c3dc3d99d8462ea1">kaldi::nnet3::IdentifySubmatrixArgs</a></div><div class="ttdeci">void IdentifySubmatrixArgs(std::vector&lt; NnetComputation::Command &gt; *commands, std::vector&lt; int32 * &gt; *submatrix_args)</div><div class="ttdoc">This function outputs to &quot;submatrix_args&quot; the addresses of the args (arguments arg1 through arg6) in ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l00075">nnet-optimize-utils.cc:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af87da4e8a0e1880438bf77e8a34b4143"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void IdentifySubmatrixArgsInComputation </td>
          <td>(</td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 * &gt; *&#160;</td>
          <td class="paramname"><em>submatrix_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function outputs to "submatrix_args" the addresses of integers in 'computation' that correspond to submatrices. </p>
<p>These may be present in 'commands', and in 'indexes_multi'. This is useful in renumbering code. Note: some of the pointers may point to a zero value, for optional submatrix args in commands, but for efficiency we don't provide pointers for the -1's in 'indexes_multi'. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00230">230</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-optimize-utils_8cc_source.html#l00029">IdentifySubmatrixArgs()</a>, and <a class="el" href="nnet-computation_8h_source.html#l00289">NnetComputation::indexes_multi</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00251">ComputationRenumberer::ComputeSubmatrixIsUsed()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00330">ComputationRenumberer::RenumberSubmatrices()</a>.</p>
<div class="fragment"><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                                                           {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aac8664deabb618f4c3dc3d99d8462ea1">IdentifySubmatrixArgs</a>(&amp;(computation-&gt;commands), submatrix_args);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">size_t</span> extra_size = 0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; computation-&gt;indexes_multi.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    extra_size += computation-&gt;indexes_multi[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  submatrix_args-&gt;reserve(submatrix_args-&gt;size() + extra_size);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; computation-&gt;indexes_multi.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &amp;indexes_multi =</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        computation-&gt;indexes_multi[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        iter = indexes_multi.begin(), end = indexes_multi.end();</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;first != -1)</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        submatrix_args-&gt;push_back(&amp;(iter-&gt;first));</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aac8664deabb618f4c3dc3d99d8462ea1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aac8664deabb618f4c3dc3d99d8462ea1">kaldi::nnet3::IdentifySubmatrixArgs</a></div><div class="ttdeci">void IdentifySubmatrixArgs(std::vector&lt; NnetComputation::Command &gt; *commands, std::vector&lt; int32 * &gt; *submatrix_args)</div><div class="ttdoc">This function outputs to &quot;submatrix_args&quot; the addresses of the args (arguments arg1 through arg6) in ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l00075">nnet-optimize-utils.cc:75</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a79ed08ad0dcf1b82a23e4e3c96967502"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::IndexesMultiToSubmatrixIndexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes_multi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>submatrix_indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>given a vector of pairs from computation.indexes_multi_indexes containing paris (submatrix-index, row-index), this function outputs to "submatrix_indexes" all (unique) submatrix indexes that appear; and it outputs to "contains_null_marker" true if the pair (-1, -1) appears anywhere in indexes_multi, and false otherwise. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00247">247</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze_8cc_source.html#l00267">ComputeCommandAttributes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                         {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  submatrix_indexes-&gt;clear();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      iter = indexes_multi.begin(), end = indexes_multi.end();</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_submatrix_index = -1; <span class="comment">// an optimization.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> submatrix_index = iter-&gt;first;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (submatrix_index != -1 &amp;&amp; submatrix_index != cur_submatrix_index) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      cur_submatrix_index = submatrix_index;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      submatrix_indexes-&gt;push_back(submatrix_index);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(submatrix_indexes);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a672e127a288d02b4a8e292b86aadfc04"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsSimpleNnet </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns true if the nnet has the following properties: It has one output, called "output". </p>
<p>It has an input called "input", and possibly an extra input called "ivector", but no other inputs. There are probably some other properties that we really ought to be checking, and we may add more later on. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00042">42</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00444">Nnet::GetNodeIndex()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00107">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00033">NumInputNodes()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00025">NumOutputNodes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00129">ComputeSimpleNnetContext()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00027">NnetDecodableBase::NnetDecodableBase()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00362">NnetInfo()</a>, and <a class="el" href="am-nnet-simple_8cc_source.html#l00096">AmNnetSimple::SetContext()</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// check that we have just one output node and it is</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// called &quot;output&quot;.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#ab0c3bad5386ea02d61e9596ba76b77eb">NumOutputNodes</a>(nnet) != 1 ||</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      nnet.GetNodeIndex(<span class="stringliteral">&quot;output&quot;</span>) == -1 ||</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      !nnet.IsOutputNode(nnet.GetNodeIndex(<span class="stringliteral">&quot;output&quot;</span>)))</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">// check that there is an input node named &quot;input&quot;.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (nnet.GetNodeIndex(<span class="stringliteral">&quot;input&quot;</span>) == -1 ||</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      !nnet.IsInputNode(nnet.GetNodeIndex(<span class="stringliteral">&quot;input&quot;</span>)))</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// if there was just one input, then it was named</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// &quot;input&quot; and everything checks out.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#a2ce1aea23a558c0461ff1ab72f41ebb6">NumInputNodes</a>(nnet) == 1)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">// Otherwise, there should be 2 inputs and one</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">// should be called &quot;ivector&quot;.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a2ce1aea23a558c0461ff1ab72f41ebb6">NumInputNodes</a>(nnet) == 2 &amp;&amp;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      nnet.GetNodeIndex(<span class="stringliteral">&quot;ivector&quot;</span>) != -1 &amp;&amp;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      nnet.IsInputNode(nnet.GetNodeIndex(<span class="stringliteral">&quot;ivector&quot;</span>));</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2ce1aea23a558c0461ff1ab72f41ebb6"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2ce1aea23a558c0461ff1ab72f41ebb6">kaldi::nnet3::NumInputNodes</a></div><div class="ttdeci">int32 NumInputNodes(const Nnet &amp;nnet)</div><div class="ttdoc">returns the number of input nodes of this nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00033">nnet-utils.cc:33</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ab0c3bad5386ea02d61e9596ba76b77eb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ab0c3bad5386ea02d61e9596ba76b77eb">kaldi::nnet3::NumOutputNodes</a></div><div class="ttdeci">int32 NumOutputNodes(const Nnet &amp;nnet)</div><div class="ttdoc">returns the number of output nodes of this nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00025">nnet-utils.cc:25</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a30e2d3a7507084b838f420b5e10b37f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool IsValidName </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if 'name' would be a valid name for a component or node in a <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a>. </p>
<p>This is a nonempty string beginning with A-Za-z_, and containing only -_A-Za-z0-9. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00403">403</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00031">ConfigLine::ParseLine()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00464">Nnet::RemoveRedundantConfigLines()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00096">SimpleForwardingDescriptor::WriteConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                                        {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordflow">if</span> (name.size() == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; name.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; !isalpha(name[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]) &amp;&amp; name[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != <span class="charliteral">&#39;_&#39;</span>)</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (!isalnum(name[i]) &amp;&amp; name[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != <span class="charliteral">&#39;_&#39;</span> &amp;&amp; name[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != <span class="charliteral">&#39;-&#39;</span>)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04165cf9403194c5a77e922f8f14d5f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> kaldi::nnet3::KlDivergence </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-am-adjust-priors_8cc_source.html#l00031">31</a> of file <a class="el" href="nnet3-am-adjust-priors_8cc_source.html">nnet3-am-adjust-priors.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="kaldi-math_8h_source.html#l00100">kaldi::Log()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-am-adjust-priors_8cc_source.html#l00048">PrintPriorDiagnostics()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                   {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> sum_p = p.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>(), sum_q = q.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordflow">if</span> (fabs(sum_p - 1.0) &gt; 0.01 || fabs(sum_q - 1.0) &gt; 0.01) {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;KlDivergence: vectors are not close to being normalized &quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;               &lt;&lt; sum_p &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; sum_q;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  }</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(p.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() == q.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">double</span> ans = 0.0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; p.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> p_prob = p(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) / sum_p, q_prob = q(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) / sum_q;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    ans += p_prob * <a class="code" href="namespacekaldi.html#af75c4606b108091c348102660de63180">Log</a>(p_prob / q_prob);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_af75c4606b108091c348102660de63180"><div class="ttname"><a href="namespacekaldi.html#af75c4606b108091c348102660de63180">kaldi::Log</a></div><div class="ttdeci">double Log(double x)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00100">kaldi-math.h:100</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adbc06e3c26b68f19c01aad13eeb95205"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::LimitDerivativeTimes </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetOptimizeOptions &amp;&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This optimization, which has no effect unless you set &ndash;min-deriv-time or &ndash;max-deriv-time, modifies the backprop operations for efficiency based on the assumption that derivatives for any Cindex with t &lt; min_deriv_time or t &gt; max_deriv_time are zero. </p>
<p>(this is based on the fact that derivatives in recurrent setups will either decay to zero over time, or will explode and anyway become meaningless). This is only applied if you are not comoputing any input-derivatives). The assumption, for simple Components, is that backprop operations are no-ops as long as the input was zeroed, because the back-propagated derivatives would be zero and the model would not be updated.</p>
<p>The most important effect of this operation is to modify some operations of type kBackprop and kBackpropNoModelUpdate for simple Components, to either make them operate on row ranges of their original input (which in general will be newly created submatrices), or to remove them altogether if they do not operate on any 't' values within the correct range.</p>
<p>We assert as a requirement of this optimization that all allocation commands must zero their matrices (this effectively means that you cannot apply this optimization after <a class="el" href="namespacekaldi_1_1nnet3.html#aae053839b5ed781f2f7408489a1528dd" title="This optimization function changes, where possible, matrix initializations of type kAllocMatrixZeroed...">RemoveUnnecessaryZeroing()</a>). This means that we don't have to worry about leaving things undefined after removing backprop operations. We also assert that backprop commands that set instead of adding to their input, must not be outputting to things that were previously set to nonzero values. (this shouldn't ever be a problem, but we do check.</p>
<p>Note: after this optimization it will likely be beneficial to call RemoveUnnecessaryOperations to remove operations not of type kBackprop that have now become unnecessary&ndash; e.g. operations that do the backprop through Descriptors. </p>

</div>
</div>
<a class="anchor" id="a6ed9b871bd28649b80165dc1af5d1a98"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LimitDerivativeTimes </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>min_deriv_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_deriv_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l01805">1805</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize-utils_8cc_source.html#l01535">DerivativeTimeLimiter::LimitDerivTimes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                                                        {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  DerivativeTimeLimiter limiter(nnet, min_deriv_time, max_deriv_time,</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                                computation);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  limiter.LimitDerivTimes();</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9efe2804eba8c2da73af3aa4eff4a2fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MakeSccGraph </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>sccs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>scc_graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a list of sccs of a graph (e.g. </p>
<p>as computed by FindSccs), compute a directed graph on the sccs. Of course this directed graph will be acyclic. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00164">164</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>, and <a class="el" href="nnet-graph-test_8cc_source.html#l00172">UnitTestMakeSccGraph()</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                           {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(scc_graph != NULL);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  scc_graph-&gt;clear();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  scc_graph-&gt;resize(sccs.size());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">// Hash map from node to SCC index.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  std::vector&lt;int32&gt; node_to_scc_index(graph.size());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sccs.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); ++<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] &gt;= 0 &amp;&amp; sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] &lt; graph.size());</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      node_to_scc_index[sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]] = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// Builds graph.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; sccs.size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); ++<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node = sccs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node &gt;= 0 &amp;&amp; node &lt; graph.size());</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; graph[node].size(); ++k) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span> (node_to_scc_index[graph[node][k]] != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) { <span class="comment">// Exclucding self.</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          (*scc_graph)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(node_to_scc_index[graph[node][k]]);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// If necessary, we can use a hash maps to avoid this sorting.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;((*scc_graph)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a82b64d14f92892efd68998d19e012c1c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::MaxMemoryUsage </td>
          <td>(</td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total memory, in bytes, used by the computation (just the temporary memory, not counting the memory used by the nnet itself). </p>
<p>This is defined as the maximum amount of memory used at any one instant. </p>

</div>
</div>
<a class="anchor" id="a4ceebc46ef1be292f6b2ff71cc1128ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MergeExamples </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; NnetExample &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetExample *&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merge a set of input examples into a single example (typically the size of "src" will be the minibatch size). </p>
<p>Will crash if "src" is the empty vector. If "compress" is true, it will compress any non-sparse features in the output. </p>

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00147">147</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-example-utils_8cc_source.html#l00031">GetIoNames()</a>, <a class="el" href="nnet-example-utils_8cc_source.html#l00047">GetIoSizes()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-example-utils_8cc_source.html#l00085">MergeIo()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-merge-egs_8cc_source.html#l00042">main()</a>, and <a class="el" href="nnet-example-test_8cc_source.html#l00067">UnitTestNnetMergeExamples()</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                           {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!src.empty());</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  std::vector&lt;std::string&gt; io_names;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a2f2093173e902d1445fcd80def82ea4b">GetIoNames</a>(src, &amp;io_names);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// the sizes are the total number of Indexes we have across all examples.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  std::vector&lt;int32&gt; io_sizes;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a9cffcda7d561b7a342c1e268364e7583">GetIoSizes</a>(src, io_names, &amp;io_sizes);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#af1308684fa0a80a9163906b4cdbf0c04">MergeIo</a>(src, io_names, io_sizes, compress, merged_eg);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2f2093173e902d1445fcd80def82ea4b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2f2093173e902d1445fcd80def82ea4b">kaldi::nnet3::GetIoNames</a></div><div class="ttdeci">static void GetIoNames(const std::vector&lt; NnetExample &gt; &amp;src, std::vector&lt; std::string &gt; *names_vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00031">nnet-example-utils.cc:31</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9cffcda7d561b7a342c1e268364e7583"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9cffcda7d561b7a342c1e268364e7583">kaldi::nnet3::GetIoSizes</a></div><div class="ttdeci">static void GetIoSizes(const std::vector&lt; NnetExample &gt; &amp;src, const std::vector&lt; std::string &gt; &amp;names, std::vector&lt; int32 &gt; *sizes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00047">nnet-example-utils.cc:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_af1308684fa0a80a9163906b4cdbf0c04"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#af1308684fa0a80a9163906b4cdbf0c04">kaldi::nnet3::MergeIo</a></div><div class="ttdeci">static void MergeIo(const std::vector&lt; NnetExample &gt; &amp;src, const std::vector&lt; std::string &gt; &amp;names, const std::vector&lt; int32 &gt; &amp;sizes, bool compress, NnetExample *merged_eg)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00085">nnet-example-utils.cc:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af1308684fa0a80a9163906b4cdbf0c04"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::MergeIo </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; NnetExample &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetExample *&#160;</td>
          <td class="paramname"><em>merged_eg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00085">85</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="sparse-matrix_8cc_source.html#l00818">kaldi::AppendGeneralMatrixRows()</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00046">NnetIo::features</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00042">NnetIo::indexes</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, and <a class="el" href="nnet3_2nnet-example_8h_source.html#l00036">NnetIo::name</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-utils_8cc_source.html#l00147">MergeExamples()</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                            {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_feats = names.size();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  std::vector&lt;int32&gt; cur_size(num_feats, 0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  std::vector&lt;std::vector&lt;GeneralMatrix const*&gt; &gt; output_lists(num_feats);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  merged_eg-&gt;io.clear();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  merged_eg-&gt;io.resize(num_feats);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> f = 0; f &lt; num_feats; f++) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    NnetIo &amp;io = merged_eg-&gt;io[f];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = sizes[f];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(size &gt; 0);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    io.name = names[f];</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    io.indexes.resize(size);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  std::vector&lt;std::string&gt;::const_iterator names_begin = names.begin(),</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                             names_end = names.end();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  std::vector&lt;NnetExample&gt;::const_iterator iter = src.begin(), end = src.end();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; iter != end; ++iter,++<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    std::vector&lt;NnetIo&gt;::const_iterator iter2 = iter-&gt;io.begin(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                         end2 = iter-&gt;io.end();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">for</span> (; iter2 != end2; ++iter2) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keyword">const</span> NnetIo &amp;io = *iter2;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      std::vector&lt;std::string&gt;::const_iterator names_iter =</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          std::lower_bound(names_begin, names_end, io.name);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(*names_iter == io.name);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> f = names_iter - names_begin;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_size = io.indexes.size(),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          &amp;this_offset = cur_size[f];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(this_size + this_offset &lt;= sizes[f]);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      output_lists[f].push_back(&amp;(io.features));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      NnetIo &amp;output_io = merged_eg-&gt;io[f];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      std::copy(io.indexes.begin(), io.indexes.end(),</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                output_io.indexes.begin() + this_offset);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      std::vector&lt;Index&gt;::iterator output_iter = output_io.indexes.begin();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// Set the n index to be different for each of the original examples.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = this_offset; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; this_offset + this_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">// we could easily support merging already-merged egs, but I don&#39;t see a</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="comment">// need for it right now.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(output_iter[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> == 0 &amp;&amp;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                     <span class="stringliteral">&quot;Merging already-merged egs?  Not currentlysupported.&quot;</span>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        output_iter[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].n = <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      this_offset += this_size;  <span class="comment">// note: this_offset is a reference.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cur_size == sizes);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> f = 0; f &lt; num_feats; f++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="group__matrix__group.html#gac4e482ffba86badf4f9bf2c7fa6e5214">AppendGeneralMatrixRows</a>(output_lists[f],</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                            &amp;(merged_eg-&gt;io[f].features));</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (compress) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// the following won&#39;t do anything if the features were sparse.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      merged_eg-&gt;io[f].features.Compress();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__matrix__group_html_gac4e482ffba86badf4f9bf2c7fa6e5214"><div class="ttname"><a href="group__matrix__group.html#gac4e482ffba86badf4f9bf2c7fa6e5214">kaldi::AppendGeneralMatrixRows</a></div><div class="ttdeci">void AppendGeneralMatrixRows(const std::vector&lt; const GeneralMatrix * &gt; &amp;src, GeneralMatrix *mat)</div><div class="ttdoc">Appends all the matrix rows of a list of GeneralMatrixes, to get a single GeneralMatrix. </div><div class="ttdef"><b>Definition:</b> <a href="sparse-matrix_8cc_source.html#l00818">sparse-matrix.cc:818</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a20e1e086f75487fe19752fd2b34ca627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MoveSizingCommands </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This optimization moves commands that initialize matrices to as late as possible, and commands that empty matrices to as early as possible. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00028">28</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8h_source.html#l00261">MatrixAccesses::accesses</a>, <a class="el" href="nnet-analyze_8h_source.html#l00251">MatrixAccesses::allocate_command</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00267">ComputeCommandAttributes()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00436">ComputeMatrixAccesses()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00390">ComputeVariableAccesses()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00254">MatrixAccesses::deallocate_command</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00133">ComputationVariables::Init()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                                                        {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  ComputationVariables variables;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  variables.Init(*computation);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  std::vector&lt;CommandAttributes&gt; attributes;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aa02a576b6e9aa0977f3eb52471742b85">ComputeCommandAttributes</a>(nnet, *computation, variables, &amp;attributes);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  std::vector&lt;std::vector&lt;Access&gt; &gt; variable_accesses;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a474b6a19fd42f428dd178f9af05150a8">ComputeVariableAccesses</a>(variables, attributes, &amp;variable_accesses);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  std::vector&lt;MatrixAccesses&gt; matrix_accesses;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a2f107eabc73f1b70436ed117375778c1">ComputeMatrixAccesses</a>(nnet, *computation, variables, attributes,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                        &amp;matrix_accesses);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// The way we will renumber the commands is, we will first set this vector up</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// with pairs (command-index * 3, pointer-to-command), and we will then modify</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="comment">// the command-indexes in this vector to the numbers that we want, and sort</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// it.  The reason for the * 3 is so that we can number commands &quot;just-after&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">// existing indexes (by adding 1) and &quot;just-before&quot; (by subtracting 1).</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands = computation-&gt;commands.size(),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      num_matrices = matrix_accesses.size();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  std::vector&lt;std::pair&lt;int32,NnetComputation::Command*&gt; &gt;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      commands(num_commands);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_commands; c++) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    commands[c].first = c * 3;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    commands[c].second = &amp;(computation-&gt;commands[c]);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> m = 1; m &lt; num_matrices; m++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">const</span> MatrixAccesses &amp;ma = matrix_accesses[m];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (ma.allocate_command != -1) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">// first_access_command will be index of first non-initializing access.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_access_command = -1;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">if</span> (!ma.accesses.empty()) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        first_access_command = ma.accesses[0].command_index;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">if</span> (first_access_command == ma.allocate_command) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          <span class="keywordflow">if</span> (ma.accesses.size() &gt; 1)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            first_access_command = ma.accesses[1].command_index;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            first_access_command = -1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (first_access_command != -1) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(first_access_command &gt; ma.allocate_command);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="comment">// move the initialization command to just before the first access.</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        commands[ma.allocate_command].first = first_access_command * 3 - 1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">if</span> (ma.deallocate_command != -1) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (!ma.accesses.empty()) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> last_access_command = ma.accesses.back().command_index;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="comment">// move the destruction command to just after the last access.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        commands[ma.deallocate_command].first = last_access_command * 3 + 1;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  std::sort(commands.begin(), commands.end());</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  std::vector&lt;NnetComputation::Command&gt; reordered_commands(num_commands);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_commands; c++)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    reordered_commands[c] = *(commands[c].second);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  computation-&gt;commands = reordered_commands;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa02a576b6e9aa0977f3eb52471742b85"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa02a576b6e9aa0977f3eb52471742b85">kaldi::nnet3::ComputeCommandAttributes</a></div><div class="ttdeci">void ComputeCommandAttributes(const Nnet &amp;nnet, const NnetComputation &amp;computation, const ComputationVariables &amp;vars, std::vector&lt; CommandAttributes &gt; *attributes)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l00267">nnet-analyze.cc:267</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a474b6a19fd42f428dd178f9af05150a8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a474b6a19fd42f428dd178f9af05150a8">kaldi::nnet3::ComputeVariableAccesses</a></div><div class="ttdeci">void ComputeVariableAccesses(const ComputationVariables &amp;variables, const std::vector&lt; CommandAttributes &gt; &amp;command_attributes, std::vector&lt; std::vector&lt; Access &gt; &gt; *variable_accesses)</div><div class="ttdoc">After the command-level attributes have been computed, this function organizes them per variable (see...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l00390">nnet-analyze.cc:390</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2f107eabc73f1b70436ed117375778c1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2f107eabc73f1b70436ed117375778c1">kaldi::nnet3::ComputeMatrixAccesses</a></div><div class="ttdeci">void ComputeMatrixAccesses(const Nnet &amp;nnet, const NnetComputation &amp;computation, const ComputationVariables &amp;variables, const std::vector&lt; CommandAttributes &gt; &amp;command_attributes, std::vector&lt; MatrixAccesses &gt; *matrix_accesses)</div><div class="ttdoc">This function organizes information in the CommandAttributes in a way that is convenient to access pe...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l00436">nnet-analyze.cc:436</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a81eeaabd042c236a1e0276c353a7d450"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string NnetInfo </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function returns various info about the neural net. </p>
<p>If the nnet satisfied IsSimpleNnet(nnet), the info includes "left-context=5\nright-context=3\n...". The info includes the output of nnet.Info(). This is modeled after the info that <a class="el" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html">AmNnetSimple</a> returns in its Info() function (we need this in the CTC code). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00362">362</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-utils_8cc_source.html#l00129">ComputeSimpleNnetContext()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00765">Nnet::Info()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00635">Nnet::InputDim()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00042">IsSimpleNnet()</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00643">Nnet::OutputDim()</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils-test_8cc_source.html#l00027">UnitTestNnetContext()</a>.</p>
<div class="fragment"><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                                     {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  std::ostringstream ostr;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">IsSimpleNnet</a>(nnet)) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, right_context;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// this call will crash if the nnet is not &#39;simple&#39;.</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">ComputeSimpleNnetContext</a>(nnet, &amp;left_context, &amp;right_context);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;left-context: &quot;</span> &lt;&lt; left_context &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    ostr &lt;&lt; <span class="stringliteral">&quot;right-context: &quot;</span> &lt;&lt; right_context &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  ostr &lt;&lt; <span class="stringliteral">&quot;input-dim: &quot;</span> &lt;&lt; nnet.InputDim(<span class="stringliteral">&quot;input&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  ostr &lt;&lt; <span class="stringliteral">&quot;ivector-dim: &quot;</span> &lt;&lt; nnet.InputDim(<span class="stringliteral">&quot;ivector&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  ostr &lt;&lt; <span class="stringliteral">&quot;output-dim: &quot;</span> &lt;&lt; nnet.OutputDim(<span class="stringliteral">&quot;output&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  ostr &lt;&lt; <span class="stringliteral">&quot;# Nnet info follows.\n&quot;</span>;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  ostr &lt;&lt; nnet.Info();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a88aa85d232ba1ad6e430f6f6dcda29c1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">kaldi::nnet3::ComputeSimpleNnetContext</a></div><div class="ttdeci">void ComputeSimpleNnetContext(const Nnet &amp;nnet, int32 *left_context, int32 *right_context)</div><div class="ttdoc">ComputeNnetContext computes the left-context and right-context of a nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00129">nnet-utils.cc:129</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a672e127a288d02b4a8e292b86aadfc04"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a672e127a288d02b4a8e292b86aadfc04">kaldi::nnet3::IsSimpleNnet</a></div><div class="ttdeci">bool IsSimpleNnet(const Nnet &amp;nnet)</div><div class="ttdoc">This function returns true if the nnet has the following properties: It has one output, called &quot;output&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00042">nnet-utils.cc:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac25c4eeb172565878e12ca4355ad9147"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool NnetParametersAreIdentical </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used for testing that the updatable parameters in two networks are the same. </p>
<p>May crash if structure differs. Prints warning and returns false if parameters differ. E.g. set threshold to 1.0e-05 (it's a relative threshold, applied per component). </p>

<p>Definition at line <a class="el" href="nnet-test-utils_8cc_source.html#l01124">1124</a> of file <a class="el" href="nnet-test-utils_8cc_source.html">nnet-test-utils.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00655">Nnet::GetComponentName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Component::Type()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                                                               {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet1.NumComponents() == nnet2.NumComponents());</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_components = nnet1.NumComponents();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_components; c++) {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keyword">const</span> Component *c1 = nnet1.GetComponent(c),</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                    *c2 = nnet2.GetComponent(c);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(c1-&gt;Type() == c2-&gt;Type());</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">if</span> (c1-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      <span class="keyword">const</span> UpdatableComponent *u1 = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>UpdatableComponent*<span class="keyword">&gt;</span>(c1),</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;                               *u2 = dynamic_cast&lt;const UpdatableComponent*&gt;(c2);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(u1 != NULL &amp;&amp; u2 != NULL);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> prod11 = u1-&gt;DotProduct(*u1), prod12 = u1-&gt;DotProduct(*u2),</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                prod21 = u2-&gt;DotProduct(*u1), prod22 = u2-&gt;DotProduct(*u2);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> max_prod = std::max(std::max(prod11, prod12),</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                                    std::max(prod21, prod22)),</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                min_prod = std::min(std::min(prod11, prod12),</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                                    std::min(prod21, prod22));</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <span class="keywordflow">if</span> (max_prod - min_prod &gt; threshold * max_prod) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Component &#39;&quot;</span> &lt;&lt; nnet1.GetComponentName(c)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;&#39; differs in nnet1 versus nnet2: prod(11,12,21,22) = &quot;</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                   &lt;&lt; prod11 &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; prod12 &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; prod21 &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; prod22;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a679a6d66a5e4a3993124bc35597dd06b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void NnetToDirectedGraph </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>graph</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes an nnet and turns it to a directed graph on nodes. </p>
<p>The nodes will be numbered from 0 to graph-&gt;size() - 1, where graph-&gt;size() == nnet.NumNodes(). For each node-index n, the vector in (*graph)[n] will contain a list of all the nodes that have a direct dependency on node n (in order to compute them). For instance, if n is an input node, (*graph)[n] will be the empty list because it won't depend on anything. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00030">30</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8h_source.html#l00084">NetworkNode::descriptor</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00135">Nnet::GetNode()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00466">Descriptor::GetNodeDependencies()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kDescriptor</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kDimRange</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00055">kInput</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00090">NetworkNode::node_index</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00082">NetworkNode::node_type</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00124">Nnet::NumNodes()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, and <a class="el" href="structkaldi_1_1nnet3_1_1NetworkNode.html#a59b26a99fb5f5a9a7dfdcf5b50bf86c7">NetworkNode::u</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                                              {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  graph-&gt;clear();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes = nnet.NumNodes();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  graph-&gt;resize(num_nodes);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; num_nodes; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> NetworkNode &amp;node = nnet.GetNode(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// handle dependencies of this node.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    std::vector&lt;int32&gt; node_dependencies;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordflow">switch</span> (node.node_type) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kInput</a>:</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">break</span>;  <span class="comment">// no node dependencies.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kDescriptor</a>: </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        node.descriptor.GetNodeDependencies(&amp;node_dependencies);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kComponent</a>:</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        node_dependencies.push_back(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> - 1);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kDimRange</a>:</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        node_dependencies.push_back(node.u.node_index);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid node type&quot;</span>;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;node_dependencies);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; node_dependencies.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dep_n = node_dependencies[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(dep_n &gt;= 0 &amp;&amp; dep_n &lt; num_nodes);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      (*graph)[dep_n].push_back(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a02fee4c0e0e6f1b7ab7a678d61627461">kaldi::nnet3::kComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16aa3512d23926af0e0dad8c3293443d04c">kaldi::nnet3::kInput</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16af6fcd3c520d4fbd679b82fdf40a3ed8b">kaldi::nnet3::kDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#acac9cbaeea226ed297804c012dc12b16a6febfa61862690007ae5a50703dd03db">kaldi::nnet3::kDimRange</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00055">nnet-nnet.h:55</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a59f9bf54d192e760e406499f997327be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string kaldi::nnet3::NormalizeTextDescriptor </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>desc_str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00179">179</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor_8cc_source.html#l00825">GeneralDescriptor::ConvertToDescriptor()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00474">GeneralDescriptor::Parse()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00399">Descriptor::WriteConfig()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00199">UnitTestGeneralDescriptorSpecial()</a>.</p>
<div class="fragment"><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                                               {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  std::vector&lt;std::string&gt; tokens;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(desc_str, &amp;tokens);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  tokens.push_back(<span class="stringliteral">&quot;end of input&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keyword">const</span> std::string *next_token = &amp;(tokens[0]);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html">GeneralDescriptor</a> *gen_desc = GeneralDescriptor::Parse(node_names,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                         &amp;next_token);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="keywordflow">if</span> (*next_token != <span class="stringliteral">&quot;end of input&quot;</span>)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Parsing Descriptor, expected end of input but got &quot;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt;  *next_token &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> *desc = gen_desc-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html#a71138fe8137308e15564d18bdc625e4c">ConvertToDescriptor</a>();</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  std::ostringstream ostr;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  desc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr, node_names);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keyword">delete</span> gen_desc;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keyword">delete</span> desc;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Result of normalizing &quot;</span> &lt;&lt; desc_str &lt;&lt; <span class="stringliteral">&quot; is: &quot;</span> &lt;&lt; ostr.str();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">return</span> ostr.str();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html">kaldi::nnet3::Descriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00429">nnet-descriptor.h:429</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1GeneralDescriptor_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html">kaldi::nnet3::GeneralDescriptor</a></div><div class="ttdoc">This class is only used when parsing Descriptors. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00513">nnet-descriptor.h:513</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac6b64008b19bbb6e8769769cbf96fa68"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">kaldi::nnet3::DescriptorTokenize</a></div><div class="ttdeci">bool DescriptorTokenize(const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</div><div class="ttdoc">This function tokenizes input when parsing Descriptor configuration values. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00355">nnet-parse.cc:355</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html_a8f09e9fcbf206d294cf53959ef0c832a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">kaldi::nnet3::Descriptor::WriteConfig</a></div><div class="ttdeci">void WriteConfig(std::ostream &amp;os, const std::vector&lt; std::string &gt; &amp;node_names) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00399">nnet-descriptor.cc:399</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1GeneralDescriptor_html_a71138fe8137308e15564d18bdc625e4c"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html#a71138fe8137308e15564d18bdc625e4c">kaldi::nnet3::GeneralDescriptor::ConvertToDescriptor</a></div><div class="ttdeci">Descriptor * ConvertToDescriptor()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00825">nnet-descriptor.cc:825</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ce1aea23a558c0461ff1ab72f41ebb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> NumInputNodes </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the number of input nodes of this nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00033">33</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00107">Nnet::IsInputNode()</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, and <a class="el" href="_2nnet-nnet_8h_source.html#l00124">Nnet::NumNodes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00042">IsSimpleNnet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                      {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = 0;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; nnet.NumNodes(); <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (nnet.IsInputNode(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>))</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      ans++;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2aaea01bc54e382c47d9a0a205489a97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::NumOutputIndexes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-merge-egs_8cc_source.html#l00031">31</a> of file <a class="el" href="nnet3-merge-egs_8cc_source.html">nnet3-merge-egs.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, and <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>.</p>

<p>Referenced by <a class="el" href="nnet3-merge-egs_8cc_source.html#l00042">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                              {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name == <span class="stringliteral">&quot;output&quot;</span>)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keywordflow">return</span> eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].indexes.size();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No output named &#39;output&#39; in the eg.&quot;</span>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">return</span> 0;  <span class="comment">// Suppress compiler warning.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_acfc99ed8d51e6726a7c4e888afebc910"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">kaldi::nnet3::NnetExample::io</a></div><div class="ttdeci">std::vector&lt; NnetIo &gt; io</div><div class="ttdoc">&quot;io&quot; contains the input and output. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00087">nnet-example.h:87</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0c3bad5386ea02d61e9596ba76b77eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> NumOutputNodes </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns the number of output nodes of this nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00025">25</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, and <a class="el" href="_2nnet-nnet_8h_source.html#l00124">Nnet::NumNodes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils_8cc_source.html#l00042">IsSimpleNnet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                                       {</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = 0;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; nnet.NumNodes(); <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span> (nnet.IsOutputNode(<a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>))</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      ans++;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96164bd20d5a66c3c0ca62e30250d46a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> NumParameters </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total of the number of parameters in the updatable components of the nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00289">289</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00384">UpdatableComponent::NumParameters()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-nnet_8cc_source.html#l00765">Nnet::Info()</a>, <a class="el" href="nnet3-show-progress_8cc_source.html#l00027">main()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00331">UnVectorizeNnet()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00308">VectorizeNnet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                     {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = 0;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; src.NumComponents(); c++) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keyword">const</span> Component *comp = src.GetComponent(c);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">// For now all updatable components inherit from class UpdatableComponent.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// If that changes in future, we will change this code.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keyword">const</span> UpdatableComponent *uc =</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (uc == NULL)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Updatable component does not inherit from class &quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="stringliteral">&quot;UpdatableComponent; change this code.&quot;</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      ans += uc-&gt;NumParameters();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25df665b8f7a712a34469e53fc875851"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> NumUpdatableComponents </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>dest</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of updatable components in the nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00352">352</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="combine-nnet_8cc_source.html#l00028">kaldi::nnet2::CombineNnets()</a>, <a class="el" href="combine-nnet-fast_8cc_source.html#l00200">FastNnetCombiner::CombineNnets()</a>, <a class="el" href="combine-nnet-a_8cc_source.html#l00102">kaldi::nnet2::CombineNnetsA()</a>, <a class="el" href="combine-nnet-fast_8cc_source.html#l00355">FastNnetCombiner::ComputeCurrentNnet()</a>, <a class="el" href="combine-nnet-a_8cc_source.html#l00031">kaldi::nnet2::GetUpdateDirection()</a>, <a class="el" href="nnet3-show-progress_8cc_source.html#l00027">main()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00206">PrintVectorPerUpdatableComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                               {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = 0;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; dest.NumComponents(); c++) {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keyword">const</span> Component *comp = dest.GetComponent(c);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      ans++;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5001f1f230fce8994722a8d211ab0b81"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>ostream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Index &amp;&#160;</td>
          <td class="paramname"><em>index</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00172">172</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="nnet-common_8h_source.html#l00045">Index::n</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                                  {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordflow">return</span> ostream &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; index.n &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; index.t &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; index.x &lt;&lt; <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af4f4752f24d0cdba07dd92e93430b965"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>ostream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Cindex &amp;&#160;</td>
          <td class="paramname"><em>cindex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00176">176</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                                                                    {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keywordflow">return</span> ostream &lt;&lt; <span class="charliteral">&#39;(&#39;</span> &lt;&lt; cindex.first &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; cindex.second &lt;&lt; <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a170051dd847dd17ea4826fe55635fb72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationGraphBuilder::ComputableInfo &amp;&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is to be used in logging only. </p>

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l00292">292</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>References <a class="el" href="nnet-computation-graph_8h_source.html#l00139">ComputationGraphBuilder::kComputable</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00140">ComputationGraphBuilder::kNotComputable</a>, <a class="el" href="nnet-computation-graph_8h_source.html#l00138">ComputationGraphBuilder::kUnknown</a>, and <a class="el" href="nnet-computation-graph_8h_source.html#l00141">ComputationGraphBuilder::kWillNotCompute</a>.</p>
<div class="fragment"><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                                              {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">switch</span> (info) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">case</span> ComputationGraphBuilder::kUnknown: os &lt;&lt; <span class="stringliteral">&quot;kUnknown&quot;</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">case</span> ComputationGraphBuilder::kComputable: os &lt;&lt; <span class="stringliteral">&quot;kComputable&quot;</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">case</span> ComputationGraphBuilder::kNotComputable: os &lt;&lt; <span class="stringliteral">&quot;kNotComputable&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">case</span> ComputationGraphBuilder::kWillNotCompute: os &lt;&lt; <span class="stringliteral">&quot;kWillNotCompute&quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">default</span>: os &lt;&lt; <span class="stringliteral">&quot;[invalid enum value]&quot;</span>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">return</span> os;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63bbb226b5063936684810e9cc6f830a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; kaldi::nnet3::operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a96e8c7c5766b9f5c698ce7195489efba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Optimize </td>
          <td>(</td>
          <td class="paramtype">const NnetOptimizeOptions &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the top-level function for optimizing a computation. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00326">326</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize_8h_source.html#l00045">NnetOptimizeOptions::allocate_from_other</a>, <a class="el" href="nnet-optimize_8h_source.html#l00038">NnetOptimizeOptions::backprop_in_place</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00975">CheckComputation()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00036">NnetOptimizeOptions::consolidate_model_update</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00266">ConsolidateModelUpdate()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00039">NnetOptimizeOptions::convert_addition</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00276">ConvertAdditionToAssignment()</a>, <a class="el" href="kaldi-error_8h_source.html#l00060">kaldi::GetVerboseLevel()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00043">NnetOptimizeOptions::initialize_undefined</a>, <a class="el" href="nnet-optimize-utils_8cc_source.html#l01805">LimitDerivativeTimes()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00047">NnetOptimizeOptions::max_deriv_time</a>, <a class="el" href="nnet-optimize_8h_source.html#l00046">NnetOptimizeOptions::min_deriv_time</a>, <a class="el" href="nnet-optimize_8h_source.html#l00044">NnetOptimizeOptions::move_sizing_commands</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00028">MoveSizingCommands()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00035">NnetOptimizeOptions::optimize</a>, <a class="el" href="nnet-optimize_8h_source.html#l00037">NnetOptimizeOptions::propagate_in_place</a>, <a class="el" href="nnet-optimize_8h_source.html#l00040">NnetOptimizeOptions::remove_assignments</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00185">RemoveUnnecessaryAllocation()</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00090">RemoveUnnecessaryZeroing()</a>, and <a class="el" href="nnet-optimize_8cc_source.html#l00251">VariableMergingOptimization()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00448">CachingOptimizingCompiler::Compile()</a>, <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00040">UnitTestNnetCompute()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00258">UnitTestNnetInputDerivatives()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>, and <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                            {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">if</span> (!config.optimize)</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// this will do nothing unless --min-deriv-time or --max-deriv-time was</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// set.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a6ed9b871bd28649b80165dc1af5d1a98">LimitDerivativeTimes</a>(nnet, config.min_deriv_time, config.max_deriv_time,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                       computation);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">if</span> (config.consolidate_model_update)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ad35855c00662ec8d8b2cf5e14569db0a">ConsolidateModelUpdate</a>(nnet, request, computation);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">if</span> (config.convert_addition)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ac759ea60772df625784bcc714f7a41da">ConvertAdditionToAssignment</a>(nnet, computation);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">if</span> (config.remove_assignments || config.backprop_in_place ||</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      config.propagate_in_place)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a7464172a2f27484596c2d374bb1adcd6">VariableMergingOptimization</a>(config, nnet, request, computation);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">if</span> (config.initialize_undefined)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aae053839b5ed781f2f7408489a1528dd">RemoveUnnecessaryZeroing</a>(nnet, computation);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">if</span> (config.move_sizing_commands)</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a20e1e086f75487fe19752fd2b34ca627">MoveSizingCommands</a>(nnet, computation);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordflow">if</span> (config.allocate_from_other)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a92c251003c3f612c5cfbcbd72cbd030b">RemoveUnnecessaryAllocation</a>(nnet, computation);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">GetVerboseLevel</a>() &gt;= 4)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">CheckComputation</a>(nnet, request, *computation, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a7464172a2f27484596c2d374bb1adcd6"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a7464172a2f27484596c2d374bb1adcd6">kaldi::nnet3::VariableMergingOptimization</a></div><div class="ttdeci">void VariableMergingOptimization(const NnetOptimizeOptions &amp;config, const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This wraps class VariableMergingOptimizer in a simplified interface. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00251">nnet-optimize.cc:251</a></div></div>
<div class="ttc" id="group__error__group_html_gae77f5cf98f18f8cbe207690e49da166e"><div class="ttname"><a href="group__error__group.html#gae77f5cf98f18f8cbe207690e49da166e">kaldi::GetVerboseLevel</a></div><div class="ttdeci">int32 GetVerboseLevel()</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00060">kaldi-error.h:60</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac759ea60772df625784bcc714f7a41da"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac759ea60772df625784bcc714f7a41da">kaldi::nnet3::ConvertAdditionToAssignment</a></div><div class="ttdeci">void ConvertAdditionToAssignment(const Nnet &amp;nnet, NnetComputation *computation)</div><div class="ttdoc">This converts addition operations (things with Add in their names) to copy operations (things with Co...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00276">nnet-optimize.cc:276</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a6ed9b871bd28649b80165dc1af5d1a98"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a6ed9b871bd28649b80165dc1af5d1a98">kaldi::nnet3::LimitDerivativeTimes</a></div><div class="ttdeci">void LimitDerivativeTimes(const Nnet &amp;nnet, int32 min_deriv_time, int32 max_deriv_time, NnetComputation *computation)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l01805">nnet-optimize-utils.cc:1805</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a20e1e086f75487fe19752fd2b34ca627"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a20e1e086f75487fe19752fd2b34ca627">kaldi::nnet3::MoveSizingCommands</a></div><div class="ttdeci">void MoveSizingCommands(const Nnet &amp;nnet, NnetComputation *computation)</div><div class="ttdoc">This optimization moves commands that initialize matrices to as late as possible, and commands that e...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00028">nnet-optimize.cc:28</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a92c251003c3f612c5cfbcbd72cbd030b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a92c251003c3f612c5cfbcbd72cbd030b">kaldi::nnet3::RemoveUnnecessaryAllocation</a></div><div class="ttdeci">void RemoveUnnecessaryAllocation(const Nnet &amp;nnet, NnetComputation *computation)</div><div class="ttdoc">This optimization detects cases where we deallocate a matrix, and then later allocate another matrix ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00185">nnet-optimize.cc:185</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aae053839b5ed781f2f7408489a1528dd"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aae053839b5ed781f2f7408489a1528dd">kaldi::nnet3::RemoveUnnecessaryZeroing</a></div><div class="ttdeci">void RemoveUnnecessaryZeroing(const Nnet &amp;nnet, NnetComputation *computation)</div><div class="ttdoc">This optimization function changes, where possible, matrix initializations of type kAllocMatrixZeroed...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00090">nnet-optimize.cc:90</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a28797c2cdd8990a88b55e122b2b2931a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a28797c2cdd8990a88b55e122b2b2931a">kaldi::nnet3::CheckComputation</a></div><div class="ttdeci">void CheckComputation(const Nnet &amp;nnet, const ComputationRequest &amp;request, const NnetComputation &amp;computation, bool check_rewrite)</div><div class="ttdoc">This is a convenience interface for class ComputationChecker. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l00975">nnet-analyze.cc:975</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad35855c00662ec8d8b2cf5e14569db0a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad35855c00662ec8d8b2cf5e14569db0a">kaldi::nnet3::ConsolidateModelUpdate</a></div><div class="ttdeci">void ConsolidateModelUpdate(const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This consolidates the model-update parts of the backprop into larger operations (applicable mostly to...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00266">nnet-optimize.cc:266</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e18825b4c5b0834e638296b2f5bb35a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ParseFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function used in Init routines. </p>
<p>Suppose name=="foo", if "string" has a field like foo=12, this function will set "param" to 12 and remove that element from "string". It returns true if the parameter was read. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00219">219</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="text-utils_8h_source.html#l00114">kaldi::ConvertStringToInteger()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="text-utils_8cc_source.html#l00061">kaldi::SplitStringToVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                   {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  std::vector&lt;std::string&gt; split_string;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">SplitStringToVector</a>(*<span class="keywordtype">string</span>, <span class="stringliteral">&quot; \t&quot;</span>, <span class="keyword">true</span>,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                      &amp;split_string);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  std::string name_equals = name + <span class="stringliteral">&quot;=&quot;</span>; <span class="comment">// the name and then the equals sign.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordtype">size_t</span> len = name_equals.length();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].compare(0, len, name_equals) == 0) {</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].substr(len), param))</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad option &quot;</span> &lt;&lt; split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      *<span class="keywordtype">string</span> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="comment">// Set &quot;string&quot; to all the pieces but the one we used.</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          <span class="keywordflow">if</span> (!string-&gt;empty()) *<span class="keywordtype">string</span> += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          *<span class="keywordtype">string</span> += split_string[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a39eb3f7ce5fab6dbbcb396b3f8e196f4"><div class="ttname"><a href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">kaldi::ConvertStringToInteger</a></div><div class="ttdeci">bool ConvertStringToInteger(const std::string &amp;str, Int *out)</div><div class="ttdoc">Converts a string into an integer via strtoll and returns false if there was any kind of problem (i...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00114">text-utils.h:114</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ac332ce23fcf74c011cfa83276cd08477"><div class="ttname"><a href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">kaldi::SplitStringToVector</a></div><div class="ttdeci">void SplitStringToVector(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; std::string &gt; *out)</div><div class="ttdoc">Split a string using any of the single character delimiters. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00061">text-utils.cc:61</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a06c170854db9a3b5bb3915dfb52380c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ParseFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version of ParseFromString is for parameters of type bool, which can appear as any string beginning with f, F, t or T. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00245">245</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="text-utils_8cc_source.html#l00061">kaldi::SplitStringToVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                  {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  std::vector&lt;std::string&gt; split_string;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">SplitStringToVector</a>(*<span class="keywordtype">string</span>, <span class="stringliteral">&quot; \t&quot;</span>, <span class="keyword">true</span>,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                      &amp;split_string);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  std::string name_equals = name + <span class="stringliteral">&quot;=&quot;</span>; <span class="comment">// the name and then the equals sign.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordtype">size_t</span> len = name_equals.length();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keywordflow">if</span> (split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].compare(0, len, name_equals) == 0) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      std::string b = split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].substr(len);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">if</span> (b.empty())</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad option &quot;</span> &lt;&lt; split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="keywordflow">if</span> (b[0] == <span class="charliteral">&#39;f&#39;</span> || b[0] == <span class="charliteral">&#39;F&#39;</span>) *param = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (b[0] == <span class="charliteral">&#39;t&#39;</span> || b[0] == <span class="charliteral">&#39;T&#39;</span>) *param = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad option &quot;</span> &lt;&lt; split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      *<span class="keywordtype">string</span> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="comment">// Set &quot;string&quot; to all the pieces but the one we used.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="keywordflow">if</span> (!string-&gt;empty()) *<span class="keywordtype">string</span> += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          *<span class="keywordtype">string</span> += split_string[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ac332ce23fcf74c011cfa83276cd08477"><div class="ttname"><a href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">kaldi::SplitStringToVector</a></div><div class="ttdeci">void SplitStringToVector(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; std::string &gt; *out)</div><div class="ttdoc">Split a string using any of the single character delimiters. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00061">text-utils.cc:61</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7eac951c4af19775f3ba550efa12f385"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ParseFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version of ParseFromString is for parameters of type BaseFloat. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00276">276</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="text-utils_8cc_source.html#l00211">kaldi::ConvertStringToReal()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="text-utils_8cc_source.html#l00061">kaldi::SplitStringToVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                                       {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  std::vector&lt;std::string&gt; split_string;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">SplitStringToVector</a>(*<span class="keywordtype">string</span>, <span class="stringliteral">&quot; \t&quot;</span>, <span class="keyword">true</span>,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                      &amp;split_string);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  std::string name_equals = name + <span class="stringliteral">&quot;=&quot;</span>; <span class="comment">// the name and then the equals sign.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordtype">size_t</span> len = name_equals.length();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">if</span> (split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].compare(0, len, name_equals) == 0) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a13daeb30570a27a34e639db5fdaa648c">ConvertStringToReal</a>(split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].substr(len), param))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad option &quot;</span> &lt;&lt; split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      *<span class="keywordtype">string</span> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="comment">// Set &quot;string&quot; to all the pieces but the one we used.</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;          <span class="keywordflow">if</span> (!string-&gt;empty()) *<span class="keywordtype">string</span> += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          *<span class="keywordtype">string</span> += split_string[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a13daeb30570a27a34e639db5fdaa648c"><div class="ttname"><a href="namespacekaldi.html#a13daeb30570a27a34e639db5fdaa648c">kaldi::ConvertStringToReal</a></div><div class="ttdeci">bool ConvertStringToReal(const std::string &amp;str, double *out)</div><div class="ttdoc">ConvertStringToReal converts a string into either float or double via strtod, and returns false if th...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00211">text-utils.cc:211</a></div></div>
<div class="ttc" id="namespacekaldi_html_ac332ce23fcf74c011cfa83276cd08477"><div class="ttname"><a href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">kaldi::SplitStringToVector</a></div><div class="ttdeci">void SplitStringToVector(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; std::string &gt; *out)</div><div class="ttdoc">Split a string using any of the single character delimiters. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00061">text-utils.cc:61</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afd5f31afe3e5137b700d0af4fbb13211"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ParseFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version of ParseFromString is for parsing strings. </p>
<p>(these should not contain space). </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00302">302</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="text-utils_8cc_source.html#l00061">kaldi::SplitStringToVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                       {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  std::vector&lt;std::string&gt; split_string;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">SplitStringToVector</a>(*<span class="keywordtype">string</span>, <span class="stringliteral">&quot; \t&quot;</span>, <span class="keyword">true</span>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                      &amp;split_string);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  std::string name_equals = name + <span class="stringliteral">&quot;=&quot;</span>; <span class="comment">// the name and then the equals sign.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordtype">size_t</span> len = name_equals.length();</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].compare(0, len, name_equals) == 0) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      *param = split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].substr(len);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">// Set &quot;string&quot; to all the pieces but the one we used.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      *<span class="keywordtype">string</span> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="keywordflow">if</span> (!string-&gt;empty()) *<span class="keywordtype">string</span> += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          *<span class="keywordtype">string</span> += split_string[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ac332ce23fcf74c011cfa83276cd08477"><div class="ttname"><a href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">kaldi::SplitStringToVector</a></div><div class="ttdeci">void SplitStringToVector(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; std::string &gt; *out)</div><div class="ttdoc">Split a string using any of the single character delimiters. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00061">text-utils.cc:61</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7f7f50f1457000af31efe2ecd53f983a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ParseFromString </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version of ParseFromString handles colon-separated or comma-separated lists of integers. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00328">328</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="text-utils_8h_source.html#l00064">kaldi::SplitStringToIntegers()</a>, and <a class="el" href="text-utils_8cc_source.html#l00061">kaldi::SplitStringToVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                              {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  std::vector&lt;std::string&gt; split_string;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">SplitStringToVector</a>(*<span class="keywordtype">string</span>, <span class="stringliteral">&quot; \t&quot;</span>, <span class="keyword">true</span>,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                      &amp;split_string);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  std::string name_equals = name + <span class="stringliteral">&quot;=&quot;</span>; <span class="comment">// the name and then the equals sign.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordtype">size_t</span> len = name_equals.length();</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].compare(0, len, name_equals) == 0) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">SplitStringToIntegers</a>(split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].substr(len), <span class="stringliteral">&quot;:,&quot;</span>,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                 <span class="keyword">false</span>, param))</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad option &quot;</span> &lt;&lt; split_string[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      *<span class="keywordtype">string</span> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <span class="comment">// Set &quot;string&quot; to all the pieces but the one we used.</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_string.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> != <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          <span class="keywordflow">if</span> (!string-&gt;empty()) *<span class="keywordtype">string</span> += <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          *<span class="keywordtype">string</span> += split_string[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ae95740f87fc2fb79419753e21396c647"><div class="ttname"><a href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">kaldi::SplitStringToIntegers</a></div><div class="ttdeci">bool SplitStringToIntegers(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; I &gt; *out)</div><div class="ttdoc">Split a string (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00064">text-utils.h:64</a></div></div>
<div class="ttc" id="namespacekaldi_html_ac332ce23fcf74c011cfa83276cd08477"><div class="ttname"><a href="namespacekaldi.html#ac332ce23fcf74c011cfa83276cd08477">kaldi::SplitStringToVector</a></div><div class="ttdeci">void SplitStringToVector(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; std::string &gt; *out)</div><div class="ttdoc">Split a string using any of the single character delimiters. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8cc_source.html#l00061">text-utils.cc:61</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3fbd67899f39d18e85c03f06e0c69bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string kaldi::nnet3::ParsingContext </td>
          <td>(</td>
          <td class="paramtype">const std::string *&#160;</td>
          <td class="paramname"><em>token_ptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor_8cc_source.html#l00029">29</a> of file <a class="el" href="nnet-descriptor_8cc_source.html">nnet-descriptor.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor_8cc_source.html#l00045">ExpectToken()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00056">ReadIntegerToken()</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                                            {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">if</span> (*token_ptr == <span class="stringliteral">&quot;end of input&quot;</span>)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  std::string next_few_tokens = <span class="stringliteral">&quot;, next part of line is: &quot;</span>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">// in the next line, *token_ptr should never equal &quot;&quot; but it&#39;s to mitigate the</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">// effect of bugs where we read past the end of the array.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">while</span> (*token_ptr != <span class="stringliteral">&quot;end of input&quot;</span> &amp;&amp; *token_ptr != <span class="stringliteral">&quot;&quot;</span> &amp;&amp;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;         next_few_tokens.size() &lt; 40) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    next_few_tokens = (next_few_tokens + <span class="stringliteral">&quot; &quot;</span>) + *token_ptr;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    token_ptr++;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">if</span> (*token_ptr != <span class="stringliteral">&quot;end of input&quot;</span>)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    next_few_tokens = next_few_tokens + <span class="stringliteral">&quot; ...&quot;</span>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordflow">return</span> next_few_tokens;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ca498bb15fc664236fdd7316a1b8831"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PerturbParams </td>
          <td>(</td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>stddev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls PerturbParams (with the given stddev) on all updatable components of the nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00174">174</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#af8524a3f9d683293269f46e3cc54b285">UpdatableComponent::PerturbParams()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                               {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    Component *comp = nnet-&gt;GetComponent(c);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      UpdatableComponent *u_comp = <span class="keyword">dynamic_cast&lt;</span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(u_comp != NULL);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      u_comp-&gt;PerturbParams(stddev);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab5b506b12f6ee61fbe53115f474df376"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintCindex </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Cindex &amp;&#160;</td>
          <td class="paramname"><em>cindex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00180">180</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l00155">ComputationGraph::Print()</a>.</p>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                                         {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(cindex.first) &lt; node_names.size());</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  os &lt;&lt; node_names[cindex.first] &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; cindex.second.n &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;     &lt;&lt; cindex.second.t;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">if</span> (cindex.second.x != 0)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; cindex.second.x;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a610537b433bd5824688a70413c9905c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintCindexes </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>ostream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Cindex &gt; &amp;&#160;</td>
          <td class="paramname"><em>cindexes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>node_names</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this will only be used for pretty-printing. </p>
<p>It prints a vector of Cindexes in a compact, human-readable way with compression of ranges. If the values of the node indexes are the same for the entire vector, it will just be node-name followed by the output of PrintIndexes, e.g. some_node[ (1,1,0) ]. Otherwise it will divide the vector into ranges that each have all the same node name, and will print out each range in the way we just mentioned. 'node_names' will usually come from a call like nnet.GetNodeNames(). </p>

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00232">232</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-common_8cc_source.html#l00190">PrintIndexes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00354">PrintComputationPreamble()</a>.</p>
<div class="fragment"><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                                           {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_cindexes = cindexes.size();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (num_cindexes == 0) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    ostream &lt;&lt; <span class="stringliteral">&quot;[ ]&quot;</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_offset = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  std::vector&lt;Index&gt; indexes;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  indexes.reserve(cindexes.size());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">while</span> (cur_offset &lt; num_cindexes) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_node_index = cindexes[cur_offset].first;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">while</span> (cur_offset &lt; num_cindexes &amp;&amp;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;           cindexes[cur_offset].first == cur_node_index) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      indexes.push_back(cindexes[cur_offset].second);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      cur_offset++;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(cur_node_index) &lt; node_names.size());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keyword">const</span> std::string &amp;node_name = node_names[cur_node_index];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    ostream &lt;&lt; node_name;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#af952225c01896b2850ffdb09ea2f0ba6">PrintIndexes</a>(ostream, indexes);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    indexes.clear();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_af952225c01896b2850ffdb09ea2f0ba6"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#af952225c01896b2850ffdb09ea2f0ba6">kaldi::nnet3::PrintIndexes</a></div><div class="ttdeci">void PrintIndexes(std::ostream &amp;os, const std::vector&lt; Index &gt; &amp;indexes)</div><div class="ttdoc">this will only be used for pretty-printing. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00190">nnet-common.cc:190</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="add0941dcac8fe7e6bfe5d65979c9d388"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string kaldi::nnet3::PrintCommand </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_commands</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-analyze-test_8cc_source.html#l00028">28</a> of file <a class="el" href="nnet-analyze-test_8cc_source.html">nnet-analyze-test.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00416">NnetComputation::GetCommandStrings()</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, and <a class="el" href="nnet-analyze-test_8cc_source.html#l00039">UnitTestNnetAnalyze()</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                        {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="keywordflow">if</span> (command &lt; 0 || command &gt;= num_commands)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    os &lt;&lt; command;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;c&#39;</span> &lt;&lt; command;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace8b522d1ba98e1b9f16d48c7951eac1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::PrintCommand </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>computation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>command_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>submatrix_strings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes_strings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes_multi_strings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation_8cc_source.html#l00240">240</a> of file <a class="el" href="nnet-computation_8cc_source.html">nnet-computation.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00243">NnetComputation::Command::arg2</a>, <a class="el" href="nnet-computation_8h_source.html#l00244">NnetComputation::Command::arg3</a>, <a class="el" href="nnet-computation_8h_source.html#l00245">NnetComputation::Command::arg4</a>, <a class="el" href="nnet-computation_8h_source.html#l00246">NnetComputation::Command::arg5</a>, <a class="el" href="nnet-computation_8h_source.html#l00247">NnetComputation::Command::arg6</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00655">Nnet::GetComponentName()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00294">NnetComputation::indexes_ranges</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kAddRowRanges</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kAddRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kAddToRowsMulti</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackprop</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kBackpropNoModelUpdate</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kCopyRows</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00206">kCopyToRowsMulti</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixAdd</a>, <a class="el" href="nnet-computation_8h_source.html#l00205">kMatrixCopy</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperation</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperationMarker</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kPropagate</a>, <a class="el" href="nnet-computation_8h_source.html#l00204">kStoreStats</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, and <a class="el" href="nnet-computation_8h_source.html#l00306">NnetComputation::need_model_derivative</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                                            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(command_index &lt; computation.commands.size());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;c&quot;</span> &lt;&lt; command_index &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keyword">const</span> NnetComputation::Command &amp;c = computation.commands[command_index];</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">switch</span> (c.command_type) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>:</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot; = zeros(&quot;</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_rows</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; computation.matrices[c.arg1].num_cols &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>:</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot; = undefined(&quot;</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_rows</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; computation.matrices[c.arg1].num_cols &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot; = []\n&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>:</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot;.swap(m&quot;</span> &lt;&lt; c.arg2 &lt;&lt; <span class="stringliteral">&quot;) [dim = &quot;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_rows &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_cols &lt;&lt; <span class="stringliteral">&quot;]\n&quot;</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot;.swap(m&quot;</span> &lt;&lt; c.arg2 &lt;&lt; <span class="stringliteral">&quot;) [dim = &quot;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_rows &lt;&lt; <span class="stringliteral">&quot; x &quot;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;         &lt;&lt; computation.matrices[c.arg1].num_cols &lt;&lt; <span class="stringliteral">&quot;]; m&quot;</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;         &lt;&lt; c.arg1 &lt;&lt; <span class="stringliteral">&quot;.zero();\n&quot;</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kPropagate</a>:</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      os &lt;&lt; nnet.GetComponentName(c.arg1) &lt;&lt; <span class="stringliteral">&quot;.Propagate(&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">if</span> (c.arg2 == 0) os &lt;&lt; <span class="stringliteral">&quot;NULL, &quot;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">else</span> os &lt;&lt; <span class="stringliteral">&quot;precomputed_indexes[&quot;</span> &lt;&lt; c.arg2 &lt;&lt; <span class="stringliteral">&quot;], &quot;</span>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      os &lt;&lt; submatrix_strings[c.arg3] &lt;&lt; <span class="stringliteral">&quot;, &amp;&quot;</span> &lt;&lt; submatrix_strings[c.arg4]</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kStoreStats</a>:</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      os &lt;&lt; nnet.GetComponentName(c.arg1) &lt;&lt; <span class="stringliteral">&quot;.StoreStats(&quot;</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         &lt;&lt; submatrix_strings[c.arg2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a>:</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kBackpropNoModelUpdate</a>: {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> component_index = c.arg1;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      os &lt;&lt; nnet.GetComponentName(component_index) &lt;&lt; <span class="stringliteral">&quot;.Backprop(&quot;</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      <span class="keywordflow">if</span> (c.arg2 == 0) os &lt;&lt; <span class="stringliteral">&quot;NULL, &quot;</span>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">else</span> os &lt;&lt; <span class="stringliteral">&quot;precomputed_indexes[&quot;</span> &lt;&lt; c.arg2 &lt;&lt; <span class="stringliteral">&quot;], &quot;</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      os &lt;&lt; submatrix_strings[c.arg3] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;         &lt;&lt; submatrix_strings[c.arg4] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;         &lt;&lt; submatrix_strings[c.arg5] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         &lt;&lt; (computation.need_model_derivative &amp;&amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;             c.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kBackprop</a> ?</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;             <span class="stringliteral">&quot;[component-pointer], &quot;</span> : <span class="stringliteral">&quot;NULL, &quot;</span>)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         &lt;&lt; (c.arg6 == 0 ? std::string(<span class="stringliteral">&quot;NULL&quot;</span>) :</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;             std::string(<span class="stringliteral">&quot;&amp;&quot;</span>) + submatrix_strings[c.arg6]) &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kMatrixCopy</a>:</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      os &lt;&lt; submatrix_strings[c.arg1] &lt;&lt; <span class="stringliteral">&quot; = &quot;</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;         &lt;&lt; submatrix_strings[c.arg2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kMatrixAdd</a>:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      os &lt;&lt; submatrix_strings[c.arg1] &lt;&lt; <span class="stringliteral">&quot; += &quot;</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;         &lt;&lt; submatrix_strings[c.arg2] &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a>:</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kCopyRows</a>:</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      os &lt;&lt; submatrix_strings[c.arg1] &lt;&lt; <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;         &lt;&lt; (c.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kAddRows</a> ? <span class="stringliteral">&quot;AddRows&quot;</span> :</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;             <span class="stringliteral">&quot;CopyRows&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; submatrix_strings[c.arg2]</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;         &lt;&lt; indexes_strings[c.arg3] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a>:</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>:</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a>:</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kCopyToRowsMulti</a>: {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352">CommandType</a> ct = c.command_type;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      os &lt;&lt; submatrix_strings[c.arg1] &lt;&lt; <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;         &lt;&lt; (ct == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kAddRowsMulti</a> ? <span class="stringliteral">&quot;AddRowsMulti&quot;</span> :</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;             (ct == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kAddToRowsMulti</a>? <span class="stringliteral">&quot;AddToRowsMulti&quot;</span> :</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;              (ct == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kCopyRowsMulti</a> ? <span class="stringliteral">&quot;CopyRowsMulti&quot;</span> :</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;               <span class="stringliteral">&quot;CopyToRowsMulti&quot;</span>))) &lt;&lt; <span class="stringliteral">&quot;(&quot;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         &lt;&lt; indexes_multi_strings[c.arg2] &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kAddRowRanges</a>: {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      os &lt;&lt; submatrix_strings[c.arg1] &lt;&lt; <span class="stringliteral">&quot;.AddRowRanges(&quot;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         &lt;&lt; submatrix_strings[c.arg2] &lt;&lt; <span class="stringliteral">&quot;, [&quot;</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keyword">const</span> std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &amp;pairs =</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;           computation.indexes_ranges[c.arg3];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; pairs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        os &lt;&lt; pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; (pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second - 1);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; pairs.size()) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;])\n&quot;</span>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>:</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;[no-op]\n&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kNoOperationMarker</a>:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;# begin backward commands\n&quot;</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Un-handled command type.&quot;</span>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352">kaldi::nnet3::CommandType</a></div><div class="ttdeci">CommandType</div><div class="ttdoc">CommandType is an enum that describes the category of the command used in the NnetComputation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00201">nnet-computation.h:201</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a35d3d1a70d075561aaf91b263ea28f74">kaldi::nnet3::kMatrixCopy</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a341a9c019757a7f1172d86bad51500a5">kaldi::nnet3::kCopyRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a308b0ecf9083a7fde572d88f70af6258">kaldi::nnet3::kCopyRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae9638edeb0ada9a6373257fd508ae11f">kaldi::nnet3::kAddRows</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8ce789ab4782758335cc37349fb97257">kaldi::nnet3::kMatrixAdd</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00205">nnet-computation.h:205</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352af67517e882c1aebe145a016945b9e6a4">kaldi::nnet3::kNoOperationMarker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a5161c1dfc34a4df1b19e9d3b8dc9499c">kaldi::nnet3::kCopyToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26009d8f2bc3f61d214925ae25af9962">kaldi::nnet3::kAddRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352afab6637ac4a83d6775366b4e9c42e241">kaldi::nnet3::kBackpropNoModelUpdate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a7832c022dde05525759677b75b362b83">kaldi::nnet3::kBackprop</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a26ebe2a579bf27a5453cb7b489ad6f69">kaldi::nnet3::kPropagate</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a662aa95978d72cd24fde262e35941fad">kaldi::nnet3::kAddToRowsMulti</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00206">nnet-computation.h:206</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8fec1e67ab7c48513d561605914a81cb">kaldi::nnet3::kStoreStats</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00204">nnet-computation.h:204</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a86646468234ab036580a4f2e4d72af3c">kaldi::nnet3::kAddRowRanges</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa4f9689026c0962fecfe5cc56194840d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintCommandAttributes </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; CommandAttributes &gt; &amp;&#160;</td>
          <td class="paramname"><em>attributes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is to be used in debugging; it produces human-readable output. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l01180">1180</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8h_source.html#l00060">CommandAttributes::matrices_read</a>, <a class="el" href="nnet-analyze_8h_source.html#l00062">CommandAttributes::matrices_written</a>, <a class="el" href="nnet-analyze_8h_source.html#l00050">CommandAttributes::variables_read</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00052">CommandAttributes::variables_written</a>.</p>
<div class="fragment"><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                                                                            {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands = attributes.size();</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; num_commands; c++) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="keyword">const</span> CommandAttributes &amp;this_attr = attributes[c];</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;c&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span> (!this_attr.variables_read.empty()) {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;r(&quot;</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      std::vector&lt;int32&gt;::const_iterator iter = this_attr.variables_read.begin(),</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          end = this_attr.variables_read.end();</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;v&quot;</span> &lt;&lt; *iter;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">if</span> (iter+1 != end) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (!this_attr.variables_written.empty()) {</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;w(&quot;</span>;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      std::vector&lt;int32&gt;::const_iterator</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;          iter = this_attr.variables_written.begin(),</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;          end = this_attr.variables_written.end();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;v&quot;</span> &lt;&lt; *iter;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <span class="keywordflow">if</span> (iter+1 != end) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    }</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">if</span> (!this_attr.matrices_read.empty()) {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;r(&quot;</span>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      std::vector&lt;int32&gt;::const_iterator iter = this_attr.matrices_read.begin(),</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          end = this_attr.matrices_read.end();</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; *iter;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <span class="keywordflow">if</span> (iter+1 != end) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> (!this_attr.matrices_written.empty()) {</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;w(&quot;</span>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      std::vector&lt;int32&gt;::const_iterator</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;          iter = this_attr.matrices_written.begin(),</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;          end = this_attr.matrices_written.end();</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; *iter;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="keywordflow">if</span> (iter+1 != end) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;  }</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84e0b21f2d4f6d5eaf3edb65595b417c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::PrintComputationPreamble </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NnetComputation &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>submatrix_strings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes_strings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes_multi_strings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation_8cc_source.html#l00354">354</a> of file <a class="el" href="nnet-computation_8cc_source.html">nnet-computation.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00223">NnetComputation::MatrixDebugInfo::cindexes</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00650">Nnet::GetNodeName()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00050">Nnet::GetNodeNames()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00300">NnetComputation::input_output_info</a>, <a class="el" href="nnet-computation_8h_source.html#l00222">NnetComputation::MatrixDebugInfo::is_deriv</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, <a class="el" href="nnet-computation_8h_source.html#l00263">NnetComputation::matrix_debug_info</a>, and <a class="el" href="nnet-common_8cc_source.html#l00232">PrintCindexes()</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00416">NnetComputation::GetCommandStrings()</a>, and <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                       {</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="comment">// First print info about the matrices.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;matrix &quot;</span>;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; c.matrices.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; c.matrices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].num_rows</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; c.matrices[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].num_cols &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; c.matrices.size())</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="comment">// show which matrices the inputs and outputs map to.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">for</span> (unordered_map&lt;<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>, std::pair&lt;int32, int32&gt; &gt;::const_iterator iter =</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;           c.input_output_info.begin(); iter != c.input_output_info.end();</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;       ++iter) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> node_index = iter-&gt;first,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        value_matrix_index = iter-&gt;second.first,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        deriv_matrix_index = iter-&gt;second.second;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    os &lt;&lt; nnet.GetNodeName(node_index) &lt;&lt; <span class="stringliteral">&quot;.value -&gt; m&quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;       &lt;&lt; value_matrix_index &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> (deriv_matrix_index != 0) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      os &lt;&lt; nnet.GetNodeName(node_index) &lt;&lt; <span class="stringliteral">&quot;.deriv -&gt; m&quot;</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;         &lt;&lt; deriv_matrix_index &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keywordflow">if</span> (!c.matrix_debug_info.empty()) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;# The following show how matrices correspond to network-nodes and\n&quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;# cindex-ids.  Format is: matrix = &lt;node-id&gt;.[value|deriv][ &lt;list-of-cindex-ids&gt; ]\n&quot;</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;# where a cindex-id is written as (n,t[,x]) but ranges of t values are compressed\n&quot;</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;# so we write (n, tfirst:tlast).\n&quot;</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(c.matrix_debug_info.size() == c.matrices.size());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 1; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; c.matrices.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">const</span> NnetComputation::MatrixDebugInfo &amp;debug_info =</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          c.matrix_debug_info[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; == &quot;</span> &lt;&lt; (debug_info.is_deriv ? <span class="stringliteral">&quot;deriv: &quot;</span> : <span class="stringliteral">&quot;value: &quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a610537b433bd5824688a70413c9905c6">PrintCindexes</a>(os, debug_info.cindexes, nnet.GetNodeNames());</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a610537b433bd5824688a70413c9905c6"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a610537b433bd5824688a70413c9905c6">kaldi::nnet3::PrintCindexes</a></div><div class="ttdeci">void PrintCindexes(std::ostream &amp;ostream, const std::vector&lt; Cindex &gt; &amp;cindexes, const std::vector&lt; std::string &gt; &amp;node_names)</div><div class="ttdoc">this will only be used for pretty-printing. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00232">nnet-common.cc:232</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a55b3c5fd7a70b59070dfec3be993ff80"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::PrintFloatSuccinctly </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>f</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00445">445</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse_8cc_source.html#l00462">SummarizeVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                                                              {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">if</span> (fabs(f) &lt; 10000.0 &amp;&amp; fabs(f) &gt;= 10.0) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    os  &lt;&lt; std::fixed &lt;&lt; std::setprecision(0) &lt;&lt; f;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(f) &gt;= 0.995) {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    os  &lt;&lt; std::fixed &lt;&lt; std::setprecision(1) &lt;&lt; f;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fabs(f) &gt;= 0.01) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    os  &lt;&lt; std::fixed &lt;&lt; std::setprecision(2) &lt;&lt; f;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    os &lt;&lt; std::setprecision(1) &lt;&lt; f;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  os.unsetf(std::ios_base::floatfield);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  os &lt;&lt; std::setprecision(6);  <span class="comment">// Restore the default.</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a794312260c52d2eb93f30302ee0a7173"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string PrintGraphToString </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints a graph to a string in a pretty way for human readability, e.g. </p>
<p>as 0 -&gt; 1,2; 1 -&gt; 2; 2 -&gt; 3,4,5; etc. </p>

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00248">248</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00265">ComputeNnetComputationEpochs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                                                        {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes = graph.size();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_nodes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    os &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot; -&gt; (&quot;</span>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;vec = graph[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = vec.size();</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; size; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      os &lt;&lt; vec[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + 1 &lt; size) os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">if</span> (i + 1 &lt; num_nodes) os &lt;&lt; <span class="stringliteral">&quot;; &quot;</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af952225c01896b2850ffdb09ea2f0ba6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintIndexes </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>ostream</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Index &gt; &amp;&#160;</td>
          <td class="paramname"><em>indexes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>this will only be used for pretty-printing. </p>
<p>It prints a vector of Indexes in a compact, human-readable way with compression of ranges (it also doesn't print the x index if it's 1.0. Example output: "[ (1,1:20), (2, 1:20) ]" which would correspond to the indexes [ (1,1,0), (1,2,0) ... (1,20,0) (2,1,0) ... (2,20,0) ]. </p>

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00190">190</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-common_8h_source.html#l00045">Index::n</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation_8cc_source.html#l00465">IoSpecification::Print()</a>, and <a class="el" href="nnet-common_8cc_source.html#l00232">PrintCindexes()</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                                                   {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="keywordflow">if</span> (indexes.empty()) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;[ ]&quot;</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// range_starts will be the starts of ranges (with consecutive t values and</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// the same n value and zero x values) that we compactly print.  we&#39;ll append</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="comment">// &quot;end&quot; to range_starts for convenience.n</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  std::vector&lt;int32&gt; range_starts;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_start = 0, end = indexes.size();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = cur_start; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; end; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> Index &amp;index = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; cur_start &amp;&amp;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        (index.t != indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].t + 1 ||</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         index.n != indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].n ||</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;         index.x != indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].x)) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      range_starts.push_back(cur_start);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      cur_start = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    }</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  range_starts.push_back(cur_start);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  range_starts.push_back(end);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_ranges = range_starts.size() - 1;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = 0; r &lt; num_ranges; r++) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> range_start = range_starts[r], range_end = range_starts[r+1];</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(range_end &gt; range_start);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; indexes[range_start].n &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (range_end == range_start + 1)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      os &lt;&lt; indexes[range_start].t;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      os &lt;&lt; indexes[range_start].t &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; indexes[range_end - 1].t;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (indexes[range_start].x != 0)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; indexes[range_start].x;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (r + 1 &lt; num_ranges)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91ad7b2e440d9b50c196a361f559a427"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintIntegerVector </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>ints</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00259">259</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01001">kaldi::nnet3::computation_graph::ComputeEpochInfo()</a>, and <a class="el" href="nnet-computation_8cc_source.html#l00175">GetIndexesStrings()</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                      {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">if</span> (ints.empty()) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;[ ]&quot;</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// range_starts will be the starts of ranges (with consecutive or identical</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// values) that we compactly print.  we&#39;ll append &quot;end&quot; to range_starts for</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// convenience.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  std::vector&lt;int32&gt; range_starts;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_start = 0, end = ints.size();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = cur_start; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; end; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &gt; cur_start) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> range_start_val = ints[cur_start],</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;          range_start_plus_one_val = ints[cur_start+1],</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          cur_val = ints[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">// if we have reached the end of a range...</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="keywordflow">if</span> (!((range_start_plus_one_val == range_start_val &amp;&amp;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;             cur_val == range_start_val) ||</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            (range_start_plus_one_val == range_start_val + 1 &amp;&amp;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;             cur_val == range_start_val + <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> - cur_start))) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        range_starts.push_back(cur_start);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        cur_start = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  range_starts.push_back(cur_start);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  range_starts.push_back(end);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_ranges = range_starts.size() - 1;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> r = 0; r &lt; num_ranges; r++) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> range_start = range_starts[r], range_end = range_starts[r+1];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(range_end &gt; range_start);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span> (range_end == range_start + 1)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      os &lt;&lt; ints[range_start];</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (range_end == range_start + 2)  <span class="comment">// don&#39;t print ranges of 2.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      os &lt;&lt; ints[range_start] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ints[range_start+1];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ints[range_start] == ints[range_start+1])</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      os &lt;&lt; ints[range_start] &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; (range_end - range_start);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      os &lt;&lt; ints[range_start] &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; ints[range_end - 1];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (r + 1 &lt; num_ranges)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa09a3995a6335eb986c2fb6432ff785c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintMatrixAccesses </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; MatrixAccesses &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix_accesses</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is to be used in debugging; it produces human-readable output. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l01162">1162</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8h_source.html#l00261">MatrixAccesses::accesses</a>, <a class="el" href="nnet-analyze_8h_source.html#l00251">MatrixAccesses::allocate_command</a>, <a class="el" href="nnet-analyze_8h_source.html#l00254">MatrixAccesses::deallocate_command</a>, <a class="el" href="nnet-analyze_8h_source.html#l00077">kReadAccess</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00078">kWriteAccess</a>.</p>
<div class="fragment"><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                                                                           {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = matrix_accesses.size();</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> m = 1; m &lt; num_matrices; m++) {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keyword">const</span> MatrixAccesses &amp;a = matrix_accesses[m];</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;m&quot;</span> &lt;&lt; m &lt;&lt; <span class="stringliteral">&quot;: init-command=&quot;</span> &lt;&lt; a.allocate_command</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, destroy-command=&quot;</span> &lt;&lt; a.deallocate_command</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;, accesses=&quot;</span>;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    std::vector&lt;Access&gt;::const_iterator iter = a.accesses.begin(),</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        end = a.accesses.end();</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">for</span> (; iter != end; ++iter)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;c&#39;</span> &lt;&lt; iter-&gt;command_index &lt;&lt; <span class="stringliteral">&quot;(&quot;</span></div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         &lt;&lt; (iter-&gt;access_type == <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kReadAccess</a> ? <span class="stringliteral">&quot;r&quot;</span> :</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;             (iter-&gt;access_type == <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a> ? <span class="stringliteral">&quot;w&quot;</span> : <span class="stringliteral">&quot;rw&quot;</span>)) &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478acaca1f8be65b8d29c8710e04ac7629f3">kaldi::nnet3::kReadAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00077">nnet-analyze.h:77</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a14e044557c8e48dce3feeb79c8402ff2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintParameterStats </td>
          <td>(</td>
          <td class="paramtype">std::ostringstream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CuVector&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_mean</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print to 'os' some information about the mean and standard deviation of some parameters, used in Info() functions in <a class="el" href="nnet-simple-component_8cc.html">nnet-simple-component.cc</a>. </p>
<p>For example: PrintParameterStats(os, "bias", bias_params_, true); would print to 'os' something like the string ", bias-{mean,stddev}=-0.013,0.196". If 'include_mean = false', it will print something like ", bias-rms=0.2416", and this represents and uncentered standard deviation. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00498">498</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="cu-vector_8h_source.html#l00067">CuVectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="cu-vector_8cc_source.html#l00261">CuVectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00036">kaldi::VecVec()</a>.</p>

<p>Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l00716">AffineComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l00975">RepeatedAffineComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01377">BlockAffineComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02158">NaturalGradientAffineComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02276">FixedAffineComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02607">FixedScaleComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l02679">FixedBiasComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01663">PerElementScaleComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l01832">PerElementOffsetComponent::Info()</a>, <a class="el" href="nnet-simple-component_8cc_source.html#l03004">ConvolutionComponent::Info()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l03646">Convolutional1dComponent::Info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                            {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  os &lt;&lt; std::setprecision(4);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordflow">if</span> (include_mean) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> mean = params.<a class="code" href="classkaldi_1_1CuVectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>() / params.<a class="code" href="classkaldi_1_1CuVectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>(),</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        stddev = std::sqrt(<a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(params, params) / params.<a class="code" href="classkaldi_1_1CuVectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() - mean * mean);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;{mean,stddev}=&quot;</span> &lt;&lt; mean &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; stddev;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rms = std::sqrt(<a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(params, params) / params.<a class="code" href="classkaldi_1_1CuVectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>());</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;rms=&quot;</span> &lt;&lt; rms;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  os &lt;&lt; std::setprecision(6);  <span class="comment">// restore the default precision.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1CuVectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1CuVectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::CuVectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-vector_8cc_source.html#l00261">cu-vector.cc:261</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1CuVectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1CuVectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::CuVectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-vector_8h_source.html#l00067">cu-vector.h:67</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga4750cd6f7a02a013435779588056b153"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">kaldi::VecVec</a></div><div class="ttdeci">Real VecVec(const VectorBase&lt; Real &gt; &amp;a, const VectorBase&lt; Real &gt; &amp;b)</div><div class="ttdoc">Returns dot product between v1 and v2. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00036">kaldi-vector.cc:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e0100db7fe73351b449fa77ddc46b0c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PrintParameterStats </td>
          <td>(</td>
          <td class="paramtype">std::ostringstream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CuMatrix&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_mean</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print to 'os' some information about the mean and standard deviation of some parameters, used in Info() functions in <a class="el" href="nnet-simple-component_8cc.html">nnet-simple-component.cc</a>. </p>
<p>For example: PrintParameterStats(os, "linear-params", linear_params_; would print to 'os' something like the string ", linear-params-rms=0.239". If you set include_mean to true, it will print something like ", linear-params-{mean-stddev}=0.103,0.183". </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00515">515</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="cu-matrix_8h_source.html#l00196">CuMatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="cu-matrix_8h_source.html#l00195">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02434">CuMatrixBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>.</p>
<div class="fragment"><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                            {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  os &lt;&lt; std::setprecision(4);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; name &lt;&lt; <span class="charliteral">&#39;-&#39;</span>;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dim = params.<a class="code" href="classkaldi_1_1CuMatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() * params.<a class="code" href="classkaldi_1_1CuMatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <span class="keywordflow">if</span> (include_mean) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> mean = params.<a class="code" href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>() / dim,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        stddev = std::sqrt(<a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(params, params, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) / dim -</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                           mean * mean);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;{mean,stddev}=&quot;</span> &lt;&lt; mean &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; stddev;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rms = std::sqrt(<a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(params, params, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) / dim);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;rms=&quot;</span> &lt;&lt; rms;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  os &lt;&lt; std::setprecision(6);  <span class="comment">// restore the default precision.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::CuMatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00196">cu-matrix.h:196</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::CuMatrixBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02434">cu-matrix.cc:2434</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::CuMatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8h_source.html#l00195">cu-matrix.h:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa1a1184cd1146007ebf5403444309b69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::PrintPriorDiagnostics </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>old_priors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>new_priors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-am-adjust-priors_8cc_source.html#l00048">48</a> of file <a class="el" href="nnet3-am-adjust-priors_8cc_source.html">nnet3-am-adjust-priors.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l01017">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00797">VectorBase&lt; Real &gt;::ApplyAbs()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet3-am-adjust-priors_8cc_source.html#l00031">KlDivergence()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00566">VectorBase&lt; Real &gt;::Max()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-am-adjust-priors_8cc_source.html#l00070">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                                {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (old_priors.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() == 0) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Model did not previously have priors attached.&quot;</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> diff_prior(new_priors);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    diff_prior.AddVec(-1.0, old_priors);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    diff_prior.ApplyAbs();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_index;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    diff_prior.Max(&amp;max_index);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Adjusting priors: largest absolute difference was for &quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;pdf &quot;</span> &lt;&lt; max_index &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; old_priors(max_index)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; new_priors(max_index);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Adjusting priors: K-L divergence from old to new is &quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;              &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a04165cf9403194c5a77e922f8f14d5f9">KlDivergence</a>(old_priors, new_priors);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a04165cf9403194c5a77e922f8f14d5f9"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a04165cf9403194c5a77e922f8f14d5f9">kaldi::nnet3::KlDivergence</a></div><div class="ttdeci">BaseFloat KlDivergence(const Vector&lt; BaseFloat &gt; &amp;p, const Vector&lt; BaseFloat &gt; &amp;q)</div><div class="ttdef"><b>Definition:</b> <a href="nnet3-am-adjust-priors_8cc_source.html#l00031">nnet3-am-adjust-priors.cc:31</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6cbf9817f25ef1302ede1ed03897394a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string PrintVectorPerUpdatableComponent </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const VectorBase&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is for printing, to a string, a vector with one element per updatable component of the nnet (e.g. </p>
<p>the output of ComponentDotProducts), in a human readable way, as [ component-name1:number1 component-name2:number2 ... ]. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00206">206</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00655">Nnet::GetComponentName()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00352">NumUpdatableComponents()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-show-progress_8cc_source.html#l00027">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                                               {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;[ &quot;</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a25df665b8f7a712a34469e53fc875851">NumUpdatableComponents</a>(nnet) == vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>());</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> updatable_c = 0;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet.NumComponents(); c++) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keyword">const</span> Component *comp = nnet.GetComponent(c);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keyword">const</span> std::string &amp;component_name = nnet.GetComponentName(c);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      os &lt;&lt; component_name &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; vec(updatable_c) &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      updatable_c++;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(updatable_c == vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  os &lt;&lt; <span class="charliteral">&#39;]&#39;</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a25df665b8f7a712a34469e53fc875851"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a25df665b8f7a712a34469e53fc875851">kaldi::nnet3::NumUpdatableComponents</a></div><div class="ttdeci">int32 NumUpdatableComponents(const Nnet &amp;dest)</div><div class="ttdoc">Returns the number of updatable components in the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00352">nnet-utils.cc:352</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2fee0700fd475dc0d6b4a9d618e9a72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::PrintVectorVectorPair </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt;&#160;</td>
          <td class="paramname"><em>vec_vec_pair</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00050">50</a> of file <a class="el" href="nnet-compile-utils-test_8cc_source.html">nnet-compile-utils-test.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00275">UnitTestSplitLocations()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00070">UnitTestSplitLocationsBackward()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                                                                 {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  std::ostringstream ostream;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vec_vec_pair.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; vec_vec_pair[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)  {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      ostream &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; vec_vec_pair[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;              &lt;&lt; vec_vec_pair[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second &lt;&lt; <span class="stringliteral">&quot;) &quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    ostream &lt;&lt; std::endl;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; ostream.str();</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f43129423ce5f470437ce2b0972715b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ProcessFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; BaseFloat &gt; *&#160;</td>
          <td class="paramname"><em>ivector_feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>targets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>utt_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_targets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>right_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frames_per_eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *&#160;</td>
          <td class="paramname"><em>num_frames_written</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *&#160;</td>
          <td class="paramname"><em>num_egs_written</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a> *&#160;</td>
          <td class="paramname"><em>example_writer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-get-egs-dense-targets_8cc_source.html#l00033">33</a> of file <a class="el" href="nnet3-get-egs-dense-targets_8cc_source.html">nnet3-get-egs-dense-targets.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00117">NnetExample::Compress()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00227">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, and <a class="el" href="kaldi-table-inl_8h_source.html#l01181">TableWriter&lt; Holder &gt;::Write()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-get-egs-dense-targets_8cc_source.html#l00133">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                                           {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == <span class="keyword">static_cast&lt;</span><a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a><span class="keyword">&gt;</span>(targets.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>()));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = 0; t &lt; feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>(); t += frames_per_eg) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// actual_frames_per_eg is the number of frames with actual targets.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// At the end of the file, we pad with the last frame repeated</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// so that all examples have the same structure (prevents the need</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// for recompilations).</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// TODO: We might need to ignore the end of the file.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> actual_frames_per_eg = std::min(frames_per_eg,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                                          feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - t);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tot_frames = left_context + frames_per_eg + right_context;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> input_frames(tot_frames, feats.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>());</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// Set up &quot;input_frames&quot;.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = -left_context; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; frames_per_eg + right_context; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t2 = <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + t;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (t2 &lt; 0) t2 = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (t2 &gt;= feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>()) t2 = feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - 1;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> src(feats, t2),</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;          dest(input_frames, <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + left_context);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      dest.CopyFromVec(src);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// call the regular input &quot;input&quot;.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;input&quot;</span>, - left_context,</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                           input_frames));</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// if applicable, add the iVector feature.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">if</span> (ivector_feats != NULL) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// try to get closest frame to middle of window to get</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// a representative iVector.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> closest_frame = t + (actual_frames_per_eg / 2);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() &gt; 0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keywordflow">if</span> (closest_frame &gt;= ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>())</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        closest_frame = ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - 1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> ivector(1, ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      ivector.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(0).CopyFromVec(ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(closest_frame));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;ivector&quot;</span>, 0, ivector));</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// add the labels.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> targets_dest(frames_per_eg, targets.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>());</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; actual_frames_per_eg; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="comment">// Copy the i^th row of the target matrix from the (t+i)^th row of the</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="comment">// input targets matrix</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> this_target_dest(targets_dest, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> this_target_src(targets, t+<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      this_target_dest.CopyFromVec(this_target_src);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    } </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// Copy the last frame&#39;s target to the padded frames</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = actual_frames_per_eg; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; frames_per_eg; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="comment">// Copy the i^th row of the target matrix from the last row of the </span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <span class="comment">// input targets matrix</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(t + actual_frames_per_eg - 1 == feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - 1);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> this_target_dest(targets_dest, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> this_target_src(targets, t+actual_frames_per_eg-1);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      this_target_dest.CopyFromVec(this_target_src);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    } </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// push this created targets matrix into the eg</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;output&quot;</span>, 0, targets_dest));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span> (compress)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#a0ba9edee3fd93ac653cee4e428b6e93e">Compress</a>();</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    os &lt;&lt; utt_id &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; t;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    std::string key = os.str(); <span class="comment">// key is &lt;utt_id&gt;-&lt;frame_id&gt;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    *num_frames_written += actual_frames_per_eg;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    *num_egs_written += 1;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    example_writer-&gt;<a class="code" href="group__table__impl__types.html#ga563dc98f9c647a721ad2468f08b684a0">Write</a>(key, eg);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html">kaldi::nnet3::NnetExample</a></div><div class="ttdoc">NnetExample is the input data and corresponding label (or labels) for one or more frames of input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00082">nnet-example.h:82</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html">kaldi::nnet3::NnetIo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00033">nnet-example.h:33</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__table__impl__types_html_ga563dc98f9c647a721ad2468f08b684a0"><div class="ttname"><a href="group__table__impl__types.html#ga563dc98f9c647a721ad2468f08b684a0">kaldi::TableWriter::Write</a></div><div class="ttdeci">void Write(const std::string &amp;key, const T &amp;value) const </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-table-inl_8h_source.html#l01181">kaldi-table-inl.h:1181</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html"><div class="ttname"><a href="classkaldi_1_1Matrix.html">kaldi::Matrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a29c8fdd802482a5c58eaa224a4fdb170"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">kaldi::MatrixBase::Row</a></div><div class="ttdeci">const SubVector&lt; Real &gt; Row(MatrixIndexT i) const </div><div class="ttdoc">Return specific row of matrix [const]. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00182">kaldi-matrix.h:182</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_a0ba9edee3fd93ac653cee4e428b6e93e"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#a0ba9edee3fd93ac653cee4e428b6e93e">kaldi::nnet3::NnetExample::Compress</a></div><div class="ttdeci">void Compress()</div><div class="ttdoc">Compresses any (input) features that are not sparse. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8cc_source.html#l00117">nnet-example.cc:117</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::MatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdoc">Returns number of columns (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_acfc99ed8d51e6726a7c4e888afebc910"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">kaldi::nnet3::NnetExample::io</a></div><div class="ttdeci">std::vector&lt; NnetIo &gt; io</div><div class="ttdoc">&quot;io&quot; contains the input and output. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00087">nnet-example.h:87</a></div></div>
<div class="ttc" id="classkaldi_1_1SubVector_html"><div class="ttname"><a href="classkaldi_1_1SubVector.html">kaldi::SubVector</a></div><div class="ttdoc">Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00479">kaldi-vector.h:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a91ea84b2938a661d4b98daa3cfc51606"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ProcessFile </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1MatrixBase.html">MatrixBase</a>&lt; BaseFloat &gt; *&#160;</td>
          <td class="paramname"><em>ivector_feats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> &amp;&#160;</td>
          <td class="paramname"><em>pdf_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>utt_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>compress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_pdfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>right_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frames_per_eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *&#160;</td>
          <td class="paramname"><em>num_frames_written</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> *&#160;</td>
          <td class="paramname"><em>num_egs_written</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacekaldi_1_1nnet3.html#af2246cc04a2596de3c09fad3c3513671">NnetExampleWriter</a> *&#160;</td>
          <td class="paramname"><em>example_writer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-get-egs_8cc_source.html#l00033">33</a> of file <a class="el" href="nnet3-get-egs_8cc_source.html">nnet3-get-egs.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00117">NnetExample::Compress()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00227">VectorBase&lt; Real &gt;::CopyFromVec()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00037">kaldi::kUndefined</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00061">MatrixBase&lt; Real &gt;::NumCols()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00058">MatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, and <a class="el" href="kaldi-table-inl_8h_source.html#l01181">TableWriter&lt; Holder &gt;::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                                           {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() == <span class="keyword">static_cast&lt;</span><a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a><span class="keyword">&gt;</span>(pdf_post.size()));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t = 0; t &lt; feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>(); t += frames_per_eg) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// actual_frames_per_eg is the number of frames with nonzero</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// posteriors.  At the end of the file we pad with zero posteriors</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// so that all examples have the same structure (prevents the need</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// for recompilations).</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> actual_frames_per_eg = std::min(frames_per_eg,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                                          feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - t);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tot_frames = left_context + frames_per_eg + right_context;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> input_frames(tot_frames, feats.<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>(), <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kUndefined</a>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// Set up &quot;input_frames&quot;.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = -left_context; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; frames_per_eg + right_context; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t2 = <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + t;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="keywordflow">if</span> (t2 &lt; 0) t2 = 0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (t2 &gt;= feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>()) t2 = feats.<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - 1;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="classkaldi_1_1SubVector.html">SubVector&lt;BaseFloat&gt;</a> src(feats, t2),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          dest(input_frames, <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> + left_context);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      dest.CopyFromVec(src);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// call the regular input &quot;input&quot;.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;input&quot;</span>, - left_context,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                           input_frames));</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// if applicable, add the iVector feature.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (ivector_feats != NULL) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="comment">// try to get closest frame to middle of window to get</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// a representative iVector.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> closest_frame = t + (actual_frames_per_eg / 2);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() &gt; 0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      <span class="keywordflow">if</span> (closest_frame &gt;= ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>())</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        closest_frame = ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">NumRows</a>() - 1;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> ivector(1, ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">NumCols</a>());</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      ivector.<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(0).CopyFromVec(ivector_feats-&gt;<a class="code" href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">Row</a>(closest_frame));</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;ivector&quot;</span>, 0, ivector));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// add the labels.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a> labels(frames_per_eg);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; actual_frames_per_eg; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      labels[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = pdf_post[t + <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// remaining posteriors for frames are empty.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">io</a>.push_back(<a class="code" href="structkaldi_1_1nnet3_1_1NnetIo.html">NnetIo</a>(<span class="stringliteral">&quot;output&quot;</span>, num_pdfs, 0, labels));</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">if</span> (compress)</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#a0ba9edee3fd93ac653cee4e428b6e93e">Compress</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    os &lt;&lt; utt_id &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; t;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    std::string key = os.str(); <span class="comment">// key is &lt;utt_id&gt;-&lt;frame_id&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    *num_frames_written += actual_frames_per_eg;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    *num_egs_written += 1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    example_writer-&gt;<a class="code" href="group__table__impl__types.html#ga563dc98f9c647a721ad2468f08b684a0">Write</a>(key, eg);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html">kaldi::nnet3::NnetExample</a></div><div class="ttdoc">NnetExample is the input data and corresponding label (or labels) for one or more frames of input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00082">nnet-example.h:82</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetIo_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetIo.html">kaldi::nnet3::NnetIo</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00033">nnet-example.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80baf2cd3231820315500697550960956126">kaldi::kUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00037">matrix-common.h:37</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__table__impl__types_html_ga563dc98f9c647a721ad2468f08b684a0"><div class="ttname"><a href="group__table__impl__types.html#ga563dc98f9c647a721ad2468f08b684a0">kaldi::TableWriter::Write</a></div><div class="ttdeci">void Write(const std::string &amp;key, const T &amp;value) const </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-table-inl_8h_source.html#l01181">kaldi-table-inl.h:1181</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html"><div class="ttname"><a href="classkaldi_1_1Matrix.html">kaldi::Matrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_a29c8fdd802482a5c58eaa224a4fdb170"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#a29c8fdd802482a5c58eaa224a4fdb170">kaldi::MatrixBase::Row</a></div><div class="ttdeci">const SubVector&lt; Real &gt; Row(MatrixIndexT i) const </div><div class="ttdoc">Return specific row of matrix [const]. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00182">kaldi-matrix.h:182</a></div></div>
<div class="ttc" id="group__posterior__group_html_ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><div class="ttname"><a href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">kaldi::Posterior</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &gt; Posterior</div><div class="ttdoc">Posterior is a typedef for storing acoustic-state (actually, transition-id) posteriors over an uttera...</div><div class="ttdef"><b>Definition:</b> <a href="posterior_8h_source.html#l00042">posterior.h:42</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_a0ba9edee3fd93ac653cee4e428b6e93e"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#a0ba9edee3fd93ac653cee4e428b6e93e">kaldi::nnet3::NnetExample::Compress</a></div><div class="ttdeci">void Compress()</div><div class="ttdoc">Compresses any (input) features that are not sparse. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8cc_source.html#l00117">nnet-example.cc:117</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_ab204078beff8151c95d1828544acf92c"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#ab204078beff8151c95d1828544acf92c">kaldi::MatrixBase::NumRows</a></div><div class="ttdeci">MatrixIndexT NumRows() const </div><div class="ttdoc">Returns number of rows (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00058">kaldi-matrix.h:58</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html_afe58124fbfb387ddc20513bf3075b16e"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html#afe58124fbfb387ddc20513bf3075b16e">kaldi::MatrixBase::NumCols</a></div><div class="ttdeci">MatrixIndexT NumCols() const </div><div class="ttdoc">Returns number of columns (or zero for emtpy matrix). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8h_source.html#l00061">kaldi-matrix.h:61</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_acfc99ed8d51e6726a7c4e888afebc910"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#acfc99ed8d51e6726a7c4e888afebc910">kaldi::nnet3::NnetExample::io</a></div><div class="ttdeci">std::vector&lt; NnetIo &gt; io</div><div class="ttdoc">&quot;io&quot; contains the input and output. </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00087">nnet-example.h:87</a></div></div>
<div class="ttc" id="classkaldi_1_1SubVector_html"><div class="ttname"><a href="classkaldi_1_1SubVector.html">kaldi::SubVector</a></div><div class="ttdoc">Represents a non-allocating general vector which can be defined as a sub-vector of higher-level vecto...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00479">kaldi-vector.h:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace63d2b2d7c79e9881204ea52366e48c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadConfigFile </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; *&#160;</td>
          <td class="paramname"><em>lines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads in a config file and *appends* its contents to a vector of lines; it is responsible for removing comments (anything after '#') and stripping out any lines that contain only whitespace after comment removal. </p>

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00414">414</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, and <a class="el" href="nnet-parse-test_8cc_source.html#l00167">UnitTestReadConfig()</a>.</p>
<div class="fragment"><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                                 {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines != NULL);</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  std::string line;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordflow">while</span> (std::getline(is, line)) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">if</span> (line.size() == 0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordtype">size_t</span> start = line.find_first_not_of(<span class="stringliteral">&quot; \t&quot;</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">size_t</span> end = line.find_first_of(<span class="charliteral">&#39;#&#39;</span>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (start == std::string::npos || start == end) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    end = line.find_last_not_of(<span class="stringliteral">&quot; \t&quot;</span>, end - 1);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(end &gt;= start);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    lines-&gt;push_back(line.substr(start, end - start + 1));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2069492e6a46f0c6b003a52cf87e2f7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadIndexVector </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Index &gt; *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00135">135</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor_8cc_source.html#l00045">ExpectToken()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00054">kaldi::ReadBasicType()</a>, and <a class="el" href="nnet-common_8cc_source.html#l00079">ReadIndexVectorElementBinary()</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00038">NnetIo::Read()</a>, and <a class="el" href="nnet-common-test_8cc_source.html#l00027">UnitTestIndexIo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                            {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">ExpectToken</a>(is, binary, <span class="stringliteral">&quot;&lt;I1V&gt;&quot;</span>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;size);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span> (size &lt; 0) {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error reading Index vector: size = &quot;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              &lt;&lt; size;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  vec-&gt;resize(size);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">if</span> (!binary) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      (*vec)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Read(is, binary);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#ada744dcd7dc25034e74e7a1f076fa05b">ReadIndexVectorElementBinary</a>(is, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>, vec);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00054">io-funcs-inl.h:54</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ada744dcd7dc25034e74e7a1f076fa05b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ada744dcd7dc25034e74e7a1f076fa05b">kaldi::nnet3::ReadIndexVectorElementBinary</a></div><div class="ttdeci">static void ReadIndexVectorElementBinary(std::istream &amp;is, int32 i, std::vector&lt; Index &gt; *vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00079">nnet-common.cc:79</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga4c7a80f758e878578e78b667f62463a5"><div class="ttname"><a href="group__io__funcs__basic.html#ga4c7a80f758e878578e78b667f62463a5">kaldi::ExpectToken</a></div><div class="ttdeci">void ExpectToken(std::istream &amp;is, bool binary, const char *token)</div><div class="ttdoc">ExpectToken tries to read in the given token, and throws an exception on failure. ...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00188">io-funcs.cc:188</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada744dcd7dc25034e74e7a1f076fa05b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::ReadIndexVectorElementBinary </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; Index &gt; *&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00079">79</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-common_8h_source.html#l00045">Index::n</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00054">kaldi::ReadBasicType()</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>

<p>Referenced by <a class="el" href="nnet-common_8cc_source.html#l00135">ReadIndexVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                           {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordtype">bool</span> binary = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  Index &amp;index = (*vec)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">if</span> (!is.good())</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;End of file while reading vector of Index.&quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">signed</span> <span class="keywordtype">char</span> c = is.get();</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0) {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (std::abs(<span class="keywordtype">int</span>(c)) &lt; 125) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      index.n = 0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      index.t = c;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      index.x = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <span class="keywordflow">if</span> (c != 127)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unexpected character &quot;</span> &lt;&lt; c</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; encountered while reading Index vector.&quot;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.n));</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.t));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.x));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    Index &amp;last_index = (*vec)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (std::abs(<span class="keywordtype">int</span>(c)) &lt; 125) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      index.n = last_index.n;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      index.t = last_index.t + c;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      index.x = last_index.x;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keywordflow">if</span> (c != 127)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Unexpected character &quot;</span> &lt;&lt; c</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; encountered while reading Index vector.&quot;</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.n));</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.t));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, binary, &amp;(index.x));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00054">io-funcs-inl.h:54</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a556f73d99d4fcebed0e0bde2c2d34094"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::ReadIntegerToken </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>what_we_are_parsing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string **&#160;</td>
          <td class="paramname"><em>next_token</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor_8cc_source.html#l00056">56</a> of file <a class="el" href="nnet-descriptor_8cc_source.html">nnet-descriptor.cc</a>.</p>

<p>References <a class="el" href="text-utils_8h_source.html#l00114">kaldi::ConvertStringToInteger()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00029">ParsingContext()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor_8cc_source.html#l00560">GeneralDescriptor::ParseOffset()</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00586">GeneralDescriptor::ParseReplaceIndex()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00576">GeneralDescriptor::ParseRound()</a>.</p>
<div class="fragment"><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                                            {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(**next_token, &amp;ans))</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected integer while parsing &quot;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;              &lt;&lt; what_we_are_parsing &lt;&lt; <span class="stringliteral">&quot;, got &#39;&quot;</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;              &lt;&lt; **next_token &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#aa3fbd67899f39d18e85c03f06e0c69bf">ParsingContext</a>(*next_token);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  (*next_token)++;  <span class="comment">// advance token pointer.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a39eb3f7ce5fab6dbbcb396b3f8e196f4"><div class="ttname"><a href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">kaldi::ConvertStringToInteger</a></div><div class="ttdeci">bool ConvertStringToInteger(const std::string &amp;str, Int *out)</div><div class="ttdoc">Converts a string into an integer via strtoll and returns false if there was any kind of problem (i...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00114">text-utils.h:114</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa3fbd67899f39d18e85c03f06e0c69bf"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa3fbd67899f39d18e85c03f06e0c69bf">kaldi::nnet3::ParsingContext</a></div><div class="ttdeci">static std::string ParsingContext(const std::string *token_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00029">nnet-descriptor.cc:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac37caf62dbe225383341d770509b2d55"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::RearrangeIndexes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-simple-component_8cc_source.html#l03219">3219</a> of file <a class="el" href="nnet-simple-component_8cc_source.html">nnet-simple-component.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>.</p>

<p>Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l03239">ConvolutionComponent::InderivPatchesToInderiv()</a>.</p>
<div class="fragment"><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;                                                                                   {</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> D = in.size();</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> L = 0;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; D; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    <span class="keywordflow">if</span> (in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size() &gt; L)</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      L = in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  out-&gt;resize(L);</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; L; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    (*out)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(D, -1);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; D; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;      (*out)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    }</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  }</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1146f4efa141a56210f9dbf1090b20f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RemoveNoOps </td>
          <td>(</td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes commands of type kNoOperation in the computation. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00604">604</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, and <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperation</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l01535">DerivativeTimeLimiter::LimitDerivTimes()</a>, <a class="el" href="nnet-optimize-utils_8cc_source.html#l00706">VariableMergingOptimizer::MergeVariables()</a>, and <a class="el" href="nnet-optimize_8cc_source.html#l00185">RemoveUnnecessaryAllocation()</a>.</p>
<div class="fragment"><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                               {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  std::vector&lt;NnetComputation::Command&gt;::iterator</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      input_iter = computation-&gt;commands.begin(),</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      input_end = computation-&gt;commands.end(),</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      output_iter = computation-&gt;commands.begin();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keywordflow">for</span> (; input_iter != input_end; ++input_iter) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (input_iter-&gt;command_type != <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      *output_iter = *input_iter;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      ++output_iter;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    }</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  computation-&gt;commands.resize(output_iter - computation-&gt;commands.begin());</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a92c251003c3f612c5cfbcbd72cbd030b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RemoveUnnecessaryAllocation </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This optimization detects cases where we deallocate a matrix, and then later allocate another matrix of the same size; and replaces them with commands of type kAllocFromOther or kAllocFromOtherZeroed. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00185">185</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00242">NnetComputation::Command::arg1</a>, <a class="el" href="nnet-computation_8h_source.html#l00241">NnetComputation::Command::command_type</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00158">ComputeCommandPairs()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOther</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kAllocMatrixFromOtherZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-computation_8h_source.html#l00203">kDeallocMatrix</a>, <a class="el" href="nnet-computation_8h_source.html#l00207">kNoOperation</a>, <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00604">RemoveNoOps()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                               {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// For each size of matrix (i.e. each pair&lt;int32,int32&gt;), we</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// accumulate a list of indexes of deallocation commands that</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="comment">// are for that size, and a list of indexes of allocation commands</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="comment">// for that size.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">// For each distinct matrix size, we then call ComputeCommandPairs on those</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// two lists, to get pairs of (deallocation, allocation) command-indexes that</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// we can optimize out to a single command.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// The map is from a (num-rows,num-columns) to two lists, of</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// (deallocation-commands, allocation-commands).  The order may seem</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="comment">// backwards, but that&#39;s the order of the pairs we are looking for.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">typedef</span> unordered_map&lt;std::pair&lt;int32,int32&gt;,</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      std::pair&lt;std::vector&lt;int32&gt;,std::vector&lt;int32&gt; &gt;,</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      PairHasher&lt;int32&gt; &gt; MapType;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  MapType pair_map;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_commands = computation-&gt;commands.size();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> command_index = 0; command_index &lt; num_commands; command_index++) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    NnetComputation::Command &amp;command = computation-&gt;commands[command_index];</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> (command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a> ||</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a> ||</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> m = command.arg1, num_rows = computation-&gt;matrices[m].num_rows,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          num_cols = computation-&gt;matrices[m].num_cols;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      std::pair&lt;int32,int32&gt; p(num_rows, num_cols);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      std::pair&lt;std::vector&lt;int32&gt;,std::vector&lt;int32&gt; &gt; &amp;lists = pair_map[p];</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (command.command_type == <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>)</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        lists.first.push_back(command_index);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        lists.second.push_back(command_index);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  MapType::const_iterator iter = pair_map.begin(), end = pair_map.end();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  std::vector&lt;std::pair&lt;int32,int32&gt; &gt; command_pairs;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a4874b04bb051028a1b6cb08cff2d1994">ComputeCommandPairs</a>(iter-&gt;second, &amp;command_pairs);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; command_pairs.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dealloc_index = command_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        alloc_index = command_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    NnetComputation::Command</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        &amp;dealloc_command = computation-&gt;commands[dealloc_index],</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        &amp;alloc_command = computation-&gt;commands[alloc_index];</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(dealloc_command.command_type ==</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                 <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kDeallocMatrix</a>);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(alloc_command.command_type ==</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                 <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a> ||</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                 alloc_command.command_type==</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                 <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// remove the deallocation command.</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    dealloc_command.command_type =  <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kNoOperation</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    alloc_command.arg2 = dealloc_command.arg1;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">if</span> (alloc_command.command_type ==</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      alloc_command.command_type =</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kAllocMatrixFromOther</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      alloc_command.command_type =</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kAllocMatrixFromOtherZeroed</a>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a1146f4efa141a56210f9dbf1090b20f0">RemoveNoOps</a>(computation);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a4874b04bb051028a1b6cb08cff2d1994"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a4874b04bb051028a1b6cb08cff2d1994">kaldi::nnet3::ComputeCommandPairs</a></div><div class="ttdeci">static void ComputeCommandPairs(const std::pair&lt; std::vector&lt; int32 &gt;, std::vector&lt; int32 &gt; &gt; &amp;lists, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *pairs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00158">nnet-optimize.cc:158</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a79ca9eaa954dd29bb0671fb99e550439">kaldi::nnet3::kNoOperation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00207">nnet-computation.h:207</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ae77588ab7fc4ccf842de7ec941247062">kaldi::nnet3::kDeallocMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a2ffa126c95db5cb37f86de49ae4d66ca">kaldi::nnet3::kAllocMatrixFromOtherZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1146f4efa141a56210f9dbf1090b20f0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1146f4efa141a56210f9dbf1090b20f0">kaldi::nnet3::RemoveNoOps</a></div><div class="ttdeci">void RemoveNoOps(NnetComputation *computation)</div><div class="ttdoc">Removes commands of type kNoOperation in the computation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-utils_8cc_source.html#l00604">nnet-optimize-utils.cc:604</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352ac68649c74ab0264e4db51c27d1394f6c">kaldi::nnet3::kAllocMatrixFromOther</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00203">nnet-computation.h:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae053839b5ed781f2f7408489a1528dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RemoveUnnecessaryZeroing </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This optimization function changes, where possible, matrix initializations of type kAllocMatrixZeroed to kAllocMatrixUndefined. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00090">90</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8h_source.html#l00251">MatrixAccesses::allocate_command</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00156">ComputationVariables::AppendVariablesForMatrix()</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00267">MatrixAccesses::is_output</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixUndefined</a>, <a class="el" href="nnet-computation_8h_source.html#l00202">kAllocMatrixZeroed</a>, <a class="el" href="nnet-analyze_8h_source.html#l00078">kWriteAccess</a>, <a class="el" href="nnet-analyze_8h_source.html#l00295">Analyzer::matrix_accesses</a>, <a class="el" href="nnet-analyze_8h_source.html#l00294">Analyzer::variable_accesses</a>, and <a class="el" href="nnet-analyze_8h_source.html#l00292">Analyzer::variables</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                                            {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  Analyzer a;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  a.Init(nnet, *computation);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// OK, now we&#39;ll work out which matrices have all their pieces (i.e. all the</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// variables belonging to that matrix) written to as the first instruction</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// apart from the initial zeroing.  These matrices can have the initial</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// zeroing replaced by a sizing operation that leaves the data undefined.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = a.matrix_accesses.size();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> matrix_index = 0; matrix_index &lt; num_matrices; matrix_index++) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">const</span> MatrixAccesses &amp;accesses = a.matrix_accesses[matrix_index];</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> allocate_command = accesses.allocate_command;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (allocate_command == -1)  <span class="comment">// an input</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// nothing to do.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">if</span> (computation-&gt;commands[allocate_command].command_type !=</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kAllocMatrixZeroed</a>) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(computation-&gt;commands[allocate_command].command_type ==</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                   <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keywordflow">continue</span>;  <span class="comment">// already leaving it undefined, so nothing to do.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::vector&lt;int32&gt; variables_for_matrix;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    a.variables.AppendVariablesForMatrix(matrix_index, &amp;variables_for_matrix);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">bool</span> all_variables_ok = <span class="keyword">true</span>;  <span class="comment">// if this stays true, it means we don&#39;t need</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                   <span class="comment">// the initial zeroing.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; variables_for_matrix.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> variable_index = variables_for_matrix[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keyword">const</span> std::vector&lt;Access&gt; &amp;v_accesses =</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          a.variable_accesses[variable_index];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(v_accesses.size() &gt; 0 &amp;&amp;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                   v_accesses[0].command_index == allocate_command &amp;&amp;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                   v_accesses[0].access_type == <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="keywordflow">if</span> (v_accesses.size() &gt; 1 &amp;&amp;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          v_accesses[1].access_type != <a class="code" href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kWriteAccess</a>) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        all_variables_ok = <span class="keyword">false</span>;  <span class="comment">// first access after zeroing was not a write</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (v_accesses.size() == 1 &amp;&amp;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;          accesses.is_output) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">// the only command that touches this variable is the allocation, and it</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="comment">// is an output variable.  (this is unusual, but can happen e.g. if it&#39;s</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="comment">// a derivative, but due to min_deriv_time and max_deriv_time it ends up</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// always being zero.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        all_variables_ok = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (all_variables_ok) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="comment">// Here is where the change actually happens.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      computation-&gt;commands[allocate_command].command_type =</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <a class="code" href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kAllocMatrixUndefined</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a8cf8e30f096831a33208ef1b9e22affc">kaldi::nnet3::kAllocMatrixZeroed</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a21e038f5b8958e203d28bc4f18472352a45d4b0c9ccaa83d0f2ab46e59f6e51be">kaldi::nnet3::kAllocMatrixUndefined</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00202">nnet-computation.h:202</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ad8aff9e545a5f496a179a16667431478a6c8aa74b13e6c53c03527cac24060e4f">kaldi::nnet3::kWriteAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00078">nnet-analyze.h:78</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6828e427bd8883455705e0c9b99b5f2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RenumberComputation </td>
          <td>(</td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function detects submatrices, matrices, and members of indexes_multi and indexes that are never used (e.g. </p>
<p>due to changes made in other optimization code), and removes them from the computation by way of suitable renumbering. It does not remove no-ops from computation-&gt;commands_; to do that, call RemoveNoOps(computation). </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00599">599</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize-utils_8cc_source.html#l00396">ComputationRenumberer::Renumber()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l01535">DerivativeTimeLimiter::LimitDerivTimes()</a>, and <a class="el" href="nnet-optimize-utils_8cc_source.html#l00706">VariableMergingOptimizer::MergeVariables()</a>.</p>
<div class="fragment"><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                       {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  ComputationRenumberer renumberer(computation);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  renumberer.Renumber();</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a94e3ce52963d290fbf0595dea3b126c6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ReplaceInInput </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>orig_matrix_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>new_matrix_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wherever matrix orig_matrix_index appears in the input of the network (i.e. </p>
<p>in computation-&gt;input_output_info), replaces it with new_matrix_index. Returns true if it did replace it. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00621">621</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00300">NnetComputation::input_output_info</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00803">VariableMergingOptimizer::DoRightMerge()</a>.</p>
<div class="fragment"><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                  {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordtype">bool</span> ans = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = computation-&gt;matrices.size();</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(orig_matrix_index &gt; 0 &amp;&amp; orig_matrix_index &lt; num_matrices &amp;&amp;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;               new_matrix_index &gt; 0 &amp;&amp; new_matrix_index &lt; num_matrices);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  unordered_map&lt;int32, std::pair&lt;int32, int32&gt; &gt;::iterator</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      iter = computation-&gt;input_output_info.begin(),</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      end = computation-&gt;input_output_info.end();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> network_node = iter-&gt;first,</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        &amp;value_matrix_index = iter-&gt;second.first,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        &amp;deriv_matrix_index = iter-&gt;second.second;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">if</span> (nnet.IsOutputNode(network_node)) {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="comment">// deriv_matrix_index would be an input to the computation.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      <span class="keywordflow">if</span> (deriv_matrix_index == orig_matrix_index) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        deriv_matrix_index = new_matrix_index;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">// value_matrix_index would be an input to the computation.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">if</span> (value_matrix_index == orig_matrix_index) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        value_matrix_index = new_matrix_index;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2efea0af361ac9b6981f605d7e616028"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ReplaceInOutput </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>orig_matrix_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>new_matrix_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wherever matrix orig_matrix_index appears in the output of the network (i.e. </p>
<p>A helper function used in some optimization functions.</p>
<p>in computation-&gt;input_output_info), replaces it with new_matrix_index. Returns true if it did replace it.</p>
<p>Wherever matrix orig_matrix_index appears in the output of the network (i.e. in computation-&gt;input_output_info), replaces it with new_matrix_index. Returns true if it did replace it. </p>

<p>Definition at line <a class="el" href="nnet-optimize-utils_8cc_source.html#l00657">657</a> of file <a class="el" href="nnet-optimize-utils_8cc_source.html">nnet-optimize-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-computation_8h_source.html#l00300">NnetComputation::input_output_info</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00107">Nnet::IsInputNode()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00099">Nnet::IsOutputNode()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-computation_8h_source.html#l00259">NnetComputation::matrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-utils_8cc_source.html#l00900">VariableMergingOptimizer::DoLeftMerge()</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                  {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">bool</span> ans = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_matrices = computation-&gt;matrices.size();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(orig_matrix_index &gt; 0 &amp;&amp; orig_matrix_index &lt; num_matrices &amp;&amp;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;               new_matrix_index &gt; 0 &amp;&amp; new_matrix_index &lt; num_matrices);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  unordered_map&lt;int32, std::pair&lt;int32, int32&gt; &gt;::iterator</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      iter = computation-&gt;input_output_info.begin(),</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      end = computation-&gt;input_output_info.end();</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> network_node = iter-&gt;first,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        &amp;value_matrix_index = iter-&gt;second.first,</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        &amp;deriv_matrix_index = iter-&gt;second.second;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (nnet.IsOutputNode(network_node)) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      <span class="comment">// value_matrix_index would be an output of the computation.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">if</span> (value_matrix_index == orig_matrix_index) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        value_matrix_index = new_matrix_index;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="comment">// deriv_matrix_index would be an output of the computation.</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">if</span> (deriv_matrix_index == orig_matrix_index) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// we&#39;d only have derivatives for actual inputs. [note: we also allow</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// users to provide inputs for component nodes, but these would not have</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="comment">// derivatives.]</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(nnet.IsInputNode(network_node));</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        deriv_matrix_index = new_matrix_index;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    }</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a62b3a3e7be6ebc2a2af34bdb347ec76a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ScaleNnet </td>
          <td>(</td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scales the nnet parameters and stats by this scale. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00267">267</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00320">Component::Scale()</a>, and <a class="el" href="nnet-utils_8cc_source.html#l00162">SetZero()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-am-copy_8cc_source.html#l00027">main()</a>, and <a class="el" href="nnet-training_8cc_source.html#l00047">NnetTrainer::Train()</a>.</p>
<div class="fragment"><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                            {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordflow">if</span> (scale == 1.0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (scale == 0.0) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a>(<span class="keyword">false</span>, nnet);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      Component *comp = nnet-&gt;GetComponent(c);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      comp-&gt;Scale(scale);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9f63e4d60600b08466b42e409dd6253d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">kaldi::nnet3::SetZero</a></div><div class="ttdeci">void SetZero(bool is_gradient, Nnet *nnet)</div><div class="ttdoc">Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00162">nnet-utils.cc:162</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adfcccae5ab2f658419cedbd126f574f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::SecondElementComparator </td>
          <td>(</td>
          <td class="paramtype">const std::pair&lt; int32, int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>first_pair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::pair&lt; int32, int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>second_pair</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00078">78</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">SplitLocationsUsingSubmatHistogram()</a>.</p>
<div class="fragment"><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                                                        {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="keywordflow">if</span> (first_pair.second == second_pair.second)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">return</span> first_pair.first &gt; second_pair.first;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordflow">return</span> first_pair.second &gt; second_pair.second;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3c1cb3ecc86f15353f90fab03073c77d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::SelectFromExample </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> &amp;&#160;</td>
          <td class="paramname"><em>eg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>frame_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>left_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>right_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>frame_shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> *&#160;</td>
          <td class="paramname"><em>eg_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is responsible for possibly selecting one frame from multiple supervised frames, and reducing the left and right context as specified. </p>
<p>If frame == "" it does not reduce the supervised frames; if frame == "random" it selects one random frame; otherwise it expects frame to be an integer, and will select only the output with that frame index (or return false if there was no such output).</p>
<p>If left_context != -1 it removes any inputs with t &lt; (smallest output - left_context). If left_context != -1 it removes any inputs with t &lt; (smallest output - left_context).</p>
<p>It returns true if it was able to select a frame. We only anticipate it ever returning false in situations where frame is an integer, and the eg came from the end of a file and has a smaller than normal number of supervised frames. </p>

<p>Definition at line <a class="el" href="nnet3-copy-egs_8cc_source.html#l00188">188</a> of file <a class="el" href="nnet3-copy-egs_8cc_source.html">nnet3-copy-egs.cc</a>.</p>

<p>References <a class="el" href="nnet3-copy-egs_8cc_source.html#l00048">ContainsSingleExample()</a>, <a class="el" href="text-utils_8h_source.html#l00114">kaldi::ConvertStringToInteger()</a>, <a class="el" href="nnet3-copy-egs_8cc_source.html#l00111">FilterExample()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, and <a class="el" href="nnet-example-utils_8cc_source.html#l00159">ShiftExampleTimes()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-copy-egs_8cc_source.html#l00250">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                            {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_input_t, max_input_t,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      min_output_t, max_output_t;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a9d106dafc23aa3dc2359adc0bb2a94bd">ContainsSingleExample</a>(eg, &amp;min_input_t, &amp;max_input_t,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                             &amp;min_output_t, &amp;max_output_t))</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Too late to perform frame selection/context reduction on &quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;these examples (already merged?)&quot;</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordflow">if</span> (frame_str != <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// select one frame.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (frame_str == <span class="stringliteral">&quot;random&quot;</span>) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      min_output_t = max_output_t = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(min_output_t,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                                                          max_output_t);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> frame;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(frame_str, &amp;frame))</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Invalid option --frame=&#39;&quot;</span> &lt;&lt; frame_str &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="keywordflow">if</span> (frame &lt; min_output_t || frame &gt; max_output_t) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment">// Frame is out of range.  Should happen only rarely.  Calling code</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment">// makes sure of this.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      min_output_t = max_output_t = frame;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// There may come a time when we want to remove or make it possible to disable</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// the error messages below.  The std::max and std::min expressions may seem</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">// unnecessary but are intended to make life easier if and when we do that.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span> (left_context != -1) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (min_input_t &gt; min_output_t - left_context)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;You requested --left-context=&quot;</span> &lt;&lt; left_context</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, but example only has left-context of &quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                &lt;&lt;  (min_output_t - min_input_t);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    min_input_t = std::max(min_input_t, min_output_t - left_context);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span> (right_context != -1) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (max_input_t &lt; max_output_t + right_context)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;You requested --right-context=&quot;</span> &lt;&lt; right_context</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, but example only has right-context of &quot;</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                &lt;&lt;  (max_input_t - max_output_t);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    max_input_t = std::min(max_input_t, max_output_t + right_context);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ae235076d32848d3ce99ecd4a763e0961">FilterExample</a>(eg,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                min_input_t, max_input_t,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                min_output_t, max_output_t,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                eg_out);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (frame_shift != 0) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    std::vector&lt;std::string&gt; exclude_names;  <span class="comment">// we can later make this</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    exclude_names.push_back(std::string(<span class="stringliteral">&quot;ivector&quot;</span>)); <span class="comment">// configurable.</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a372bbe2bbd902e2f572a04d4c5e80f06">ShiftExampleTimes</a>(frame_shift, exclude_names, eg_out);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a39eb3f7ce5fab6dbbcb396b3f8e196f4"><div class="ttname"><a href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">kaldi::ConvertStringToInteger</a></div><div class="ttdeci">bool ConvertStringToInteger(const std::string &amp;str, Int *out)</div><div class="ttdoc">Converts a string into an integer via strtoll and returns false if there was any kind of problem (i...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00114">text-utils.h:114</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a372bbe2bbd902e2f572a04d4c5e80f06"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a372bbe2bbd902e2f572a04d4c5e80f06">kaldi::nnet3::ShiftExampleTimes</a></div><div class="ttdeci">void ShiftExampleTimes(int32 t_offset, const std::vector&lt; std::string &gt; &amp;exclude_names, NnetExample *eg)</div><div class="ttdoc">Shifts the time-index t of everything in the &quot;eg&quot; by adding &quot;t_offset&quot; to all &quot;t&quot; values...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00159">nnet-example-utils.cc:159</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9d106dafc23aa3dc2359adc0bb2a94bd"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9d106dafc23aa3dc2359adc0bb2a94bd">kaldi::nnet3::ContainsSingleExample</a></div><div class="ttdeci">bool ContainsSingleExample(const NnetExample &amp;eg, int32 *min_input_t, int32 *max_input_t, int32 *min_output_t, int32 *max_output_t)</div><div class="ttdoc">Returns true if the &quot;eg&quot; contains just a single example, meaning that all the &quot;n&quot; values in the index...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3-copy-egs_8cc_source.html#l00048">nnet3-copy-egs.cc:48</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae235076d32848d3ce99ecd4a763e0961"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae235076d32848d3ce99ecd4a763e0961">kaldi::nnet3::FilterExample</a></div><div class="ttdeci">void FilterExample(const NnetExample &amp;eg, int32 min_input_t, int32 max_input_t, int32 min_output_t, int32 max_output_t, NnetExample *eg_out)</div><div class="ttdoc">This function filters the indexes (and associated feature rows) in a NnetExample, removing any index/...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3-copy-egs_8cc_source.html#l00111">nnet3-copy-egs.cc:111</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abfc29da249703fa1e9c54cf85f6f0ef1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::SetDerivTimesOptions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> *&#160;</td>
          <td class="paramname"><em>opt_config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-derivative-test_8cc_source.html#l00046">46</a> of file <a class="el" href="nnet-derivative-test_8cc_source.html">nnet-derivative-test.cc</a>.</p>

<p>References <a class="el" href="nnet-derivative-test_8cc_source.html#l00031">ComputeMinAndMaxTimes()</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-optimize_8h_source.html#l00047">NnetOptimizeOptions::max_deriv_time</a>, <a class="el" href="nnet-optimize_8h_source.html#l00046">NnetOptimizeOptions::min_deriv_time</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                                           {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_t, max_t;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[0].name == <span class="stringliteral">&quot;input&quot;</span>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keyword">const</span> std::vector&lt;Index&gt; &amp;input_indexes = request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[0].indexes;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a12fab71b9fb0d11733b8d9e452da5eda">ComputeMinAndMaxTimes</a>(input_indexes, &amp;min_t, &amp;max_t);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> orig_min_t = min_t, orig_max_t = max_t;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> t_length = max_t + 1 - min_t;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(t_length &gt; 0);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">if</span> (t_length == 1)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 2) == 0) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// remove as much as 4 frames from the left (but don&#39;t remove everything).</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    min_t += std::min(4, <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, t_length - 1));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    opt_config-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3d087b2a181462f940490eeba587d5ed">min_deriv_time</a> = min_t;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    t_length = max_t + 1 - min_t;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(t_length &gt; 0);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 2) == 0) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    max_t -= std::min(4, <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, t_length - 1));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    opt_config-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3eb30cd32859e75b85a514ee9747f9ef">max_deriv_time</a> = max_t;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    t_length = max_t + 1 - min_t;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(t_length &gt; 0);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 4) == 0) {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// ensure that all derivs will be pruned away;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// this tests more code.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    min_t = orig_min_t - 10;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    max_t = min_t + 1;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> output_min_t, output_max_t;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].name == <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a12fab71b9fb0d11733b8d9e452da5eda">ComputeMinAndMaxTimes</a>(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].indexes,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                        &amp;output_min_t, &amp;output_max_t);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;ComputationRequest has output (min,max) = (&quot;</span> &lt;&lt; output_min_t</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; output_max_t &lt;&lt; <span class="stringliteral">&quot;), input (min,max) = (&quot;</span> &lt;&lt; orig_min_t</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            &lt;&lt; <span class="charliteral">&#39;,&#39;</span> &lt;&lt; orig_max_t &lt;&lt; <span class="stringliteral">&quot;), limiting deriv times to (&quot;</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            &lt;&lt; opt_config-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3d087b2a181462f940490eeba587d5ed">min_deriv_time</a> &lt;&lt; <span class="charliteral">&#39;,&#39;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            &lt;&lt; opt_config-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3eb30cd32859e75b85a514ee9747f9ef">max_deriv_time</a>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a56ccdfeff2303e6dee20771d1a4fad78"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">kaldi::nnet3::ComputationRequest::inputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; inputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00104">nnet-computation.h:104</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a3d087b2a181462f940490eeba587d5ed"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3d087b2a181462f940490eeba587d5ed">kaldi::nnet3::NnetOptimizeOptions::min_deriv_time</a></div><div class="ttdeci">int32 min_deriv_time</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00046">nnet-optimize.h:46</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a12fab71b9fb0d11733b8d9e452da5eda"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a12fab71b9fb0d11733b8d9e452da5eda">kaldi::nnet3::ComputeMinAndMaxTimes</a></div><div class="ttdeci">void ComputeMinAndMaxTimes(const std::vector&lt; Index &gt; &amp;indexes, int32 *min_t, int32 *max_t)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-derivative-test_8cc_source.html#l00031">nnet-derivative-test.cc:31</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a75f6d03596c9241ae8d5791e6d0d84aa"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">kaldi::nnet3::ComputationRequest::outputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; outputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00105">nnet-computation.h:105</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a3eb30cd32859e75b85a514ee9747f9ef"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3eb30cd32859e75b85a514ee9747f9ef">kaldi::nnet3::NnetOptimizeOptions::max_deriv_time</a></div><div class="ttdeci">int32 max_deriv_time</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00047">nnet-optimize.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3936ad79463d7cfd23ba1efd54f56084"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetLearningRate </td>
          <td>(</td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>learning_rate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the learning rate for all the components in the nnet to this value. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00251">251</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, and <a class="el" href="nnet-component-itf_8h_source.html#l00371">UpdatableComponent::SetLearningRate()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-am-copy_8cc_source.html#l00027">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                                 {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    Component *comp = nnet-&gt;GetComponent(c);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">// For now all updatable components inherit from class UpdatableComponent.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="comment">// If that changes in future, we will change this code.</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      UpdatableComponent *uc = <span class="keyword">dynamic_cast&lt;</span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">if</span> (uc == NULL)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Updatable component does not inherit from class &quot;</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="stringliteral">&quot;UpdatableComponent; change this code.&quot;</span>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      uc-&gt;SetLearningRate(learning_rate);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad96e7aef845800f1dc88fa2ad1aade28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::SetPriors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1Vector.html">Vector</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>transition_accs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prior_floor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html">AmNnetSimple</a> *&#160;</td>
          <td class="paramname"><em>am_nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3-am-train-transitions_8cc_source.html#l00028">28</a> of file <a class="el" href="nnet3-am-train-transitions_8cc_source.html">nnet3-am-train-transitions.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="am-nnet-simple_8cc_source.html#l00028">AmNnetSimple::NumPdfs()</a>, <a class="el" href="transition-model_8h_source.html#l00181">TransitionModel::NumPdfs()</a>, <a class="el" href="am-nnet-simple_8cc_source.html#l00068">AmNnetSimple::SetPriors()</a>, and <a class="el" href="transition-model_8h_source.html#l00312">TransitionModel::TransitionIdToPdf()</a>.</p>

<p>Referenced by <a class="el" href="nnet3-am-train-transitions_8cc_source.html#l00053">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                      {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tmodel.<a class="code" href="classkaldi_1_1TransitionModel.html#a180f61fc479820bd993a879bb8c71341">NumPdfs</a>() == am_nnet-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html#a180f61fc479820bd993a879bb8c71341">NumPdfs</a>());</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> pdf_counts(tmodel.<a class="code" href="classkaldi_1_1TransitionModel.html#a180f61fc479820bd993a879bb8c71341">NumPdfs</a>());</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(transition_accs(0) == 0.0); <span class="comment">// There is</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// no zero transition-id.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = 1; tid &lt; transition_accs.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>(); tid++) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pdf = tmodel.<a class="code" href="group__hmm__group.html#ga1fb8326e780cac6c317f7e8dd2bc14dc">TransitionIdToPdf</a>(tid);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    pdf_counts(pdf) += transition_accs(tid);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> sum = pdf_counts.Sum();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sum != 0.0);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(prior_floor &gt; 0.0 &amp;&amp; prior_floor &lt; 1.0);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  pdf_counts.Scale(1.0 / sum);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  pdf_counts.ApplyFloor(prior_floor);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  pdf_counts.Scale(1.0 / pdf_counts.Sum()); <span class="comment">// normalize again.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  am_nnet-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1AmNnetSimple.html#a9ab18efc13ed11baec71f29801c3addb">SetPriors</a>(pdf_counts);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}               </div>
<div class="ttc" id="group__hmm__group_html_ga1fb8326e780cac6c317f7e8dd2bc14dc"><div class="ttname"><a href="group__hmm__group.html#ga1fb8326e780cac6c317f7e8dd2bc14dc">kaldi::TransitionModel::TransitionIdToPdf</a></div><div class="ttdeci">int32 TransitionIdToPdf(int32 trans_id) const </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8h_source.html#l00312">transition-model.h:312</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1AmNnetSimple_html_a9ab18efc13ed11baec71f29801c3addb"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1AmNnetSimple.html#a9ab18efc13ed11baec71f29801c3addb">kaldi::nnet3::AmNnetSimple::SetPriors</a></div><div class="ttdeci">void SetPriors(const VectorBase&lt; BaseFloat &gt; &amp;priors)</div><div class="ttdef"><b>Definition:</b> <a href="am-nnet-simple_8cc_source.html#l00068">am-nnet-simple.cc:68</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a180f61fc479820bd993a879bb8c71341"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a180f61fc479820bd993a879bb8c71341">kaldi::TransitionModel::NumPdfs</a></div><div class="ttdeci">int32 NumPdfs() const </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8h_source.html#l00181">transition-model.h:181</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1AmNnetSimple_html_a180f61fc479820bd993a879bb8c71341"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1AmNnetSimple.html#a180f61fc479820bd993a879bb8c71341">kaldi::nnet3::AmNnetSimple::NumPdfs</a></div><div class="ttdeci">int32 NumPdfs() const </div><div class="ttdef"><b>Definition:</b> <a href="am-nnet-simple_8cc_source.html#l00028">am-nnet-simple.cc:28</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9f63e4d60600b08466b42e409dd6253d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetZero </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>is_gradient</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>nnet</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00162">162</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">UpdatableComponent::SetZero()</a>.</p>

<p>Referenced by <a class="el" href="nnet-randomizer_8cc_source.html#l00045">MatrixRandomizer::AddData()</a>, <a class="el" href="nnet-randomizer_8cc_source.html#l00103">VectorRandomizer::AddData()</a>, <a class="el" href="tp-matrix_8cc_source.html#l00088">TpMatrix&lt; Real &gt;::Cholesky()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00151">CuMatrixBase&lt; Real &gt;::CopyFromBlock()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00829">MatrixBase&lt; Real &gt;::CopyFromTp()</a>, <a class="el" href="feature-functions_8cc_source.html#l00091">kaldi::ExtractWindow()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00026">NnetComputeProb::NnetComputeProb()</a>, <a class="el" href="nnet-training_8cc_source.html#l00026">NnetTrainer::NnetTrainer()</a>, <a class="el" href="qr_8cc_source.html#l00409">SpMatrix&lt; Real &gt;::Qr()</a>, <a class="el" href="nnet-diagnostics_8cc_source.html#l00050">NnetComputeProb::Reset()</a>, <a class="el" href="cu-array-inl_8h_source.html#l00039">CuArray&lt; T &gt;::Resize()</a>, <a class="el" href="packed-matrix_8cc_source.html#l00094">PackedMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-packed-matrix_8cc_source.html#l00040">CuPackedMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-vector_8cc_source.html#l00841">CuVector&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00189">Vector&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00048">CuMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00692">Matrix&lt; Real &gt;::Resize()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00267">ScaleNnet()</a>, <a class="el" href="cu-packed-matrix_8cc_source.html#l00365">CuPackedMatrix&lt; Real &gt;::SetUnit()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01195">MatrixBase&lt; Real &gt;::SetUnit()</a>, <a class="el" href="nnet-training_8cc_source.html#l00047">NnetTrainer::Train()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00258">UnitTestNnetInputDerivatives()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">UnitTestNnetModelDerivatives()</a>, <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>, and <a class="el" href="estimate-am-sgmm-multi_8cc_source.html#l00081">MleAmSgmmGlobalAccs::ZeroAccumulators()</a>.</p>
<div class="fragment"><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                         {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    Component *comp = nnet-&gt;GetComponent(c);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      UpdatableComponent *u_comp = <span class="keyword">dynamic_cast&lt;</span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(u_comp != NULL);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      u_comp-&gt;SetZero(is_gradient);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a372bbe2bbd902e2f572a04d4c5e80f06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ShiftExampleTimes </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>t_offset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>exclude_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetExample *&#160;</td>
          <td class="paramname"><em>eg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Shifts the time-index t of everything in the "eg" by adding "t_offset" to all "t" values. </p>
<p>This might be useful in things like clockwork RNNs that are not invariant to time-shifts, to ensure that we see different shifts of each example during training. "exclude_names" is a vector (not necessarily sorted) of names of nnet inputs that we avoid shifting the "t" values of&ndash; normally it will contain just the single string "ivector" because we always leave t=0 for any ivector. </p>

<p>Definition at line <a class="el" href="nnet-example-utils_8cc_source.html#l00159">159</a> of file <a class="el" href="nnet-example-utils_8cc_source.html">nnet-example-utils.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-example_8h_source.html#l00087">NnetExample::io</a>.</p>

<p>Referenced by <a class="el" href="nnet3-copy-egs_8cc_source.html#l00188">SelectFromExample()</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                        {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">if</span> (t_offset == 0)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  std::vector&lt;NnetIo&gt;::iterator iter = eg-&gt;io.begin(),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      end = eg-&gt;io.end();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (; iter != end; iter++) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">bool</span> name_is_excluded = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    std::vector&lt;std::string&gt;::const_iterator</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        exclude_iter = exclude_names.begin(),</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        exclude_end = exclude_names.end();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">for</span> (; exclude_iter != exclude_end; ++exclude_iter) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;name == *exclude_iter) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        name_is_excluded = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">if</span> (!name_is_excluded) {</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="comment">// name is not something like &quot;ivector&quot; that we exclude from shifting.</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      std::vector&lt;Index&gt;::iterator index_iter = iter-&gt;indexes.begin(),</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          index_end = iter-&gt;indexes.end();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">for</span> (; index_iter != index_end; ++index_iter)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        index_iter-&gt;t += t_offset;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed1893395273c5cb53ea3606c2bad94a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::SortSubmatLists </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt;&#160;</td>
          <td class="paramname"><em>submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>max_submat_list_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00087">87</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">SplitLocations()</a>.</p>
<div class="fragment"><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  *max_submat_list_size = 0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  sorted_submat_lists-&gt;reserve(submat_lists.size());</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(submat_lists.size() &gt; 0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; submat_lists.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span> (submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size() &gt; *max_submat_list_size)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      *max_submat_list_size = submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    sorted_submat_lists-&gt;push_back(submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    std::sort((*sorted_submat_lists)[i].begin(),</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;              (*sorted_submat_lists)[i].end(),</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;              FirstElementComparator());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7c81548b4f8146cd3447b10d556978a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SplitLocations </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>split_lists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The input to this function is a vector of lists of pairs, and this function splits it up into a list of vectors of pairs. </p>
<p>In order to make the lists all the same length it may have to insert "dummy" pairs with value (-1, -1). In addition, this function implement certain heuristics to break up the list into pairs in a particular desirable way, as we will describe below.</p>
<p>submat_lists.dim() may be large e.g. 1024 (it usually represents a minibatch size), but the maximum size of the lists will usually be fairly small e.g. no more than 4 or so, as it represents the number of terms in a hand-coded summation expression.</p>
<p>The use of this function is in interpreting a command to set each row of a matrix to a sum of terms. Each pair represents an input term, interpreted as (index-of-matrix, row-index), which represents a vector that will form part of the sum.</p>
<p>It would be possible to simply pad at the end with (-1, -1), but this function also makes an attempt to pad more carefully so that for the most part, each output vector of pairs has inputs from only one matrix, i.e. the pair.first values are all the same. This will allow us to use a potentially more efficient command in the compiled code. It doesn't have to be 100% optimal. Note: in the most common case, all the lists will have the same length and padding will not be necessary at all.</p>
<p>See documentation here: <a class="el" href="dnn3_code_compilation.html#dnn3_compile_compiler_split_locations">Forward computation for Descriptors (SplitLocations)</a> </p>

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">337</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00113">ComputeSubmatIndexHistogram()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00087">SortSubmatLists()</a>, and <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">SplitLocationsUsingSubmatHistogram()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00515">Compiler::DoForwardComputationFromSubmatLocationsList()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">SplitLocationsBackward()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00275">UnitTestSplitLocations()</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                                {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// a histogram of the submat_indexes in the submat_lists</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// each occurence in a given submat_list is considered unique so we maintain</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="comment">// a vector to count each occurrence separately.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">// The i&#39;th element in the vector corresponds to the count of</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">// the (i+1)&#39;th occurrence of a submat_index in a submat_list</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  unordered_map&lt;int32, std::vector&lt;int32&gt; &gt; submat_histogram;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_submat_list_size = 0;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="comment">// initializing a vector of list of pairs to store the sorted submat_lists</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  std::vector&lt;std::vector&lt; std::pair&lt;int32, int32&gt; &gt; &gt;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      sorted_submat_lists;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aed1893395273c5cb53ea3606c2bad94a">SortSubmatLists</a>(submat_lists, &amp;sorted_submat_lists, &amp;max_submat_list_size);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a602adf8e3c912ce0b74cbc5700255867">ComputeSubmatIndexHistogram</a>(sorted_submat_lists, &amp;submat_histogram);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// the vector has same information as the submat_histogram, but it is</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="comment">// suitable for sorting according to frequency. The first elements of pairs</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// can be repeated, these correspond to different occurrences in the same list</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt; submat_histogram_vector;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="comment">// copy the key, occurence_counts from submat_histogram to a vector</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  unordered_map&lt;int32, std::vector&lt;int32&gt; &gt;::iterator hist_iter;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">for</span> (hist_iter = submat_histogram.begin();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;       hist_iter != submat_histogram.end();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;       ++hist_iter) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; (hist_iter-&gt;second).size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      submat_histogram_vector.push_back(</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          std::make_pair(hist_iter-&gt;first, (hist_iter-&gt;second)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ab45cba0a2a0446179a2741e19949afcd">SplitLocationsUsingSubmatHistogram</a>(max_submat_list_size, &amp;sorted_submat_lists,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                     &amp;submat_histogram_vector, split_lists);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a602adf8e3c912ce0b74cbc5700255867"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a602adf8e3c912ce0b74cbc5700255867">kaldi::nnet3::ComputeSubmatIndexHistogram</a></div><div class="ttdeci">void ComputeSubmatIndexHistogram(const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; sorted_submat_lists, unordered_map&lt; int32, std::vector&lt; int32 &gt; &gt; *submat_histogram)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00113">nnet-compile-utils.cc:113</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ab45cba0a2a0446179a2741e19949afcd"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ab45cba0a2a0446179a2741e19949afcd">kaldi::nnet3::SplitLocationsUsingSubmatHistogram</a></div><div class="ttdeci">static void SplitLocationsUsingSubmatHistogram(int32 max_submat_list_size, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *submat_histogram_vector, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *split_lists)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00243">nnet-compile-utils.cc:243</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aed1893395273c5cb53ea3606c2bad94a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aed1893395273c5cb53ea3606c2bad94a">kaldi::nnet3::SortSubmatLists</a></div><div class="ttdeci">void SortSubmatLists(const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *sorted_submat_lists, int32 *max_submat_list_size)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00087">nnet-compile-utils.cc:87</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a230b979419515f453ee5c8f2bc87a4dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SplitLocationsBackward </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>split_lists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function has the same interface as <a class="el" href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8" title="The input to this function is a vector of lists of pairs, and this function splits it up into a list ...">SplitLocations()</a>; however, it ensures certain additional properties of the output "split_lists", which are necessary because of the way it is used in backprop code. </p>
<p>For each sub-list sublist = (*split_lists)[i], the properties it ensures are: Either:</p>
<ul>
<li>all pairs in the list "sublist" are unique (except that the special pair (-1, -1) may be repeated), Or:</li>
<li>the .first values in the list "sublist" are all the same, and the .second have a special property [see the function HasContiguousProperty in <a class="el" href="nnet-compile_8cc.html">nnet-compile.cc</a>]- basically that if we list the .second elements, each unique number that appears there appears only in one contiguous range, e.g. the list [ 6 6 6 1 5 5 5 ] has this property, but [ 1 2 1 ] does not. (however, -1's are not subject to this limitation, so [ -1 4 -1 ] satisfies the property). This function ensures this property by first calling SplitLocations, and then doing further splitting as necessary to ensure the property. However, if as a result it needs to split any given initially-split list into more than 2 sub-lists, it will print a warning (once per process). If we have to split into too many lists it will generate inefficient computations, and we will need to extend the backprop code to support more general types of operation. If all elements of submat_lists are empty, the output split_lists will be the empty vector. </li>
</ul>

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">469</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00377">ConvertToIndexes()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00401">EnsureContiguousProperty()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">SplitLocations()</a>, and <a class="el" href="nnet-compile-utils_8cc_source.html#l00438">SplitPairList()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile_8cc_source.html#l00532">Compiler::DoBackwardComputationFromSubmatLocationsList()</a>, and <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00070">UnitTestSplitLocationsBackward()</a>.</p>
<div class="fragment"><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                                                {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  std::vector&lt;std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &gt; split_lists_intermediate;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// Split the submat_lists</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8">SplitLocations</a>(submat_lists, &amp;split_lists_intermediate);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_lists_intermediate.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_value;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    std::vector&lt;int32&gt; second_values;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">ConvertToIndexes</a>(split_lists_intermediate[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>],</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                         &amp;first_value, &amp;second_values)) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="comment">// the .first values are the same</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="keywordflow">if</span> (first_value == -1) <span class="keywordflow">continue</span>;  <span class="comment">// don&#39;t output anything for this.</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      std::vector&lt;std::vector&lt;int32&gt; &gt; second_values_split;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">EnsureContiguousProperty</a>(second_values, &amp;second_values_split);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <span class="keywordflow">if</span> (second_values_split.size() == 1) {</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">// this branch is an optimization for speed.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        split_lists-&gt;push_back(split_lists_intermediate[i]);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; second_values_split.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;          split_lists-&gt;resize(split_lists-&gt;size() + 1);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;input_list = second_values_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &amp;output_list =</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;              split_lists-&gt;back();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          output_list.resize(input_list.size());</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = input_list.size();</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; size; k++) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> row = input_list[k];</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keywordflow">if</span> (row == -1) output_list[k].first = -1;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">else</span> output_list[k].first = first_value;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            output_list[k].second = row;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;          }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="comment">// the .first values are not the same</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <span class="comment">// splitting the list of pairs to ensure unique pairs, unless it is</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">// (-1,-1)</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      std::vector&lt;std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &gt; new_split_lists;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a1df4b00a6ceed8cc071e249ed8c931d0">SplitPairList</a>(split_lists_intermediate[i],</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                    &amp;new_split_lists);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; new_split_lists.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)  {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        split_lists-&gt;push_back(new_split_lists[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae99488174e8dde27f8f30d91d61c0cd2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">kaldi::nnet3::ConvertToIndexes</a></div><div class="ttdeci">bool ConvertToIndexes(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;location_vector, int32 *first_value, std::vector&lt; int32 &gt; *second_values)</div><div class="ttdoc">If it is the case for some i &gt;= 0 that all the .first elements of &quot;location_vector&quot; are either i or -...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00377">nnet-compile-utils.cc:377</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a7c81548b4f8146cd3447b10d556978a8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8">kaldi::nnet3::SplitLocations</a></div><div class="ttdeci">void SplitLocations(const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; &amp;submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *split_lists)</div><div class="ttdoc">The input to this function is a vector of lists of pairs, and this function splits it up into a list ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00337">nnet-compile-utils.cc:337</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1df4b00a6ceed8cc071e249ed8c931d0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1df4b00a6ceed8cc071e249ed8c931d0">kaldi::nnet3::SplitPairList</a></div><div class="ttdeci">void SplitPairList(std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;list, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *split_lists)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00438">nnet-compile-utils.cc:438</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a84ff5e289907fa63155ee9bec0f9c631"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">kaldi::nnet3::EnsureContiguousProperty</a></div><div class="ttdeci">void EnsureContiguousProperty(const std::vector&lt; int32 &gt; &amp;indexes, std::vector&lt; std::vector&lt; int32 &gt; &gt; *indexes_out)</div><div class="ttdoc">This function takes a vector of indexes and splits it up into as separate vectors of the same size...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00401">nnet-compile-utils.cc:401</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab45cba0a2a0446179a2741e19949afcd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::SplitLocationsUsingSubmatHistogram </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_submat_list_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sorted_submat_lists</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>submat_histogram_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>split_lists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00243">243</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00203">ExtractGivenPairsFromSubmatLists()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00224">ExtractLastPairFromSubmatLists()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00167">FindSubmatIndexInSubmatLists()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="nnet-compile-utils_8cc_source.html#l00078">SecondElementComparator()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">SplitLocations()</a>.</p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                                                 {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="comment">// sort the submat_histogram_vector based on second element of pair</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// in descending order then first element of pair in descending order</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  std::sort(submat_histogram_vector-&gt;begin(),</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            submat_histogram_vector-&gt;end(), <a class="code" href="namespacekaldi_1_1nnet3.html#adfcccae5ab2f658419cedbd126f574f0">SecondElementComparator</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> prev_max_remaining_submat_list_size = max_submat_list_size;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator iter;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="keywordflow">for</span> (iter = submat_histogram_vector-&gt;begin();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;       iter != submat_histogram_vector-&gt;end();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;       ++iter)  {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    std::pair&lt;int32, int32&gt; submat_index_and_count = *iter;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    std::vector&lt;std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator&gt;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        output_iterator_list;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_remaining_submat_list_size = 0;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#abff8a093b516f579b1bce94a954f6e7c">FindSubmatIndexInSubmatLists</a>(submat_index_and_count.first,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                 sorted_submat_lists,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                                 &amp;output_iterator_list,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                 &amp;max_remaining_submat_list_size);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">if</span> (max_remaining_submat_list_size</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        &lt; prev_max_remaining_submat_list_size)  {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="comment">// since we will have a smaller max_remaining_submat_list_size by</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      <span class="comment">// splitting this submat_index into a seperate list,</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="comment">// we will split it;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt; list_of_pairs;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#ac3395b82092a47a75b581f5f4a55a503">ExtractGivenPairsFromSubmatLists</a>(output_iterator_list,</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                       sorted_submat_lists,</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                       &amp;list_of_pairs);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      split_lists-&gt;push_back(list_of_pairs);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      prev_max_remaining_submat_list_size = max_remaining_submat_list_size;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// rearrange the remaining pairs into lists where</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// pairs with multiple first elements are allowed</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Note : we don&#39;t yet know if there is any advantage of having multiple</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// calls to the same submat in kAddRowsMulti. If this is actually helpful</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// then use the sorted_histogram_vector to first copy submat_indexes which</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// did not make it to kAddRows calls</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; prev_max_remaining_submat_list_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt; list_of_pairs;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a078fe7414bf11ee4f33567cb85b2b202">ExtractLastPairFromSubmatLists</a>(sorted_submat_lists,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                   &amp;list_of_pairs);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    split_lists-&gt;push_back(list_of_pairs);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_abff8a093b516f579b1bce94a954f6e7c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#abff8a093b516f579b1bce94a954f6e7c">kaldi::nnet3::FindSubmatIndexInSubmatLists</a></div><div class="ttdeci">void FindSubmatIndexInSubmatLists(int32 submat_index, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt;::iterator &gt; *output_iterator_list, int32 *max_remaining_submat_list_size)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00167">nnet-compile-utils.cc:167</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_adfcccae5ab2f658419cedbd126f574f0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#adfcccae5ab2f658419cedbd126f574f0">kaldi::nnet3::SecondElementComparator</a></div><div class="ttdeci">bool SecondElementComparator(const std::pair&lt; int32, int32 &gt; &amp;first_pair, const std::pair&lt; int32, int32 &gt; &amp;second_pair)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00078">nnet-compile-utils.cc:78</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a078fe7414bf11ee4f33567cb85b2b202"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a078fe7414bf11ee4f33567cb85b2b202">kaldi::nnet3::ExtractLastPairFromSubmatLists</a></div><div class="ttdeci">static void ExtractLastPairFromSubmatLists(std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *list_of_pairs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00224">nnet-compile-utils.cc:224</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac3395b82092a47a75b581f5f4a55a503"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac3395b82092a47a75b581f5f4a55a503">kaldi::nnet3::ExtractGivenPairsFromSubmatLists</a></div><div class="ttdeci">void ExtractGivenPairsFromSubmatLists(std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt;::iterator &gt; &amp;input_iterator_list, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *sorted_submat_lists, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *list_of_pairs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00203">nnet-compile-utils.cc:203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1df4b00a6ceed8cc071e249ed8c931d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::SplitPairList </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>split_lists</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils_8cc_source.html#l00438">438</a> of file <a class="el" href="nnet-compile-utils_8cc_source.html">nnet-compile-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">SplitLocationsBackward()</a>.</p>
<div class="fragment"><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                                                               {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  split_lists-&gt;clear();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; list.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// searching for the new pair in the new_split_lists</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">bool</span> added_pair = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> ( list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first == -1)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; split_lists-&gt;size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)  {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator iter</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          = std::find_if((*split_lists)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].begin(),</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                         (*split_lists)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].end(),</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                         PairIsEqualComparator(list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      <span class="keywordflow">if</span> (iter == (*split_lists)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].end()) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="comment">// this pair is not in this list</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        (*split_lists)[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        added_pair = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      }</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (!added_pair)  {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt; list_of_pairs(list.size(),</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                                                          std::make_pair(-1, -1));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      list_of_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = list[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      split_lists-&gt;push_back(list_of_pairs);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordflow">if</span> (split_lists-&gt;size() == 0)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Input list has just dummy pairs&quot;</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a375de0015e95f4f495e8c367c76c50c0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kaldi::nnet3::StringsApproxEqual </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">30</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00084">TestNnetComponentAddScale()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00075">TestNnetComponentCopy()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00126">TestNnetComponentUpdatable()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00094">TestNnetComponentVectorizeUnVectorize()</a>, and <a class="el" href="_2nnet-component-test_8cc_source.html#l00117">TestStringsApproxEqual()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                                   {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> (a == b || a.size() != b.size())</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">size_t</span> size = a.size();</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> pos = 0; pos &lt; size; pos++) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">if</span> (a[pos] != b[pos]) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keywordflow">if</span> (!isdigit(a[pos]) || !isdigit(b[pos]))</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="comment">// if it&#39;s not the last digit in the string, goto fail</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;      <span class="keywordflow">if</span> (pos + 1 != size &amp;&amp; isdigit(a[pos+1]))</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keywordtype">size_t</span> pos2;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keywordflow">for</span> (pos2 = pos - 1; pos2 &gt; 0; pos2--) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="keywordflow">if</span> (a[pos2] == <span class="charliteral">&#39;.&#39;</span>) <span class="keywordflow">break</span>;  <span class="comment">// we accept this difference: we went backwards and found a &#39;.&#39;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (!isdigit(a[pos2]))  <span class="comment">// we reject this difference: we went back and</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                <span class="comment">// found non-digit before &#39;.&#39; -&gt; not floating</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                <span class="comment">// point.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;          <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">if</span> (pos2 == 0)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">goto</span> fail;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  }</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;fail:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Info strings differ: &#39;&quot;</span> &lt;&lt; a &lt;&lt; <span class="stringliteral">&quot;&#39; vs. &#39;&quot;</span> &lt;&lt; b &lt;&lt; <span class="stringliteral">&quot;&#39;.&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9edff78ae3a66646a203ad49ab320347"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string SummarizeVector </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse_8cc_source.html#l00462">462</a> of file <a class="el" href="nnet-parse_8cc_source.html">nnet-parse.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00065">VectorBase&lt; Real &gt;::Data()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-parse_8cc_source.html#l00445">PrintFloatSuccinctly()</a>, <a class="el" href="text-utils_8h_source.html#l00064">kaldi::SplitStringToIntegers()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00036">kaldi::VecVec()</a>.</p>

<p>Referenced by <a class="el" href="nnet-component-itf_8cc_source.html#l00252">NonlinearComponent::Info()</a>, and <a class="el" href="nnet-parse-test_8cc_source.html#l00223">UnitTestSummarizeVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                                                        {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordflow">if</span> (vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() &lt; 10) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;[ &quot;</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a55b3c5fd7a70b59070dfec3be993ff80">PrintFloatSuccinctly</a>(os, vec(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      os &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// print out mean and standard deviation, and some selected values.</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> mean = vec.<a class="code" href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>() / vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>(),</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        stddev = sqrt(<a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(vec, vec) / vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() - mean * mean);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    std::string percentiles_str = <span class="stringliteral">&quot;0,1,2,5 10,20,50,80,90 95,98,99,100&quot;</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    std::vector&lt;int32&gt; percentiles;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordtype">bool</span> ans = <a class="code" href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">SplitStringToIntegers</a>(percentiles_str, <span class="stringliteral">&quot;, &quot;</span>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                                     &amp;percentiles);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ans);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;[percentiles(&quot;</span> &lt;&lt; percentiles_str &lt;&lt; <span class="stringliteral">&quot;)=(&quot;</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    Vector&lt;BaseFloat&gt; vec_sorted(vec);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    std::sort(vec_sorted.Data(), vec_sorted.Data() + vec_sorted.Dim());</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = vec.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>() - 1;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; percentiles.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> percentile = percentiles[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> value = vec_sorted((n * percentile) / 100);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a55b3c5fd7a70b59070dfec3be993ff80">PrintFloatSuccinctly</a>(os, value);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1 &lt; percentiles.size())</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        os &lt;&lt; (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 3 || <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 8 ? <span class="charliteral">&#39; &#39;</span> : <span class="charliteral">&#39;,&#39;</span>);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    os &lt;&lt; std::setprecision(3);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;), mean=&quot;</span> &lt;&lt; mean &lt;&lt; <span class="stringliteral">&quot;, stddev=&quot;</span> &lt;&lt; stddev &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  }</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_html_ae95740f87fc2fb79419753e21396c647"><div class="ttname"><a href="namespacekaldi.html#ae95740f87fc2fb79419753e21396c647">kaldi::SplitStringToIntegers</a></div><div class="ttdeci">bool SplitStringToIntegers(const std::string &amp;full, const char *delim, bool omit_empty_strings, std::vector&lt; I &gt; *out)</div><div class="ttdoc">Split a string (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00064">text-utils.h:64</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::VectorBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdoc">Returns sum of the elements. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00680">kaldi-vector.cc:680</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a55b3c5fd7a70b59070dfec3be993ff80"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a55b3c5fd7a70b59070dfec3be993ff80">kaldi::nnet3::PrintFloatSuccinctly</a></div><div class="ttdeci">static void PrintFloatSuccinctly(std::ostream &amp;os, BaseFloat f)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00445">nnet-parse.cc:445</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga4750cd6f7a02a013435779588056b153"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">kaldi::VecVec</a></div><div class="ttdeci">Real VecVec(const VectorBase&lt; Real &gt; &amp;a, const VectorBase&lt; Real &gt; &amp;b)</div><div class="ttdoc">Returns dot product between v1 and v2. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00036">kaldi-vector.cc:36</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49f9f182fa8dc05d6672c4b7fcad737f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::SumVectorSizes </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-computation-graph_8cc_source.html#l01144">1144</a> of file <a class="el" href="nnet-computation-graph_8cc_source.html">nnet-computation-graph.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-computation-graph_8cc_source.html#l01252">ComputeComputationPhases()</a>.</p>
<div class="fragment"><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                                                                     {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> ans = 0;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt;::const_iterator iter = vec.begin(),</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      end = vec.end();</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keywordflow">for</span> (; iter != end; ++iter)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    ans += iter-&gt;size();</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a145f09473f55df6f338ac4d69cff8bf1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TarjanSccRecursive </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32 *&#160;</td>
          <td class="paramname"><em>global_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; TarjanNode &gt; *&#160;</td>
          <td class="paramname"><em>tarjan_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>tarjan_stack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sccs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph_8cc_source.html#l00085">85</a> of file <a class="el" href="nnet-graph_8cc_source.html">nnet-graph.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph_8cc_source.html#l00138">FindSccsTarjan()</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                                                            {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sccs != NULL);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tarjan_nodes != NULL);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tarjan_stack != NULL);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(global_index != NULL);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(node &gt;= 0 &amp;&amp; node &lt; graph.size());</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// Initializes the current Tarjan node.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  (*tarjan_nodes)[node].index = *global_index;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  (*tarjan_nodes)[node].lowlink = *global_index;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  *global_index += 1;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  (*tarjan_nodes)[node].on_stack = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  tarjan_stack-&gt;push_back(node);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="comment">// DFS from the current node.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; graph[node].size(); ++<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> next = graph[node][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordflow">if</span> ((*tarjan_nodes)[next].index == -1) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="comment">// First time we see this node.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a145f09473f55df6f338ac4d69cff8bf1">TarjanSccRecursive</a>(next, graph,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                         global_index, tarjan_nodes, tarjan_stack, sccs);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      (*tarjan_nodes)[node].lowlink = std::min((*tarjan_nodes)[node].lowlink,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                               (*tarjan_nodes)[next].lowlink);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*tarjan_nodes)[next].on_stack) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">// Next node is on the stack -- back edge. We can&#39;t use the lowlink of</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="comment">// next node, because that may point to the index of the root, while the</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// current node can&#39;t be the root.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      (*tarjan_nodes)[node].lowlink = std::min((*tarjan_nodes)[node].lowlink,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                               (*tarjan_nodes)[next].index);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// Output SCC.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">if</span> ((*tarjan_nodes)[node].index == (*tarjan_nodes)[node].lowlink) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    std::vector&lt;int32&gt; scc;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pop_node;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      pop_node = tarjan_stack-&gt;back();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      tarjan_stack-&gt;pop_back();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      (*tarjan_nodes)[pop_node].on_stack = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      scc.push_back(pop_node);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    } <span class="keywordflow">while</span> (pop_node != node);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(pop_node == node);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    sccs-&gt;push_back(scc);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a145f09473f55df6f338ac4d69cff8bf1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a145f09473f55df6f338ac4d69cff8bf1">kaldi::nnet3::TarjanSccRecursive</a></div><div class="ttdeci">void TarjanSccRecursive(int32 node, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, int32 *global_index, std::vector&lt; TarjanNode &gt; *tarjan_nodes, std::vector&lt; int32 &gt; *tarjan_stack, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00085">nnet-graph.cc:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a554b097cfc8c22c7fe43dec7ceca8839"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetComponentAddScale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00084">84</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="nnet-component-itf_8h_source.html#l00328">Component::Add()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00118">Component::Info()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00320">Component::Scale()</a>, and <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">StringsApproxEqual()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                             {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c2 = c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c3 = c2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  c3-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aab16938236bd0978bad5de6d56fcf47f">Add</a>(0.5, *c2);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  c2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Scale</a>(1.5);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(c2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>(), c3-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>()));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">delete</span> c2;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keyword">delete</span> c3;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a750ca3e44a00898afea53b54697226ba"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">kaldi::nnet3::Component::Scale</a></div><div class="ttdeci">virtual void Scale(BaseFloat scale)</div><div class="ttdoc">This virtual function when called by. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00320">nnet-component-itf.h:320</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a375de0015e95f4f495e8c367c76c50c0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">kaldi::nnet3::StringsApproxEqual</a></div><div class="ttdeci">static bool StringsApproxEqual(const std::string &amp;a, const std::string &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00030">nnet-component-test.cc:30</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a17f20e0b2d35ec6866a6b479e7d9e867"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">kaldi::nnet3::Component::Info</a></div><div class="ttdeci">virtual std::string Info() const </div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8cc_source.html#l00118">nnet-component-itf.cc:118</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aab16938236bd0978bad5de6d56fcf47f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aab16938236bd0978bad5de6d56fcf47f">kaldi::nnet3::Component::Add</a></div><div class="ttdeci">virtual void Add(BaseFloat alpha, const Component &amp;other)</div><div class="ttdoc">This virtual function when called by  an UpdatableComponent adds the parameters of another updatable...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00328">nnet-component-itf.h:328</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af7d4b74958e0a63a4e52bef63e71f394"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetComponentCopy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00075">75</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00118">Component::Info()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">StringsApproxEqual()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                         {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c2 = c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>(), c2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>())) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected info strings to be equal: &#39;&quot;</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;              &lt;&lt; c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>() &lt;&lt; <span class="stringliteral">&quot;&#39; vs. &#39;&quot;</span> &lt;&lt; c2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">delete</span> c2;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a375de0015e95f4f495e8c367c76c50c0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">kaldi::nnet3::StringsApproxEqual</a></div><div class="ttdeci">static bool StringsApproxEqual(const std::string &amp;a, const std::string &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00030">nnet-component-test.cc:30</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a17f20e0b2d35ec6866a6b479e7d9e867"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">kaldi::nnet3::Component::Info</a></div><div class="ttdeci">virtual std::string Info() const </div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8cc_source.html#l00118">nnet-component-itf.cc:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee5e219c905cd82d682bc00a0de72d74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetComponentIo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00061">61</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00037">Component::ReadNew()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a852bc7306aaa45b284f662f1ddb1a3d5">Component::Write()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                                       {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordtype">bool</span> binary = (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  std::ostringstream os1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a852bc7306aaa45b284f662f1ddb1a3d5">Write</a>(os1, binary);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  std::istringstream is(os1.str());</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c2 = Component::ReadNew(is, binary);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  std::ostringstream os2;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  c2-&gt;Write(os2, binary);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">if</span> (!binary) {</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(os2.str() == os1.str());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="keyword">delete</span> c2;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a852bc7306aaa45b284f662f1ddb1a3d5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a852bc7306aaa45b284f662f1ddb1a3d5">kaldi::nnet3::Component::Write</a></div><div class="ttdeci">virtual void Write(std::ostream &amp;os, bool binary) const =0</div><div class="ttdoc">Write component to stream. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b28b95264b6db2e9ce5658f8f939a8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetComponentUpdatable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00126">126</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00205">UpdatableComponent::Info()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00384">UpdatableComponent::NumParameters()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00936">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00320">Component::Scale()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">UpdatableComponent::SetZero()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">StringsApproxEqual()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00036">kaldi::VecVec()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                              {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>))</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(c);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">if</span> (uc == NULL) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!(c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) &amp;&amp;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                 <span class="stringliteral">&quot;Component returns updatable flag but does not inherit &quot;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                 <span class="stringliteral">&quot;from UpdatableComponent&quot;</span>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span>(!(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>)){</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// testing that if it declares itself as non-updatable,</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// Scale() and Add() and SetZero() have no effect.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">NumParameters</a>() == 0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc) == 0);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>());</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Scale</a>(7.0);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    uc2-&gt;Add(3.0, *uc);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(uc2-&gt;Info(), uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>()));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">SetZero</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(uc2-&gt;Info(), uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>()));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keyword">delete</span> uc2;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">NumParameters</a>() != 0);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>()),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        *uc3 = dynamic_cast&lt;UpdatableComponent*&gt;(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// testing some expected invariances of scale and add.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Scale</a>(5.0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    uc2-&gt;Add(3.0, *uc3);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    uc3-&gt;Scale(8.0);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// now they should both be scaled to 8 times the original component.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(uc2-&gt;Info(), uc3-&gt;Info())) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Expected info strings to be equal: &#39;&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                &lt;&lt; uc2-&gt;Info() &lt;&lt; <span class="stringliteral">&quot;&#39; vs. &#39;&quot;</span> &lt;&lt; uc3-&gt;Info() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">// testing that scaling by 0.5 works the same whether</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// done on the vectorized paramters or via Scale().</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> vec2(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">NumParameters</a>());</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    uc2-&gt;Vectorize(&amp;vec2);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    vec2.<a class="code" href="classkaldi_1_1VectorBase.html#a3de2c6ff761b6879aae381fcfdfa36e6">Scale</a>(0.5);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    uc2-&gt;UnVectorize(vec2);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    uc3-&gt;Scale(0.5);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc2-&gt;Info() == uc3-&gt;Info());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// testing that SetZero() works the same whether done on the vectorized</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// paramters or via SetZero(), and that unvectorizing something that&#39;s been</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// zeroed gives us zero parameters.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    uc2-&gt;Vectorize(&amp;vec2);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    vec2.SetZero();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    uc2-&gt;UnVectorize(vec2);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    uc3-&gt;SetZero(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    uc3-&gt;Vectorize(&amp;vec2);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc2-&gt;Info() == uc3-&gt;Info() &amp;&amp; <a class="code" href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">VecVec</a>(vec2, vec2) == 0.0);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">delete</span> uc2;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keyword">delete</span> uc3;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a750ca3e44a00898afea53b54697226ba"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">kaldi::nnet3::Component::Scale</a></div><div class="ttdeci">virtual void Scale(BaseFloat scale)</div><div class="ttdoc">This virtual function when called by. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00320">nnet-component-itf.h:320</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_ac0697192d76083f84fc989f67fbee5e9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">kaldi::nnet3::UpdatableComponent::DotProduct</a></div><div class="ttdeci">virtual BaseFloat DotProduct(const UpdatableComponent &amp;other) const =0</div><div class="ttdoc">Computes dot-product between parameters of two instances of a Component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a3a4ff15fafe0c8c4885586fc2c36ca8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">kaldi::nnet3::Component::Properties</a></div><div class="ttdeci">virtual int32 Properties() const =0</div><div class="ttdoc">Return bitmask of the component&#39;s properties. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_aa89881e9be0d01d34fedd82539973447"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">kaldi::nnet3::UpdatableComponent::SetZero</a></div><div class="ttdeci">virtual void SetZero(bool treat_as_gradient)=0</div><div class="ttdoc">Sets parameters to zero, and if treat_as_gradient is true, sets is_gradient_ to true and sets learnin...</div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a517fbabeba8d141cca20bea307710195"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">kaldi::nnet3::UpdatableComponent::NumParameters</a></div><div class="ttdeci">virtual int32 NumParameters() const </div><div class="ttdoc">The following new virtual function returns the total dimension of the parameters in this class...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00384">nnet-component-itf.h:384</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a375de0015e95f4f495e8c367c76c50c0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">kaldi::nnet3::StringsApproxEqual</a></div><div class="ttdeci">static bool StringsApproxEqual(const std::string &amp;a, const std::string &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00030">nnet-component-test.cc:30</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_a3de2c6ff761b6879aae381fcfdfa36e6"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#a3de2c6ff761b6879aae381fcfdfa36e6">kaldi::VectorBase::Scale</a></div><div class="ttdeci">void Scale(Real alpha)</div><div class="ttdoc">Multiplies all elements by this constant. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00936">kaldi-vector.cc:936</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">kaldi::nnet3::UpdatableComponent</a></div><div class="ttdoc">Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00345">nnet-component-itf.h:345</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a17f20e0b2d35ec6866a6b479e7d9e867"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">kaldi::nnet3::UpdatableComponent::Info</a></div><div class="ttdeci">virtual std::string Info() const </div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8cc_source.html#l00205">nnet-component-itf.cc:205</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__matrix__funcs__scalar_html_ga4750cd6f7a02a013435779588056b153"><div class="ttname"><a href="group__matrix__funcs__scalar.html#ga4750cd6f7a02a013435779588056b153">kaldi::VecVec</a></div><div class="ttdeci">Real VecVec(const VectorBase&lt; Real &gt; &amp;a, const VectorBase&lt; Real &gt; &amp;b)</div><div class="ttdoc">Returns dot product between v1 and v2. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8cc_source.html#l00036">kaldi-vector.cc:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a179079a64f06a09c80c757753016b094"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetComponentVectorizeUnVectorize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00094">94</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00205">UpdatableComponent::Info()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00384">UpdatableComponent::NumParameters()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">UpdatableComponent::SetZero()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">StringsApproxEqual()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00391">UpdatableComponent::UnVectorize()</a>, and <a class="el" href="nnet-component-itf_8h_source.html#l00389">UpdatableComponent::Vectorize()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                                                         {</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordflow">if</span> (!(c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>))</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(c);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc != NULL);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">SetZero</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> params(uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">NumParameters</a>());</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a9deca2646415c089df8ba0db9387c83b">Vectorize</a>(&amp;params);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(params.Min()==0.0 &amp;&amp; params.Sum()==0.0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a9deca2646415c089df8ba0db9387c83b">Vectorize</a>(&amp;params);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a0d6ac2b7329981543aa1299d94c9556d">UnVectorize</a>(params);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>(), uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>()));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> x = uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc2), y = uc-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      z = uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(x, y) &amp;&amp; <a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(y, z));</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> params2(uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">NumParameters</a>());</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  uc2-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a9deca2646415c089df8ba0db9387c83b">Vectorize</a>(&amp;params2);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; params.Dim(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(params(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) == params2(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">delete</span> uc2;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_ac0697192d76083f84fc989f67fbee5e9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">kaldi::nnet3::UpdatableComponent::DotProduct</a></div><div class="ttdeci">virtual BaseFloat DotProduct(const UpdatableComponent &amp;other) const =0</div><div class="ttdoc">Computes dot-product between parameters of two instances of a Component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a3a4ff15fafe0c8c4885586fc2c36ca8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">kaldi::nnet3::Component::Properties</a></div><div class="ttdeci">virtual int32 Properties() const =0</div><div class="ttdoc">Return bitmask of the component&#39;s properties. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_aa89881e9be0d01d34fedd82539973447"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">kaldi::nnet3::UpdatableComponent::SetZero</a></div><div class="ttdeci">virtual void SetZero(bool treat_as_gradient)=0</div><div class="ttdoc">Sets parameters to zero, and if treat_as_gradient is true, sets is_gradient_ to true and sets learnin...</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a517fbabeba8d141cca20bea307710195"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a517fbabeba8d141cca20bea307710195">kaldi::nnet3::UpdatableComponent::NumParameters</a></div><div class="ttdeci">virtual int32 NumParameters() const </div><div class="ttdoc">The following new virtual function returns the total dimension of the parameters in this class...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00384">nnet-component-itf.h:384</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a375de0015e95f4f495e8c367c76c50c0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">kaldi::nnet3::StringsApproxEqual</a></div><div class="ttdeci">static bool StringsApproxEqual(const std::string &amp;a, const std::string &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00030">nnet-component-test.cc:30</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">kaldi::nnet3::UpdatableComponent</a></div><div class="ttdoc">Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00345">nnet-component-itf.h:345</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a9deca2646415c089df8ba0db9387c83b"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a9deca2646415c089df8ba0db9387c83b">kaldi::nnet3::UpdatableComponent::Vectorize</a></div><div class="ttdeci">virtual void Vectorize(VectorBase&lt; BaseFloat &gt; *params) const </div><div class="ttdoc">Turns the parameters into vector form. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00389">nnet-component-itf.h:389</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a0d6ac2b7329981543aa1299d94c9556d"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a0d6ac2b7329981543aa1299d94c9556d">kaldi::nnet3::UpdatableComponent::UnVectorize</a></div><div class="ttdeci">virtual void UnVectorize(const VectorBase&lt; BaseFloat &gt; &amp;params)</div><div class="ttdoc">Converts the parameters from vector form. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00391">nnet-component-itf.h:391</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_a17f20e0b2d35ec6866a6b479e7d9e867"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#a17f20e0b2d35ec6866a6b479e7d9e867">kaldi::nnet3::UpdatableComponent::Info</a></div><div class="ttdeci">virtual std::string Info() const </div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8cc_source.html#l00205">nnet-component-itf.cc:205</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade08d6728a35e80cbf187c6da2d28596"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestNnetDecodable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classkaldi_1_1Matrix.html">Matrix</a>&lt; BaseFloat &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase</a>&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>reference_output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00031">31</a> of file <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html">nnet-compute-test.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00040">UnitTestNnetCompute()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                                        {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// DecodableAmNnetSimpleOptions opts;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// This is a placeholder for where we&#39;ll eventually test either the decodable</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="comment">// object or something similar to it (e.g. a base class)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac1a1dc9b5063b680db3bb5e8ce670a21"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::TestSimpleComponentDataDerivative </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>perturb_delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00284">284</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Component::Backprop()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">Component::InputDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00071">kBackpropNeedsInput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00073">kBackpropNeedsOutput</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">Component::OutputDim()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Component::Propagate()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Component::Type()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                                {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">InputDim</a>(),</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      output_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">OutputDim</a>(),</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      num_rows = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> properties = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_data(num_rows, input_dim),</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      output_data(num_rows, output_dim),</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      output_deriv(num_rows, output_dim);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  input_data.SetRandn();</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  output_deriv.SetRandn();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;output_data);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_deriv(num_rows, input_dim), empty_mat;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Backprop</a>(<span class="stringliteral">&quot;foobar&quot;</span>, NULL,</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a>) ? input_data : empty_mat),</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kBackpropNeedsOutput</a>) ? output_data : empty_mat),</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;             output_deriv, NULL, &amp;input_deriv);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> test_dim = 3;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> original_objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output_deriv, output_data, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> measured_objf_change(test_dim),</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      predicted_objf_change(test_dim);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; test_dim; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> perturbed_input_data(num_rows, input_dim),</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        perturbed_output_data(num_rows, output_dim);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    perturbed_input_data.SetRandn();</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    perturbed_input_data.Scale(perturb_delta);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// at this point, perturbed_input_data contains the offset at the input data.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    predicted_objf_change(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(perturbed_input_data, input_deriv,</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                           <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    perturbed_input_data.AddMat(1.0, input_data);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, perturbed_input_data, &amp;perturbed_output_data);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    measured_objf_change(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output_deriv, perturbed_output_data,</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                                          <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) - original_objf;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  }</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Predicted objf-change = &quot;</span> &lt;&lt; predicted_objf_change;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Measured objf-change = &quot;</span> &lt;&lt; measured_objf_change;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> threshold = 0.1;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordtype">bool</span> ans = <a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(predicted_objf_change, measured_objf_change, threshold);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">if</span> (!ans)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Data-derivative test failed, component-type=&quot;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;               &lt;&lt; c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Type</a>() &lt;&lt; <span class="stringliteral">&quot;, input-dim=&quot;</span> &lt;&lt; input_dim</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;, output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordflow">if</span> (c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Type</a>() == <span class="stringliteral">&quot;NormalizeComponent&quot;</span> &amp;&amp; input_dim == 1) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// derivatives are mathematically zero, but the measured and predicted</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// objf have different roundoff and the relative differences are large.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// this is not unexpected.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Accepting deriv differences since it is NormalizeComponent &quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;with dim=1.&quot;</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ac0f2f034a884363d4e0694c62ea8a764"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">kaldi::nnet3::Component::OutputDim</a></div><div class="ttdeci">virtual int32 OutputDim() const =0</div><div class="ttdoc">Returns output-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kaldi::nnet3::kBackpropNeedsOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00073">nnet-component-itf.h:73</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a3a4ff15fafe0c8c4885586fc2c36ca8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">kaldi::nnet3::Component::Properties</a></div><div class="ttdeci">virtual int32 Properties() const =0</div><div class="ttdoc">Return bitmask of the component&#39;s properties. </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ab6b6147feb5e0688469b735a6546c222"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">kaldi::nnet3::Component::Type</a></div><div class="ttdeci">virtual std::string Type() const =0</div><div class="ttdoc">Returns a string such as &quot;SigmoidComponent&quot;, describing the type of the object. </div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a5923fbec316ecf7d5a7f6d7e1cbc5ada"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">kaldi::nnet3::Component::Propagate</a></div><div class="ttdeci">virtual void Propagate(const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *out) const =0</div><div class="ttdoc">Propagate function. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a7f37d871d35c43a03324502cea308635"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">kaldi::nnet3::Component::InputDim</a></div><div class="ttdeci">virtual int32 InputDim() const =0</div><div class="ttdoc">Returns input-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa2219a3e590b0a995243a7faed7d4df8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">kaldi::nnet3::Component::Backprop</a></div><div class="ttdeci">virtual void Backprop(const std::string &amp;debug_info, const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, Component *to_update, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const =0</div><div class="ttdoc">Backprop function; depending on which of the arguments &#39;to_update&#39; and &#39;in_deriv&#39; are non-NULL...</div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a72a20443febb349c12d3f34ea6d5bdc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool kaldi::nnet3::TestSimpleComponentModelDerivative </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>perturb_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>test_derivative</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00345">345</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Component::Backprop()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">UpdatableComponent::DotProduct()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">Component::InputDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00071">kBackpropNeedsInput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00073">kBackpropNeedsOutput</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">Component::OutputDim()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#af8524a3f9d683293269f46e3cc54b285">UpdatableComponent::PerturbParams()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Component::Propagate()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">UpdatableComponent::SetZero()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Component::Type()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                              {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">InputDim</a>(),</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      output_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">OutputDim</a>(),</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      num_rows = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> properties = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordflow">if</span> ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) == 0) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// nothing to test.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_data(num_rows, input_dim),</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      output_data(num_rows, output_dim),</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      output_deriv(num_rows, output_dim);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  input_data.SetRandn();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  output_deriv.SetRandn();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;output_data);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> original_objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output_deriv, output_data, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c_copy = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(&amp;c);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc_copy = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(c_copy);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc != NULL &amp;&amp; uc_copy != NULL);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">if</span> (test_derivative) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">bool</span> is_gradient = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    uc_copy-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">SetZero</a>(is_gradient);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_deriv(num_rows, input_dim), empty_mat;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Backprop</a>(<span class="stringliteral">&quot;foobar&quot;</span>, NULL,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a>) ? input_data : empty_mat),</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kBackpropNeedsOutput</a>) ? output_data : empty_mat),</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;             output_deriv, c_copy,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;             (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0 ? &amp;input_deriv : NULL));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">if</span> (!test_derivative) { <span class="comment">// Just testing that the model update is downhill.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> new_output_data(num_rows, output_dim);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    c_copy-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;new_output_data);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> new_objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output_deriv, new_output_data, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordtype">bool</span> ans = (new_objf &gt; original_objf);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span> (!ans) {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;After update, new objf is not better than the original objf: &quot;</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                 &lt;&lt; new_objf &lt;&lt; <span class="stringliteral">&quot; &lt;= &quot;</span> &lt;&lt; original_objf;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">delete</span> c_copy;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// check that the model derivative is accurate.</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> test_dim = 3;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> measured_objf_change(test_dim),</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        predicted_objf_change(test_dim);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; test_dim; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> perturbed_output_data(num_rows, output_dim);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c_perturbed = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a> *uc_perturbed =</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">UpdatableComponent</a>*<span class="keyword">&gt;</span>(c_perturbed);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(uc_perturbed != NULL);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      uc_perturbed-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#af8524a3f9d683293269f46e3cc54b285">PerturbParams</a>(perturb_delta);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      predicted_objf_change(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = uc_copy-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc_perturbed) -</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          uc_copy-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">DotProduct</a>(*uc);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      c_perturbed-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;perturbed_output_data);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      measured_objf_change(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output_deriv, perturbed_output_data,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                            <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>) - original_objf;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="keyword">delete</span> c_perturbed;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Predicted objf-change = &quot;</span> &lt;&lt; predicted_objf_change;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Measured objf-change = &quot;</span> &lt;&lt; measured_objf_change;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> threshold = 0.1;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordtype">bool</span> ans = <a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(predicted_objf_change, measured_objf_change,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                           threshold);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (!ans)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Model-derivative test failed, component-type=&quot;</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                 &lt;&lt; c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Type</a>() &lt;&lt; <span class="stringliteral">&quot;, input-dim=&quot;</span> &lt;&lt; input_dim</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;, output-dim=&quot;</span> &lt;&lt; output_dim;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">delete</span> c_copy;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ac0f2f034a884363d4e0694c62ea8a764"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">kaldi::nnet3::Component::OutputDim</a></div><div class="ttdeci">virtual int32 OutputDim() const =0</div><div class="ttdoc">Returns output-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kaldi::nnet3::kBackpropNeedsOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00073">nnet-component-itf.h:73</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_ac0697192d76083f84fc989f67fbee5e9"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#ac0697192d76083f84fc989f67fbee5e9">kaldi::nnet3::UpdatableComponent::DotProduct</a></div><div class="ttdeci">virtual BaseFloat DotProduct(const UpdatableComponent &amp;other) const =0</div><div class="ttdoc">Computes dot-product between parameters of two instances of a Component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a3a4ff15fafe0c8c4885586fc2c36ca8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">kaldi::nnet3::Component::Properties</a></div><div class="ttdeci">virtual int32 Properties() const =0</div><div class="ttdoc">Return bitmask of the component&#39;s properties. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_aa89881e9be0d01d34fedd82539973447"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#aa89881e9be0d01d34fedd82539973447">kaldi::nnet3::UpdatableComponent::SetZero</a></div><div class="ttdeci">virtual void SetZero(bool treat_as_gradient)=0</div><div class="ttdoc">Sets parameters to zero, and if treat_as_gradient is true, sets is_gradient_ to true and sets learnin...</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html">kaldi::nnet3::UpdatableComponent</a></div><div class="ttdoc">Class UpdatableComponent is a Component which has trainable parameters; it extends the interface of C...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00345">nnet-component-itf.h:345</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ab6b6147feb5e0688469b735a6546c222"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">kaldi::nnet3::Component::Type</a></div><div class="ttdeci">virtual std::string Type() const =0</div><div class="ttdoc">Returns a string such as &quot;SigmoidComponent&quot;, describing the type of the object. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1UpdatableComponent_html_af8524a3f9d683293269f46e3cc54b285"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1UpdatableComponent.html#af8524a3f9d683293269f46e3cc54b285">kaldi::nnet3::UpdatableComponent::PerturbParams</a></div><div class="ttdeci">virtual void PerturbParams(BaseFloat stddev)=0</div><div class="ttdoc">This function is to be used in testing. </div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a5923fbec316ecf7d5a7f6d7e1cbc5ada"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">kaldi::nnet3::Component::Propagate</a></div><div class="ttdeci">virtual void Propagate(const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *out) const =0</div><div class="ttdoc">Propagate function. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a7f37d871d35c43a03324502cea308635"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">kaldi::nnet3::Component::InputDim</a></div><div class="ttdeci">virtual int32 InputDim() const =0</div><div class="ttdoc">Returns input-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa2219a3e590b0a995243a7faed7d4df8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">kaldi::nnet3::Component::Backprop</a></div><div class="ttdeci">virtual void Backprop(const std::string &amp;debug_info, const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, Component *to_update, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const =0</div><div class="ttdoc">Backprop function; depending on which of the arguments &#39;to_update&#39; and &#39;in_deriv&#39; are non-NULL...</div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d2f85463a6a7b714692a2e84160f137"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestSimpleComponentPropagateProperties </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> &amp;&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00188">188</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00273">kaldi::AssertEqual()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Component::Backprop()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Component::Copy()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">Component::InputDim()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00067">kBackpropAdds</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00075">kBackpropInPlace</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00071">kBackpropNeedsInput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00073">kBackpropNeedsOutput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00049">kLinearInInput</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00052">kLinearInParameters</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00060">kPropagateAdds</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00056">kPropagateInPlace</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">Component::OutputDim()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Component::Propagate()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00320">Component::Scale()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00593">CuMatrixBase&lt; Real &gt;::Scale()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, and <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Component::Type()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">UnitTestNnetComponent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                                                                {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> properties = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Properties</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c_copy = NULL, *c_copy_scaled = NULL;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    c_copy = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();  <span class="comment">// This will test backprop with an updatable component.</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0 &amp;&amp;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      (properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0">kLinearInParameters</a>)) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    c_copy_scaled = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">Copy</a>();  <span class="comment">// This will test backprop with an updatable component.</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    c_copy_scaled-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">Scale</a>(0.5);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> input_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">InputDim</a>(),</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      output_dim = c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">OutputDim</a>(),</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      num_rows = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 100);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_data(num_rows, input_dim);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  input_data.SetRandn();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      input_data_scaled(input_data),</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      output_data1(num_rows, output_dim),</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      output_data2(num_rows, output_dim),</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      output_data3(input_data),</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      output_data4(num_rows, output_dim),</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      output_data5(num_rows, output_dim);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  output_data2.Add(1.0);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  input_data_scaled.Scale(2.0);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keywordflow">if</span> ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kPropagateAdds</a>) &amp;&amp; (properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d">kPropagateInPlace</a>)) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;kPropagateAdds and kPropagateInPlace flags are incompatible.&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;output_data1);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data, &amp;output_data2);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordflow">if</span> (properties &amp; kPropagateInPlace) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, output_data3, &amp;output_data3);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (!output_data1.ApproxEqual(output_data3)) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Test of kPropagateInPlace flag for component of type &quot;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                &lt;&lt; c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">Type</a>() &lt;&lt; <span class="stringliteral">&quot; failed.&quot;</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordflow">if</span> (properties &amp; kPropagateAdds)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    output_data2.Add(-1.0); <span class="comment">// remove the offset</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(output_data1, output_data2);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <span class="keywordflow">if</span> (c_copy_scaled) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    c_copy_scaled-&gt;Propagate(NULL, input_data, &amp;output_data4);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    output_data4.Scale(2.0);  <span class="comment">// we scaled the parameters by 0.5 above, and the</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// output is supposed to be linear in the parameter value.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(output_data1, output_data4);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778">kLinearInInput</a>) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">Propagate</a>(NULL, input_data_scaled, &amp;output_data5);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    output_data5.Scale(0.5);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(output_data1, output_data5);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv(num_rows, output_dim);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  output_deriv.SetRandn();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> input_deriv1(num_rows, input_dim),</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      input_deriv2(num_rows, input_dim),</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      input_deriv3(output_deriv);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  input_deriv2.Add(1.0);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> empty_mat;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// test with input_deriv1 that&#39;s zero</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Backprop</a>(<span class="stringliteral">&quot;foobar&quot;</span>, NULL,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kBackpropNeedsInput</a>) ? input_data : empty_mat),</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;             ((properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kBackpropNeedsOutput</a>) ? output_data1 : empty_mat),</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;             output_deriv,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;             c_copy,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;             &amp;input_deriv1);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="comment">// test with input_deriv2 that&#39;s all ones.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Backprop</a>(<span class="stringliteral">&quot;foobar&quot;</span>, NULL,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;             ((properties &amp; kBackpropNeedsInput) ? input_data : empty_mat),</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;             ((properties &amp; kBackpropNeedsOutput) ? output_data1 : empty_mat),</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;             output_deriv,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;             c_copy,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;             &amp;input_deriv2);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <span class="comment">// test backprop in place, if supported.</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordflow">if</span> (properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df">kBackpropInPlace</a>) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    c.<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">Backprop</a>(<span class="stringliteral">&quot;foobar&quot;</span>, NULL,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;               ((properties &amp; kBackpropNeedsInput) ? input_data : empty_mat),</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;               ((properties &amp; kBackpropNeedsOutput) ? output_data1 : empty_mat),</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;               input_deriv3,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;               c_copy,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;               &amp;input_deriv3);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">if</span> (properties &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kBackpropAdds</a>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    input_deriv2.Add(-1.0);  <span class="comment">// subtract the offset.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(input_deriv1, input_deriv2);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">if</span> (properties &amp; kBackpropInPlace)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(input_deriv1, input_deriv3);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">delete</span> c_copy;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keyword">delete</span> c_copy_scaled;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa46d9c7de00be8203e16a6e55af0afef"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa46d9c7de00be8203e16a6e55af0afef">kaldi::nnet3::Component::Copy</a></div><div class="ttdeci">virtual Component * Copy() const =0</div><div class="ttdoc">Copies component (deep copy). </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a42c174e9fb59e48e231bb37543587cb0">kaldi::nnet3::kLinearInParameters</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00052">nnet-component-itf.h:52</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ac0f2f034a884363d4e0694c62ea8a764"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ac0f2f034a884363d4e0694c62ea8a764">kaldi::nnet3::Component::OutputDim</a></div><div class="ttdeci">virtual int32 OutputDim() const =0</div><div class="ttdoc">Returns output-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a750ca3e44a00898afea53b54697226ba"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a750ca3e44a00898afea53b54697226ba">kaldi::nnet3::Component::Scale</a></div><div class="ttdeci">virtual void Scale(BaseFloat scale)</div><div class="ttdoc">This virtual function when called by. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00320">nnet-component-itf.h:320</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2a37e781d9be4e2cb09699a840dde841">kaldi::nnet3::kBackpropNeedsOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00073">nnet-component-itf.h:73</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a3a4ff15fafe0c8c4885586fc2c36ca8a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">kaldi::nnet3::Component::Properties</a></div><div class="ttdeci">virtual int32 Properties() const =0</div><div class="ttdoc">Return bitmask of the component&#39;s properties. </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a2f52823d0c7fdc03b0be47662c66146d">kaldi::nnet3::kPropagateInPlace</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00056">nnet-component-itf.h:56</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3adac6588b2ef2e8b52936718cf97263e7">kaldi::nnet3::kBackpropNeedsInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00071">nnet-component-itf.h:71</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a5180ca55eb0162c68740d51295d056c7">kaldi::nnet3::kPropagateAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00060">nnet-component-itf.h:60</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3abaa0f1d8521d4753ffae9f2cc22a15df">kaldi::nnet3::kBackpropInPlace</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00075">nnet-component-itf.h:75</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_ab6b6147feb5e0688469b735a6546c222"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#ab6b6147feb5e0688469b735a6546c222">kaldi::nnet3::Component::Type</a></div><div class="ttdeci">virtual std::string Type() const =0</div><div class="ttdoc">Returns a string such as &quot;SigmoidComponent&quot;, describing the type of the object. </div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3acda3bbc91bd09631b18fdc57376c2b90">kaldi::nnet3::kBackpropAdds</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00067">nnet-component-itf.h:67</a></div></div>
<div class="ttc" id="namespacekaldi_html_aeb6ba6085493e3f15358e49751342177"><div class="ttname"><a href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">kaldi::AssertEqual</a></div><div class="ttdeci">static void AssertEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">assert abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)) </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00273">kaldi-math.h:273</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a5923fbec316ecf7d5a7f6d7e1cbc5ada"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a5923fbec316ecf7d5a7f6d7e1cbc5ada">kaldi::nnet3::Component::Propagate</a></div><div class="ttdeci">virtual void Propagate(const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in, CuMatrixBase&lt; BaseFloat &gt; *out) const =0</div><div class="ttdoc">Propagate function. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a7f37d871d35c43a03324502cea308635"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a7f37d871d35c43a03324502cea308635">kaldi::nnet3::Component::InputDim</a></div><div class="ttdeci">virtual int32 InputDim() const =0</div><div class="ttdoc">Returns input-dimension of this component. </div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_aa2219a3e590b0a995243a7faed7d4df8"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#aa2219a3e590b0a995243a7faed7d4df8">kaldi::nnet3::Component::Backprop</a></div><div class="ttdeci">virtual void Backprop(const std::string &amp;debug_info, const ComponentPrecomputedIndexes *indexes, const CuMatrixBase&lt; BaseFloat &gt; &amp;in_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_value, const CuMatrixBase&lt; BaseFloat &gt; &amp;out_deriv, Component *to_update, CuMatrixBase&lt; BaseFloat &gt; *in_deriv) const =0</div><div class="ttdoc">Backprop function; depending on which of the arguments &#39;to_update&#39; and &#39;in_deriv&#39; are non-NULL...</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a8f49618f68d0a6da392ecdd0ed5ca778">kaldi::nnet3::kLinearInInput</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00049">nnet-component-itf.h:49</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ace60719eb494447690bfb8e77e02a2e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::TestStringsApproxEqual </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00117">117</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="_2nnet-component-test_8cc_source.html#l00030">StringsApproxEqual()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00467">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                              {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// we must test the test.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(<span class="stringliteral">&quot;a&quot;</span>, <span class="stringliteral">&quot;b&quot;</span>));</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>));</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(<span class="stringliteral">&quot;1.234&quot;</span>, <span class="stringliteral">&quot;1.235&quot;</span>));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(<span class="stringliteral">&quot;x 1.234 y&quot;</span>, <span class="stringliteral">&quot;x 1.235 y&quot;</span>));</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">StringsApproxEqual</a>(<span class="stringliteral">&quot;x 1.234 y 6.41&quot;</span>, <span class="stringliteral">&quot;x 1.235 y 6.49&quot;</span>));</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a375de0015e95f4f495e8c367c76c50c0"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a375de0015e95f4f495e8c367c76c50c0">kaldi::nnet3::StringsApproxEqual</a></div><div class="ttdeci">static bool StringsApproxEqual(const std::string &amp;a, const std::string &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00030">nnet-component-test.cc:30</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a63c8dc97af58bac620a4754a6dcc49ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestComputeGraphTranspose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00148">148</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="nnet-graph-test_8cc_source.html#l00026">AssertGraphEqual()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00047">BuildTestGraph()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00072">BuildTestGraphTranspose()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00063">ComputeGraphTranspose()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00202">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                     {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; graph;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">BuildTestGraph</a>(&amp;graph);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; graph_transpose;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">ComputeGraphTranspose</a>(graph, &amp;graph_transpose);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; ref_graph_transpose;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a0d0ace1de8245a113abc6674f184a19f">BuildTestGraphTranspose</a>(&amp;ref_graph_transpose);</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">AssertGraphEqual</a>(graph_transpose, ref_graph_transpose));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2cf1ba5597d79505ed5fd378338740bb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">kaldi::nnet3::BuildTestGraph</a></div><div class="ttdeci">void BuildTestGraph(std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00047">nnet-graph-test.cc:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac4457943f315ab2e900b1f81606404f8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac4457943f315ab2e900b1f81606404f8">kaldi::nnet3::ComputeGraphTranspose</a></div><div class="ttdeci">void ComputeGraphTranspose(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph_transpose)</div><div class="ttdoc">Outputs a graph in which the order of arcs is reversed. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00063">nnet-graph.cc:63</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a0d0ace1de8245a113abc6674f184a19f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a0d0ace1de8245a113abc6674f184a19f">kaldi::nnet3::BuildTestGraphTranspose</a></div><div class="ttdeci">void BuildTestGraphTranspose(std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00072">nnet-graph-test.cc:72</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1b9cf952746776c000ad16fcc9a9f990"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">kaldi::nnet3::AssertGraphEqual</a></div><div class="ttdeci">bool AssertGraphEqual(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph1, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph2)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00026">nnet-graph-test.cc:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a09c05c0131617f375bfa70bc5a88ef6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestComputeTopSortOrder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00187">187</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="nnet-graph-test_8cc_source.html#l00038">AssertVectorEqual()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00114">BuildTestSccGraph()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00131">BuildTestTopSortOrder()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00223">ComputeTopSortOrder()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00202">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                                   {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; scc_graph;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aa97309456d46852962866b097697c6b7">BuildTestSccGraph</a>(&amp;scc_graph);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  std::vector&lt;int32&gt; node_to_order;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ae4c2ac8a9e96d220776910b2a9ae2971">ComputeTopSortOrder</a>(scc_graph, &amp;node_to_order);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  std::vector&lt;int32&gt; ref_node_to_order;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a1a8af0bfaf3239fc5f740444edc92874">BuildTestTopSortOrder</a>(&amp;ref_node_to_order);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a60bde0a269254ed7c2471823ba362d75">AssertVectorEqual</a>(node_to_order, ref_node_to_order));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a60bde0a269254ed7c2471823ba362d75"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a60bde0a269254ed7c2471823ba362d75">kaldi::nnet3::AssertVectorEqual</a></div><div class="ttdeci">bool AssertVectorEqual(const std::vector&lt; int32 &gt; &amp;vec1, const std::vector&lt; int32 &gt; &amp;vec2)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00038">nnet-graph-test.cc:38</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae4c2ac8a9e96d220776910b2a9ae2971"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae4c2ac8a9e96d220776910b2a9ae2971">kaldi::nnet3::ComputeTopSortOrder</a></div><div class="ttdeci">void ComputeTopSortOrder(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; int32 &gt; *node_to_order)</div><div class="ttdoc">Given an acyclic graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming f...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00223">nnet-graph.cc:223</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa97309456d46852962866b097697c6b7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa97309456d46852962866b097697c6b7">kaldi::nnet3::BuildTestSccGraph</a></div><div class="ttdeci">void BuildTestSccGraph(std::vector&lt; std::vector&lt; int32 &gt; &gt; *scc_graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00114">nnet-graph-test.cc:114</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1a8af0bfaf3239fc5f740444edc92874"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1a8af0bfaf3239fc5f740444edc92874">kaldi::nnet3::BuildTestTopSortOrder</a></div><div class="ttdeci">void BuildTestTopSortOrder(std::vector&lt; int32 &gt; *node_to_order)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00131">nnet-graph-test.cc:131</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a013e6098460707cee578712638ce37dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestConfigLineParse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse-test_8cc_source.html#l00026">26</a> of file <a class="el" href="nnet-parse-test_8cc_source.html">nnet-parse-test.cc</a>.</p>

<p>References <a class="el" href="nnet-parse_8cc_source.html#l00092">ConfigLine::GetValue()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00176">ConfigLine::HasUnusedValues()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="nnet-parse_8cc_source.html#l00031">ConfigLine::ParseLine()</a>, and <a class="el" href="nnet-parse_8cc_source.html#l00184">ConfigLine::UnusedValues()</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse-test_8cc_source.html#l00248">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                               {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  std::string str;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    str = <span class="stringliteral">&quot;xx=yyy foo=bar  baz=123 ba=1:2&quot;</span>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> status = cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(status);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    std::string str_value;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;xx&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;yyy&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;foo&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;bar&quot;</span>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;xy&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;baz&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;123&quot;</span>);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    std::vector&lt;int32&gt; int_values;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;xx&quot;</span>, &amp;int_values));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;baz&quot;</span>, &amp;int_values));</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(int_values.size() == 1 &amp;&amp; int_values[0] == 123);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;ba&quot;</span>, &amp;int_values));</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(int_values.size() == 2 &amp;&amp; int_values[0] == 1 &amp;&amp; int_values[1] == 2);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    str = <span class="stringliteral">&quot;baz=x y z pp = qq ab =cd ac= bd&quot;</span>;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    str = <span class="stringliteral">&quot;baz=x y z pp = qq ab=cd ac=bd&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    str = <span class="stringliteral">&quot;baz&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  {</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    str = <span class="stringliteral">&quot;a=b baz&quot;</span>;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str) &amp;&amp; cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#aabde332012d17419c9df000802b6a196">UnusedValues</a>() == <span class="stringliteral">&quot;a=b baz&quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    str = <span class="stringliteral">&quot;a=b baz &quot;</span>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str) &amp;&amp; cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#aabde332012d17419c9df000802b6a196">UnusedValues</a>() == <span class="stringliteral">&quot;a=b baz&quot;</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    str = <span class="stringliteral">&quot;a=b =c&quot;</span>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    str = <span class="stringliteral">&quot;baz=&#39;x y z&#39; pp=qq ab=cd ac=bd&quot;</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    std::string str_value;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;baz&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;x y z&quot;</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;pp&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;qq&quot;</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#aabde332012d17419c9df000802b6a196">UnusedValues</a>() == <span class="stringliteral">&quot;ab=cd ac=bd&quot;</span>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;ab&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;cd&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#aabde332012d17419c9df000802b6a196">UnusedValues</a>() == <span class="stringliteral">&quot;ac=bd&quot;</span>);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;ac&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;bd&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    str = <span class="stringliteral">&quot;baz= pp = qq flag=t &quot;</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    str = <span class="stringliteral">&quot; baz= pp=qq flag=t  &quot;</span>;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    std::string str_value;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;baz&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;pp&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;qq&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;flag&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(str_value == <span class="stringliteral">&quot;t&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">HasUnusedValues</a>());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">bool</span> bool_value = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;flag&quot;</span>, &amp;bool_value));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(bool_value);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    str = <span class="stringliteral">&quot;_baz=a -pp=qq&quot;</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    str = <span class="stringliteral">&quot;0baz=a pp=qq&quot;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    str = <span class="stringliteral">&quot;-baz=a pp=qq&quot;</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    str = <span class="stringliteral">&quot;_baz&#39;=a pp=qq&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    str = <span class="stringliteral">&quot;baz=g&quot;</span>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">bool</span> flag;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;baz&quot;</span>, &amp;flag));</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    str = <span class="stringliteral">&quot;_baz1=a pp=qq&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">ParseLine</a>(str));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    std::string str_value;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.<a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">GetValue</a>(<span class="stringliteral">&quot;_baz1&quot;</span>, &amp;str_value));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html">kaldi::nnet3::ConfigLine</a></div><div class="ttdoc">This class is responsible for parsing input xx=yyy a=b c empty= f-oo=bar ba_z=123 bing=&#39;a b c&#39; baz=&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8h_source.html#l00039">nnet-parse.h:39</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html_a89086da42b4e4067874be15685d424a3"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html#a89086da42b4e4067874be15685d424a3">kaldi::nnet3::ConfigLine::ParseLine</a></div><div class="ttdeci">bool ParseLine(const std::string &amp;line)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00031">nnet-parse.cc:31</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html_af46be0e68aa534ee0a388bf163c1d9ac"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html#af46be0e68aa534ee0a388bf163c1d9ac">kaldi::nnet3::ConfigLine::GetValue</a></div><div class="ttdeci">bool GetValue(const std::string &amp;key, std::string *value)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00092">nnet-parse.cc:92</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html_aabde332012d17419c9df000802b6a196"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html#aabde332012d17419c9df000802b6a196">kaldi::nnet3::ConfigLine::UnusedValues</a></div><div class="ttdeci">std::string UnusedValues() const </div><div class="ttdoc">returns e.g. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00184">nnet-parse.cc:184</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html_a923c067b975cdc38197e6c2b9e826246"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html#a923c067b975cdc38197e6c2b9e826246">kaldi::nnet3::ConfigLine::HasUnusedValues</a></div><div class="ttdeci">bool HasUnusedValues() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00176">nnet-parse.cc:176</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa84775bbab03ebc20020d57dbefb2586"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestDescriptorIo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00088">88</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>, <a class="el" href="nnet-descriptor-test_8cc_source.html#l00075">GenRandDescriptor()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00380">Descriptor::Parse()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00399">Descriptor::WriteConfig()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00223">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                            {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 100; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 5;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    std::vector&lt;std::string&gt; node_names(num_nodes);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; node_names.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      std::ostringstream ostr;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      ostr &lt;&lt; <span class="stringliteral">&quot;a&quot;</span> &lt;&lt; (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      node_names[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = ostr.str();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> desc;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    std::ostringstream ostr;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2465e8e47256304999d4cd892e7162b9">GenRandDescriptor</a>(num_nodes, &amp;desc);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    desc.<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr, node_names);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> desc2(desc), desc3, desc4;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    desc3 = desc;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    std::vector&lt;std::string&gt; tokens;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(ostr.str(), &amp;tokens);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    tokens.push_back(<span class="stringliteral">&quot;end of input&quot;</span>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    std::istringstream istr(ostr.str());</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keyword">const</span> std::string *next_token = &amp;(tokens[0]);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">bool</span> ans = desc4.<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#addb4cf06320aab37ab19510329bf40c5">Parse</a>(node_names, &amp;next_token);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ans);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    std::ostringstream ostr2;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    desc2.WriteConfig(ostr2, node_names);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    std::ostringstream ostr3;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    desc3.<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr3, node_names);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    std::ostringstream ostr4;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    desc4.<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr4, node_names);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ostr.str() == ostr2.str());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ostr.str() == ostr3.str());</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;x = &quot;</span> &lt;&lt; ostr.str();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;y = &quot;</span> &lt;&lt; ostr4.str();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (ostr.str() != ostr4.str()) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;x and y differ: checking that it&#39;s due to Offset normalization.&quot;</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ostr.str().find(<span class="stringliteral">&quot;Offset(Offset&quot;</span>) != std::string::npos ||</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                   (ostr.str().find(<span class="stringliteral">&quot;Offset(&quot;</span>) != std::string::npos &amp;&amp;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    ostr.str().find(<span class="stringliteral">&quot;, 0)&quot;</span>) != std::string::npos));</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html">kaldi::nnet3::Descriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00429">nnet-descriptor.h:429</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html_addb4cf06320aab37ab19510329bf40c5"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html#addb4cf06320aab37ab19510329bf40c5">kaldi::nnet3::Descriptor::Parse</a></div><div class="ttdeci">bool Parse(const std::vector&lt; std::string &gt; &amp;node_names, const std::string **next_token)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00380">nnet-descriptor.cc:380</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac6b64008b19bbb6e8769769cbf96fa68"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">kaldi::nnet3::DescriptorTokenize</a></div><div class="ttdeci">bool DescriptorTokenize(const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</div><div class="ttdoc">This function tokenizes input when parsing Descriptor configuration values. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00355">nnet-parse.cc:355</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html_a8f09e9fcbf206d294cf53959ef0c832a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">kaldi::nnet3::Descriptor::WriteConfig</a></div><div class="ttdeci">void WriteConfig(std::ostream &amp;os, const std::vector&lt; std::string &gt; &amp;node_names) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00399">nnet-descriptor.cc:399</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2465e8e47256304999d4cd892e7162b9"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2465e8e47256304999d4cd892e7162b9">kaldi::nnet3::GenRandDescriptor</a></div><div class="ttdeci">void GenRandDescriptor(int32 num_nodes, Descriptor *desc)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00075">nnet-descriptor-test.cc:75</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac447841fa736f8af0f8c64e8cd415644"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestDescriptorTokenize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse-test_8cc_source.html#l00195">195</a> of file <a class="el" href="nnet-parse-test_8cc_source.html">nnet-parse-test.cc</a>.</p>

<p>References <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse-test_8cc_source.html#l00248">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                  {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  std::vector&lt;std::string&gt; lines;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  std::string str = <span class="stringliteral">&quot;(,test )&quot;</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines[0] == <span class="stringliteral">&quot;(&quot;</span> &amp;&amp; lines[1] == <span class="stringliteral">&quot;,&quot;</span> &amp;&amp; lines[2] == <span class="stringliteral">&quot;test&quot;</span> &amp;&amp; lines[3] == <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  str = <span class="stringliteral">&quot;(,1test )&quot;</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  str = <span class="stringliteral">&quot;t (,-1 )&quot;</span>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines.size() == 5 &amp;&amp; lines[0] == <span class="stringliteral">&quot;t&quot;</span> &amp;&amp; lines[3] == <span class="stringliteral">&quot;-1&quot;</span>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  str = <span class="stringliteral">&quot;   sd , -112 )&quot;</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines.size() == 4 &amp;&amp; lines[0] == <span class="stringliteral">&quot;sd&quot;</span> &amp;&amp; lines[2] == <span class="stringliteral">&quot;-112&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  str = <span class="stringliteral">&quot;   sd , +112 )&quot;</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines.size() == 4 &amp;&amp; lines[0] == <span class="stringliteral">&quot;sd&quot;</span> &amp;&amp; lines[2] == <span class="stringliteral">&quot;+112&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  str = <span class="stringliteral">&quot;foo&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(str, &amp;lines));</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines.size() == 1 &amp;&amp; lines[0] == <span class="stringliteral">&quot;foo&quot;</span>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac6b64008b19bbb6e8769769cbf96fa68"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">kaldi::nnet3::DescriptorTokenize</a></div><div class="ttdeci">bool DescriptorTokenize(const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</div><div class="ttdoc">This function tokenizes input when parsing Descriptor configuration values. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00355">nnet-parse.cc:355</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a26164e97ad97a37e3401b95d0d82098b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestEnsureContiguousProperty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00222">222</a> of file <a class="el" href="nnet-compile-utils-test_8cc_source.html">nnet-compile-utils-test.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00401">EnsureContiguousProperty()</a>, <a class="el" href="nnet-compile-utils_8cc_source.html#l00523">HasContiguousProperty()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00361">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                        {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; 10; k++) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    std::vector&lt;int32&gt; indexes(size);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 4);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt; reverse_indexes;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">bool</span> ans = <a class="code" href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">HasContiguousProperty</a>(indexes, &amp;reverse_indexes);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (ans) { <span class="comment">// has contiguous property -&gt; EnsureContiguousProperty should do</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;               <span class="comment">// nothing.</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      std::vector&lt;std::vector&lt;int32&gt; &gt; indexes_split;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">EnsureContiguousProperty</a>(indexes, &amp;indexes_split);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="keywordflow">if</span> (indexes.size() == 0 ||</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          *std::max_element(indexes.begin(), indexes.end()) == -1) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split.size() == 0);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split.size() == 1 &amp;&amp;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                     indexes_split[0] == indexes);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      std::vector&lt;std::vector&lt;int32&gt; &gt; indexes_split;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">EnsureContiguousProperty</a>(indexes, &amp;indexes_split);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split.size() &gt; 1);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_val = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordtype">bool</span> found = (this_val == -1);  <span class="comment">// not looking for anything if</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                        <span class="comment">// this_val is -1.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; indexes_split.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          <span class="keywordflow">if</span> (found) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == -1);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">if</span> (indexes_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == this_val) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;              found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == -1);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;          }</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(found);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; indexes_split.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;          <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].size() == indexes.size() &amp;&amp;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                       <a class="code" href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">HasContiguousProperty</a>(indexes_split[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>], &amp;reverse_indexes));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae892457066e9b2ac1632188de1aa06f1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">kaldi::nnet3::HasContiguousProperty</a></div><div class="ttdeci">bool HasContiguousProperty(const std::vector&lt; int32 &gt; &amp;indexes, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *reverse_indexes)</div><div class="ttdoc">This function returns true if for each integer i != -1, all the indexes j at which indexes[j] == i ar...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00523">nnet-compile-utils.cc:523</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a84ff5e289907fa63155ee9bec0f9c631"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a84ff5e289907fa63155ee9bec0f9c631">kaldi::nnet3::EnsureContiguousProperty</a></div><div class="ttdeci">void EnsureContiguousProperty(const std::vector&lt; int32 &gt; &amp;indexes, std::vector&lt; std::vector&lt; int32 &gt; &gt; *indexes_out)</div><div class="ttdoc">This function takes a vector of indexes and splits it up into as separate vectors of the same size...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00401">nnet-compile-utils.cc:401</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af092740ce1ecc4592e3d5c70425baf7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestFindSccs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00160">160</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="nnet-graph-test_8cc_source.html#l00026">AssertGraphEqual()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00047">BuildTestGraph()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00097">BuildTestSccs()</a>, <a class="el" href="nnet-graph_8cc_source.html#l00156">FindSccs()</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00202">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                        {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; graph;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">BuildTestGraph</a>(&amp;graph);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; sccs;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ae72c79fbb6ec81b69aaee02701fa23e5">FindSccs</a>(graph, &amp;sccs);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; ref_sccs;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a0081c3d0993ad39f10df0eb4857188f5">BuildTestSccs</a>(&amp;ref_sccs);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">AssertGraphEqual</a>(sccs, ref_sccs));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2cf1ba5597d79505ed5fd378338740bb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">kaldi::nnet3::BuildTestGraph</a></div><div class="ttdeci">void BuildTestGraph(std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00047">nnet-graph-test.cc:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae72c79fbb6ec81b69aaee02701fa23e5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae72c79fbb6ec81b69aaee02701fa23e5">kaldi::nnet3::FindSccs</a></div><div class="ttdeci">void FindSccs(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdoc">Given a directed graph (where each std::vector&lt;int32&gt; is a list of destination-nodes of arcs coming f...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00156">nnet-graph.cc:156</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a0081c3d0993ad39f10df0eb4857188f5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a0081c3d0993ad39f10df0eb4857188f5">kaldi::nnet3::BuildTestSccs</a></div><div class="ttdeci">void BuildTestSccs(std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00097">nnet-graph-test.cc:97</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1b9cf952746776c000ad16fcc9a9f990"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">kaldi::nnet3::AssertGraphEqual</a></div><div class="ttdeci">bool AssertGraphEqual(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph1, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph2)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00026">nnet-graph-test.cc:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2e3fd435407cfc4dec9e51a07d3c4f26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestGeneralDescriptor </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00134">134</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="nnet-descriptor_8cc_source.html#l00825">GeneralDescriptor::ConvertToDescriptor()</a>, <a class="el" href="nnet-parse_8cc_source.html#l00355">DescriptorTokenize()</a>, <a class="el" href="nnet-descriptor-test_8cc_source.html#l00075">GenRandDescriptor()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="nnet-descriptor_8cc_source.html#l00474">GeneralDescriptor::Parse()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="nnet-descriptor_8cc_source.html#l00399">Descriptor::WriteConfig()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00223">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                                 {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; 100; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_nodes = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 5;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    std::vector&lt;std::string&gt; node_names(num_nodes);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; node_names.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      std::ostringstream ostr;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      ostr &lt;&lt; <span class="stringliteral">&quot;a&quot;</span> &lt;&lt; (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>+1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      node_names[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = ostr.str();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> desc;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    std::ostringstream ostr;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2465e8e47256304999d4cd892e7162b9">GenRandDescriptor</a>(num_nodes, &amp;desc);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    desc.<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr, node_names);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> desc2(desc), desc3;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    desc3 = desc;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    std::vector&lt;std::string&gt; tokens;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">DescriptorTokenize</a>(ostr.str(), &amp;tokens);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    tokens.push_back(<span class="stringliteral">&quot;end of input&quot;</span>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    std::istringstream istr(ostr.str());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">const</span> std::string *next_token = &amp;(tokens[0]);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html">GeneralDescriptor</a> *gen_desc = GeneralDescriptor::Parse(node_names,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                                           &amp;next_token);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span> (*next_token != <span class="stringliteral">&quot;end of input&quot;</span>)</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Parsing Descriptor, expected end of input but got &quot;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span> &lt;&lt;  *next_token &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html">Descriptor</a> *desc4 = gen_desc-&gt;<a class="code" href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html#a71138fe8137308e15564d18bdc625e4c">ConvertToDescriptor</a>();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    std::ostringstream ostr2;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    desc4-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">WriteConfig</a>(ostr2, node_names);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Original descriptor was: &quot;</span> &lt;&lt; ostr.str();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Parsed descriptor was: &quot;</span> &lt;&lt; ostr2.str();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">if</span> (ostr2.str() != ostr.str())</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Strings differed.  Check manually.&quot;</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keyword">delete</span> gen_desc;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="keyword">delete</span> desc4;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html">kaldi::nnet3::Descriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00429">nnet-descriptor.h:429</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1GeneralDescriptor_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html">kaldi::nnet3::GeneralDescriptor</a></div><div class="ttdoc">This class is only used when parsing Descriptors. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8h_source.html#l00513">nnet-descriptor.h:513</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac6b64008b19bbb6e8769769cbf96fa68"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac6b64008b19bbb6e8769769cbf96fa68">kaldi::nnet3::DescriptorTokenize</a></div><div class="ttdeci">bool DescriptorTokenize(const std::string &amp;input, std::vector&lt; std::string &gt; *tokens)</div><div class="ttdoc">This function tokenizes input when parsing Descriptor configuration values. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00355">nnet-parse.cc:355</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Descriptor_html_a8f09e9fcbf206d294cf53959ef0c832a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Descriptor.html#a8f09e9fcbf206d294cf53959ef0c832a">kaldi::nnet3::Descriptor::WriteConfig</a></div><div class="ttdeci">void WriteConfig(std::ostream &amp;os, const std::vector&lt; std::string &gt; &amp;node_names) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00399">nnet-descriptor.cc:399</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1GeneralDescriptor_html_a71138fe8137308e15564d18bdc625e4c"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1GeneralDescriptor.html#a71138fe8137308e15564d18bdc625e4c">kaldi::nnet3::GeneralDescriptor::ConvertToDescriptor</a></div><div class="ttdeci">Descriptor * ConvertToDescriptor()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor_8cc_source.html#l00825">nnet-descriptor.cc:825</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2465e8e47256304999d4cd892e7162b9"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2465e8e47256304999d4cd892e7162b9">kaldi::nnet3::GenRandDescriptor</a></div><div class="ttdeci">void GenRandDescriptor(int32 num_nodes, Descriptor *desc)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00075">nnet-descriptor-test.cc:75</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9ae443db1f79c1de816ace0cee8706f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestGeneralDescriptorSpecial </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-descriptor-test_8cc_source.html#l00199">199</a> of file <a class="el" href="nnet-descriptor-test_8cc_source.html">nnet-descriptor-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-descriptor-test_8cc_source.html#l00179">NormalizeTextDescriptor()</a>.</p>

<p>Referenced by <a class="el" href="nnet-descriptor-test_8cc_source.html#l00223">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                        {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  std::vector&lt;std::string&gt; names;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  names.push_back(<span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  names.push_back(<span class="stringliteral">&quot;b&quot;</span>);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  names.push_back(<span class="stringliteral">&quot;c&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  names.push_back(<span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;a&quot;</span>) == <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Offset(Offset(a, 3, 5), 2, 1)&quot;</span>) == <span class="stringliteral">&quot;Offset(a, 5, 6)&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Offset(Sum(a, b), 2, 1)&quot;</span>) ==</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;               <span class="stringliteral">&quot;Sum(Offset(a, 2, 1), Offset(b, 2, 1))&quot;</span>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Sum(Append(a, b), Append(c, d))&quot;</span>) ==</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;               <span class="stringliteral">&quot;Append(Sum(a, c), Sum(b, d))&quot;</span>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Append(Append(a, b), Append(c, d))&quot;</span>) ==</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;               <span class="stringliteral">&quot;Append(a, b, c, d)&quot;</span>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Sum(a, b, c, d)&quot;</span>) ==</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;               <span class="stringliteral">&quot;Sum(a, Sum(b, Sum(c, d)))&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Sum(a)&quot;</span>) == <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">NormalizeTextDescriptor</a>(names, <span class="stringliteral">&quot;Offset(a, 0)&quot;</span>) == <span class="stringliteral">&quot;a&quot;</span>);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a59f9bf54d192e760e406499f997327be"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a59f9bf54d192e760e406499f997327be">kaldi::nnet3::NormalizeTextDescriptor</a></div><div class="ttdeci">std::string NormalizeTextDescriptor(const std::vector&lt; std::string &gt; &amp;node_names, const std::string &amp;desc_str)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-descriptor-test_8cc_source.html#l00179">nnet-descriptor-test.cc:179</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a07e09944d36b367d8e7b5978184826c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestHasContiguousProperty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00185">185</a> of file <a class="el" href="nnet-compile-utils-test_8cc_source.html">nnet-compile-utils-test.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00523">HasContiguousProperty()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, and <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00361">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                                     {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; 10; k++) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    std::vector&lt;int32&gt; indexes(size);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 4);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt; reverse_indexes;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">bool</span> ans = <a class="code" href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">HasContiguousProperty</a>(indexes, &amp;reverse_indexes);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (!ans) { <span class="comment">// doesn&#39;t have contiguous propety.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;no.&quot;</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">bool</span> found_example = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">if</span> (indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] != -1) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <span class="keywordtype">bool</span> found_not_same = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;          <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; size; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> (indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] != indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]) found_not_same = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (found_not_same) found_example = <span class="keyword">true</span>;  <span class="comment">// found something like x y x.</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(found_example);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;yes.&quot;</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; reverse_indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = reverse_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;             <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; reverse_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] == <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] = -1;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  <span class="comment">// make sure all indexes covered.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] == -1);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae892457066e9b2ac1632188de1aa06f1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae892457066e9b2ac1632188de1aa06f1">kaldi::nnet3::HasContiguousProperty</a></div><div class="ttdeci">bool HasContiguousProperty(const std::vector&lt; int32 &gt; &amp;indexes, std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; *reverse_indexes)</div><div class="ttdoc">This function returns true if for each integer i != -1, all the indexes j at which indexes[j] == i ar...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00523">nnet-compile-utils.cc:523</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a839780fb74682622f06524a99a653f88"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestIndexIo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common-test_8cc_source.html#l00027">27</a> of file <a class="el" href="nnet-common-test_8cc_source.html">nnet-common-test.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="nnet-common_8cc_source.html#l00135">ReadIndexVector()</a>, and <a class="el" href="nnet-common_8cc_source.html#l00118">WriteIndexVector()</a>.</p>

<p>Referenced by <a class="el" href="nnet-common-test_8cc_source.html#l00064">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                       {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  std::vector&lt;Index&gt; indexes(<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 10));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; indexes.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 || <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0) {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].n = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 2);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].t = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-150, 150);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].x = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 1);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="comment">// this case gets optimized while writing. (if abs(diff-in-t) &lt; 125).</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].n = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].n;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].t = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].t + <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-127, 127);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].x = indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1].x;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    }</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">bool</span> binary = (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a6d9bd2f8bc49b5d2d7dec9b2d354ffc9">WriteIndexVector</a>(os, binary, indexes);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  std::vector&lt;Index&gt; indexes2;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    indexes2 = indexes;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  std::istringstream is(os.str());</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#af2069492e6a46f0c6b003a52cf87e2f7">ReadIndexVector</a>(is, binary, &amp;indexes2);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordflow">if</span> (indexes != indexes2) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a6d9bd2f8bc49b5d2d7dec9b2d354ffc9">WriteIndexVector</a>(std::cerr, <span class="keyword">false</span>, indexes);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;  vs. \n&quot;</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a6d9bd2f8bc49b5d2d7dec9b2d354ffc9">WriteIndexVector</a>(std::cerr, <span class="keyword">false</span>, indexes2);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    std::cerr &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Indexes differ.&quot;</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a6d9bd2f8bc49b5d2d7dec9b2d354ffc9"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a6d9bd2f8bc49b5d2d7dec9b2d354ffc9">kaldi::nnet3::WriteIndexVector</a></div><div class="ttdeci">void WriteIndexVector(std::ostream &amp;os, bool binary, const std::vector&lt; Index &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00118">nnet-common.cc:118</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_af2069492e6a46f0c6b003a52cf87e2f7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#af2069492e6a46f0c6b003a52cf87e2f7">kaldi::nnet3::ReadIndexVector</a></div><div class="ttdeci">void ReadIndexVector(std::istream &amp;is, bool binary, std::vector&lt; Index &gt; *vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00135">nnet-common.cc:135</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af8bfac0b4fadf2d70853d050f21bb2db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestMakeSccGraph </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-graph-test_8cc_source.html#l00172">172</a> of file <a class="el" href="nnet-graph-test_8cc_source.html">nnet-graph-test.cc</a>.</p>

<p>References <a class="el" href="nnet-graph-test_8cc_source.html#l00026">AssertGraphEqual()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00047">BuildTestGraph()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00114">BuildTestSccGraph()</a>, <a class="el" href="nnet-graph-test_8cc_source.html#l00097">BuildTestSccs()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-graph_8cc_source.html#l00164">MakeSccGraph()</a>.</p>

<p>Referenced by <a class="el" href="nnet-graph-test_8cc_source.html#l00202">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                            {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; graph;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">BuildTestGraph</a>(&amp;graph);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; sccs;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a0081c3d0993ad39f10df0eb4857188f5">BuildTestSccs</a>(&amp;sccs);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; scc_graph;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a9efe2804eba8c2da73af3aa4eff4a2fc">MakeSccGraph</a>(graph, sccs, &amp;scc_graph);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; ref_scc_graph;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#aa97309456d46852962866b097697c6b7">BuildTestSccGraph</a>(&amp;ref_scc_graph);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">AssertGraphEqual</a>(scc_graph, ref_scc_graph));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2cf1ba5597d79505ed5fd378338740bb"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2cf1ba5597d79505ed5fd378338740bb">kaldi::nnet3::BuildTestGraph</a></div><div class="ttdeci">void BuildTestGraph(std::vector&lt; std::vector&lt; int32 &gt; &gt; *graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00047">nnet-graph-test.cc:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aa97309456d46852962866b097697c6b7"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aa97309456d46852962866b097697c6b7">kaldi::nnet3::BuildTestSccGraph</a></div><div class="ttdeci">void BuildTestSccGraph(std::vector&lt; std::vector&lt; int32 &gt; &gt; *scc_graph)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00114">nnet-graph-test.cc:114</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a0081c3d0993ad39f10df0eb4857188f5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a0081c3d0993ad39f10df0eb4857188f5">kaldi::nnet3::BuildTestSccs</a></div><div class="ttdeci">void BuildTestSccs(std::vector&lt; std::vector&lt; int32 &gt; &gt; *sccs)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00097">nnet-graph-test.cc:97</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9efe2804eba8c2da73af3aa4eff4a2fc"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9efe2804eba8c2da73af3aa4eff4a2fc">kaldi::nnet3::MakeSccGraph</a></div><div class="ttdeci">void MakeSccGraph(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;sccs, std::vector&lt; std::vector&lt; int32 &gt; &gt; *scc_graph)</div><div class="ttdoc">Given a list of sccs of a graph (e.g. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph_8cc_source.html#l00164">nnet-graph.cc:164</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a1b9cf952746776c000ad16fcc9a9f990"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a1b9cf952746776c000ad16fcc9a9f990">kaldi::nnet3::AssertGraphEqual</a></div><div class="ttdeci">bool AssertGraphEqual(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph1, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;graph2)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-graph-test_8cc_source.html#l00026">nnet-graph-test.cc:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4cc6a3d60ce5fb425830d97903d51aa2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetAnalyze </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-analyze-test_8cc_source.html#l00039">39</a> of file <a class="el" href="nnet-analyze-test_8cc_source.html">nnet-analyze-test.cc</a>.</p>

<p>References <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>, <a class="el" href="nnet-computation_8h_source.html#l00303">NnetComputation::commands</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01135">ComputationAnalysis::DataInvalidatedCommand()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01001">ComputationAnalysis::FirstAccess()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="nnet-computation_8cc_source.html#l00151">NnetComputation::GetSubmatrixStrings()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01233">Analyzer::Init()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01073">ComputationAnalysis::LastAccess()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l01103">ComputationAnalysis::LastWriteAccess()</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, <a class="el" href="nnet-analyze-test_8cc_source.html#l00028">PrintCommand()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, and <a class="el" href="nnet-computation_8h_source.html#l00273">NnetComputation::submatrices</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze-test_8cc_source.html#l00098">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;                           {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 20; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    }</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a> check_config;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// we can do the rewrite check since it&#39;s before optimization.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker(check_config, nnet, computation);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    checker.Check();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1Analyzer.html">Analyzer</a> analyzer;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    analyzer.<a class="code" href="structkaldi_1_1nnet3_1_1Analyzer.html#aab8a145e53802c80302dc498e388a2ad">Init</a>(nnet, computation);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationAnalysis.html">ComputationAnalysis</a> analysis(computation, analyzer);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// The following output is to be eyeballed by a person.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    std::vector&lt;std::string&gt; submatrix_strings;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a76de34eeeea96a8b284b1d65b68a3f47">GetSubmatrixStrings</a>(nnet, &amp;submatrix_strings);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> nc = computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#afeb2e3e7413a0649c8a60e3bcd66981b">commands</a>.size();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 30; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> s = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#acb31bf5441a137f7cbed4aeb74cb8421">submatrices</a>.size() - 1);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, nc - 1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;First access of submatrix &quot;</span> &lt;&lt; submatrix_strings[s]</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is command &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">PrintCommand</a>(nc, analysis.FirstAccess(s));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Last access of submatrix &quot;</span> &lt;&lt; submatrix_strings[s]</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is command &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">PrintCommand</a>(nc, analysis.LastAccess(s));</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Last write access of submatrix &quot;</span> &lt;&lt; submatrix_strings[s]</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; is command &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">PrintCommand</a>(nc, analysis.LastWriteAccess(s));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Data present in &quot;</span> &lt;&lt; submatrix_strings[s]</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; at command &quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot; is invalidated at command &quot;</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">PrintCommand</a>(nc, analysis.DataInvalidatedCommand(c, s));</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationChecker_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationChecker.html">kaldi::nnet3::ComputationChecker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00394">nnet-analyze.h:394</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_afeb2e3e7413a0649c8a60e3bcd66981b"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#afeb2e3e7413a0649c8a60e3bcd66981b">kaldi::nnet3::NnetComputation::commands</a></div><div class="ttdeci">std::vector&lt; Command &gt; commands</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00303">nnet-computation.h:303</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a76de34eeeea96a8b284b1d65b68a3f47"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a76de34eeeea96a8b284b1d65b68a3f47">kaldi::nnet3::NnetComputation::GetSubmatrixStrings</a></div><div class="ttdeci">void GetSubmatrixStrings(const Nnet &amp;nnet, std::vector&lt; std::string &gt; *submat_strings) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00151">nnet-computation.cc:151</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Analyzer_html_aab8a145e53802c80302dc498e388a2ad"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Analyzer.html#aab8a145e53802c80302dc498e388a2ad">kaldi::nnet3::Analyzer::Init</a></div><div class="ttdeci">void Init(const Nnet &amp;nnet, const NnetComputation &amp;computation)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8cc_source.html#l01233">nnet-analyze.cc:1233</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_acb31bf5441a137f7cbed4aeb74cb8421"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#acb31bf5441a137f7cbed4aeb74cb8421">kaldi::nnet3::NnetComputation::submatrices</a></div><div class="ttdeci">std::vector&lt; SubMatrixInfo &gt; submatrices</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00273">nnet-computation.h:273</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html_ab342a2855f4c0a04a1c4f565405e1b93"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">kaldi::nnet3::CheckComputationOptions::check_rewrite</a></div><div class="ttdeci">bool check_rewrite</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00388">nnet-analyze.h:388</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_add0941dcac8fe7e6bfe5d65979c9d388"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#add0941dcac8fe7e6bfe5d65979c9d388">kaldi::nnet3::PrintCommand</a></div><div class="ttdeci">std::string PrintCommand(int32 num_commands, int32 command)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze-test_8cc_source.html#l00028">nnet-analyze-test.cc:28</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a1ec279d69756dd3c71dce72a83ea9020"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">kaldi::nnet3::NnetComputation::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, const Nnet &amp;nnet) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00401">nnet-computation.cc:401</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">kaldi::nnet3::CheckComputationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00385">nnet-analyze.h:385</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1Analyzer_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1Analyzer.html">kaldi::nnet3::Analyzer</a></div><div class="ttdoc">This struct exists to set up various pieces of analysis; it helps avoid the repetition of code where ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00291">nnet-analyze.h:291</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationAnalysis_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationAnalysis.html">kaldi::nnet3::ComputationAnalysis</a></div><div class="ttdoc">This class performs various kinds of specific analysis on top of what class Analyzer gives you immedi...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00305">nnet-analyze.h:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a68c5b8e70a4f632063af6c4a8c397189"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetCompile </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-test_8cc_source.html#l00028">28</a> of file <a class="el" href="nnet-compile-test_8cc_source.html">nnet-compile-test.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8cc_source.html#l00478">ComputationRequest::Print()</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-test_8cc_source.html#l00062">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                           {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 20; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    }</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Computation request is:&quot;</span>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a8aa1a4815e8e109acb9e269385fd5e49">Print</a>(std::cerr);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a8aa1a4815e8e109acb9e269385fd5e49"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a8aa1a4815e8e109acb9e269385fd5e49">kaldi::nnet3::ComputationRequest::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os) const </div><div class="ttdoc">This function is for printing info about the computation request in a human-readable way...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00478">nnet-computation.cc:478</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a1ec279d69756dd3c71dce72a83ea9020"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">kaldi::nnet3::NnetComputation::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, const Nnet &amp;nnet) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00401">nnet-computation.cc:401</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a32b068b357bfea7bf051d6f644e1912d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetComponent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="_2nnet-component-test_8cc_source.html#l00433">433</a> of file <a class="el" href="_2nnet-component-test_8cc_source.html">nnet-component-test.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l01110">GenerateRandomSimpleComponent()</a>, <a class="el" href="nnet-component-itf_8cc_source.html#l00118">Component::Info()</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00084">TestNnetComponentAddScale()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00075">TestNnetComponentCopy()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00061">TestNnetComponentIo()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00126">TestNnetComponentUpdatable()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00094">TestNnetComponentVectorizeUnVectorize()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00284">TestSimpleComponentDataDerivative()</a>, <a class="el" href="_2nnet-component-test_8cc_source.html#l00345">TestSimpleComponentModelDerivative()</a>, and <a class="el" href="_2nnet-component-test_8cc_source.html#l00188">TestSimpleComponentPropagateProperties()</a>.</p>

<p>Referenced by <a class="el" href="_2nnet-component-test_8cc_source.html#l00467">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                             {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 200; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++)  {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Component.html">Component</a> *c = <a class="code" href="namespacekaldi_1_1nnet3.html#a3dccdf514f810b334ee5baa954eb88f8">GenerateRandomSimpleComponent</a>();</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; c-&gt;<a class="code" href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">Info</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#aee5e219c905cd82d682bc00a0de72d74">TestNnetComponentIo</a>(c);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#af7d4b74958e0a63a4e52bef63e71f394">TestNnetComponentCopy</a>(c);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a554b097cfc8c22c7fe43dec7ceca8839">TestNnetComponentAddScale</a>(c);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a179079a64f06a09c80c757753016b094">TestNnetComponentVectorizeUnVectorize</a>(c);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a0b28b95264b6db2e9ce5658f8f939a8b">TestNnetComponentUpdatable</a>(c);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a3d2f85463a6a7b714692a2e84160f137">TestSimpleComponentPropagateProperties</a>(*c);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">TestSimpleComponentDataDerivative</a>(*c, 1.0e-04) &amp;&amp;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">TestSimpleComponentDataDerivative</a>(*c, 1.0e-03) &amp;&amp;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">TestSimpleComponentDataDerivative</a>(*c, 1.0e-05) &amp;&amp;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">TestSimpleComponentDataDerivative</a>(*c, 1.0e-06))</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Component data-derivative test failed&quot;</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-04, <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-03, <span class="keyword">false</span>) &amp;&amp;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-06, <span class="keyword">false</span>))</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Component downhill-update test failed&quot;</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-04, <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-03, <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-05, <span class="keyword">true</span>) &amp;&amp;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        !<a class="code" href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">TestSimpleComponentModelDerivative</a>(*c, 1.0e-06, <span class="keyword">true</span>))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Component model-derivative test failed&quot;</span>;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keyword">delete</span> c;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a3d2f85463a6a7b714692a2e84160f137"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a3d2f85463a6a7b714692a2e84160f137">kaldi::nnet3::TestSimpleComponentPropagateProperties</a></div><div class="ttdeci">void TestSimpleComponentPropagateProperties(const Component &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00188">nnet-component-test.cc:188</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html">kaldi::nnet3::Component</a></div><div class="ttdoc">Abstract base-class for neural-net components. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00103">nnet-component-itf.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a554b097cfc8c22c7fe43dec7ceca8839"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a554b097cfc8c22c7fe43dec7ceca8839">kaldi::nnet3::TestNnetComponentAddScale</a></div><div class="ttdeci">void TestNnetComponentAddScale(Component *c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00084">nnet-component-test.cc:84</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a72a20443febb349c12d3f34ea6d5bdc5"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a72a20443febb349c12d3f34ea6d5bdc5">kaldi::nnet3::TestSimpleComponentModelDerivative</a></div><div class="ttdeci">bool TestSimpleComponentModelDerivative(const Component &amp;c, BaseFloat perturb_delta, bool test_derivative)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00345">nnet-component-test.cc:345</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a179079a64f06a09c80c757753016b094"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a179079a64f06a09c80c757753016b094">kaldi::nnet3::TestNnetComponentVectorizeUnVectorize</a></div><div class="ttdeci">void TestNnetComponentVectorizeUnVectorize(Component *c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00094">nnet-component-test.cc:94</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac1a1dc9b5063b680db3bb5e8ce670a21"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac1a1dc9b5063b680db3bb5e8ce670a21">kaldi::nnet3::TestSimpleComponentDataDerivative</a></div><div class="ttdeci">bool TestSimpleComponentDataDerivative(const Component &amp;c, BaseFloat perturb_delta)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00284">nnet-component-test.cc:284</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_af7d4b74958e0a63a4e52bef63e71f394"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#af7d4b74958e0a63a4e52bef63e71f394">kaldi::nnet3::TestNnetComponentCopy</a></div><div class="ttdeci">void TestNnetComponentCopy(Component *c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00075">nnet-component-test.cc:75</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Component_html_a17f20e0b2d35ec6866a6b479e7d9e867"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Component.html#a17f20e0b2d35ec6866a6b479e7d9e867">kaldi::nnet3::Component::Info</a></div><div class="ttdeci">virtual std::string Info() const </div><div class="ttdoc">Returns some text-form information about this component, for diagnostics. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8cc_source.html#l00118">nnet-component-itf.cc:118</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a0b28b95264b6db2e9ce5658f8f939a8b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a0b28b95264b6db2e9ce5658f8f939a8b">kaldi::nnet3::TestNnetComponentUpdatable</a></div><div class="ttdeci">void TestNnetComponentUpdatable(Component *c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00126">nnet-component-test.cc:126</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_aee5e219c905cd82d682bc00a0de72d74"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#aee5e219c905cd82d682bc00a0de72d74">kaldi::nnet3::TestNnetComponentIo</a></div><div class="ttdeci">void TestNnetComponentIo(Component *c)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-component-test_8cc_source.html#l00061">nnet-component-test.cc:61</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a3dccdf514f810b334ee5baa954eb88f8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a3dccdf514f810b334ee5baa954eb88f8">kaldi::nnet3::GenerateRandomSimpleComponent</a></div><div class="ttdeci">Component * GenerateRandomSimpleComponent()</div><div class="ttdoc">Generates random simple component for testing. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l01110">nnet-test-utils.cc:1110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a72aa26595d9be2bf06aa61db33ed362f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetCompute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00040">40</a> of file <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html">nnet-compute-test.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00385">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00436">NnetComputer::AcceptOutputDeriv()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00369">NnetComputer::Backward()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>, <a class="el" href="nnet-computation_8cc_source.html#l00083">NnetComputation::ComputeCudaIndexes()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>, <a class="el" href="nnet3_2nnet-compute_8h_source.html#l00040">NnetComputeOptions::debug</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00351">NnetComputer::Forward()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00405">NnetComputer::GetInputDeriv()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00415">NnetComputer::GetOutput()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02434">CuMatrixBase&lt; Real &gt;::Sum()</a>, and <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00031">TestNnetDecodable()</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-compute-test_8cc_source.html#l00126">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                           {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 20; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {    </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    }</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a> check_config;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// we can do the rewrite check since it&#39;s before optimization.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">true</span>;  </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker(check_config, nnet, computation);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    checker.Check();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> opt_config;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">Optimize</a>(opt_config, nnet, request, &amp;computation);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        std::ostringstream os;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Optimized computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">NnetComputeOptions</a> compute_opts;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      compute_opts.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">ComputeCudaIndexes</a>();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> computer(compute_opts,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                          computation,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                          nnet,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                          &amp;nnet);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// provide the input to the computation.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input sum is &quot;</span> &lt;&lt; temp.Sum();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      computer.AcceptInput(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name, &amp;temp);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    computer.Forward();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;output(computer.GetOutput(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ade08d6728a35e80cbf187c6da2d28596">TestNnetDecodable</a>(request, inputs, nnet, output);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Output sum is &quot;</span> &lt;&lt; output.Sum();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv(output.NumRows(), output.NumCols());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">SetRandn</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// output_deriv sum won&#39;t be informative so don&#39;t print it.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].has_deriv)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      computer.AcceptOutputDeriv(<span class="stringliteral">&quot;output&quot;</span>, &amp;output_deriv);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    computer.Backward();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordflow">if</span> (request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].has_deriv) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_deriv =</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            computer.GetInputDeriv(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input-deriv sum for input &#39;&quot;</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                  &lt;&lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name &lt;&lt; <span class="stringliteral">&quot;&#39; is &quot;</span> &lt;&lt; in_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_ac2af1facc3bf90819e78ea5b2bb2554d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">kaldi::nnet3::NnetComputation::ComputeCudaIndexes</a></div><div class="ttdeci">void ComputeCudaIndexes()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00083">nnet-computation.cc:83</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html_a398527b3e9e358c345c5047b16871957"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">kaldi::nnet3::NnetComputeOptions::debug</a></div><div class="ttdeci">bool debug</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00040">nnet-compute.h:40</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a40c5a82d6d015bdcc0079b535b1e9a23"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">kaldi::CuMatrixBase::SetRandn</a></div><div class="ttdeci">void SetRandn()</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02531">cu-matrix.cc:2531</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationChecker_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationChecker.html">kaldi::nnet3::ComputationChecker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00394">nnet-analyze.h:394</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a56ccdfeff2303e6dee20771d1a4fad78"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">kaldi::nnet3::ComputationRequest::inputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; inputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00104">nnet-computation.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::CuMatrixBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02434">cu-matrix.cc:2434</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">kaldi::nnet3::NnetComputeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00039">nnet-compute.h:39</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96e8c7c5766b9f5c698ce7195489efba"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">kaldi::nnet3::Optimize</a></div><div class="ttdeci">void Optimize(const NnetOptimizeOptions &amp;config, const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This is the top-level function for optimizing a computation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00326">nnet-optimize.cc:326</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">kaldi::nnet3::NnetOptimizeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00034">nnet-optimize.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html_ab342a2855f4c0a04a1c4f565405e1b93"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">kaldi::nnet3::CheckComputationOptions::check_rewrite</a></div><div class="ttdeci">bool check_rewrite</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00388">nnet-analyze.h:388</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetComputer_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetComputer.html">kaldi::nnet3::NnetComputer</a></div><div class="ttdoc">class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00059">nnet-compute.h:59</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ade08d6728a35e80cbf187c6da2d28596"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ade08d6728a35e80cbf187c6da2d28596">kaldi::nnet3::TestNnetDecodable</a></div><div class="ttdeci">void TestNnetDecodable(const ComputationRequest &amp;request, const std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; &amp;inputs, const Nnet &amp;nnet, const CuMatrixBase&lt; BaseFloat &gt; &amp;reference_output)</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute-test_8cc_source.html#l00031">nnet-compute-test.cc:31</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a1ec279d69756dd3c71dce72a83ea9020"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">kaldi::nnet3::NnetComputation::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, const Nnet &amp;nnet) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00401">nnet-computation.cc:401</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a75f6d03596c9241ae8d5791e6d0d84aa"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">kaldi::nnet3::ComputationRequest::outputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; outputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00105">nnet-computation.h:105</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">kaldi::nnet3::CheckComputationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00385">nnet-analyze.h:385</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a666e24f4c79af6ec57eeaf005b00b5dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetContext </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-utils-test_8cc_source.html#l00027">27</a> of file <a class="el" href="nnet-utils-test_8cc_source.html">nnet-utils-test.cc</a>.</p>

<p>References <a class="el" href="nnet-utils_8cc_source.html#l00129">ComputeSimpleNnetContext()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-utils_8cc_source.html#l00362">NnetInfo()</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>.</p>

<p>Referenced by <a class="el" href="nnet-utils-test_8cc_source.html#l00051">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                           {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 20; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    std::istringstream is(configs[0]);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// this test doesn&#39;t really test anything except that it runs;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// we manually inspect the output.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> left_context, right_context;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">ComputeSimpleNnetContext</a>(nnet, &amp;left_context, &amp;right_context);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Left,right-context= &quot;</span> &lt;&lt; left_context &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;              &lt;&lt; right_context &lt;&lt; <span class="stringliteral">&quot; for config: &quot;</span> &lt;&lt; configs[0];</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Info for nnet is: &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a81eeaabd042c236a1e0276c353a7d450">NnetInfo</a>(nnet);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a88aa85d232ba1ad6e430f6f6dcda29c1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a88aa85d232ba1ad6e430f6f6dcda29c1">kaldi::nnet3::ComputeSimpleNnetContext</a></div><div class="ttdeci">void ComputeSimpleNnetContext(const Nnet &amp;nnet, int32 *left_context, int32 *right_context)</div><div class="ttdoc">ComputeNnetContext computes the left-context and right-context of a nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00129">nnet-utils.cc:129</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a81eeaabd042c236a1e0276c353a7d450"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a81eeaabd042c236a1e0276c353a7d450">kaldi::nnet3::NnetInfo</a></div><div class="ttdeci">std::string NnetInfo(const Nnet &amp;nnet)</div><div class="ttdoc">This function returns various info about the neural net. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00362">nnet-utils.cc:362</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a60b81dcaa89e17f1f362e45f559d734c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetExample </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-example-test_8cc_source.html#l00035">35</a> of file <a class="el" href="nnet-example-test_8cc_source.html">nnet-example-test.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l01207">ExampleApproxEqual()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l01154">GenerateSimpleNnetTrainingExample()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00103">NnetExample::Read()</a>, and <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00090">NnetExample::Write()</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-test_8cc_source.html#l00103">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                           {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 50; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_supervised_frames = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 10),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;                   left_context = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                  right_context = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5),</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                      input_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 10),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;                     output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(5, 10),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                    ivector_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 2);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a8263b0802f12a823d6c072b53c4ee236">GenerateSimpleNnetTrainingExample</a>(num_supervised_frames, left_context,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                                      right_context, input_dim, output_dim,</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                      ivector_dim, &amp;eg);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordtype">bool</span> binary = (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">Write</a>(os, binary);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg_copy;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      eg_copy = eg;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    std::istringstream is(os.str());</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    eg_copy.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#a8e7d2790fc7e94fe9780ccc937de1270">Read</a>(is, binary);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    std::ostringstream os2;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    eg_copy.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">Write</a>(os2, binary);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (binary) {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(os.str() == os2.str());</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(eg_copy == eg);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi_1_1nnet3.html#a7a54fa7479670b5b34951fdacd2c9b1d">ExampleApproxEqual</a>(eg, eg_copy, 0.1));</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  }</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html">kaldi::nnet3::NnetExample</a></div><div class="ttdoc">NnetExample is the input data and corresponding label (or labels) for one or more frames of input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00082">nnet-example.h:82</a></div></div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a8263b0802f12a823d6c072b53c4ee236"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a8263b0802f12a823d6c072b53c4ee236">kaldi::nnet3::GenerateSimpleNnetTrainingExample</a></div><div class="ttdeci">void GenerateSimpleNnetTrainingExample(int32 num_supervised_frames, int32 left_context, int32 right_context, int32 output_dim, int32 input_dim, int32 ivector_dim, NnetExample *example)</div><div class="ttdoc">Low-level function that generates an nnet training example. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l01154">nnet-test-utils.cc:1154</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_ad5da0494b3a3f4bc33ff83c9b5ff5b40"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">kaldi::nnet3::NnetExample::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;os, bool binary) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8cc_source.html#l00090">nnet-example.cc:90</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a7a54fa7479670b5b34951fdacd2c9b1d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a7a54fa7479670b5b34951fdacd2c9b1d">kaldi::nnet3::ExampleApproxEqual</a></div><div class="ttdeci">bool ExampleApproxEqual(const NnetExample &amp;eg1, const NnetExample &amp;eg2, BaseFloat delta)</div><div class="ttdoc">Returns true if the examples are approximately equal (only intended to be used in testing)...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l01207">nnet-test-utils.cc:1207</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_a8e7d2790fc7e94fe9780ccc937de1270"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#a8e7d2790fc7e94fe9780ccc937de1270">kaldi::nnet3::NnetExample::Read</a></div><div class="ttdeci">void Read(std::istream &amp;is, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8cc_source.html#l00103">nnet-example.cc:103</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8666ffad3ea0232ebaa3cff139a32629"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetInputDerivatives </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-derivative-test_8cc_source.html#l00258">258</a> of file <a class="el" href="nnet-derivative-test_8cc_source.html">nnet-derivative-test.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00385">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00436">NnetComputer::AcceptOutputDeriv()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00881">CuMatrixBase&lt; Real &gt;::AddMat()</a>, <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00369">NnetComputer::Backward()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="nnet3_2nnet-compute_8h_source.html#l00040">NnetComputeOptions::debug</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00351">NnetComputer::Forward()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00405">NnetComputer::GetInputDeriv()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00415">NnetComputer::GetOutput()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8h_source.html#l00110">ComputationRequest::need_model_derivative</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00643">Nnet::OutputDim()</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00048">CuMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00162">SetZero()</a>, and <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>.</p>

<p>Referenced by <a class="el" href="nnet-derivative-test_8cc_source.html#l00425">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_tries = 20, num_success = 0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; num_tries; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">//gen_config.allow_nonlinearity = false;</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">//gen_config.allow_recursion = false;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">//gen_config.allow_final_nonlinearity = true;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">bool</span> allow_optimization = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// make sure that all inputs and outputs have derivatives requested/provided,</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="comment">// and that the model-update (need_model_derivative) is not requested.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a58c542fffb7e7f754148c264c90b4a5e">need_model_derivative</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      computation.Print(os, nnet);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a> check_config;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// we can do the rewrite check since it&#39;s before optimization.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker(check_config, nnet, computation);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    checker.Check();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 3) != 0 &amp;&amp; allow_optimization) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> opt_config;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// opt_config.initialize_undefined = false;  // temp</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">Optimize</a>(opt_config, nnet, request, &amp;computation);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      computation.Print(os, nnet);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Optimized computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">NnetComputeOptions</a> compute_opts;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      compute_opts.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    computation.ComputeCudaIndexes();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// the only reason we might need to provide the &amp;nnet parameter is if the</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// StoreStats() operation had been requested.  We made sure no model update</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// is being performed.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> computer(compute_opts,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                          computation,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                          nnet,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                          &amp;nnet);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_directions = 3;  <span class="comment">// must be &gt;= 1.  Best if it&#39;s &gt;1, will reduce</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                               <span class="comment">// the probability of random failures.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// the order of these vectors is:</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// [ un-perturbed, perturbed-1, perturbed-2, perturbed-3, un-perturbed ].</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// we compute un-perturbed twice to double-check the model did not change.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    std::vector&lt;BaseFloat&gt; measured_objf(num_directions + 2, 0.0),</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        predicted_objf_change(num_directions + 2, 0.0);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> delta = 1.0e-03;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// output_deriv is the derivative of the objective function w.r.t. the</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// (single) output.  We make the objf a linear function of the output and</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// just set the output_deriv to be a random matrix, which defines the</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// objective function.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrix.html#a39a370ea7e90c08257788d32cd67be66">Resize</a>(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].indexes.size(),</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a0c49e4af58d3276eec74ee8342d58f33">OutputDim</a>(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">SetRandn</a>();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    std::vector&lt;CuMatrix&lt;BaseFloat&gt; &gt; delta_inputs(inputs.size());</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    std::vector&lt;CuMatrix&lt;BaseFloat&gt; &gt; input_derivs(inputs.size());</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// pass 0 is the forward pass with the un-perturbed features; so is</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// pass num_directions + 1.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// Other passes are with various differently-perturbed versions of</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">// the features.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pass = 0; pass &lt;= num_directions + 1; pass++) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="comment">// provide the input to the computations.</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">if</span> (pass &gt; 0 &amp;&amp; pass &lt;= num_directions) {  <span class="comment">// Perturb the input randomly.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;          delta_inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Resize(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].NumRows(), inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].NumCols());</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;          delta_inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].SetRandn();</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;          delta_inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Scale(delta);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          <span class="comment">// if there are &gt;1 inputs, sometimes set the delta for input 0 to</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <span class="comment">// zero.  might sometimes give more accurate test of error in iVector</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;          <span class="comment">// derivative computation.</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0 &amp;&amp; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size() &gt; 1 &amp;&amp; <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            delta_inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a>();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          temp.AddMat(1.0, delta_inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          predicted_objf_change[pass] += <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(input_derivs[i],</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                                     delta_inputs[i], <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        }</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        computer.AcceptInput(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name, &amp;temp);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running forward computation&quot;</span>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      computer.Forward();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;output(computer.GetOutput(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Output sum for pass &quot;</span> &lt;&lt; pass &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; output.Sum();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output, output_deriv, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      measured_objf[pass] = objf;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keywordflow">if</span> (pass == 0) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="comment">// We need to compute the input derivatives.</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(output_deriv);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        computer.AcceptOutputDeriv(<span class="stringliteral">&quot;output&quot;</span>, &amp;temp);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running backward computation&quot;</span>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        computer.Backward();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          input_derivs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = computer.GetInputDeriv(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input-deriv norm for &#39;&quot;</span> &lt;&lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    &lt;&lt; <span class="stringliteral">&quot;&#39; is &quot;</span> &lt;&lt; input_derivs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].FrobeniusNorm();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(measured_objf[0],</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                             measured_objf[num_directions + 1]));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> predicted_objf_change_vec(num_directions),</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        measured_objf_change_vec(num_directions);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> &lt; num_directions; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>++) {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> predicted_change = predicted_objf_change[<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>+1],</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                 measured_change = measured_objf[<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>+1] - measured_objf[0];</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      predicted_objf_change_vec(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) = predicted_change;</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      measured_objf_change_vec(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) = measured_change;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Vector of predicted objf-change is: &quot;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;              &lt;&lt; predicted_objf_change_vec;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Vector of measured objf-change is: &quot;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;              &lt;&lt; measured_objf_change_vec;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> delta_thresh = 0.1;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(predicted_objf_change_vec,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                     measured_objf_change_vec, delta_thresh)) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Predicted and measured objf-changes differ too much.&quot;</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      num_success++;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    }</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input-derivative check succeeded for &quot;</span> &lt;&lt; num_success &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            &lt;&lt; num_tries &lt;&lt; <span class="stringliteral">&quot; tries.&quot;</span>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keywordflow">if</span> (num_success &lt; num_tries - (2 + num_tries / 5))</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Failed too many times.&quot;</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a58c542fffb7e7f754148c264c90b4a5e"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a58c542fffb7e7f754148c264c90b4a5e">kaldi::nnet3::ComputationRequest::need_model_derivative</a></div><div class="ttdeci">bool need_model_derivative</div><div class="ttdoc">if need_model_derivative is true, then we&#39;ll be doing either model training or model-derivative compu...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00110">nnet-computation.h:110</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html_a398527b3e9e358c345c5047b16871957"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">kaldi::nnet3::NnetComputeOptions::debug</a></div><div class="ttdeci">bool debug</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00040">nnet-compute.h:40</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a40c5a82d6d015bdcc0079b535b1e9a23"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">kaldi::CuMatrixBase::SetRandn</a></div><div class="ttdeci">void SetRandn()</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02531">cu-matrix.cc:2531</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationChecker_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationChecker.html">kaldi::nnet3::ComputationChecker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00394">nnet-analyze.h:394</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a56ccdfeff2303e6dee20771d1a4fad78"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">kaldi::nnet3::ComputationRequest::inputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; inputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00104">nnet-computation.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">kaldi::nnet3::NnetComputeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00039">nnet-compute.h:39</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96e8c7c5766b9f5c698ce7195489efba"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">kaldi::nnet3::Optimize</a></div><div class="ttdeci">void Optimize(const NnetOptimizeOptions &amp;config, const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This is the top-level function for optimizing a computation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00326">nnet-optimize.cc:326</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">kaldi::nnet3::NnetOptimizeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00034">nnet-optimize.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a0c49e4af58d3276eec74ee8342d58f33"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a0c49e4af58d3276eec74ee8342d58f33">kaldi::nnet3::Nnet::OutputDim</a></div><div class="ttdeci">int32 OutputDim(const std::string &amp;output_name) const </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00643">nnet-nnet.cc:643</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html_ab342a2855f4c0a04a1c4f565405e1b93"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">kaldi::nnet3::CheckComputationOptions::check_rewrite</a></div><div class="ttdeci">bool check_rewrite</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00388">nnet-analyze.h:388</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9f63e4d60600b08466b42e409dd6253d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">kaldi::nnet3::SetZero</a></div><div class="ttdeci">void SetZero(bool is_gradient, Nnet *nnet)</div><div class="ttdoc">Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00162">nnet-utils.cc:162</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetComputer_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetComputer.html">kaldi::nnet3::NnetComputer</a></div><div class="ttdoc">class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00059">nnet-compute.h:59</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a75f6d03596c9241ae8d5791e6d0d84aa"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">kaldi::nnet3::ComputationRequest::outputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; outputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00105">nnet-computation.h:105</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html_a39a370ea7e90c08257788d32cd67be66"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html#a39a370ea7e90c08257788d32cd67be66">kaldi::CuMatrix::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT rows, MatrixIndexT cols, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Allocate the memory. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00048">cu-matrix.cc:48</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">kaldi::nnet3::CheckComputationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00385">nnet-analyze.h:385</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b4b0e8d73b17875e8bc5cc492e79b71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetIo </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet3_2nnet-nnet-test_8cc_source.html#l00027">27</a> of file <a class="el" href="nnet3_2nnet-nnet-test_8cc_source.html">nnet-nnet-test.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00565">Nnet::Read()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, and <a class="el" href="_2nnet-nnet_8cc_source.html#l00596">Nnet::Write()</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-nnet-test_8cc_source.html#l00061">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                      {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 100; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">bool</span> binary = (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    std::istringstream is(configs[0]);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    std::ostringstream os;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a48d602540846ab9e77b4a9a6611e58a2">Write</a>(os, binary);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">const</span> std::string &amp;original_output = os.str();</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    std::istringstream nnet_is(original_output);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ab1b9ede63de755642e79f7287a62b92c">Read</a>(nnet_is, binary);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    std::istringstream nnet_is2(original_output);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet2;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    nnet2.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#ab1b9ede63de755642e79f7287a62b92c">Read</a>(nnet_is2, binary);</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    std::ostringstream os2, os3;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a48d602540846ab9e77b4a9a6611e58a2">Write</a>(os2, binary);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    nnet2.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a48d602540846ab9e77b4a9a6611e58a2">Write</a>(os3, binary);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (binary) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(os2.str() == original_output);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(os3.str() == original_output);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_ab1b9ede63de755642e79f7287a62b92c"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#ab1b9ede63de755642e79f7287a62b92c">kaldi::nnet3::Nnet::Read</a></div><div class="ttdeci">void Read(std::istream &amp;istream, bool binary)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00565">nnet-nnet.cc:565</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a48d602540846ab9e77b4a9a6611e58a2"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a48d602540846ab9e77b4a9a6611e58a2">kaldi::nnet3::Nnet::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;ostream, bool binary) const </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00596">nnet-nnet.cc:596</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc5c658def484ea9be939487a4b60465"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetMergeExamples </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-example-test_8cc_source.html#l00067">67</a> of file <a class="el" href="nnet-example-test_8cc_source.html">nnet-example-test.cc</a>.</p>

<p>References <a class="el" href="nnet-test-utils_8cc_source.html#l01154">GenerateSimpleNnetTrainingExample()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-example-utils_8cc_source.html#l00147">MergeExamples()</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, and <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00090">NnetExample::Write()</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-test_8cc_source.html#l00103">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                 {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 50; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_supervised_frames = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 10),</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                   left_context = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5),</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                  right_context = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 5),</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                      input_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 10),</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                     output_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(5, 10),</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                    ivector_dim = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(-1, 2);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_egs = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 4);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    std::vector&lt;NnetExample&gt; egs_to_be_merged(num_egs);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_egs; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="comment">// sometimes omit the ivector.  just tests things a bit more</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="comment">// thoroughly.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a8263b0802f12a823d6c072b53c4ee236">GenerateSimpleNnetTrainingExample</a>(num_supervised_frames, left_context,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                                        right_context, input_dim, output_dim,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                                        <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0 ? 0 : ivector_dim,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                                        &amp;eg);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt;&lt; <span class="stringliteral">&quot;&#39;th example to be merged is: &quot;</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      eg.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">Write</a>(std::cerr, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      egs_to_be_merged[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Swap(&amp;eg);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html">NnetExample</a> eg_merged;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">bool</span> compress = (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a4ceebc46ef1be292f6b2ff71cc1128ee">MergeExamples</a>(egs_to_be_merged, compress, &amp;eg_merged);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Merged example is: &quot;</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    eg_merged.<a class="code" href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">Write</a>(std::cerr, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;}</div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html">kaldi::nnet3::NnetExample</a></div><div class="ttdoc">NnetExample is the input data and corresponding label (or labels) for one or more frames of input...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8h_source.html#l00082">nnet-example.h:82</a></div></div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a8263b0802f12a823d6c072b53c4ee236"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a8263b0802f12a823d6c072b53c4ee236">kaldi::nnet3::GenerateSimpleNnetTrainingExample</a></div><div class="ttdeci">void GenerateSimpleNnetTrainingExample(int32 num_supervised_frames, int32 left_context, int32 right_context, int32 output_dim, int32 input_dim, int32 ivector_dim, NnetExample *example)</div><div class="ttdoc">Low-level function that generates an nnet training example. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l01154">nnet-test-utils.cc:1154</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetExample_html_ad5da0494b3a3f4bc33ff83c9b5ff5b40"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetExample.html#ad5da0494b3a3f4bc33ff83c9b5ff5b40">kaldi::nnet3::NnetExample::Write</a></div><div class="ttdeci">void Write(std::ostream &amp;os, bool binary) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-example_8cc_source.html#l00090">nnet-example.cc:90</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a4ceebc46ef1be292f6b2ff71cc1128ee"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a4ceebc46ef1be292f6b2ff71cc1128ee">kaldi::nnet3::MergeExamples</a></div><div class="ttdeci">void MergeExamples(const std::vector&lt; NnetExample &gt; &amp;src, bool compress, NnetExample *merged_eg)</div><div class="ttdoc">Merge a set of input examples into a single example (typically the size of &quot;src&quot; will be the minibatc...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-example-utils_8cc_source.html#l00147">nnet-example-utils.cc:147</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a557038a07d45e34088f4943c2a668b2b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestNnetModelDerivatives </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-derivative-test_8cc_source.html#l00091">91</a> of file <a class="el" href="nnet-derivative-test_8cc_source.html">nnet-derivative-test.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00385">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00436">NnetComputer::AcceptOutputDeriv()</a>, <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00369">NnetComputer::Backward()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>, <a class="el" href="nnet-computation_8cc_source.html#l00083">NnetComputation::ComputeCudaIndexes()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="nnet3_2nnet-compute_8h_source.html#l00040">NnetComputeOptions::debug</a>, <a class="el" href="nnet-utils_8cc_source.html#l00225">DotProduct()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00351">NnetComputer::Forward()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00415">NnetComputer::GetOutput()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-computation_8h_source.html#l00110">ComputationRequest::need_model_derivative</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00643">Nnet::OutputDim()</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, <a class="el" href="nnet-utils_8cc_source.html#l00174">PerturbParams()</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, <a class="el" href="cu-matrix_8cc_source.html#l00048">CuMatrix&lt; Real &gt;::Resize()</a>, <a class="el" href="nnet-derivative-test_8cc_source.html#l00046">SetDerivTimesOptions()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00162">SetZero()</a>, and <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>.</p>

<p>Referenced by <a class="el" href="nnet-derivative-test_8cc_source.html#l00425">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_tries = 20, num_success = 0, num_fail = 0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; num_tries; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">//gen_config.allow_nonlinearity = false;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">//gen_config.allow_recursion = false;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">//gen_config.allow_final_nonlinearity = true;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">bool</span> allow_optimization = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">bool</span> limit_deriv_times = (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 2) == 0);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// make sure that a model-derivative is requested, and an output-derivative</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// is supplied.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a58c542fffb7e7f754148c264c90b4a5e">need_model_derivative</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].has_deriv = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// whether input-derivatives are required or not does not matter,</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// so leave it as it is in that regard.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a> check_config;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// we can do the rewrite check since it&#39;s before optimization.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker(check_config, nnet, computation);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    checker.Check();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 3) != 0 &amp;&amp; allow_optimization) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> opt_config;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <span class="keywordflow">if</span> (limit_deriv_times)</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#abfc29da249703fa1e9c54cf85f6f0ef1">SetDerivTimesOptions</a>(request, &amp;opt_config);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">Optimize</a>(opt_config, nnet, request, &amp;computation);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Optimized computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker_opt(check_config, nnet, computation);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      checker_opt.Check();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">NnetComputeOptions</a> compute_opts;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      compute_opts.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">ComputeCudaIndexes</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet_deriv(nnet);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">bool</span> is_gradient = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a>(is_gradient, &amp;nnet_deriv);  <span class="comment">// forces &quot;simple&quot; update and unit</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                        <span class="comment">// learning rate.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_directions = 4;  <span class="comment">// must be &gt;= 1.  Best if it&#39;s &gt;1, will reduce</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                               <span class="comment">// the probability of random failures.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// the order of these vectors is:</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// [ un-perturbed, perturbed-1, perturbed-2, perturbed-3 ].</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    std::vector&lt;BaseFloat&gt; measured_objf(num_directions + 1, 0.0),</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        predicted_objf_change(num_directions + 1, 0.0);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> delta = 5.0e-04;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// output_deriv is the derivative of the objective function w.r.t. the</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// (single) output.  We make the objf a linear function of the output and</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// just set the output_deriv to be a random matrix, which defines the</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// objective function.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrix.html#a39a370ea7e90c08257788d32cd67be66">Resize</a>(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].indexes.size(),</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                        nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a0c49e4af58d3276eec74ee8342d58f33">OutputDim</a>(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">SetRandn</a>();</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// pass 0 is the forward pass with the un-perturbed model.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// Other passes are with various differently-perturbed versions of</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// the model.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> pass = 0; pass &lt;= num_directions; pass++) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet_copy(nnet);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (pass &gt; 0)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="namespacekaldi_1_1nnet3.html#a2ca498bb15fc664236fdd7316a1b8831">PerturbParams</a>(delta, &amp;nnet_copy);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> computer(compute_opts,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            computation,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            nnet_copy,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            (pass == 0 ? &amp;nnet_deriv : &amp;nnet_copy));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      <span class="comment">// provide the input to the computation.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        computer.AcceptInput(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name, &amp;temp);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running forward computation&quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      computer.Forward();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;output(computer.GetOutput(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Output sum for pass &quot;</span> &lt;&lt; pass &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; output.Sum();</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(output, output_deriv, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      measured_objf[pass] = objf;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">if</span> (pass == 0) {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// we need to do the backward computation (to get the model derivative)</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(output_deriv);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        computer.AcceptOutputDeriv(<span class="stringliteral">&quot;output&quot;</span>, &amp;temp);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running backward computation&quot;</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        computer.Backward();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="comment">// work out the predicted objf-change as dot-product of deriv and</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// parameter-change.  The expression below can be interpreted as</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="comment">// DotProduct(nnet_copy - nnet, nnet_deriv).</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        predicted_objf_change[pass] = <a class="code" href="namespacekaldi_1_1nnet3.html#a4dc8f245e845514d33d24ecf1a054406">DotProduct</a>(nnet_copy, nnet_deriv) -</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                      <a class="code" href="namespacekaldi_1_1nnet3.html#a4dc8f245e845514d33d24ecf1a054406">DotProduct</a>(nnet, nnet_deriv);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> predicted_objf_change_vec(num_directions),</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        measured_objf_change_vec(num_directions);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> &lt; num_directions; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>++) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> predicted_change = predicted_objf_change[<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>+1],</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                 measured_change = measured_objf[<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>+1] - measured_objf[0];</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      predicted_objf_change_vec(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) = predicted_change;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      measured_objf_change_vec(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) = measured_change;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Vector of predicted objf-change is: &quot;</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;              &lt;&lt; predicted_objf_change_vec;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Vector of measured objf-change is: &quot;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              &lt;&lt; measured_objf_change_vec;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> delta_thresh = 0.05;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (limit_deriv_times) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Not checking that predicted/measured changes matched &quot;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;because we limited times of derivatives.&quot;</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(predicted_objf_change_vec,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                       measured_objf_change_vec, delta_thresh)) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Predicted and measured objf-changes differ too much.&quot;</span>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        num_fail++;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        num_success++;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Model-derivative check succeeded for &quot;</span> &lt;&lt; num_success &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            &lt;&lt; (num_fail + num_success) &lt;&lt; <span class="stringliteral">&quot; tries.&quot;</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_checked = num_fail + num_success;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (num_success &lt; num_checked - (2 + num_checked / 5))</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Failed too many times.&quot;</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a58c542fffb7e7f754148c264c90b4a5e"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a58c542fffb7e7f754148c264c90b4a5e">kaldi::nnet3::ComputationRequest::need_model_derivative</a></div><div class="ttdeci">bool need_model_derivative</div><div class="ttdoc">if need_model_derivative is true, then we&#39;ll be doing either model training or model-derivative compu...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00110">nnet-computation.h:110</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_ac2af1facc3bf90819e78ea5b2bb2554d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">kaldi::nnet3::NnetComputation::ComputeCudaIndexes</a></div><div class="ttdeci">void ComputeCudaIndexes()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00083">nnet-computation.cc:83</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html_a398527b3e9e358c345c5047b16871957"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">kaldi::nnet3::NnetComputeOptions::debug</a></div><div class="ttdeci">bool debug</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00040">nnet-compute.h:40</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a40c5a82d6d015bdcc0079b535b1e9a23"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">kaldi::CuMatrixBase::SetRandn</a></div><div class="ttdeci">void SetRandn()</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02531">cu-matrix.cc:2531</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationChecker_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationChecker.html">kaldi::nnet3::ComputationChecker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00394">nnet-analyze.h:394</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a56ccdfeff2303e6dee20771d1a4fad78"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">kaldi::nnet3::ComputationRequest::inputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; inputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00104">nnet-computation.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_abfc29da249703fa1e9c54cf85f6f0ef1"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#abfc29da249703fa1e9c54cf85f6f0ef1">kaldi::nnet3::SetDerivTimesOptions</a></div><div class="ttdeci">void SetDerivTimesOptions(const ComputationRequest &amp;request, NnetOptimizeOptions *opt_config)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-derivative-test_8cc_source.html#l00046">nnet-derivative-test.cc:46</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">kaldi::nnet3::NnetComputeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00039">nnet-compute.h:39</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96e8c7c5766b9f5c698ce7195489efba"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">kaldi::nnet3::Optimize</a></div><div class="ttdeci">void Optimize(const NnetOptimizeOptions &amp;config, const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This is the top-level function for optimizing a computation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00326">nnet-optimize.cc:326</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">kaldi::nnet3::NnetOptimizeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00034">nnet-optimize.h:34</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a4dc8f245e845514d33d24ecf1a054406"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a4dc8f245e845514d33d24ecf1a054406">kaldi::nnet3::DotProduct</a></div><div class="ttdeci">BaseFloat DotProduct(const Nnet &amp;nnet1, const Nnet &amp;nnet2)</div><div class="ttdoc">Returns dot product between two networks of the same structure (calls the DotProduct functions of the...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00225">nnet-utils.cc:225</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a0c49e4af58d3276eec74ee8342d58f33"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a0c49e4af58d3276eec74ee8342d58f33">kaldi::nnet3::Nnet::OutputDim</a></div><div class="ttdeci">int32 OutputDim(const std::string &amp;output_name) const </div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00643">nnet-nnet.cc:643</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html_ab342a2855f4c0a04a1c4f565405e1b93"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">kaldi::nnet3::CheckComputationOptions::check_rewrite</a></div><div class="ttdeci">bool check_rewrite</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00388">nnet-analyze.h:388</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9f63e4d60600b08466b42e409dd6253d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">kaldi::nnet3::SetZero</a></div><div class="ttdeci">void SetZero(bool is_gradient, Nnet *nnet)</div><div class="ttdoc">Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00162">nnet-utils.cc:162</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetComputer_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetComputer.html">kaldi::nnet3::NnetComputer</a></div><div class="ttdoc">class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00059">nnet-compute.h:59</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a1ec279d69756dd3c71dce72a83ea9020"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">kaldi::nnet3::NnetComputation::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, const Nnet &amp;nnet) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00401">nnet-computation.cc:401</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a75f6d03596c9241ae8d5791e6d0d84aa"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">kaldi::nnet3::ComputationRequest::outputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; outputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00105">nnet-computation.h:105</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html_a39a370ea7e90c08257788d32cd67be66"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html#a39a370ea7e90c08257788d32cd67be66">kaldi::CuMatrix::Resize</a></div><div class="ttdeci">void Resize(MatrixIndexT rows, MatrixIndexT cols, MatrixResizeType resize_type=kSetZero)</div><div class="ttdoc">Allocate the memory. </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l00048">cu-matrix.cc:48</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2ca498bb15fc664236fdd7316a1b8831"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2ca498bb15fc664236fdd7316a1b8831">kaldi::nnet3::PerturbParams</a></div><div class="ttdeci">void PerturbParams(BaseFloat stddev, Nnet *nnet)</div><div class="ttdoc">Calls PerturbParams (with the given stddev) on all updatable components of the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00174">nnet-utils.cc:174</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">kaldi::nnet3::CheckComputationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00385">nnet-analyze.h:385</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0d3983f63fe3e84e488bc3e27a67e540"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::UnitTestNnetOptimize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-optimize-test_8cc_source.html#l00178">178</a> of file <a class="el" href="nnet-optimize-test_8cc_source.html">nnet-optimize-test.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize_8h_source.html#l00038">NnetOptimizeOptions::backprop_in_place</a>, <a class="el" href="nnet-optimize_8h_source.html#l00043">NnetOptimizeOptions::initialize_undefined</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>, <a class="el" href="nnet-optimize_8h_source.html#l00047">NnetOptimizeOptions::max_deriv_time</a>, <a class="el" href="nnet-optimize_8h_source.html#l00046">NnetOptimizeOptions::min_deriv_time</a>, <a class="el" href="nnet-optimize_8h_source.html#l00044">NnetOptimizeOptions::move_sizing_commands</a>, <a class="el" href="nnet-optimize_8h_source.html#l00037">NnetOptimizeOptions::propagate_in_place</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="nnet-optimize_8h_source.html#l00040">NnetOptimizeOptions::remove_assignments</a>, and <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">UnitTestNnetOptimizeWithOptions()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-test_8cc_source.html#l00229">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                   {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> optimize_all;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// randomly sometimes set min_deriv and max_deriv to small/large values,</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="comment">// which will cause some of the LimitDerivativeTimes() code to be called</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="comment">// (without really changing anything).</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 3) == 0) optimize_all.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3d087b2a181462f940490eeba587d5ed">min_deriv_time</a> = -200;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 3) == 0) optimize_all.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3eb30cd32859e75b85a514ee9747f9ef">max_deriv_time</a> = 1000;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="comment">// this is useful for debugging as it removes nans:</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">// optimize_all.initialize_undefined = false;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">bool</span> success = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize_all);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keywordflow">if</span> (success)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// Test failed with full optimization. Slowly retry with various</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// optimizations switched off.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a> optimize = optimize_all;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  optimize.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a8de177378a5c3ef537b9d5927012427d">propagate_in_place</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordtype">bool</span> succ_no_propagate_in_place = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  optimize = optimize_all;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  optimize.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a751610db82b663a3b2b415a839b0cad4">backprop_in_place</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keywordtype">bool</span> succ_no_backprop_in_place = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  optimize = optimize_all;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  optimize.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a5a9cf0a0e6fa879ef136d18e4b3a7493">remove_assignments</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="keywordtype">bool</span> succ_no_remove_assignments = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  optimize = optimize_all;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  optimize.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#afc411b18b95a954ce30c56a8c802571c">initialize_undefined</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordtype">bool</span> succ_no_initialize_undefined = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  optimize = optimize_all;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  optimize.<a class="code" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#addc98e404df5dfefac47028896957554">move_sizing_commands</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">bool</span> succ_no_move_sizing_commands = <a class="code" href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">UnitTestNnetOptimizeWithOptions</a>(optimize);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#define KALDI_SUCCFAIL(b) ((b) ? &quot;SUCCESS&quot; : &quot;FAILURE&quot;)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor"></span>  <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;Test failed with all optimizations enabled. Retried test with the &quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;following optimizations turned off:&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n  propagate_in_place   ... &quot;</span> &lt;&lt; <a class="code" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>(succ_no_propagate_in_place)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n  backprop_in_place    ... &quot;</span> &lt;&lt; <a class="code" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>(succ_no_backprop_in_place)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n  remove_assignments   ... &quot;</span> &lt;&lt; <a class="code" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>(succ_no_remove_assignments)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n  initialize_undefined ... &quot;</span> &lt;&lt; <a class="code" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>(succ_no_initialize_undefined)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    &lt;&lt; <span class="stringliteral">&quot;\n  move_sizing_commands ... &quot;</span> &lt;&lt; <a class="code" href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a>(succ_no_move_sizing_commands);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#undef KALDI_SUCCFAIL</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="nnet-optimize-test_8cc_html_a0a30890603ea368e7ab3c691dcf04169"><div class="ttname"><a href="nnet-optimize-test_8cc.html#a0a30890603ea368e7ab3c691dcf04169">KALDI_SUCCFAIL</a></div><div class="ttdeci">#define KALDI_SUCCFAIL(b)</div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_addc98e404df5dfefac47028896957554"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#addc98e404df5dfefac47028896957554">kaldi::nnet3::NnetOptimizeOptions::move_sizing_commands</a></div><div class="ttdeci">bool move_sizing_commands</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00044">nnet-optimize.h:44</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a5a9cf0a0e6fa879ef136d18e4b3a7493"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a5a9cf0a0e6fa879ef136d18e4b3a7493">kaldi::nnet3::NnetOptimizeOptions::remove_assignments</a></div><div class="ttdeci">bool remove_assignments</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00040">nnet-optimize.h:40</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a03a8d81b9d815de3d77efb9b0cfff36d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a03a8d81b9d815de3d77efb9b0cfff36d">kaldi::nnet3::UnitTestNnetOptimizeWithOptions</a></div><div class="ttdeci">static bool UnitTestNnetOptimizeWithOptions(NnetOptimizeOptions opt_config)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize-test_8cc_source.html#l00032">nnet-optimize-test.cc:32</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a3d087b2a181462f940490eeba587d5ed"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3d087b2a181462f940490eeba587d5ed">kaldi::nnet3::NnetOptimizeOptions::min_deriv_time</a></div><div class="ttdeci">int32 min_deriv_time</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00046">nnet-optimize.h:46</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a8de177378a5c3ef537b9d5927012427d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a8de177378a5c3ef537b9d5927012427d">kaldi::nnet3::NnetOptimizeOptions::propagate_in_place</a></div><div class="ttdeci">bool propagate_in_place</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00037">nnet-optimize.h:37</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">kaldi::nnet3::NnetOptimizeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00034">nnet-optimize.h:34</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a751610db82b663a3b2b415a839b0cad4"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a751610db82b663a3b2b415a839b0cad4">kaldi::nnet3::NnetOptimizeOptions::backprop_in_place</a></div><div class="ttdeci">bool backprop_in_place</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00038">nnet-optimize.h:38</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_a3eb30cd32859e75b85a514ee9747f9ef"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#a3eb30cd32859e75b85a514ee9747f9ef">kaldi::nnet3::NnetOptimizeOptions::max_deriv_time</a></div><div class="ttdeci">int32 max_deriv_time</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00047">nnet-optimize.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetOptimizeOptions_html_afc411b18b95a954ce30c56a8c802571c"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html#afc411b18b95a954ce30c56a8c802571c">kaldi::nnet3::NnetOptimizeOptions::initialize_undefined</a></div><div class="ttdeci">bool initialize_undefined</div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8h_source.html#l00043">nnet-optimize.h:43</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a03a8d81b9d815de3d77efb9b0cfff36d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool kaldi::nnet3::UnitTestNnetOptimizeWithOptions </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkaldi_1_1nnet3_1_1NnetOptimizeOptions.html">NnetOptimizeOptions</a>&#160;</td>
          <td class="paramname"><em>opt_config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-optimize-test_8cc_source.html#l00032">32</a> of file <a class="el" href="nnet-optimize-test_8cc_source.html">nnet-optimize-test.cc</a>.</p>

<p>References <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00385">NnetComputer::AcceptInput()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00436">NnetComputer::AcceptOutputDeriv()</a>, <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00369">NnetComputer::Backward()</a>, <a class="el" href="nnet-analyze_8cc_source.html#l00554">ComputationChecker::Check()</a>, <a class="el" href="nnet-analyze_8h_source.html#l00388">CheckComputationOptions::check_rewrite</a>, <a class="el" href="nnet-computation_8cc_source.html#l00083">NnetComputation::ComputeCudaIndexes()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00778">ComputeExampleComputationRequestSimple()</a>, <a class="el" href="nnet-compile_8cc_source.html#l00033">Compiler::CreateComputation()</a>, <a class="el" href="nnet3_2nnet-compute_8h_source.html#l00040">NnetComputeOptions::debug</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00351">NnetComputer::Forward()</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l00717">GenerateConfigSequence()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00405">NnetComputer::GetInputDeriv()</a>, <a class="el" href="nnet3_2nnet-compute_8cc_source.html#l00415">NnetComputer::GetOutput()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="nnet-computation_8h_source.html#l00104">ComputationRequest::inputs</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a>, <a class="el" href="nnet-test-utils_8cc_source.html#l01124">NnetParametersAreIdentical()</a>, <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>, <a class="el" href="nnet-computation_8h_source.html#l00105">ComputationRequest::outputs</a>, <a class="el" href="nnet-computation_8cc_source.html#l00401">NnetComputation::Print()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00161">Nnet::ReadConfig()</a>, <a class="el" href="cu-matrix_8cc_source.html#l02531">CuMatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00162">SetZero()</a>, and <a class="el" href="cu-matrix_8cc_source.html#l02434">CuMatrixBase&lt; Real &gt;::Sum()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize-test_8cc_source.html#l00178">UnitTestNnetOptimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;                                                                            {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//opt_config.convert_addition = false;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">//opt_config.remove_assignments = false;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">//opt_config.move_sizing_commands = false;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">//opt_config.allocate_from_other = false;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  srand(0);  <span class="comment">// Every run must be deterministic.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> = 0; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a> &lt; 40; <a class="code" href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">n</a>++) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keyword">struct </span><a class="code" href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">NnetGenerationOptions</a> gen_config;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    std::vector&lt;std::string&gt; configs;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">GenerateConfigSequence</a>(gen_config, &amp;configs);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; configs.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input config[&quot;</span> &lt;&lt; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;&lt; <span class="stringliteral">&quot;] is: &quot;</span> &lt;&lt; configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>];</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      std::istringstream is(configs[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      nnet.<a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">ReadConfig</a>(is);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html">ComputationRequest</a> request;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    std::vector&lt;Matrix&lt;BaseFloat&gt; &gt; inputs;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">ComputeExampleComputationRequestSimple</a>(nnet, &amp;request, &amp;inputs);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Compiler.html">Compiler</a> compiler(request, nnet);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CompilerOptions.html">CompilerOptions</a> opts;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    compiler.CreateComputation(opts, &amp;computation);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">Print</a>(os, nnet);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Generated computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">CheckComputationOptions</a> check_config;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// we can do the rewrite check since it&#39;s before optimization.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    check_config.<a class="code" href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">check_rewrite</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1ComputationChecker.html">ComputationChecker</a> checker(check_config, nnet, computation);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    checker.Check();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html">NnetComputation</a> computation_opt(computation);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">Optimize</a>(opt_config, nnet, request, &amp;computation_opt);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      std::ostringstream os;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      computation_opt.Print(os, nnet);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Optimized computation is: &quot;</span> &lt;&lt; os.str();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">NnetComputeOptions</a> compute_opts;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(0, 1) == 0)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      compute_opts.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    computation.<a class="code" href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">ComputeCudaIndexes</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    computation_opt.ComputeCudaIndexes();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet_to_update(nnet);  <span class="comment">// copy of the nnet that we update...  needed to</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                                <span class="comment">// test the consolidation of backprop commands,</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                                <span class="comment">// otherwise the optimized and non-optimized</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                <span class="comment">// comptuations differ.</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">bool</span> is_gradient = <span class="keyword">true</span>;  <span class="comment">// with natural gradient, the consolidation would</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                              <span class="comment">// affect the final model params -&gt; test just the</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                              <span class="comment">// gradient.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a>(is_gradient, &amp;nnet_to_update);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> computer(compute_opts,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                          computation,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                          nnet,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                          &amp;nnet_to_update);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet_opt(nnet);  <span class="comment">// copy of the nnet for the optimized computation.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                          <span class="comment">// necessary in case backprop changes parameters.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1Nnet.html">Nnet</a> nnet_opt_to_update(nnet_opt);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">SetZero</a>(is_gradient, &amp;nnet_opt_to_update);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// NnetComputer for the optimized version of the computation.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classkaldi_1_1nnet3_1_1NnetComputer.html">NnetComputer</a> computer_opt(compute_opts,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                              computation_opt,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                              nnet_opt,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                              &amp;nnet_opt_to_update);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// provide the input to the computations.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input sum is &quot;</span> &lt;&lt; temp.Sum();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      computer.AcceptInput(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name, &amp;temp);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> temp2(inputs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      computer_opt.AcceptInput(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name, &amp;temp2);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running non-optimized forward computation&quot;</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    computer.Forward();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running optimized forward computation&quot;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    computer_opt.Forward();</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;output(computer.GetOutput(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Output sum (not optimized) is &quot;</span> &lt;&lt; output.Sum();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;output_opt(computer_opt.GetOutput(<span class="stringliteral">&quot;output&quot;</span>));</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Output sum (optimized) is &quot;</span> &lt;&lt; output_opt.Sum();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(output, output_opt)) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Non-optimized and optimized versions of the computation give &quot;</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;different outputs.&quot;</span>;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv(output.NumRows(), output.NumCols());</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    output_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">SetRandn</a>();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> output_deriv_opt(output_deriv);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">if</span> (request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">outputs</a>[0].has_deriv) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      computer.AcceptOutputDeriv(<span class="stringliteral">&quot;output&quot;</span>, &amp;output_deriv);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      computer_opt.AcceptOutputDeriv(<span class="stringliteral">&quot;output&quot;</span>, &amp;output_deriv_opt);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running non-optimized backward computation&quot;</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    computer.Backward();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Running optimized backward computation&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    computer_opt.Backward();</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">if</span> (request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].has_deriv) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_deriv =</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            computer.GetInputDeriv(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;in_deriv_opt =</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            computer_opt.GetInputDeriv(request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input-deriv sum for input &#39;&quot;</span> &lt;&lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;&#39; (non-optimized) is &quot;</span> &lt;&lt; in_deriv.<a class="code" href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Input-deriv sum for input &#39;&quot;</span> &lt;&lt; request.<a class="code" href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">inputs</a>[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].name</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;&#39; (optimized) is &quot;</span> &lt;&lt; in_deriv_opt.<a class="code" href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">Sum</a>();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(in_deriv, in_deriv_opt)) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Non-optimized and optimized versions of the &quot;</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                     &lt;&lt; <span class="stringliteral">&quot;computation give different input-derivs.&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi_1_1nnet3.html#ac25c4eeb172565878e12ca4355ad9147">NnetParametersAreIdentical</a>(nnet_to_update,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                    nnet_opt_to_update, 1.0e-05)) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Neural networks differ after training, between &quot;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;optimized and non-optimized computation.&quot;</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a318f3e22ac453fd1efea583625fe76c3"><div class="ttname"><a href="namespacernnlm.html#a318f3e22ac453fd1efea583625fe76c3">rnnlm::n</a></div><div class="ttdeci">struct rnnlm::@10::@11 n</div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html_a2d86f93445cacbb3af16821e331b564f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html#a2d86f93445cacbb3af16821e331b564f">kaldi::nnet3::Nnet::ReadConfig</a></div><div class="ttdeci">void ReadConfig(std::istream &amp;config_file)</div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8cc_source.html#l00161">nnet-nnet.cc:161</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ac25c4eeb172565878e12ca4355ad9147"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ac25c4eeb172565878e12ca4355ad9147">kaldi::nnet3::NnetParametersAreIdentical</a></div><div class="ttdeci">bool NnetParametersAreIdentical(const Nnet &amp;nnet1, const Nnet &amp;nnet2, BaseFloat threshold=1.0e-05)</div><div class="ttdoc">Used for testing that the updatable parameters in two networks are the same. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l01124">nnet-test-utils.cc:1124</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_ac2af1facc3bf90819e78ea5b2bb2554d"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#ac2af1facc3bf90819e78ea5b2bb2554d">kaldi::nnet3::NnetComputation::ComputeCudaIndexes</a></div><div class="ttdeci">void ComputeCudaIndexes()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00083">nnet-computation.cc:83</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html_a398527b3e9e358c345c5047b16871957"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html#a398527b3e9e358c345c5047b16871957">kaldi::nnet3::NnetComputeOptions::debug</a></div><div class="ttdeci">bool debug</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00040">nnet-compute.h:40</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_a40c5a82d6d015bdcc0079b535b1e9a23"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#a40c5a82d6d015bdcc0079b535b1e9a23">kaldi::CuMatrixBase::SetRandn</a></div><div class="ttdeci">void SetRandn()</div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02531">cu-matrix.cc:2531</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetGenerationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetGenerationOptions.html">kaldi::nnet3::NnetGenerationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8h_source.html#l00033">nnet-test-utils.h:33</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ComputationChecker_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ComputationChecker.html">kaldi::nnet3::ComputationChecker</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00394">nnet-analyze.h:394</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a56ccdfeff2303e6dee20771d1a4fad78"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a56ccdfeff2303e6dee20771d1a4fad78">kaldi::nnet3::ComputationRequest::inputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; inputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00104">nnet-computation.h:104</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html_af5873d2ae114332d0f5b3da304cd5779"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html#af5873d2ae114332d0f5b3da304cd5779">kaldi::CuMatrixBase::Sum</a></div><div class="ttdeci">Real Sum() const </div><div class="ttdef"><b>Definition:</b> <a href="cu-matrix_8cc_source.html#l02434">cu-matrix.cc:2434</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputeOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputeOptions.html">kaldi::nnet3::NnetComputeOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00039">nnet-compute.h:39</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CompilerOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CompilerOptions.html">kaldi::nnet3::CompilerOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00034">nnet-compile.h:34</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html">kaldi::nnet3::ComputationRequest</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00103">nnet-computation.h:103</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2370ad59bd8f6a9f348193b491d88d8a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2370ad59bd8f6a9f348193b491d88d8a">kaldi::nnet3::ComputeExampleComputationRequestSimple</a></div><div class="ttdeci">void ComputeExampleComputationRequestSimple(const Nnet &amp;nnet, ComputationRequest *request, std::vector&lt; Matrix&lt; BaseFloat &gt; &gt; *inputs)</div><div class="ttdoc">This function computes an example computation request, for testing purposes. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00778">nnet-test-utils.cc:778</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96e8c7c5766b9f5c698ce7195489efba"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96e8c7c5766b9f5c698ce7195489efba">kaldi::nnet3::Optimize</a></div><div class="ttdeci">void Optimize(const NnetOptimizeOptions &amp;config, const Nnet &amp;nnet, const ComputationRequest &amp;request, NnetComputation *computation)</div><div class="ttdoc">This is the top-level function for optimizing a computation. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-optimize_8cc_source.html#l00326">nnet-optimize.cc:326</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Nnet_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Nnet.html">kaldi::nnet3::Nnet</a></div><div class="ttdef"><b>Definition:</b> <a href="_2nnet-nnet_8h_source.html#l00115">nnet-nnet.h:115</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html_ab342a2855f4c0a04a1c4f565405e1b93"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html#ab342a2855f4c0a04a1c4f565405e1b93">kaldi::nnet3::CheckComputationOptions::check_rewrite</a></div><div class="ttdeci">bool check_rewrite</div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00388">nnet-analyze.h:388</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9f63e4d60600b08466b42e409dd6253d"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9f63e4d60600b08466b42e409dd6253d">kaldi::nnet3::SetZero</a></div><div class="ttdeci">void SetZero(bool is_gradient, Nnet *nnet)</div><div class="ttdoc">Calls SetZero (with the given is_gradient parameter) on all updatable components of the nnet...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00162">nnet-utils.cc:162</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1NnetComputer_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1NnetComputer.html">kaldi::nnet3::NnetComputer</a></div><div class="ttdoc">class NnetComputer is responsible for executing the computation described in the &quot;computation&quot; object...</div><div class="ttdef"><b>Definition:</b> <a href="nnet3_2nnet-compute_8h_source.html#l00059">nnet-compute.h:59</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html">kaldi::nnet3::NnetComputation</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00213">nnet-computation.h:213</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1NnetComputation_html_a1ec279d69756dd3c71dce72a83ea9020"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1NnetComputation.html#a1ec279d69756dd3c71dce72a83ea9020">kaldi::nnet3::NnetComputation::Print</a></div><div class="ttdeci">void Print(std::ostream &amp;os, const Nnet &amp;nnet) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8cc_source.html#l00401">nnet-computation.cc:401</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComputationRequest_html_a75f6d03596c9241ae8d5791e6d0d84aa"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComputationRequest.html#a75f6d03596c9241ae8d5791e6d0d84aa">kaldi::nnet3::ComputationRequest::outputs</a></div><div class="ttdeci">std::vector&lt; IoSpecification &gt; outputs</div><div class="ttdef"><b>Definition:</b> <a href="nnet-computation_8h_source.html#l00105">nnet-computation.h:105</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1Compiler_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1Compiler.html">kaldi::nnet3::Compiler</a></div><div class="ttdoc">This class creates an initial version of the NnetComputation, without any optimization or sharing of ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile_8h_source.html#l00044">nnet-compile.h:44</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9a6ec6b257d100e7dab22ce3feac226f"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9a6ec6b257d100e7dab22ce3feac226f">kaldi::nnet3::GenerateConfigSequence</a></div><div class="ttdeci">void GenerateConfigSequence(const NnetGenerationOptions &amp;opts, std::vector&lt; std::string &gt; *configs)</div><div class="ttdoc">Generates a sequence of at least one config files, output as strings, where the first in the sequence...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-test-utils_8cc_source.html#l00717">nnet-test-utils.cc:717</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1CheckComputationOptions_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1CheckComputationOptions.html">kaldi::nnet3::CheckComputationOptions</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-analyze_8h_source.html#l00385">nnet-analyze.h:385</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7012eb43a414f870091986ffeec55aea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestPreconditionDirectionsOnline </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="natural-gradient-online-test_8cc_source.html#l00261">261</a> of file <a class="el" href="natural-gradient-online-test_8cc_source.html">natural-gradient-online-test.cc</a>.</p>

<p>References <a class="el" href="cu-vector_8cc_source.html#l00538">CuVectorBase&lt; Real &gt;::AddDiagMatMat()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l00119">MatrixBase&lt; Real &gt;::AddVecVec()</a>, <a class="el" href="kaldi-math_8h_source.html#l00273">kaldi::AssertEqual()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="matrix-common_8h_source.html#l00032">kaldi::kNoTrans</a>, <a class="el" href="matrix-common_8h_source.html#l00031">kaldi::kTrans</a>, <a class="el" href="cu-matrix_8h_source.html#l00195">CuMatrixBase&lt; Real &gt;::NumRows()</a>, <a class="el" href="natural-gradient-online-test_8cc_source.html#l00067">OnlineNaturalGradientSimple::PreconditionDirections()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00144">OnlineNaturalGradient::PreconditionDirections()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00099">kaldi::RandInt()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00936">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01186">MatrixBase&lt; Real &gt;::Set()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00300">VectorBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l01202">MatrixBase&lt; Real &gt;::SetRandn()</a>, <a class="el" href="natural-gradient-online-test_8cc_source.html#l00033">OnlineNaturalGradientSimple::SetRank()</a>, <a class="el" href="natural-gradient-online_8cc_source.html#l00618">OnlineNaturalGradient::SetRank()</a>, <a class="el" href="kaldi-matrix_8cc_source.html#l02531">kaldi::TraceMatMat()</a>, and <a class="el" href="natural-gradient-online_8h_source.html#l00422">OnlineNaturalGradient::TurnOnDebug()</a>.</p>

<p>Referenced by <a class="el" href="natural-gradient-online-test_8cc_source.html#l00326">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                            {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">MatrixIndexT</a> R = 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 30,  <span class="comment">// rank of correction</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      N = (2 * R) + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 30,  <span class="comment">// batch size</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      D = R + 1 + <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 20; <span class="comment">// problem dimension.  Must be &gt; R.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">// Test sometimes with features that are all-zero or all-one; this will</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">// help to make sure low-rank or zero input doesn&#39;t crash the code.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">bool</span> zero = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">bool</span> one = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 3 == 0) zero = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">//else if (Rand() % 2 == 0) one = true;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="classkaldi_1_1CuVector.html">CuVector&lt;BaseFloat&gt;</a> row_prod1(N), row_prod2(N);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> gamma1, gamma2;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> big_eig_factor = <a class="code" href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">RandInt</a>(1, 20);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  big_eig_factor = big_eig_factor * big_eig_factor;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> big_eig_vector(D);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  big_eig_vector.SetRandn();</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  big_eig_vector.Scale(big_eig_factor);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html">OnlineNaturalGradientSimple</a> preconditioner1;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">OnlineNaturalGradient</a> preconditioner2;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  preconditioner1.<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html#afb9bffca178027f3e5d52ec73a1ee0fe">SetRank</a>(R);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  preconditioner2.<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#afb9bffca178027f3e5d52ec73a1ee0fe">SetRank</a>(R);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  preconditioner2.<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a35086953bbc759bd2ac9cb660d87d83f">TurnOnDebug</a>();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_iters = 100;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> iter = 0; iter &lt; num_iters; iter++) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classkaldi_1_1Matrix.html">Matrix&lt;BaseFloat&gt;</a> M_cpu(N, D);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (one) M_cpu.Set(1.0);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!zero) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      M_cpu.SetRandn();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> rand_vec(N);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      rand_vec.SetRandn();</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      M_cpu.AddVecVec(1.0, rand_vec, big_eig_vector);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> M(M_cpu);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> Mcopy1(M), Mcopy2(M);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    preconditioner1.<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html#a40de84aa34756dd2c783f5f8a131670a">PreconditionDirections</a>(&amp;Mcopy1, &amp;row_prod1, &amp;gamma1);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    preconditioner2.<a class="code" href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a40de84aa34756dd2c783f5f8a131670a">PreconditionDirections</a>(&amp;Mcopy2, &amp;row_prod2, &amp;gamma2);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> trace1 = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(M, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>),</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        trace2 = <a class="code" href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">TraceMatMat</a>(Mcopy1, Mcopy1, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(trace1, trace2 * gamma2 * gamma2, 1.0e-02);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(Mcopy1, Mcopy2);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(row_prod1, row_prod2, 1.0e-02f);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">AssertEqual</a>(gamma1, gamma2, 1.0e-02);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// make sure positive definite</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="classkaldi_1_1CuVector.html">CuVector&lt;BaseFloat&gt;</a> inner_prods(M.NumRows());</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    inner_prods.<a class="code" href="classkaldi_1_1CuVectorBase.html#a46c4e5094335a6e257a08cb9ae0e7ff0">AddDiagMatMat</a>(1.0, M, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kNoTrans</a>, Mcopy1, <a class="code" href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kTrans</a>, 0.0);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(inner_prods.Min() &gt;= 0.0);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  }</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple_html_afb9bffca178027f3e5d52ec73a1ee0fe"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html#afb9bffca178027f3e5d52ec73a1ee0fe">kaldi::nnet3::OnlineNaturalGradientSimple::SetRank</a></div><div class="ttdeci">void SetRank(int32 rank)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online-test_8cc_source.html#l00033">natural-gradient-online-test.cc:33</a></div></div>
<div class="ttc" id="classkaldi_1_1CuVector_html"><div class="ttname"><a href="classkaldi_1_1CuVector.html">kaldi::CuVector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_afb9bffca178027f3e5d52ec73a1ee0fe"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#afb9bffca178027f3e5d52ec73a1ee0fe">kaldi::nnet3::OnlineNaturalGradient::SetRank</a></div><div class="ttdeci">void SetRank(int32 rank)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00618">natural-gradient-online.cc:618</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html">kaldi::nnet3::OnlineNaturalGradient</a></div><div class="ttdoc">Keywords for search: natural gradient, naturalgradient, NG-SGD. </div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00413">natural-gradient-online.h:413</a></div></div>
<div class="ttc" id="classkaldi_1_1Matrix_html"><div class="ttname"><a href="classkaldi_1_1Matrix.html">kaldi::Matrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1CuVectorBase_html_a46c4e5094335a6e257a08cb9ae0e7ff0"><div class="ttname"><a href="classkaldi_1_1CuVectorBase.html#a46c4e5094335a6e257a08cb9ae0e7ff0">kaldi::CuVectorBase::AddDiagMatMat</a></div><div class="ttdeci">void AddDiagMatMat(Real alpha, const CuMatrixBase&lt; Real &gt; &amp;M, MatrixTransposeType transM, const CuMatrixBase&lt; Real &gt; &amp;N, MatrixTransposeType transN, Real beta=1.0)</div><div class="ttdoc">Add the diagonal of a matrix product: *this = diag(M N), assuming the &quot;trans&quot; arguments are both kNoT...</div><div class="ttdef"><b>Definition:</b> <a href="cu-vector_8cc_source.html#l00538">cu-vector.cc:538</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa538d6ef272b2ad113f1860fccbc2c3e2">kaldi::kTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00031">matrix-common.h:31</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_aac2c220416519a2b0a7ad822ee2ef972"><div class="ttname"><a href="namespacekaldi.html#aac2c220416519a2b0a7ad822ee2ef972">kaldi::MatrixIndexT</a></div><div class="ttdeci">int32 MatrixIndexT</div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00091">matrix-common.h:91</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a35086953bbc759bd2ac9cb660d87d83f"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a35086953bbc759bd2ac9cb660d87d83f">kaldi::nnet3::OnlineNaturalGradient::TurnOnDebug</a></div><div class="ttdeci">void TurnOnDebug()</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8h_source.html#l00422">natural-gradient-online.h:422</a></div></div>
<div class="ttc" id="namespacekaldi_html_a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d"><div class="ttname"><a href="namespacekaldi.html#a610f4f6c3c8fe58b76713f593b9d724fa6decd3b781a809d748e5221d49f0ab5d">kaldi::kNoTrans</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00032">matrix-common.h:32</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple_html_a40de84aa34756dd2c783f5f8a131670a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html#a40de84aa34756dd2c783f5f8a131670a">kaldi::nnet3::OnlineNaturalGradientSimple::PreconditionDirections</a></div><div class="ttdeci">void PreconditionDirections(CuMatrixBase&lt; BaseFloat &gt; *R, CuVectorBase&lt; BaseFloat &gt; *row_prod, BaseFloat *scale)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online-test_8cc_source.html#l00067">natural-gradient-online-test.cc:67</a></div></div>
<div class="ttc" id="namespacekaldi_html_a94b9f349754706b9d6f38bb5ccc11c77"><div class="ttname"><a href="namespacekaldi.html#a94b9f349754706b9d6f38bb5ccc11c77">kaldi::TraceMatMat</a></div><div class="ttdeci">Real TraceMatMat(const MatrixBase&lt; Real &gt; &amp;A, const MatrixBase&lt; Real &gt; &amp;B, MatrixTransposeType trans)</div><div class="ttdoc">We need to declare this here as it will be a friend function. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-matrix_8cc_source.html#l02531">kaldi-matrix.cc:2531</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradientSimple.html">kaldi::nnet3::OnlineNaturalGradientSimple</a></div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online-test_8cc_source.html#l00028">natural-gradient-online-test.cc:28</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_aeb6ba6085493e3f15358e49751342177"><div class="ttname"><a href="namespacekaldi.html#aeb6ba6085493e3f15358e49751342177">kaldi::AssertEqual</a></div><div class="ttdeci">static void AssertEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">assert abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)) </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00273">kaldi-math.h:273</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1OnlineNaturalGradient_html_a40de84aa34756dd2c783f5f8a131670a"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1OnlineNaturalGradient.html#a40de84aa34756dd2c783f5f8a131670a">kaldi::nnet3::OnlineNaturalGradient::PreconditionDirections</a></div><div class="ttdeci">void PreconditionDirections(CuMatrixBase&lt; BaseFloat &gt; *R, CuVectorBase&lt; BaseFloat &gt; *row_prod, BaseFloat *scale)</div><div class="ttdef"><b>Definition:</b> <a href="natural-gradient-online_8cc_source.html#l00144">natural-gradient-online.cc:144</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0361eab3c5ebb78e6be060e6fa78e1a1"><div class="ttname"><a href="namespacekaldi.html#a0361eab3c5ebb78e6be060e6fa78e1a1">kaldi::RandInt</a></div><div class="ttdeci">int32 RandInt(int32 min_val, int32 max_val, struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00099">kaldi-math.cc:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad179bd30fedc76b302f19fb2cb1e6a60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestReadConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse-test_8cc_source.html#l00167">167</a> of file <a class="el" href="nnet-parse-test_8cc_source.html">nnet-parse-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-math_8h_source.html#l00262">kaldi::ApproxEqual()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="nnet-parse_8cc_source.html#l00414">ReadConfigFile()</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse-test_8cc_source.html#l00248">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                          {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  std::string str = <span class="stringliteral">&quot; alpha=aa beta=\&quot;b b\&quot;# String test\n&quot;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="stringliteral">&quot;beta2=&#39;b c&#39; beta3=bd # \n&quot;</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <span class="stringliteral">&quot;gamma=1:2:3:4  # Int Vector test\n&quot;</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="stringliteral">&quot; de1ta=f  # Bool + Integer in key Comment test delta=t  \n&quot;</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="stringliteral">&quot;_epsilon=-1  # Int Vector test _epsilon=1 \n&quot;</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="stringliteral">&quot; zet-_a=0.15   theta=1.1# Float, -, _ test\n&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="stringliteral">&quot;quoted=&#39;a b c&#39; # quoted string\n&quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="stringliteral">&quot;quoted2=\&quot;d e &#39;a b=c&#39; f\&quot; # string quoted with double quotes&quot;</span>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  std::istringstream is(str);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  std::vector&lt;std::string&gt; lines;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#ace63d2b2d7c79e9881204ea52366e48c">ReadConfigFile</a>(is, &amp;lines);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(lines.size() == 8);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classkaldi_1_1nnet3_1_1ConfigLine.html">ConfigLine</a> cfl;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; lines.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.ParseLine(lines[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]));</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.GetValue(<span class="stringliteral">&quot;beta2&quot;</span>, &amp;str) &amp;&amp; str == <span class="stringliteral">&quot;b c&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.GetValue(<span class="stringliteral">&quot;_epsilon&quot;</span>, &amp;str) &amp;&amp; str == <span class="stringliteral">&quot;-1&quot;</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.GetValue(<span class="stringliteral">&quot;quoted&quot;</span>, &amp;str) &amp;&amp; str == <span class="stringliteral">&quot;a b c&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.GetValue(<span class="stringliteral">&quot;quoted2&quot;</span>, &amp;str) &amp;&amp; str == <span class="stringliteral">&quot;d e &#39;a b=c&#39; f&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> float_val = 0;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(cfl.GetValue(<span class="stringliteral">&quot;zet-_a&quot;</span>, &amp;float_val) &amp;&amp; <a class="code" href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">ApproxEqual</a>(float_val, 0.15));</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1nnet3_1_1ConfigLine_html"><div class="ttname"><a href="classkaldi_1_1nnet3_1_1ConfigLine.html">kaldi::nnet3::ConfigLine</a></div><div class="ttdoc">This class is responsible for parsing input xx=yyy a=b c empty= f-oo=bar ba_z=123 bing=&#39;a b c&#39; baz=&quot;...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8h_source.html#l00039">nnet-parse.h:39</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ace63d2b2d7c79e9881204ea52366e48c"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ace63d2b2d7c79e9881204ea52366e48c">kaldi::nnet3::ReadConfigFile</a></div><div class="ttdeci">void ReadConfigFile(std::istream &amp;is, std::vector&lt; std::string &gt; *lines)</div><div class="ttdoc">This function reads in a config file and *appends* its contents to a vector of lines; it is responsib...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00414">nnet-parse.cc:414</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a99dcbb9fdaa6c980ba67941d45adf017"><div class="ttname"><a href="namespacekaldi.html#a99dcbb9fdaa6c980ba67941d45adf017">kaldi::ApproxEqual</a></div><div class="ttdeci">static bool ApproxEqual(float a, float b, float relative_tolerance=0.001)</div><div class="ttdoc">return abs(a - b) &lt;= relative_tolerance * (abs(a)+abs(b)). </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00262">kaldi-math.h:262</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6242a8c5b093373663b9ec8210946b8a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestSplitLocations </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00275">275</a> of file <a class="el" href="nnet-compile-utils-test_8cc_source.html">nnet-compile-utils-test.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00377">ConvertToIndexes()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00050">PrintVectorVectorPair()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="nnet-compile-utils_8cc_source.html#l00337">SplitLocations()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00361">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                          {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> minibatch_size = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 1024 + 100;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_submat_indexes = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 1;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_submat_list_size = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 1;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_num_kAddRows = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2; <span class="comment">// minimum number of kAddRows compatible</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// lists expected in the final split lists. This value will be used to</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">// create input submat_lists so that this is guaranteed</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  max_submat_list_size = min_num_kAddRows + max_submat_list_size;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt; all_pairs;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  all_pairs.reserve(minibatch_size * max_submat_list_size);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  std::vector&lt;std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &gt;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      submat_lists(minibatch_size),</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;      split_lists;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  std::vector&lt;int32&gt; submat_indexes(num_submat_indexes);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_submat_indexes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    submat_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// generating submat_lists</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_generated_submat_list_size = 0;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; minibatch_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_locations = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % max_submat_list_size + 1;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    max_generated_submat_list_size =</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        max_generated_submat_list_size &lt; num_locations ?</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        num_locations : max_generated_submat_list_size;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].reserve(num_locations);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; num_locations; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;= min_num_kAddRows)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// since we need min_num_kAddRows in the split_lists we ensure that</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="comment">// we add a pair with the same first element in all the submat_lists</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(std::make_pair(submat_indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>],</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                           <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % minibatch_size));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;          std::make_pair(submat_indexes[<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % num_submat_indexes],</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                         <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % minibatch_size));</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    all_pairs.insert(all_pairs.end(), submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(),</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                     submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8">SplitLocations</a>(submat_lists, &amp;split_lists);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">if</span> (verbose)  {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;submat_list&quot;</span>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">PrintVectorVectorPair</a>(submat_lists);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;split_lists&quot;</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">PrintVectorVectorPair</a>(split_lists);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;===========================&quot;</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; split_lists.size();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_kAddRows_in_output = 0;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_value;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  std::vector&lt;int32&gt; second_values;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">// ensure that elements in submat_lists are also present</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">// in split_lists</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0 ; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_lists.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    second_values.clear();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">ConvertToIndexes</a>(split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;first_value, &amp;second_values)) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <span class="comment">// Checking if ConvertToIndexes did a proper conversion of the indexes</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; second_values.size(); j++)  {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (split_lists[i][j].first != -1)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>((split_lists[i][j].first == first_value) &amp;&amp;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                       (split_lists[i][j].second == second_values[j]));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      num_kAddRows_in_output++;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); j++) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="keywordflow">if</span> (split_lists[i][j].first == -1)</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator iter =</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          std::find_if(all_pairs.begin(), all_pairs.end(),</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <a class="code" href="structkaldi_1_1nnet3_1_1ComparePair.html">ComparePair</a>(split_lists[i][j]));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(iter != all_pairs.end());</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      all_pairs.erase(iter);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(all_pairs.size() == 0);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// ensure that there are at least as many kAddRows compatible split_lists as</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// specified</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_kAddRows_in_output &gt;= min_num_kAddRows);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComparePair_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComparePair.html">kaldi::nnet3::ComparePair</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils-test_8cc_source.html#l00026">nnet-compile-utils-test.cc:26</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae99488174e8dde27f8f30d91d61c0cd2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">kaldi::nnet3::ConvertToIndexes</a></div><div class="ttdeci">bool ConvertToIndexes(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;location_vector, int32 *first_value, std::vector&lt; int32 &gt; *second_values)</div><div class="ttdoc">If it is the case for some i &gt;= 0 that all the .first elements of &quot;location_vector&quot; are either i or -...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00377">nnet-compile-utils.cc:377</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a7c81548b4f8146cd3447b10d556978a8"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a7c81548b4f8146cd3447b10d556978a8">kaldi::nnet3::SplitLocations</a></div><div class="ttdeci">void SplitLocations(const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; &amp;submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *split_lists)</div><div class="ttdoc">The input to this function is a vector of lists of pairs, and this function splits it up into a list ...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00337">nnet-compile-utils.cc:337</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ab2fee0700fd475dc0d6b4a9d618e9a72"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">kaldi::nnet3::PrintVectorVectorPair</a></div><div class="ttdeci">void PrintVectorVectorPair(std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; vec_vec_pair)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils-test_8cc_source.html#l00050">nnet-compile-utils-test.cc:50</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae8d72d1c711cbf1c6cb14e49fa474a51"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestSplitLocationsBackward </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00070">70</a> of file <a class="el" href="nnet-compile-utils-test_8cc_source.html">nnet-compile-utils-test.cc</a>.</p>

<p>References <a class="el" href="nnet-compile-utils_8cc_source.html#l00377">ConvertToIndexes()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00050">PrintVectorVectorPair()</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, and <a class="el" href="nnet-compile-utils_8cc_source.html#l00469">SplitLocationsBackward()</a>.</p>

<p>Referenced by <a class="el" href="nnet-compile-utils-test_8cc_source.html#l00361">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                                  {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> minibatch_size = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 1024 + 100;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_submat_indexes = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 1;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_submat_list_size = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 10 + 1;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> min_num_kAddRows = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2; <span class="comment">// minimum number of kAddRows compatible</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// lists expected in the final split lists. This value will be used to</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// create input submat_lists so that this is guaranteed</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  max_submat_list_size = min_num_kAddRows + max_submat_list_size;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  std::vector&lt;std::pair&lt;int32, int32&gt; &gt; all_pairs;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  all_pairs.reserve(minibatch_size * max_submat_list_size);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  std::vector&lt;std::vector&lt;std::pair&lt;int32, int32&gt; &gt; &gt;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;      submat_lists(minibatch_size),</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      split_lists;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  std::vector&lt;int32&gt; submat_indexes(num_submat_indexes);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_submat_indexes; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    submat_indexes[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// generating submat_lists</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_generated_submat_list_size = 0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; minibatch_size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_locations = <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % max_submat_list_size + 1;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    max_generated_submat_list_size =</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        max_generated_submat_list_size &lt; num_locations ?</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        num_locations : max_generated_submat_list_size;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].reserve(num_locations);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; num_locations; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt;= min_num_kAddRows)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// since we need min_num_kAddRows in the split_lists we ensure that</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// we add a pair with the same first element in all the submat_lists</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(std::make_pair(submat_indexes[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>],</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                           <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % minibatch_size));</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          std::make_pair(submat_indexes[<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % num_submat_indexes],</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                         <a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % minibatch_size));</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    all_pairs.insert(all_pairs.end(), submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(),</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                     submat_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="namespacekaldi_1_1nnet3.html#a230b979419515f453ee5c8f2bc87a4dd">SplitLocationsBackward</a>(submat_lists, &amp;split_lists);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// Checking split_lists has all the necessary properties</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; split_lists.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)  {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_value;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    std::vector&lt;int32&gt; second_values;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">ConvertToIndexes</a>(split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], &amp;first_value, &amp;second_values))  {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="comment">// checking for contiguity and uniqueness of .second elements</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      std::vector&lt;int32&gt; occurred_values;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> prev_value = -10; <span class="comment">// using a negative value as all indices are &gt; 0</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; second_values.size(); j++)  {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">if</span> (second_values[j] == -1)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> (second_values[j] != prev_value) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          std::vector&lt;int32&gt;::iterator iter = std::find(occurred_values.begin(),</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                                        occurred_values.end(),</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                                        second_values[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(iter == occurred_values.end());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt; list_of_pairs;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// checking for uniques of elements in the list</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); j++)  {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (split_lists[i][j].first == -1)</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::const_iterator iter =</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            std::find_if(list_of_pairs.begin(), list_of_pairs.end(),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                         <a class="code" href="structkaldi_1_1nnet3_1_1PairIsEqualComparator.html">PairIsEqualComparator</a>(split_lists[i][j]));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(iter == list_of_pairs.end());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        list_of_pairs.push_back(split_lists[i][j]);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">if</span> (verbose)  {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;submat_list&quot;</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">PrintVectorVectorPair</a>(submat_lists);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;split_lists&quot;</span>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">PrintVectorVectorPair</a>(split_lists);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;===========================&quot;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_kAddRows_in_output = 0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> first_value;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  std::vector&lt;int32&gt; second_values;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// ensure that elements in submat_lists are also present</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// in split_lists</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0 ; i &lt; split_lists.size(); i++) {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    second_values.clear();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">ConvertToIndexes</a>(split_lists[i], &amp;first_value, &amp;second_values)) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">// Checking if ConvertToIndexes did a proper conversion of the indexes</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(second_values.size() == split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; second_values.size(); j++)  {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (split_lists[i][j].first != -1)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>((split_lists[i][j].first == first_value) &amp;&amp;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                       (split_lists[i][j].second == second_values[j]));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      num_kAddRows_in_output++;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> j = 0; j &lt; split_lists[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); j++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">if</span> (split_lists[i][j].first == -1)</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      std::vector&lt;std::pair&lt;int32, int32&gt; &gt;::iterator iter =</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          std::find_if(all_pairs.begin(), all_pairs.end(),</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    <a class="code" href="structkaldi_1_1nnet3_1_1ComparePair.html">ComparePair</a>(split_lists[i][j]));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(iter != all_pairs.end());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      all_pairs.erase(iter);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(all_pairs.size() == 0);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// ensure that there are at least as many kAddRows compatible split_lists as</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// specified</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_kAddRows_in_output &gt;= min_num_kAddRows);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1ComparePair_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1ComparePair.html">kaldi::nnet3::ComparePair</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils-test_8cc_source.html#l00026">nnet-compile-utils-test.cc:26</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ae99488174e8dde27f8f30d91d61c0cd2"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ae99488174e8dde27f8f30d91d61c0cd2">kaldi::nnet3::ConvertToIndexes</a></div><div class="ttdeci">bool ConvertToIndexes(const std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &amp;location_vector, int32 *first_value, std::vector&lt; int32 &gt; *second_values)</div><div class="ttdoc">If it is the case for some i &gt;= 0 that all the .first elements of &quot;location_vector&quot; are either i or -...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00377">nnet-compile-utils.cc:377</a></div></div>
<div class="ttc" id="structkaldi_1_1nnet3_1_1PairIsEqualComparator_html"><div class="ttname"><a href="structkaldi_1_1nnet3_1_1PairIsEqualComparator.html">kaldi::nnet3::PairIsEqualComparator</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils-test_8cc_source.html#l00036">nnet-compile-utils-test.cc:36</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_ab2fee0700fd475dc0d6b4a9d618e9a72"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#ab2fee0700fd475dc0d6b4a9d618e9a72">kaldi::nnet3::PrintVectorVectorPair</a></div><div class="ttdeci">void PrintVectorVectorPair(std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; vec_vec_pair)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils-test_8cc_source.html#l00050">nnet-compile-utils-test.cc:50</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a230b979419515f453ee5c8f2bc87a4dd"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a230b979419515f453ee5c8f2bc87a4dd">kaldi::nnet3::SplitLocationsBackward</a></div><div class="ttdeci">void SplitLocationsBackward(const std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; &amp;submat_lists, std::vector&lt; std::vector&lt; std::pair&lt; int32, int32 &gt; &gt; &gt; *split_lists)</div><div class="ttdoc">This function has the same interface as SplitLocations(); however, it ensures certain additional prop...</div><div class="ttdef"><b>Definition:</b> <a href="nnet-compile-utils_8cc_source.html#l00469">nnet-compile-utils.cc:469</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a7353c9f73e07a4f64149e67d737482"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void kaldi::nnet3::UnitTestSummarizeVector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-parse-test_8cc_source.html#l00223">223</a> of file <a class="el" href="nnet-parse-test_8cc_source.html">nnet-parse-test.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="matrix-common_8h_source.html#l00038">kaldi::kCopyData</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00189">Vector&lt; Real &gt;::Resize()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00300">VectorBase&lt; Real &gt;::SetRandn()</a>, and <a class="el" href="nnet-parse_8cc_source.html#l00462">SummarizeVector()</a>.</p>

<p>Referenced by <a class="el" href="nnet-parse-test_8cc_source.html#l00248">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                               {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="comment">// will be eyeballed by a human.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> vec(9);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  vec.SetRandn();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  vec(0) = 1024.2343;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  vec(1) = 0.01;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  vec(2) = 0.001234;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  vec(3) = 0.000198;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  vec(3) = 1.98e-09;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  vec(4) = 153.0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  vec(5) = 0.154;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  vec(6) = 1.2;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  vec(7) = 9.2;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  vec(8) = 10.8;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;vec = &quot;</span> &lt;&lt; vec &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a9edff78ae3a66646a203ad49ab320347">SummarizeVector</a>(vec);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  vec.Resize(20, <a class="code" href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80ba6ccfb1220c1b49764f14603227edd6e0">kCopyData</a>);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;vec = &quot;</span> &lt;&lt; vec &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span> &lt;&lt; <a class="code" href="namespacekaldi_1_1nnet3.html#a9edff78ae3a66646a203ad49ab320347">SummarizeVector</a>(vec);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab4ace1fea44c7724ab9a76d70abad80ba6ccfb1220c1b49764f14603227edd6e0"><div class="ttname"><a href="namespacekaldi.html#ab4ace1fea44c7724ab9a76d70abad80ba6ccfb1220c1b49764f14603227edd6e0">kaldi::kCopyData</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix-common_8h_source.html#l00038">matrix-common.h:38</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a9edff78ae3a66646a203ad49ab320347"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a9edff78ae3a66646a203ad49ab320347">kaldi::nnet3::SummarizeVector</a></div><div class="ttdeci">std::string SummarizeVector(const Vector&lt; BaseFloat &gt; &amp;vec)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-parse_8cc_source.html#l00462">nnet-parse.cc:462</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aded8b769020aeb041c148c931c44a040"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UnVectorizeNnet </td>
          <td>(</td>
          <td class="paramtype">const VectorBase&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the parameters from params to *dest. </p>
<p>the dimension of params must be equal to NumParameters(*dest). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00331">331</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00289">NumParameters()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00384">UpdatableComponent::NumParameters()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, and <a class="el" href="nnet-component-itf_8h_source.html#l00391">UpdatableComponent::UnVectorize()</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-combine_8cc_source.html#l00412">NnetCombiner::ComputeObjfAndDerivFromNnet()</a>.</p>
<div class="fragment"><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                 {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(parameters.Dim() == <a class="code" href="namespacekaldi_1_1nnet3.html#a96164bd20d5a66c3c0ca62e30250d46a">NumParameters</a>(*dest));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dim_offset = 0;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; dest-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    Component *comp = dest-&gt;GetComponent(c);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="comment">// For now all updatable components inherit from class UpdatableComponent.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">// If that changes in future, we will change this code.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      UpdatableComponent *uc = <span class="keyword">dynamic_cast&lt;</span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">if</span> (uc == NULL)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Updatable component does not inherit from class &quot;</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="stringliteral">&quot;UpdatableComponent; change this code.&quot;</span>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_dim = uc-&gt;NumParameters();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keyword">const</span> SubVector&lt;BaseFloat&gt; this_part(parameters, dim_offset, this_dim);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      uc-&gt;UnVectorize(this_part);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      dim_offset += this_dim;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96164bd20d5a66c3c0ca62e30250d46a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96164bd20d5a66c3c0ca62e30250d46a">kaldi::nnet3::NumParameters</a></div><div class="ttdeci">int32 NumParameters(const Nnet &amp;src)</div><div class="ttdoc">Returns the total of the number of parameters in the updatable components of the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00289">nnet-utils.cc:289</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7464172a2f27484596c2d374bb1adcd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VariableMergingOptimization </td>
          <td>(</td>
          <td class="paramtype">const NnetOptimizeOptions &amp;&#160;</td>
          <td class="paramname"><em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>nnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ComputationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">NnetComputation *&#160;</td>
          <td class="paramname"><em>computation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This wraps class <a class="el" href="classkaldi_1_1nnet3_1_1VariableMergingOptimizer.html" title="This class is responsible for merging matrices, although you probably want to access it via the the f...">VariableMergingOptimizer</a> in a simplified interface. </p>

<p>Definition at line <a class="el" href="nnet-optimize_8cc_source.html#l00251">251</a> of file <a class="el" href="nnet-optimize_8cc_source.html">nnet-optimize.cc</a>.</p>

<p>References <a class="el" href="nnet-optimize-utils_8cc_source.html#l00706">VariableMergingOptimizer::MergeVariables()</a>.</p>

<p>Referenced by <a class="el" href="nnet-optimize_8cc_source.html#l00326">Optimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                               {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">bool</span> changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">while</span> (changed) {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    VariableMergingOptimizer opt(config, nnet, request, computation);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (opt.MergeVariables())</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9b9bd865f19f604b00235336168c3ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VectorizeNnet </td>
          <td>(</td>
          <td class="paramtype">const Nnet &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">VectorBase&lt; BaseFloat &gt; *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies the nnet parameters to *params, whose dimension must be equal to NumParameters(src). </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00308">308</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00042">kUpdatableComponent</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, <a class="el" href="nnet-utils_8cc_source.html#l00289">NumParameters()</a>, <a class="el" href="nnet-component-itf_8h_source.html#l00384">UpdatableComponent::NumParameters()</a>, <a class="el" href="classkaldi_1_1nnet3_1_1Component.html#a3a4ff15fafe0c8c4885586fc2c36ca8a">Component::Properties()</a>, and <a class="el" href="nnet-component-itf_8h_source.html#l00389">UpdatableComponent::Vectorize()</a>.</p>

<p>Referenced by <a class="el" href="nnet3_2nnet-combine_8cc_source.html#l00064">NnetCombiner::AcceptNnet()</a>, <a class="el" href="nnet3_2nnet-combine_8cc_source.html#l00412">NnetCombiner::ComputeObjfAndDerivFromNnet()</a>, and <a class="el" href="nnet3_2nnet-combine_8cc_source.html#l00026">NnetCombiner::NnetCombiner()</a>.</p>
<div class="fragment"><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                                                      {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(parameters-&gt;Dim() == <a class="code" href="namespacekaldi_1_1nnet3.html#a96164bd20d5a66c3c0ca62e30250d46a">NumParameters</a>(src));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> dim_offset = 0;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; src.NumComponents(); c++) {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keyword">const</span> Component *comp = src.GetComponent(c);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (comp-&gt;Properties() &amp; <a class="code" href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kUpdatableComponent</a>) {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// For now all updatable components inherit from class UpdatableComponent.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// If that changes in future, we will change this code.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keyword">const</span> UpdatableComponent *uc =</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>UpdatableComponent*<span class="keyword">&gt;</span>(comp);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <span class="keywordflow">if</span> (uc == NULL)</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Updatable component does not inherit from class &quot;</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            <span class="stringliteral">&quot;UpdatableComponent; change this code.&quot;</span>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> this_dim = uc-&gt;NumParameters();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      SubVector&lt;BaseFloat&gt; this_part(*parameters, dim_offset, this_dim);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      uc-&gt;Vectorize(&amp;this_part);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      dim_offset += this_dim;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a36da016976f88292c0d31653a20cbfe3a61132a04f6c327dffd7f053b93ae393b">kaldi::nnet3::kUpdatableComponent</a></div><div class="ttdef"><b>Definition:</b> <a href="nnet-component-itf_8h_source.html#l00042">nnet-component-itf.h:42</a></div></div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a96164bd20d5a66c3c0ca62e30250d46a"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a96164bd20d5a66c3c0ca62e30250d46a">kaldi::nnet3::NumParameters</a></div><div class="ttdeci">int32 NumParameters(const Nnet &amp;src)</div><div class="ttdoc">Returns the total of the number of parameters in the updatable components of the nnet. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-utils_8cc_source.html#l00289">nnet-utils.cc:289</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6d9bd2f8bc49b5d2d7dec9b2d354ffc9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WriteIndexVector </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Index &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00118">118</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00033">kaldi::WriteBasicType()</a>, <a class="el" href="nnet-common_8cc_source.html#l00044">WriteIndexVectorElementBinary()</a>, and <a class="el" href="io-funcs_8cc_source.html#l00134">kaldi::WriteToken()</a>.</p>

<p>Referenced by <a class="el" href="nnet-common-test_8cc_source.html#l00027">UnitTestIndexIo()</a>, and <a class="el" href="nnet3_2nnet-example_8cc_source.html#l00028">NnetIo::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                                   {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// This token will make it easier to write back-compatible code if we later</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// change the format.</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">WriteToken</a>(os, binary, <span class="stringliteral">&quot;&lt;I1V&gt;&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> size = vec.size();</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, size);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> (!binary) {  <span class="comment">// In text mode we just use the native Write functionality.</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      vec[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].Write(os, binary);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <a class="code" href="namespacekaldi_1_1nnet3.html#a2aebb785e5823e55aa1d45d473f13a8e">WriteIndexVectorElementBinary</a>(os, vec, <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_1_1nnet3_html_a2aebb785e5823e55aa1d45d473f13a8e"><div class="ttname"><a href="namespacekaldi_1_1nnet3.html#a2aebb785e5823e55aa1d45d473f13a8e">kaldi::nnet3::WriteIndexVectorElementBinary</a></div><div class="ttdeci">static void WriteIndexVectorElementBinary(std::ostream &amp;os, const std::vector&lt; Index &gt; &amp;vec, int32 i)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-common_8cc_source.html#l00044">nnet-common.cc:44</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga87f1638ef3c0a3ee117178b202c2d02a"><div class="ttname"><a href="group__io__funcs__basic.html#ga87f1638ef3c0a3ee117178b202c2d02a">kaldi::WriteToken</a></div><div class="ttdeci">void WriteToken(std::ostream &amp;os, bool binary, const char *token)</div><div class="ttdoc">The WriteToken functions are for writing nonempty sequences of non-space characters. </div><div class="ttdef"><b>Definition:</b> <a href="io-funcs_8cc_source.html#l00134">io-funcs.cc:134</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00033">io-funcs-inl.h:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2aebb785e5823e55aa1d45d473f13a8e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void kaldi::nnet3::WriteIndexVectorElementBinary </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Index &gt; &amp;&#160;</td>
          <td class="paramname"><em>vec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-common_8cc_source.html#l00044">44</a> of file <a class="el" href="nnet-common_8cc_source.html">nnet-common.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="nnet-common_8h_source.html#l00045">Index::n</a>, <a class="el" href="nnet-common_8h_source.html#l00046">Index::t</a>, <a class="el" href="io-funcs-inl_8h_source.html#l00033">kaldi::WriteBasicType()</a>, and <a class="el" href="nnet-common_8h_source.html#l00047">Index::x</a>.</p>

<p>Referenced by <a class="el" href="nnet-common_8cc_source.html#l00118">WriteIndexVector()</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;             {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">bool</span> binary = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  Index index = vec[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> == 0) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">if</span> (index.n == 0 &amp;&amp; index.x == 0 &amp;&amp;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        std::abs(index.t) &lt; 125) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="comment">// handle this common case in one character.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      os.put(static_cast&lt;signed char&gt;(index.t));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    } <span class="keywordflow">else</span> {  <span class="comment">// handle the general case less efficiently.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      os.put(127);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.n);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.t);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.x);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    Index last_index = vec[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>-1];</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keywordflow">if</span> (index.n == last_index.n &amp;&amp; index.x == last_index.x &amp;&amp;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        std::abs(index.t - last_index.t) &lt; 125) {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordtype">signed</span> <span class="keywordtype">char</span> c = index.t - last_index.t;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      os.put(c);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    } <span class="keywordflow">else</span> {  <span class="comment">// handle the general case less efficiently.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      os.put(127);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.n);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.t);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, index.x);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (!os.good())</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Output stream error detected&quot;</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00033">io-funcs-inl.h:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a264b986f95f2cb1e5bc7032967c69a27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::YzxVectorIndex </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_x_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_y_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_z_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-simple-component_8cc_source.html#l03083">3083</a> of file <a class="el" href="nnet-simple-component_8cc_source.html">nnet-simple-component.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00156">KALDI_PARANOID_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l03239">ConvolutionComponent::InderivPatchesToInderiv()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l03102">ConvolutionComponent::InputToInputPatches()</a>.</p>
<div class="fragment"><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;                                               {</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  <a class="code" href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a>(x &lt; input_x_dim &amp;&amp; y &lt; input_y_dim &amp;&amp; z &lt; input_z_dim);</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="keywordflow">return</span> (input_y_dim * input_z_dim) * x + (input_y_dim) * z + y;</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga2c852c1a15c7f195ec8021de2ab119a0"><div class="ttname"><a href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a></div><div class="ttdeci">#define KALDI_PARANOID_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00156">kaldi-error.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca9d819d3ed85b506db090905d4c1cea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ZeroComponentStats </td>
          <td>(</td>
          <td class="paramtype">Nnet *&#160;</td>
          <td class="paramname"><em>nnet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Zeroes the component stats in all nonlinear components in the nnet. </p>

<p>Definition at line <a class="el" href="nnet-utils_8cc_source.html#l00244">244</a> of file <a class="el" href="nnet-utils_8cc_source.html">nnet-utils.cc</a>.</p>

<p>References <a class="el" href="_2nnet-nnet_8cc_source.html#l00137">Nnet::GetComponent()</a>, <a class="el" href="_2nnet-nnet_8h_source.html#l00122">Nnet::NumComponents()</a>, and <a class="el" href="nnet-component-itf_8h_source.html#l00166">Component::ZeroStats()</a>.</p>

<p>Referenced by <a class="el" href="nnet-training_8cc_source.html#l00026">NnetTrainer::NnetTrainer()</a>.</p>
<div class="fragment"><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                    {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> c = 0; c &lt; nnet-&gt;NumComponents(); c++) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    Component *comp = nnet-&gt;GetComponent(c);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    comp-&gt;ZeroStats();  <span class="comment">// for some components, this won&#39;t do anything.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a25b3b76367d2844fb0f48334f1bd5691"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> kaldi::nnet3::ZyxVectorIndex </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_x_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_y_dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>input_z_dim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="nnet-simple-component_8cc_source.html#l03091">3091</a> of file <a class="el" href="nnet-simple-component_8cc_source.html">nnet-simple-component.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00156">KALDI_PARANOID_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="nnet-simple-component_8cc_source.html#l03239">ConvolutionComponent::InderivPatchesToInderiv()</a>, and <a class="el" href="nnet-simple-component_8cc_source.html#l03102">ConvolutionComponent::InputToInputPatches()</a>.</p>
<div class="fragment"><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                                               {</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;  <a class="code" href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a>(x &lt; input_x_dim &amp;&amp; y &lt; input_y_dim &amp;&amp; z &lt; input_z_dim);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;  <span class="keywordflow">return</span> (input_y_dim * input_z_dim) * x + (input_z_dim) * y + z;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga2c852c1a15c7f195ec8021de2ab119a0"><div class="ttname"><a href="group__error__group.html#ga2c852c1a15c7f195ec8021de2ab119a0">KALDI_PARANOID_ASSERT</a></div><div class="ttdeci">#define KALDI_PARANOID_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00156">kaldi-error.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a661a5133ac17b002930d5eea66d9632c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool computation_checker_warned_unused_input = false</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks that we never use variables before they are allocated or after they are deallocated, and some other checks that can be done from the <a class="el" href="structkaldi_1_1nnet3_1_1MatrixAccesses.html">MatrixAccesses</a>. </p>

<p>Definition at line <a class="el" href="nnet-analyze_8cc_source.html#l00633">633</a> of file <a class="el" href="nnet-analyze_8cc_source.html">nnet-analyze.cc</a>.</p>

<p>Referenced by <a class="el" href="nnet-analyze_8cc_source.html#l00635">ComputationChecker::CheckComputationMatrixAccesses()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacekaldi.html">kaldi</a></li><li class="navelem"><a class="el" href="namespacekaldi_1_1nnet3.html">nnet3</a></li>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:47 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
