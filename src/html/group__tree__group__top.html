<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: Top-level tree-building functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__tree__group__top.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Top-level tree-building functions<div class="ingroups"><a class="el" href="group__tree__group.html">Modules involved in tree building</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>See <a class="el" href="tree_internals.html">Decision tree internals</a> for context.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for Top-level tree-building functions:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__tree__group__top.png" border="0" alt="" usemap="#group____tree____group____top"/>
<map name="group____tree____group____top" id="group____tree____group____top">
<area shape="rect" id="node2" href="group__tree__group.html" title="See. " alt="" coords="5,5,152,46"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1AccumulateTreeStatsOptions.html">AccumulateTreeStatsOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad6daf95a27b092517d50f0acbcea4b59"><td class="memItemLeft" align="right" valign="top">EventMap *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#gad6daf95a27b092517d50f0acbcea4b59">BuildTree</a> (Questions &amp;qopts, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets, const std::vector&lt; int32 &gt; &amp;phone2num_pdf_classes, const std::vector&lt; bool &gt; &amp;share_roots, const std::vector&lt; bool &gt; &amp;do_split, const BuildTreeStatsType &amp;stats, BaseFloat thresh, int32 max_leaves, BaseFloat cluster_thresh,int32 P)</td></tr>
<tr class="memdesc:gad6daf95a27b092517d50f0acbcea4b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">BuildTree is the normal way to build a set of decision trees.  <a href="#gad6daf95a27b092517d50f0acbcea4b59">More...</a><br/></td></tr>
<tr class="separator:gad6daf95a27b092517d50f0acbcea4b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e3d5e278c5e5ea8fd366116e2f3bbfe"><td class="memItemLeft" align="right" valign="top">EventMap *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#ga6e3d5e278c5e5ea8fd366116e2f3bbfe">BuildTreeTwoLevel</a> (Questions &amp;qopts, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets, const std::vector&lt; int32 &gt; &amp;phone2num_pdf_classes, const std::vector&lt; bool &gt; &amp;share_roots, const std::vector&lt; bool &gt; &amp;do_split, const BuildTreeStatsType &amp;stats, int32 max_leaves_first, int32 max_leaves_second, bool cluster_leaves, int32 P, std::vector&lt; int32 &gt; *leaf_map)</td></tr>
<tr class="memdesc:ga6e3d5e278c5e5ea8fd366116e2f3bbfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">BuildTreeTwoLevel builds a two-level tree, useful for example in building tied mixture systems with multiple codebooks.  <a href="#ga6e3d5e278c5e5ea8fd366116e2f3bbfe">More...</a><br/></td></tr>
<tr class="separator:ga6e3d5e278c5e5ea8fd366116e2f3bbfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19b3aa6660f3589b4a6017dd5b37eb5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#ga19b3aa6660f3589b4a6017dd5b37eb5d">GenRandStats</a> (int32 dim, int32 num_stats, int32 N, int32 P, const std::vector&lt; int32 &gt; &amp;phone_ids, const std::vector&lt; int32 &gt; &amp;hmm_lengths, const std::vector&lt; bool &gt; &amp;is_ctx_dep, bool ensure_all_phones_covered, BuildTreeStatsType *stats_out)</td></tr>
<tr class="memdesc:ga19b3aa6660f3589b4a6017dd5b37eb5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">GenRandStats generates random statistics of the form used by BuildTree.  <a href="#ga19b3aa6660f3589b4a6017dd5b37eb5d">More...</a><br/></td></tr>
<tr class="separator:ga19b3aa6660f3589b4a6017dd5b37eb5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2dc32e93b34f2086c027c7b632d1e595"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#ga2dc32e93b34f2086c027c7b632d1e595">ReadSymbolTableAsIntegers</a> (std::string filename, bool include_eps, std::vector&lt; int32 &gt; *syms)</td></tr>
<tr class="memdesc:ga2dc32e93b34f2086c027c7b632d1e595"><td class="mdescLeft">&#160;</td><td class="mdescRight">included here because it's used in some tree-building calling code.  <a href="#ga2dc32e93b34f2086c027c7b632d1e595">More...</a><br/></td></tr>
<tr class="separator:ga2dc32e93b34f2086c027c7b632d1e595"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa86991990615fc25dce24e8e13e1fb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#gaaa86991990615fc25dce24e8e13e1fb4">AutomaticallyObtainQuestions</a> (BuildTreeStatsType &amp;stats, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets_in, const std::vector&lt; int32 &gt; &amp;all_pdf_classes_in, int32 P, std::vector&lt; std::vector&lt; int32 &gt; &gt; *questions_out)</td></tr>
<tr class="memdesc:gaaa86991990615fc25dce24e8e13e1fb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Outputs sets of phones that are reasonable for questions to ask in the tree-building algorithm.  <a href="#gaaa86991990615fc25dce24e8e13e1fb4">More...</a><br/></td></tr>
<tr class="separator:gaaa86991990615fc25dce24e8e13e1fb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf850d66e74ce4fc64fd26fe193bdd156"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#gaf850d66e74ce4fc64fd26fe193bdd156">KMeansClusterPhones</a> (BuildTreeStatsType &amp;stats, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets_in, const std::vector&lt; int32 &gt; &amp;all_pdf_classes_in, int32 P, int32 num_classes, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sets_out)</td></tr>
<tr class="memdesc:gaf850d66e74ce4fc64fd26fe193bdd156"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function clusters the phones (or some initially specified sets of phones) into sets of phones, using a k-means algorithm.  <a href="#gaf850d66e74ce4fc64fd26fe193bdd156">More...</a><br/></td></tr>
<tr class="separator:gaf850d66e74ce4fc64fd26fe193bdd156"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82089f932878da16df7ea892d60f32d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tree__group__top.html#ga82089f932878da16df7ea892d60f32d8">ReadRootsFile</a> (std::istream &amp;is, std::vector&lt; std::vector&lt; int32 &gt; &gt; *phone_sets, std::vector&lt; bool &gt; *is_shared_root, std::vector&lt; bool &gt; *is_split_root)</td></tr>
<tr class="memdesc:ga82089f932878da16df7ea892d60f32d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the roots file (throws on error).  <a href="#ga82089f932878da16df7ea892d60f32d8">More...</a><br/></td></tr>
<tr class="separator:ga82089f932878da16df7ea892d60f32d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>See <a class="el" href="tree_internals.html">Decision tree internals</a> for context. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaaa86991990615fc25dce24e8e13e1fb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AutomaticallyObtainQuestions </td>
          <td>(</td>
          <td class="paramtype">BuildTreeStatsType &amp;&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_sets_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_pdf_classes_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>questions_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Outputs sets of phones that are reasonable for questions to ask in the tree-building algorithm. </p>
<p>These are obtained by tree clustering of the phones; for each node in the tree, all the leaves accessible from that node form one of the sets of phones. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stats</td><td>[in] The statistics as used for normal tree-building. </td></tr>
    <tr><td class="paramname">phone_sets_in</td><td>[in] All the phones, pre-partitioned into sets. The output sets will be various unions of these sets. These sets will normally correspond to "real phones", in cases where the phones have stress and position markings. </td></tr>
    <tr><td class="paramname">all_pdf_classes_in</td><td>[in] All the <a class="el" href="hmm.html#pdf_class">pdf-classes</a> that we consider for clustering. In the normal case this is the singleton set {1}, which means that we only consider the central hmm-position of the standard 3-state HMM, for clustering purposes. </td></tr>
    <tr><td class="paramname">P</td><td>[in] The central position in the phone context window; normally 1 for triphone system.s </td></tr>
    <tr><td class="paramname">questions_out</td><td>[out] The questions (sets of phones) are output to here. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00541">541</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00198">kaldi::DeletePointers()</a>, <a class="el" href="cluster-utils_8cc_source.html#l00082">kaldi::EnsureClusterableVectorNotNull()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00222">kaldi::FilterStatsByKey()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="cluster-utils_8h_source.html#l00210">TreeClusterOptions::kmeans_cfg</a>, <a class="el" href="context-dep_8h_source.html#l00038">kaldi::kPdfClass</a>, <a class="el" href="cluster-utils_8h_source.html#l00164">ClusterKMeansOptions::num_tries</a>, <a class="el" href="tree_2build-tree_8cc_source.html#l00483">kaldi::ObtainSetsOfPhones()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00198">kaldi::SplitStatsByKey()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00279">kaldi::SumStatsVec()</a>, and <a class="el" href="cluster-utils_8cc_source.html#l01239">kaldi::TreeCluster()</a>.</p>

<p>Referenced by <a class="el" href="cluster-phones_8cc_source.html#l00031">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                                                               {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; phone_sets(phone_sets_in);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  std::vector&lt;int32&gt; phones;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; phone_sets.size() ;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    std::sort(phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].empty())</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Empty phone set in AutomaticallyObtainQuestions&quot;</span>;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Phone set in AutomaticallyObtainQuestions contains duplicate phones&quot;</span>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      phones.push_back(phone_sets[i][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  }</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  std::sort(phones.begin(), phones.end());</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phones))</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Phones are present in more than one phone set.&quot;</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  <span class="keywordflow">if</span> (phones.empty())</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No phones provided.&quot;</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  std::vector&lt;int32&gt; all_pdf_classes(all_pdf_classes_in);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;all_pdf_classes);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!all_pdf_classes.empty());</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <a class="code" href="group__tree__group.html#gab329e7820899feed82ce631806c61975">BuildTreeStatsType</a> retained_stats;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">FilterStatsByKey</a>(stats, <a class="code" href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kPdfClass</a>, all_pdf_classes,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                   <span class="keyword">true</span>,  <span class="comment">// retain only the listed positions</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                   &amp;retained_stats);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordflow">if</span> (retained_stats.size() * 10 &lt; stats.size()) {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    std::ostringstream ss;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; all_pdf_classes.size(); i++)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      ss &lt;&lt; all_pdf_classes[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;After filtering the tree statistics to retain only stats where &quot;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;pdf-class is in the set { &quot;</span> &lt;&lt; ss.str() &lt;&lt; <span class="stringliteral">&quot;}, most of your &quot;</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;stats disappeared: the size changed from &quot;</span> &lt;&lt; stats.size()</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; retained_stats.size() &lt;&lt; <span class="stringliteral">&quot;.  You might be using &quot;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;a nonstandard topology but forgot to modify the &quot;</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;--pdf-class-list option (it defaults to { 1 } which is &quot;</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;the central state in a 3-state left-to-right topology).&quot;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; E.g. a 1-state HMM topology would require the option &quot;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;--pdf-class-list=0.&quot;</span>;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  }</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  std::vector&lt;BuildTreeStatsType&gt; split_stats;  <span class="comment">// split by phone.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <a class="code" href="group__tree__group__lower.html#gaec24b5b9b04af079fd741a4c262fc654">SplitStatsByKey</a>(retained_stats, P, &amp;split_stats);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  std::vector&lt;Clusterable*&gt; summed_stats;  <span class="comment">// summed up by phone.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <a class="code" href="group__tree__group__lower.html#ga8c594556191d0401cf83ebab7bebf068">SumStatsVec</a>(split_stats, &amp;summed_stats);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_phone = phones.back();</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordflow">if</span> (static_cast&lt;int32&gt;(summed_stats.size()) &lt; max_phone+1) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// this can happen if the last phone had no data.. if we are using</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="comment">// stress-marked, position-marked phones, this can happen.  The later</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// code will assume that a summed_stats entry exists for all phones.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    summed_stats.resize(max_phone+1, NULL);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; summed_stats.size(); i++) {  <span class="comment">// A check.</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">if</span> (summed_stats[i] != NULL &amp;&amp;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        !binary_search(phones.begin(), phones.end(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>)) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone &quot;</span>&lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; is present in stats but is not in phone list [make sure you intended this].&quot;</span>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <a class="code" href="group__clustering__group__simple.html#gaf94c6539a2a7130fc9ab220318dcbdd9">EnsureClusterableVectorNotNull</a>(&amp;summed_stats);  <span class="comment">// make sure no NULL pointers in summed_stats.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// will replace them with pointers to empty stats.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  std::vector&lt;Clusterable*&gt; summed_stats_per_set(phone_sets.size(), NULL);  <span class="comment">// summed up by set.</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phone_sets.size(); i++) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;this_set = phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    summed_stats_per_set[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = summed_stats[this_set[0]]-&gt;Copy();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 1; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; this_set.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      summed_stats_per_set[i]-&gt;Add(*(summed_stats[this_set[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]]));</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_no_data = 0;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; summed_stats_per_set.size(); i++) {  <span class="comment">// A check.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">if</span> (summed_stats_per_set[i]-&gt;Normalizer() == 0.0) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      num_no_data++;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      std::ostringstream ss;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;AutomaticallyObtainQuestions: no stats available for phone set: &quot;</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        ss &lt;&lt; phone_sets[i][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] &lt;&lt; <span class="charliteral">&#39; &#39;</span> ;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a>  &lt;&lt; ss.str();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="keywordflow">if</span> (num_no_data + 1 &gt;= summed_stats_per_set.size()) {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    std::ostringstream ss;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; all_pdf_classes.size(); i++)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      ss &lt;&lt; all_pdf_classes[i] &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;All or all but one of your classes of phones had no data. &quot;</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;Note that we only consider data where pdf-class is in the &quot;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;set ( &quot;</span> &lt;&lt; ss.str() &lt;&lt; <span class="stringliteral">&quot;).  If you have an unusual HMM &quot;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;topology this may not be what you want; use the &quot;</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;--pdf-class-list option to change this if needed. See &quot;</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;also any warnings above.&quot;</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  TreeClusterOptions topts;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  topts.kmeans_cfg.num_tries = 10;  <span class="comment">// This is a slow-but-accurate setting,</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// we do it this way since there are typically few phones.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  std::vector&lt;int32&gt; assignments;  <span class="comment">// assignment of phones to clusters. dim == summed_stats.size().</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  std::vector&lt;int32&gt; clust_assignments;  <span class="comment">// Parent of each cluster.  Dim == #clusters.</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_leaves;  <span class="comment">// number of leaf-level clusters.</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="group__clustering__group__algo.html#ga3db30ac1abd5e5908fa28d67f8217e86">TreeCluster</a>(summed_stats_per_set,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;              summed_stats_per_set.size(),  <span class="comment">// max-#clust is all of the points.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;              NULL,  <span class="comment">// don&#39;t need the clusters out.</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;              &amp;assignments,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;              &amp;clust_assignments,</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;              &amp;num_leaves,</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;              topts);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="comment">// process the information obtained by TreeCluster into the</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="comment">// form we want at output.</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <a class="code" href="namespacekaldi.html#adc8295ff9d98ff7af7eabcc34c183a60">ObtainSetsOfPhones</a>(phone_sets,</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                     assignments,</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                     clust_assignments,</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                     num_leaves,</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                     questions_out);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// The memory in summed_stats was newly allocated. [the other algorithms</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// used here do not allocate].</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="code" href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">DeletePointers</a>(&amp;summed_stats);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">DeletePointers</a>(&amp;summed_stats_per_set);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;}</div>
<div class="ttc" id="group__tree__group__lower_html_gafaa380f37e7d222293ac4d6663bdc531"><div class="ttname"><a href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">kaldi::FilterStatsByKey</a></div><div class="ttdeci">void FilterStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; EventValueType &gt; &amp;values, bool include_if_present, BuildTreeStatsType *stats_out)</div><div class="ttdoc">FilterStatsByKey filters the stats according the value of a specified key. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00222">build-tree-utils.cc:222</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_gaec24b5b9b04af079fd741a4c262fc654"><div class="ttname"><a href="group__tree__group__lower.html#gaec24b5b9b04af079fd741a4c262fc654">kaldi::SplitStatsByKey</a></div><div class="ttdeci">void SplitStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; BuildTreeStatsType &gt; *stats_out)</div><div class="ttdoc">SplitStatsByKey splits stats up according to the value of a particular key, which must be always defi...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00198">build-tree-utils.cc:198</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4f60ee3443b23229d5ef766a26c289f9"><div class="ttname"><a href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kaldi::kPdfClass</a></div><div class="ttdeci">static const EventKeyType kPdfClass</div><div class="ttdef"><b>Definition:</b> <a href="context-dep_8h_source.html#l00038">context-dep.h:38</a></div></div>
<div class="ttc" id="group__clustering__group__algo_html_ga3db30ac1abd5e5908fa28d67f8217e86"><div class="ttname"><a href="group__clustering__group__algo.html#ga3db30ac1abd5e5908fa28d67f8217e86">kaldi::TreeCluster</a></div><div class="ttdeci">BaseFloat TreeCluster(const std::vector&lt; Clusterable * &gt; &amp;points, int32 max_clust, std::vector&lt; Clusterable * &gt; *clusters_out, std::vector&lt; int32 &gt; *assignments_out, std::vector&lt; int32 &gt; *clust_assignments_out, int32 *num_leaves_out, TreeClusterOptions cfg)</div><div class="ttdoc">TreeCluster is a top-down clustering algorithm, using a binary tree (not necessarily balanced)...</div><div class="ttdef"><b>Definition:</b> <a href="cluster-utils_8cc_source.html#l01239">cluster-utils.cc:1239</a></div></div>
<div class="ttc" id="group__clustering__group__simple_html_gaf94c6539a2a7130fc9ab220318dcbdd9"><div class="ttname"><a href="group__clustering__group__simple.html#gaf94c6539a2a7130fc9ab220318dcbdd9">kaldi::EnsureClusterableVectorNotNull</a></div><div class="ttdeci">void EnsureClusterableVectorNotNull(std::vector&lt; Clusterable * &gt; *stats)</div><div class="ttdoc">Fills in any (NULL) holes in &quot;stats&quot; vector, with empty stats, because certain algorithms require non...</div><div class="ttdef"><b>Definition:</b> <a href="cluster-utils_8cc_source.html#l00082">cluster-utils.cc:82</a></div></div>
<div class="ttc" id="namespacekaldi_html_adc8295ff9d98ff7af7eabcc34c183a60"><div class="ttname"><a href="namespacekaldi.html#adc8295ff9d98ff7af7eabcc34c183a60">kaldi::ObtainSetsOfPhones</a></div><div class="ttdeci">static void ObtainSetsOfPhones(const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets, const std::vector&lt; int32 &gt; &amp;assignments, const std::vector&lt; int32 &gt; &amp;clust_assignments, int32 num_leaves, std::vector&lt; std::vector&lt; int32 &gt; &gt; *sets_out)</div><div class="ttdoc">ObtainSetsOfPhones is called by AutomaticallyObtainQuestions. </div><div class="ttdef"><b>Definition:</b> <a href="tree_2build-tree_8cc_source.html#l00483">build-tree.cc:483</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga8c594556191d0401cf83ebab7bebf068"><div class="ttname"><a href="group__tree__group__lower.html#ga8c594556191d0401cf83ebab7bebf068">kaldi::SumStatsVec</a></div><div class="ttdeci">void SumStatsVec(const std::vector&lt; BuildTreeStatsType &gt; &amp;stats_in, std::vector&lt; Clusterable * &gt; *stats_out)</div><div class="ttdoc">Sum a vector of stats. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00279">build-tree-utils.cc:279</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__tree__group_html_gab329e7820899feed82ce631806c61975"><div class="ttname"><a href="group__tree__group.html#gab329e7820899feed82ce631806c61975">kaldi::BuildTreeStatsType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventType, Clusterable * &gt; &gt; BuildTreeStatsType</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-questions_8h_source.html#l00032">build-tree-questions.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
<div class="ttc" id="namespacekaldi_html_a93a4038983f8cd71e343b85f1d117cac"><div class="ttname"><a href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">kaldi::DeletePointers</a></div><div class="ttdeci">void DeletePointers(std::vector&lt; A * &gt; *v)</div><div class="ttdoc">Deletes any non-NULL pointers in the vector v, and sets the corresponding entries of v to NULL...</div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00198">stl-utils.h:198</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad6daf95a27b092517d50f0acbcea4b59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EventMap * BuildTree </td>
          <td>(</td>
          <td class="paramtype">Questions &amp;&#160;</td>
          <td class="paramname"><em>qopts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone2num_pdf_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>share_roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>do_split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BuildTreeStatsType &amp;&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_leaves</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>cluster_thresh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>P</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BuildTree is the normal way to build a set of decision trees. </p>
<p>The sets "phone_sets" dictate how we set up the roots of the decision trees. each set of phones phone_sets[i] has shared decision-tree roots, and if the corresponding variable share_roots[i] is true, the root will be shared for the different HMM-positions in the phone. All phones in "phone_sets" should be in the stats (use FixUnseenPhones to ensure this). if for any i, do_split[i] is false, we will not do any tree splitting for phones in that set. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qopts</td><td>[in] <a class="el" href="classkaldi_1_1Questions.html" title="This class defines, for each EventKeyType, a set of initial questions that it tries and also a number...">Questions</a> options class, contains questions for each key (e.g. each phone position) </td></tr>
    <tr><td class="paramname">phone_sets</td><td>[in] Each element of phone_sets is a set of phones whose roots are shared together (prior to decision-tree splitting). </td></tr>
    <tr><td class="paramname">phone2num_pdf_classes</td><td>[in] A map from phones to the number of <a class="el" href="hmm.html#pdf_class">pdf-classes</a> in the phone (this info is derived from the <a class="el" href="classkaldi_1_1HmmTopology.html" title="A class for storing topology information for phones. ">HmmTopology</a> object) </td></tr>
    <tr><td class="paramname">share_roots</td><td>[in] A vector the same size as phone_sets; says for each phone set whether the root should be shared among all the pdf-classes or not. </td></tr>
    <tr><td class="paramname">do_split</td><td>[in] A vector the same size as phone_sets; says for each phone set whether decision-tree splitting should be done (generally true for non-silence phones). </td></tr>
    <tr><td class="paramname">stats</td><td>[in] The statistics used in tree-building. </td></tr>
    <tr><td class="paramname">thresh</td><td>[in] Threshold used in decision-tree splitting (e.g. 1000), or you may use 0 in which case max_leaves becomes the constraint. </td></tr>
    <tr><td class="paramname">max_leaves</td><td>[in] Maximum number of leaves it will create; set this to a large number if you want to just specify "thresh". </td></tr>
    <tr><td class="paramname">cluster_thresh</td><td>[in] Threshold for clustering leaves after decision-tree splitting (only within each phone-set); leaves will be combined if log-likelihood change is less than this. A value about equal to "thresh" is suitable if thresh != 0; otherwise, zero will mean no clustering is done, or a negative value (e.g. -1) sets it to the smallest likelihood change seen during the splitting algorithm; this typically causes about a 20% reduction in the number of leaves.</td></tr>
    <tr><td class="paramname">P</td><td>[in] The central position of the phone context window, e.g. 1 for a triphone system. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to an <a class="el" href="classkaldi_1_1EventMap.html" title="A class that is capable of representing a generic mapping from EventType (which is a vector of (key...">EventMap</a> object that is the tree. </dd></dl>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00135">135</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="build-tree-utils_8cc_source.html#l00840">kaldi::ClusterEventMapRestrictedByMap()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00222">kaldi::FilterStatsByKey()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00865">kaldi::GetStubMap()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00285">kaldi::ObjfGivenMap()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00664">kaldi::RenumberEventMap()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00532">kaldi::SplitDecisionTree()</a>, and <a class="el" href="build-tree-utils_8cc_source.html#l00258">kaldi::SumNormalizer()</a>.</p>

<p>Referenced by <a class="el" href="tree_2build-tree_8cc_source.html#l00313">kaldi::BuildTreeTwoLevel()</a>, <a class="el" href="context-dep_8cc_source.html#l00046">kaldi::GenRandContextDependency()</a>, <a class="el" href="context-dep_8cc_source.html#l00097">kaldi::GenRandContextDependencyLarge()</a>, <a class="el" href="sgmm-build-tree_8cc_source.html#l00032">main()</a>, and <a class="el" href="build-tree-test_8cc_source.html#l00090">kaldi::TestBuildTree()</a>.</p>
<div class="fragment"><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                             {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(thresh &gt; 0 || max_leaves &gt; 0);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(stats.size() != 0);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!phone_sets.empty()</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;         &amp;&amp; phone_sets.size() == share_roots.size()</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;         &amp;&amp; do_split.size() == phone_sets.size());</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// the inputs will be further checked in GetStubMap.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_leaves = 0;  <span class="comment">// allocator for leaves.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  EventMap *tree_stub = <a class="code" href="group__tree__group__intermediate.html#ga7e642ce32f4019c2987e0a168445c1ff">GetStubMap</a>(P,</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                   phone_sets,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                   phone2num_pdf_classes,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                   share_roots,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                   &amp;num_leaves);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;BuildTree: before building trees, map has &quot;</span>&lt;&lt; num_leaves &lt;&lt; <span class="stringliteral">&quot; leaves.&quot;</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> impr;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> smallest_split = 1.0e+10;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  std::vector&lt;int32&gt; nonsplit_phones;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; phone_sets.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (!do_split[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      nonsplit_phones.insert(nonsplit_phones.end(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  std::sort(nonsplit_phones.begin(), nonsplit_phones.end());</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(nonsplit_phones));</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="group__tree__group.html#gab329e7820899feed82ce631806c61975">BuildTreeStatsType</a> filtered_stats;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">FilterStatsByKey</a>(stats, P, nonsplit_phones, <span class="keyword">false</span>,  <span class="comment">// retain only those not</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                   <span class="comment">// in &quot;nonsplit_phones&quot;</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                   &amp;filtered_stats);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  EventMap *tree_split = <a class="code" href="group__tree__group__intermediate.html#gaa4da1fcb3f12d5c116948d37448d9e46">SplitDecisionTree</a>(*tree_stub,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                                           filtered_stats,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                                           qopts, thresh, max_leaves,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                           &amp;num_leaves, &amp;impr, &amp;smallest_split);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (cluster_thresh &lt; 0.0) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;Setting clustering threshold to smallest split &quot;</span> &lt;&lt; smallest_split;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    cluster_thresh = smallest_split;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> normalizer = <a class="code" href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">SumNormalizer</a>(stats),</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      impr_normalized = impr / normalizer,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      normalizer_filt = <a class="code" href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">SumNormalizer</a>(filtered_stats),</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      impr_normalized_filt = impr / normalizer_filt;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt;  <span class="stringliteral">&quot;After decision tree split, num-leaves = &quot;</span> &lt;&lt; num_leaves</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;, like-impr = &quot;</span> &lt;&lt; impr_normalized &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                &lt;&lt; normalizer &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt;  <span class="stringliteral">&quot;Including just phones that were split, improvement is &quot;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                &lt;&lt; impr_normalized_filt &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                &lt;&lt; normalizer_filt &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="keywordflow">if</span> (cluster_thresh != 0.0) {   <span class="comment">// Cluster the tree.</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf_before_cluster = <a class="code" href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">ObjfGivenMap</a>(stats, *tree_split);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// Now do the clustering.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_removed = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    EventMap *tree_clustered = <a class="code" href="group__tree__group__intermediate.html#gaf574b973abbfd92e5c789f7d6821f19f">ClusterEventMapRestrictedByMap</a>(*tree_split,</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                                                              stats,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                                              cluster_thresh,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                              *tree_stub,</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                                                              &amp;num_removed);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;BuildTree: removed &quot;</span>&lt;&lt; num_removed &lt;&lt; <span class="stringliteral">&quot; leaves.&quot;</span>;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_leaves = 0;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    EventMap *tree_renumbered = <a class="code" href="group__tree__group__intermediate.html#gaf37866e2792ecbd810617da2577e41d8">RenumberEventMap</a>(*tree_clustered, &amp;num_leaves);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf_after_cluster = <a class="code" href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">ObjfGivenMap</a>(stats, *tree_renumbered);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Objf change due to clustering &quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  &lt;&lt; ((objf_after_cluster-objf_before_cluster) / normalizer)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; per frame.&quot;</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Normalizing over only split phones, this is: &quot;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                  &lt;&lt; ((objf_after_cluster-objf_before_cluster) / normalizer_filt)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot; per frame.&quot;</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt;  <span class="stringliteral">&quot;Num-leaves is now &quot;</span>&lt;&lt; num_leaves;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">delete</span> tree_clustered;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keyword">delete</span> tree_split;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keyword">delete</span> tree_stub;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">return</span> tree_renumbered;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keyword">delete</span> tree_stub;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> tree_split;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;}</div>
<div class="ttc" id="group__tree__group__lower_html_ga91fda4544d5d5c48363da2bd214c981b"><div class="ttname"><a href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">kaldi::SumNormalizer</a></div><div class="ttdeci">BaseFloat SumNormalizer(const BuildTreeStatsType &amp;stats_in)</div><div class="ttdoc">Sums the normalizer [typically, data-count] over the stats. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00258">build-tree-utils.cc:258</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_gafaa380f37e7d222293ac4d6663bdc531"><div class="ttname"><a href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">kaldi::FilterStatsByKey</a></div><div class="ttdeci">void FilterStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; EventValueType &gt; &amp;values, bool include_if_present, BuildTreeStatsType *stats_out)</div><div class="ttdoc">FilterStatsByKey filters the stats according the value of a specified key. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00222">build-tree-utils.cc:222</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaa4da1fcb3f12d5c116948d37448d9e46"><div class="ttname"><a href="group__tree__group__intermediate.html#gaa4da1fcb3f12d5c116948d37448d9e46">kaldi::SplitDecisionTree</a></div><div class="ttdeci">EventMap * SplitDecisionTree(const EventMap &amp;input_map, const BuildTreeStatsType &amp;stats, Questions &amp;q_opts, BaseFloat thresh, int32 max_leaves, int32 *num_leaves, BaseFloat *obj_impr_out, BaseFloat *smallest_split_change_out)</div><div class="ttdoc">Does a decision-tree split at the leaves of an EventMap. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00532">build-tree-utils.cc:532</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaf37866e2792ecbd810617da2577e41d8"><div class="ttname"><a href="group__tree__group__intermediate.html#gaf37866e2792ecbd810617da2577e41d8">kaldi::RenumberEventMap</a></div><div class="ttdeci">EventMap * RenumberEventMap(const EventMap &amp;e_in, int32 *num_leaves)</div><div class="ttdoc">RenumberEventMap [intended to be used after calling ClusterEventMap] renumbers an EventMap so its lea...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00664">build-tree-utils.cc:664</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga9d8695592350c5d11ae73317d261cd1d"><div class="ttname"><a href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">kaldi::ObjfGivenMap</a></div><div class="ttdeci">BaseFloat ObjfGivenMap(const BuildTreeStatsType &amp;stats_in, const EventMap &amp;e)</div><div class="ttdoc">Cluster the stats given the event map return the total objf given those clusters. ...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00285">build-tree-utils.cc:285</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_ga7e642ce32f4019c2987e0a168445c1ff"><div class="ttname"><a href="group__tree__group__intermediate.html#ga7e642ce32f4019c2987e0a168445c1ff">kaldi::GetStubMap</a></div><div class="ttdeci">EventMap * GetStubMap(int32 P, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets, const std::vector&lt; int32 &gt; &amp;phone2num_pdf_classes, const std::vector&lt; bool &gt; &amp;share_roots, int32 *num_leaves_out)</div><div class="ttdoc">GetStubMap is used in tree-building functions to get the initial to-states map, before the decision-t...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00865">build-tree-utils.cc:865</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
<div class="ttc" id="group__tree__group_html_gab329e7820899feed82ce631806c61975"><div class="ttname"><a href="group__tree__group.html#gab329e7820899feed82ce631806c61975">kaldi::BuildTreeStatsType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventType, Clusterable * &gt; &gt; BuildTreeStatsType</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-questions_8h_source.html#l00032">build-tree-questions.h:32</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaf574b973abbfd92e5c789f7d6821f19f"><div class="ttname"><a href="group__tree__group__intermediate.html#gaf574b973abbfd92e5c789f7d6821f19f">kaldi::ClusterEventMapRestrictedByMap</a></div><div class="ttdeci">EventMap * ClusterEventMapRestrictedByMap(const EventMap &amp;e_in, const BuildTreeStatsType &amp;stats, BaseFloat thresh, const EventMap &amp;e_restrict, int32 *num_removed_ptr)</div><div class="ttdoc">This version of ClusterEventMapRestricted restricts the clustering to only allow things that &quot;e_restr...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00840">build-tree-utils.cc:840</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6e3d5e278c5e5ea8fd366116e2f3bbfe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EventMap * BuildTreeTwoLevel </td>
          <td>(</td>
          <td class="paramtype">Questions &amp;&#160;</td>
          <td class="paramname"><em>qopts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone2num_pdf_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>share_roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>do_split</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const BuildTreeStatsType &amp;&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_leaves_first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>max_leaves_second</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>cluster_leaves</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>leaf_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>BuildTreeTwoLevel builds a two-level tree, useful for example in building tied mixture systems with multiple codebooks. </p>
<p>It first builds a small tree by splitting to "max_leaves_first". It then splits at the leaves of "max_leaves_first" (think of this as creating multiple little trees at the leaves of the first tree), until the total number of leaves reaches "max_leaves_second". It then outputs the second tree, along with a mapping from the leaf-ids of the second tree to the leaf-ids of the first tree. Note that the interface is similar to BuildTree, and in fact it calls BuildTree internally.</p>
<p>The sets "phone_sets" dictate how we set up the roots of the decision trees. each set of phones phone_sets[i] has shared decision-tree roots, and if the corresponding variable share_roots[i] is true, the root will be shared for the different HMM-positions in the phone. All phones in "phone_sets" should be in the stats (use FixUnseenPhones to ensure this). if for any i, do_split[i] is false, we will not do any tree splitting for phones in that set.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">qopts</td><td>[in] <a class="el" href="classkaldi_1_1Questions.html" title="This class defines, for each EventKeyType, a set of initial questions that it tries and also a number...">Questions</a> options class, contains questions for each key (e.g. each phone position) </td></tr>
    <tr><td class="paramname">phone_sets</td><td>[in] Each element of phone_sets is a set of phones whose roots are shared together (prior to decision-tree splitting). </td></tr>
    <tr><td class="paramname">phone2num_pdf_classes</td><td>[in] A map from phones to the number of <a class="el" href="hmm.html#pdf_class">pdf-classes</a> in the phone (this info is derived from the <a class="el" href="classkaldi_1_1HmmTopology.html" title="A class for storing topology information for phones. ">HmmTopology</a> object) </td></tr>
    <tr><td class="paramname">share_roots</td><td>[in] A vector the same size as phone_sets; says for each phone set whether the root should be shared among all the pdf-classes or not. </td></tr>
    <tr><td class="paramname">do_split</td><td>[in] A vector the same size as phone_sets; says for each phone set whether decision-tree splitting should be done (generally true for non-silence phones). </td></tr>
    <tr><td class="paramname">stats</td><td>[in] The statistics used in tree-building. </td></tr>
    <tr><td class="paramname">max_leaves_first</td><td>[in] Maximum number of leaves it will create in first level of decision tree. </td></tr>
    <tr><td class="paramname">max_leaves_second</td><td>[in] Maximum number of leaves it will create in second level of decision tree. Must be &gt; max_leaves_first. </td></tr>
    <tr><td class="paramname">cluster_leaves</td><td>[in] Boolean value; if true, we post-cluster the leaves produced in the second level of decision-tree split; if false, we don't. The threshold for post-clustering is the log-like change of the last decision-tree split; this typically causes about a 20% reduction in the number of leaves. </td></tr>
    <tr><td class="paramname">P</td><td>[in] The central position of the phone context window, e.g. 1 for a triphone system. </td></tr>
    <tr><td class="paramname">leaf_map</td><td>[out] Will be set to be a mapping from the leaves of the "big" tree to the leaves of the "little" tree, which you can view as cluster centers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns a pointer to an <a class="el" href="classkaldi_1_1EventMap.html" title="A class that is capable of representing a generic mapping from EventType (which is a vector of (key...">EventMap</a> object that is the (big) tree. </dd></dl>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00313">313</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="tree_2build-tree_8cc_source.html#l00135">kaldi::BuildTree()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00840">kaldi::ClusterEventMapRestrictedByMap()</a>, <a class="el" href="tree_2build-tree_8cc_source.html#l00246">kaldi::ComputeTreeMapping()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00222">kaldi::FilterStatsByKey()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00689">kaldi::MapEventMapLeaves()</a>, <a class="el" href="event-map_8h_source.html#l00142">EventMap::MaxResult()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00285">kaldi::ObjfGivenMap()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00664">kaldi::RenumberEventMap()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00532">kaldi::SplitDecisionTree()</a>, and <a class="el" href="build-tree-utils_8cc_source.html#l00258">kaldi::SumNormalizer()</a>.</p>

<p>Referenced by <a class="el" href="build-tree-two-level_8cc_source.html#l00053">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                                        {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;****BuildTreeTwoLevel: building first level tree&quot;</span>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  EventMap *first_level_tree = <a class="code" href="group__tree__group__top.html#gad6daf95a27b092517d50f0acbcea4b59">BuildTree</a>(qopts, phone_sets,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                         phone2num_pdf_classes,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                         share_roots, do_split, stats, 0.0,</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                         max_leaves_first, 0.0, P);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(first_level_tree != NULL);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;****BuildTreeTwoLevel: done building first level tree&quot;</span>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  std::vector&lt;int32&gt; nonsplit_phones;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; phone_sets.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (!do_split[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>])</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      nonsplit_phones.insert(nonsplit_phones.end(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  std::sort(nonsplit_phones.begin(), nonsplit_phones.end());</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(nonsplit_phones));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="group__tree__group.html#gab329e7820899feed82ce631806c61975">BuildTreeStatsType</a> filtered_stats;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <a class="code" href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">FilterStatsByKey</a>(stats, P, nonsplit_phones, <span class="keyword">false</span>,  <span class="comment">// retain only those not</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                   <span class="comment">// in &quot;nonsplit_phones&quot;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                   &amp;filtered_stats);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_leaves = first_level_tree-&gt;MaxResult() + 1,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      old_num_leaves = num_leaves;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> smallest_split = 0.0;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> impr;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  EventMap *tree = <a class="code" href="group__tree__group__intermediate.html#gaa4da1fcb3f12d5c116948d37448d9e46">SplitDecisionTree</a>(*first_level_tree,</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                     filtered_stats,</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                     qopts, 0.0, max_leaves_second,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                     &amp;num_leaves, &amp;impr, &amp;smallest_split);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Building second-level tree: increased #leaves from &quot;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            &lt;&lt; old_num_leaves &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; num_leaves &lt;&lt; <span class="stringliteral">&quot;, smallest split was &quot;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            &lt;&lt; smallest_split;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> normalizer = <a class="code" href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">SumNormalizer</a>(stats),</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      impr_normalized = impr / normalizer;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;After second decision tree split, num-leaves = &quot;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            &lt;&lt; num_leaves &lt;&lt; <span class="stringliteral">&quot;, like-impr = &quot;</span> &lt;&lt; impr_normalized</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            &lt;&lt; <span class="stringliteral">&quot; per frame over &quot;</span> &lt;&lt; normalizer &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keywordflow">if</span> (cluster_leaves) {  <span class="comment">// Cluster the leaves of the tree.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Clustering leaves of larger tree.&quot;</span>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf_before_cluster = <a class="code" href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">ObjfGivenMap</a>(stats, *tree);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Now do the clustering.</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_removed = 0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    EventMap *tree_clustered = <a class="code" href="group__tree__group__intermediate.html#gaf574b973abbfd92e5c789f7d6821f19f">ClusterEventMapRestrictedByMap</a>(*tree,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                                              stats,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                              smallest_split,</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                              *first_level_tree,</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                              &amp;num_removed);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;BuildTreeTwoLevel: removed &quot;</span> &lt;&lt; num_removed &lt;&lt; <span class="stringliteral">&quot; leaves.&quot;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_leaves = 0;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    EventMap *tree_renumbered = <a class="code" href="group__tree__group__intermediate.html#gaf37866e2792ecbd810617da2577e41d8">RenumberEventMap</a>(*tree_clustered, &amp;num_leaves);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf_after_cluster = <a class="code" href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">ObjfGivenMap</a>(stats, *tree_renumbered);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Objf change due to clustering &quot;</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;              &lt;&lt; ((objf_after_cluster-objf_before_cluster) / <a class="code" href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">SumNormalizer</a>(stats))</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;              &lt;&lt; <span class="stringliteral">&quot; per frame.&quot;</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt;  <span class="stringliteral">&quot;Num-leaves now &quot;</span>&lt;&lt; num_leaves;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">delete</span> tree;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">delete</span> tree_clustered;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    tree = tree_renumbered;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="namespacekaldi.html#a64ddf201945fb196f6594ea21e1ca7e4">ComputeTreeMapping</a>(*first_level_tree,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                     *tree,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                     stats,</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                     leaf_map);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  { <span class="comment">// Next do another renumbering of &quot;tree&quot; so that leaves with the</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// same value in &quot;first_level_tree&quot; are contiguous.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    std::vector&lt;std::pair&lt;int32, int32&gt; &gt; leaf_pairs;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; leaf_map-&gt;size(); i++)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      leaf_pairs.push_back(std::make_pair((*leaf_map)[i], static_cast&lt;int32&gt;(i)));</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// pair of (small-tree-number, big-tree-number).</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    std::sort(leaf_pairs.begin(), leaf_pairs.end());</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    std::vector&lt;int32&gt; old2new_map(leaf_map-&gt;size()),</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        new_leaf_map(leaf_map-&gt;size());</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// Note: old2new_map maps from old indices to new indices, in the</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// renumbering; new_leaf_map maps from 2nd-level tree indices to</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// 1st-level tree indices.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; leaf_pairs.size(); i++) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> old_number = leaf_pairs[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second, new_number = <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      old2new_map[old_number] = new_number;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      new_leaf_map[new_number] = (*leaf_map)[old_number];</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    *leaf_map = new_leaf_map;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    EventMap *renumbered_tree = <a class="code" href="group__tree__group__intermediate.html#ga9de82568c2869cba7854e3c954d905cd">MapEventMapLeaves</a>(*tree, old2new_map);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keyword">delete</span> tree;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    tree = renumbered_tree;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  }</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">delete</span> first_level_tree;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">return</span> tree;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;}</div>
<div class="ttc" id="group__tree__group__lower_html_ga91fda4544d5d5c48363da2bd214c981b"><div class="ttname"><a href="group__tree__group__lower.html#ga91fda4544d5d5c48363da2bd214c981b">kaldi::SumNormalizer</a></div><div class="ttdeci">BaseFloat SumNormalizer(const BuildTreeStatsType &amp;stats_in)</div><div class="ttdoc">Sums the normalizer [typically, data-count] over the stats. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00258">build-tree-utils.cc:258</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_gafaa380f37e7d222293ac4d6663bdc531"><div class="ttname"><a href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">kaldi::FilterStatsByKey</a></div><div class="ttdeci">void FilterStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; EventValueType &gt; &amp;values, bool include_if_present, BuildTreeStatsType *stats_out)</div><div class="ttdoc">FilterStatsByKey filters the stats according the value of a specified key. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00222">build-tree-utils.cc:222</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaa4da1fcb3f12d5c116948d37448d9e46"><div class="ttname"><a href="group__tree__group__intermediate.html#gaa4da1fcb3f12d5c116948d37448d9e46">kaldi::SplitDecisionTree</a></div><div class="ttdeci">EventMap * SplitDecisionTree(const EventMap &amp;input_map, const BuildTreeStatsType &amp;stats, Questions &amp;q_opts, BaseFloat thresh, int32 max_leaves, int32 *num_leaves, BaseFloat *obj_impr_out, BaseFloat *smallest_split_change_out)</div><div class="ttdoc">Does a decision-tree split at the leaves of an EventMap. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00532">build-tree-utils.cc:532</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaf37866e2792ecbd810617da2577e41d8"><div class="ttname"><a href="group__tree__group__intermediate.html#gaf37866e2792ecbd810617da2577e41d8">kaldi::RenumberEventMap</a></div><div class="ttdeci">EventMap * RenumberEventMap(const EventMap &amp;e_in, int32 *num_leaves)</div><div class="ttdoc">RenumberEventMap [intended to be used after calling ClusterEventMap] renumbers an EventMap so its lea...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00664">build-tree-utils.cc:664</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_ga9de82568c2869cba7854e3c954d905cd"><div class="ttname"><a href="group__tree__group__intermediate.html#ga9de82568c2869cba7854e3c954d905cd">kaldi::MapEventMapLeaves</a></div><div class="ttdeci">EventMap * MapEventMapLeaves(const EventMap &amp;e_in, const std::vector&lt; int32 &gt; &amp;mapping_in)</div><div class="ttdoc">This function remaps the event-map leaves using this mapping, indexed by the number at leaf...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00689">build-tree-utils.cc:689</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga9d8695592350c5d11ae73317d261cd1d"><div class="ttname"><a href="group__tree__group__lower.html#ga9d8695592350c5d11ae73317d261cd1d">kaldi::ObjfGivenMap</a></div><div class="ttdeci">BaseFloat ObjfGivenMap(const BuildTreeStatsType &amp;stats_in, const EventMap &amp;e)</div><div class="ttdoc">Cluster the stats given the event map return the total objf given those clusters. ...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00285">build-tree-utils.cc:285</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a64ddf201945fb196f6594ea21e1ca7e4"><div class="ttname"><a href="namespacekaldi.html#a64ddf201945fb196f6594ea21e1ca7e4">kaldi::ComputeTreeMapping</a></div><div class="ttdeci">static void ComputeTreeMapping(const EventMap &amp;small_tree, const EventMap &amp;big_tree, const BuildTreeStatsType &amp;stats, std::vector&lt; int32 &gt; *leaf_map)</div><div class="ttdef"><b>Definition:</b> <a href="tree_2build-tree_8cc_source.html#l00246">build-tree.cc:246</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__tree__group_html_gab329e7820899feed82ce631806c61975"><div class="ttname"><a href="group__tree__group.html#gab329e7820899feed82ce631806c61975">kaldi::BuildTreeStatsType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventType, Clusterable * &gt; &gt; BuildTreeStatsType</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-questions_8h_source.html#l00032">build-tree-questions.h:32</a></div></div>
<div class="ttc" id="group__tree__group__intermediate_html_gaf574b973abbfd92e5c789f7d6821f19f"><div class="ttname"><a href="group__tree__group__intermediate.html#gaf574b973abbfd92e5c789f7d6821f19f">kaldi::ClusterEventMapRestrictedByMap</a></div><div class="ttdeci">EventMap * ClusterEventMapRestrictedByMap(const EventMap &amp;e_in, const BuildTreeStatsType &amp;stats, BaseFloat thresh, const EventMap &amp;e_restrict, int32 *num_removed_ptr)</div><div class="ttdoc">This version of ClusterEventMapRestricted restricts the clustering to only allow things that &quot;e_restr...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00840">build-tree-utils.cc:840</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="group__tree__group__top_html_gad6daf95a27b092517d50f0acbcea4b59"><div class="ttname"><a href="group__tree__group__top.html#gad6daf95a27b092517d50f0acbcea4b59">kaldi::BuildTree</a></div><div class="ttdeci">EventMap * BuildTree(Questions &amp;qopts, const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;phone_sets, const std::vector&lt; int32 &gt; &amp;phone2num_pdf_classes, const std::vector&lt; bool &gt; &amp;share_roots, const std::vector&lt; bool &gt; &amp;do_split, const BuildTreeStatsType &amp;stats, BaseFloat thresh, int32 max_leaves, BaseFloat cluster_thresh, int32 P)</div><div class="ttdoc">BuildTree is the normal way to build a set of decision trees. </div><div class="ttdef"><b>Definition:</b> <a href="tree_2build-tree_8cc_source.html#l00135">build-tree.cc:135</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga19b3aa6660f3589b4a6017dd5b37eb5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenRandStats </td>
          <td>(</td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_ids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>hmm_lengths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>is_ctx_dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>ensure_all_phones_covered</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BuildTreeStatsType *&#160;</td>
          <td class="paramname"><em>stats_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GenRandStats generates random statistics of the form used by BuildTree. </p>
<p>It tries to do so in such a way that they mimic "real" stats. The event keys and their corresponding values are:</p>
<ul>
<li>key == -1 == kPdfClass -&gt; pdf-class, generally corresponds to zero-based position in HMM (0, 1, 2 .. hmm_lengths[phone]-1)</li>
<li>key == 0 -&gt; phone-id of left-most context phone.</li>
<li>key == 1 -&gt; phone-id of one-from-left-most context phone.</li>
<li>key == P-1 -&gt; phone-id of central phone.</li>
<li>key == N-1 -&gt; phone-id of right-most context phone. GenRandStats is useful only for testing but it serves to document the format of stats used by BuildTreeDefault. if is_ctx_dep[phone] is set to false, GenRandStats will not define the keys for other than the P-1'th phone. <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dim</td><td>[in] dimension of features. </td></tr>
    <tr><td class="paramname">num_stats</td><td>[in] approximate number of separate phones-in-context wanted. </td></tr>
    <tr><td class="paramname">N</td><td>[in] context-size (typically 3) </td></tr>
    <tr><td class="paramname">P</td><td>[in] central-phone position in zero-based numbering (typically 1) </td></tr>
    <tr><td class="paramname">phone_ids</td><td>[in] integer ids of phones </td></tr>
    <tr><td class="paramname">hmm_lengths</td><td>[in] lengths of hmm for phone, indexed by phone. </td></tr>
    <tr><td class="paramname">is_ctx_dep</td><td>[in] boolean array indexed by phone, saying whether each phone is context dependent. </td></tr>
    <tr><td class="paramname">ensure_all_phones_covered</td><td>[in] Boolean argument: if true, GenRandStats ensures that every phone is seen at least once in the central position (P). </td></tr>
    <tr><td class="paramname">stats_out</td><td>[out] The statistics that this routine outputs. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00029">29</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="clusterable-classes_8cc_source.html#l00137">GaussClusterable::AddStats()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l01017">VectorBase&lt; Real &gt;::AddVec()</a>, <a class="el" href="stl-utils_8h_source.html#l00126">kaldi::CopyMapToVector()</a>, <a class="el" href="arpa-file-parser-test_8cc_source.html#l00065">count</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00064">rnnlm::d</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="context-dep_8h_source.html#l00038">kaldi::kPdfClass</a>, <a class="el" href="kaldi-math_8cc_source.html#l00045">kaldi::Rand()</a>, <a class="el" href="kaldi-math_8h_source.html#l00155">kaldi::RandGauss()</a>, <a class="el" href="kaldi-math_8h_source.html#l00151">kaldi::RandUniform()</a>, <a class="el" href="kaldi-matrix_8h_source.html#l00182">MatrixBase&lt; Real &gt;::Row()</a>, <a class="el" href="kaldi-vector_8cc_source.html#l00936">VectorBase&lt; Real &gt;::Scale()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, and <a class="el" href="kaldi-vector_8cc_source.html#l00680">VectorBase&lt; Real &gt;::Sum()</a>.</p>

<p>Referenced by <a class="el" href="context-dep_8cc_source.html#l00046">kaldi::GenRandContextDependency()</a>, <a class="el" href="context-dep_8cc_source.html#l00097">kaldi::GenRandContextDependencyLarge()</a>, <a class="el" href="build-tree-test_8cc_source.html#l00090">kaldi::TestBuildTree()</a>, and <a class="el" href="build-tree-test_8cc_source.html#l00025">kaldi::TestGenRandStats()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                 {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(dim &gt; 0);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_stats &gt; 0);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(N &gt; 0);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(P &lt; N);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(phone_ids.size() != 0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(stats_out != NULL &amp;&amp; stats_out-&gt;empty());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_phone = *std::max_element(phone_ids.begin(), phone_ids.end());</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(phone2hmm_length.size() &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(1 + max_phone));</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(is_ctx_dep.size() &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(1 + max_phone));</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">// Make sure phone id&#39;s distinct.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    std::vector&lt;int32&gt; tmp(phone_ids);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;tmp);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(tmp.size() == phone_ids.size());</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  }</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">size_t</span> num_phones = phone_ids.size();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="comment">// Decide on an underlying &quot;mean&quot; for phones...</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  Matrix&lt;BaseFloat&gt; phone_vecs(max_phone+1, dim);</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; max_phone+1;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0;<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; dim;<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) phone_vecs(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) = <a class="code" href="namespacekaldi.html#a3871a9c94a69d8807ea4c1d94e2d4ab9">RandGauss</a>() * (2.0 / (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>+1));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  std::map&lt;EventType, Clusterable*&gt; stats_tmp;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  std::vector&lt;bool&gt; covered(1 + max_phone, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">bool</span> all_covered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; num_stats || (ensure_all_phones_covered &amp;&amp; !all_covered);<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// decide randomly on a phone-in-context.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    std::vector&lt;int32&gt; phone_vec(N);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; (size_t)N;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) phone_vec[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = phone_ids[(<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % num_phones)];</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> hmm_length = phone2hmm_length[phone_vec[P]];</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(hmm_length &gt; 0);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    covered[phone_vec[P]] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// For each position [in the central phone]...</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; hmm_length; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">// create event vector.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <a class="code" href="namespacekaldi.html#ad52ff1019e01de1ec06a179d33d3768a">EventType</a> event_vec;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      event_vec.push_back(std::make_pair(<a class="code" href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kPdfClass</a>, (<a class="code" href="namespacekaldi.html#a568b789a0df90eb2b79de13c95133b1b">EventValueType</a>)<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>));  <span class="comment">// record the position.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> pos = 0; pos &lt; (size_t)N; pos++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="keywordflow">if</span> (pos == (<span class="keywordtype">size_t</span>)(P) || is_ctx_dep[phone_vec[P]])</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;          event_vec.push_back(std::make_pair((<a class="code" href="namespacekaldi.html#aecf39f5f52172bb00dbbe738ca2d7d51">EventKeyType</a>)pos, (<a class="code" href="namespacekaldi.html#a568b789a0df90eb2b79de13c95133b1b">EventValueType</a>)phone_vec[pos]));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// The if-statement above ensures we do not record the context of &quot;context-free&quot;</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// phone (e.g., silence).</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      Vector&lt;BaseFloat&gt; mean(dim);  <span class="comment">// mean of Gaussian.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      GaussClusterable *this_stats = <span class="keyword">new</span> GaussClusterable(dim, 0.1);  <span class="comment">// 0.1 is var floor.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      {  <span class="comment">// compute stats; this block attempts to simulate the process of &quot;real&quot; data</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// collection and does not correspond to any code you would write in a real</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="comment">// scenario.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        Vector&lt;BaseFloat&gt; weights(N);  <span class="comment">// weight of each component.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; N; k++) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;          <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> k_pos = (N - 0.5 - k) / N;  <span class="comment">// between 0 and 1, less for lower k...</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> j_pos = (hmm_length - 0.5 - <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>) / hmm_length;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          <span class="comment">// j_pos is between 0 and 1, less for lower j.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> weight = j_pos*k_pos + (1.0-j_pos)*(1.0-k_pos);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;          <span class="comment">// if j_pos close to zero, gives larger weight to k_pos close</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;          <span class="comment">// to zero.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;          <span class="keywordflow">if</span> (k == P) weight += 1.0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;          weights(k) = weight;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(weights.Sum() != 0);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        weights.Scale(1.0 / weights.Sum());</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> k = 0; k &lt; N; k++)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          mean.AddVec(weights(k), phone_vecs.Row(phone_vec[k]));</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">Rand</a>() % 2 == 0) count = 1000.0 * <a class="code" href="namespacekaldi.html#a0c4bcfc10bea5ed0d3e3cf6d74922121">RandUniform</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">else</span> count = 100.0 * <a class="code" href="namespacekaldi.html#a0c4bcfc10bea5ed0d3e3cf6d74922121">RandUniform</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_samples = 10;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> p = 0;p &lt; (size_t)num_samples; p++) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          Vector&lt;BaseFloat&gt; sample(mean);  <span class="comment">// copy mean.</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> = 0; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a> &lt; (size_t)dim; <a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>++)  sample(<a class="code" href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">d</a>) += <a class="code" href="namespacekaldi.html#a3871a9c94a69d8807ea4c1d94e2d4ab9">RandGauss</a>();  <span class="comment">// unit var.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          this_stats-&gt;AddStats(sample, count / num_samples);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span> (stats_tmp.count(event_vec) != 0) {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        stats_tmp[event_vec]-&gt;Add(*this_stats);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">delete</span> this_stats;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        stats_tmp[event_vec] = this_stats;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    all_covered = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt; num_phones; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) <span class="keywordflow">if</span> (!covered[phone_ids[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]]) all_covered = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="namespacekaldi.html#ae01a86880f554776e9c53afc7f6cb8aa">CopyMapToVector</a>(stats_tmp, stats_out);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(stats_out-&gt;size() &gt; 0);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_a0c4bcfc10bea5ed0d3e3cf6d74922121"><div class="ttname"><a href="namespacekaldi.html#a0c4bcfc10bea5ed0d3e3cf6d74922121">kaldi::RandUniform</a></div><div class="ttdeci">float RandUniform(struct RandomState *state=NULL)</div><div class="ttdoc">Returns a random number strictly between 0 and 1. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00151">kaldi-math.h:151</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3871a9c94a69d8807ea4c1d94e2d4ab9"><div class="ttname"><a href="namespacekaldi.html#a3871a9c94a69d8807ea4c1d94e2d4ab9">kaldi::RandGauss</a></div><div class="ttdeci">float RandGauss(struct RandomState *state=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8h_source.html#l00155">kaldi-math.h:155</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4f60ee3443b23229d5ef766a26c289f9"><div class="ttname"><a href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kaldi::kPdfClass</a></div><div class="ttdeci">static const EventKeyType kPdfClass</div><div class="ttdef"><b>Definition:</b> <a href="context-dep_8h_source.html#l00038">context-dep.h:38</a></div></div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_a951345011b75d2e8d9bfc18ca63510d2"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a></div><div class="ttdeci">const size_t count</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00065">arpa-file-parser-test.cc:65</a></div></div>
<div class="ttc" id="namespacekaldi_html_ad52ff1019e01de1ec06a179d33d3768a"><div class="ttname"><a href="namespacekaldi.html#ad52ff1019e01de1ec06a179d33d3768a">kaldi::EventType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventKeyType, EventValueType &gt; &gt; EventType</div><div class="ttdef"><b>Definition:</b> <a href="event-map_8h_source.html#l00058">event-map.h:58</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_aecf39f5f52172bb00dbbe738ca2d7d51"><div class="ttname"><a href="namespacekaldi.html#aecf39f5f52172bb00dbbe738ca2d7d51">kaldi::EventKeyType</a></div><div class="ttdeci">int32 EventKeyType</div><div class="ttdoc">Things of type EventKeyType can take any value. </div><div class="ttdef"><b>Definition:</b> <a href="event-map_8h_source.html#l00045">event-map.h:45</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a70777edd81d4056098f79b9cd3bffb8b"><div class="ttname"><a href="namespacekaldi.html#a70777edd81d4056098f79b9cd3bffb8b">kaldi::Rand</a></div><div class="ttdeci">int Rand(struct RandomState *state)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-math_8cc_source.html#l00045">kaldi-math.cc:45</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a568b789a0df90eb2b79de13c95133b1b"><div class="ttname"><a href="namespacekaldi.html#a568b789a0df90eb2b79de13c95133b1b">kaldi::EventValueType</a></div><div class="ttdeci">int32 EventValueType</div><div class="ttdoc">Given current code, things of type EventValueType should generally be nonnegative and in a reasonably...</div><div class="ttdef"><b>Definition:</b> <a href="event-map_8h_source.html#l00051">event-map.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_ae01a86880f554776e9c53afc7f6cb8aa"><div class="ttname"><a href="namespacekaldi.html#ae01a86880f554776e9c53afc7f6cb8aa">kaldi::CopyMapToVector</a></div><div class="ttdeci">void CopyMapToVector(const std::map&lt; A, B &gt; &amp;m, std::vector&lt; std::pair&lt; A, B &gt; &gt; *v)</div><div class="ttdoc">Copies the (key, value) pairs in a map to a vector of pairs. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00126">stl-utils.h:126</a></div></div>
<div class="ttc" id="namespacernnlm_html_a873684cefeb665f3d5e6b495de57fc0d"><div class="ttname"><a href="namespacernnlm.html#a873684cefeb665f3d5e6b495de57fc0d">rnnlm::d</a></div><div class="ttdeci">double d</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00064">mikolov-rnnlm-lib.cc:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf850d66e74ce4fc64fd26fe193bdd156"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void KMeansClusterPhones </td>
          <td>(</td>
          <td class="paramtype">BuildTreeStatsType &amp;&#160;</td>
          <td class="paramname"><em>stats</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; int32 &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_sets_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>all_pdf_classes_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_classes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>sets_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function clusters the phones (or some initially specified sets of phones) into sets of phones, using a k-means algorithm. </p>
<p>Useful, for example, in building simple models for purposes of adaptation. </p>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00674">674</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="cluster-utils_8cc_source.html#l00985">kaldi::ClusterKMeans()</a>, <a class="el" href="arpa-file-parser-test_8cc_source.html#l00065">count</a>, <a class="el" href="stl-utils_8h_source.html#l00198">kaldi::DeletePointers()</a>, <a class="el" href="cluster-utils_8cc_source.html#l00082">kaldi::EnsureClusterableVectorNotNull()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00222">kaldi::FilterStatsByKey()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="context-dep_8h_source.html#l00038">kaldi::kPdfClass</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="build-tree-utils_8cc_source.html#l00198">kaldi::SplitStatsByKey()</a>, <a class="el" href="cluster-utils_8cc_source.html#l00054">kaldi::SumClusterableNormalizer()</a>, and <a class="el" href="build-tree-utils_8cc_source.html#l00279">kaldi::SumStatsVec()</a>.</p>

<p>Referenced by <a class="el" href="cluster-phones_8cc_source.html#l00031">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                                                 {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; phone_sets(phone_sets_in);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  std::vector&lt;int32&gt; phones;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; phone_sets.size() ;<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    std::sort(phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].empty())</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Empty phone set in AutomaticallyObtainQuestions&quot;</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]))</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Phone set in AutomaticallyObtainQuestions contains duplicate phones&quot;</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      phones.push_back(phone_sets[i][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  std::sort(phones.begin(), phones.end());</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phones))</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Phones are present in more than one phone set.&quot;</span>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordflow">if</span> (phones.empty())</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;No phones provided.&quot;</span>;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  std::vector&lt;int32&gt; all_pdf_classes(all_pdf_classes_in);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(&amp;all_pdf_classes);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!all_pdf_classes.empty());</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="group__tree__group.html#gab329e7820899feed82ce631806c61975">BuildTreeStatsType</a> retained_stats;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  <a class="code" href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">FilterStatsByKey</a>(stats, <a class="code" href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kPdfClass</a>, all_pdf_classes,</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                   <span class="keyword">true</span>,  <span class="comment">// retain only the listed positions</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                   &amp;retained_stats);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  std::vector&lt;BuildTreeStatsType&gt; split_stats;  <span class="comment">// split by phone.</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="group__tree__group__lower.html#gaec24b5b9b04af079fd741a4c262fc654">SplitStatsByKey</a>(retained_stats, P, &amp;split_stats);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  std::vector&lt;Clusterable*&gt; summed_stats;  <span class="comment">// summed up by phone.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <a class="code" href="group__tree__group__lower.html#ga8c594556191d0401cf83ebab7bebf068">SumStatsVec</a>(split_stats, &amp;summed_stats);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_phone = phones.back();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="keywordflow">if</span> (static_cast&lt;int32&gt;(summed_stats.size()) &lt; max_phone+1) {</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// this can happen if the last phone had no data.. if we are using</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// stress-marked, position-marked phones, this can happen.  The later</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// code will assume that a summed_stats entry exists for all phones.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    summed_stats.resize(max_phone+1, NULL);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0; <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>) &lt; summed_stats.size(); i++) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="comment">// just a check.</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">if</span> (summed_stats[i] != NULL &amp;&amp;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        !binary_search(phones.begin(), phones.end(), <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>)) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Phone &quot;</span>&lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; is present in stats but is not in phone list [make sure you intended this].&quot;</span>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="group__clustering__group__simple.html#gaf94c6539a2a7130fc9ab220318dcbdd9">EnsureClusterableVectorNotNull</a>(&amp;summed_stats);  <span class="comment">// make sure no NULL pointers in summed_stats.</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// will replace them with pointers to empty stats.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  std::vector&lt;Clusterable*&gt; summed_stats_per_set(phone_sets.size(), NULL);  <span class="comment">// summed up by set.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phone_sets.size(); i++) {</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;this_set = phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    summed_stats_per_set[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = summed_stats[this_set[0]]-&gt;Copy();</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 1; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; this_set.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      summed_stats_per_set[i]-&gt;Add(*(summed_stats[this_set[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]]));</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; summed_stats_per_set.size(); i++) {  <span class="comment">// A check.</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (summed_stats_per_set[i]-&gt;Normalizer() == 0.0) {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      std::ostringstream ss;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;AutomaticallyObtainQuestions: no stats available for phone set: &quot;</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        ss &lt;&lt; phone_sets[i][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] &lt;&lt; <span class="charliteral">&#39; &#39;</span> ;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a>  &lt;&lt; ss.str();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  }</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  ClusterKMeansOptions opts;  <span class="comment">// Just using the default options which are a reasonable</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="comment">// compromise between speed and accuracy.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  std::vector&lt;int32&gt; assignments;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> objf_impr = <a class="code" href="group__clustering__group__algo.html#ga0d42ece3910ff042d1df1cc448a420dc">ClusterKMeans</a>(summed_stats_per_set,</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                      num_classes,</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                      NULL,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                      &amp;assignments,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                      opts);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a> = <a class="code" href="group__clustering__group__simple.html#gab13a71ba2459d0dab7158bed4cc0c446">SumClusterableNormalizer</a>(summed_stats_per_set);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;ClusterKMeans: objf change from clustering [versus single set] is &quot;</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            &lt;&lt; (objf_impr/<a class="code" href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a>) &lt;&lt; <span class="stringliteral">&quot; over &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; frames.&quot;</span>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  sets_out-&gt;resize(num_classes);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(assignments.size() == phone_sets.size());</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; assignments.size(); i++) {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> class_idx = assignments[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(class_idx) &lt; sets_out-&gt;size());</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; phone_sets[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      (*sets_out)[class_idx].push_back(phone_sets[i][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>]);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; sets_out-&gt;size(); i++) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    std::sort( (*sets_out)[i].begin(), (*sets_out)[i].end() );  <span class="comment">// just good</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// practice to have them sorted as who knows if whatever we need them for</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="comment">// will require sorting...</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>( (*sets_out)[i] ));</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">DeletePointers</a>(&amp;summed_stats);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">DeletePointers</a>(&amp;summed_stats_per_set);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;}</div>
<div class="ttc" id="group__tree__group__lower_html_gafaa380f37e7d222293ac4d6663bdc531"><div class="ttname"><a href="group__tree__group__lower.html#gafaa380f37e7d222293ac4d6663bdc531">kaldi::FilterStatsByKey</a></div><div class="ttdeci">void FilterStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; EventValueType &gt; &amp;values, bool include_if_present, BuildTreeStatsType *stats_out)</div><div class="ttdoc">FilterStatsByKey filters the stats according the value of a specified key. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00222">build-tree-utils.cc:222</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__clustering__group__simple_html_gab13a71ba2459d0dab7158bed4cc0c446"><div class="ttname"><a href="group__clustering__group__simple.html#gab13a71ba2459d0dab7158bed4cc0c446">kaldi::SumClusterableNormalizer</a></div><div class="ttdeci">BaseFloat SumClusterableNormalizer(const std::vector&lt; Clusterable * &gt; &amp;vec)</div><div class="ttdoc">Returns the total normalizer (usually count) of the cluster (pointers may be NULL). </div><div class="ttdef"><b>Definition:</b> <a href="cluster-utils_8cc_source.html#l00054">cluster-utils.cc:54</a></div></div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_gaec24b5b9b04af079fd741a4c262fc654"><div class="ttname"><a href="group__tree__group__lower.html#gaec24b5b9b04af079fd741a4c262fc654">kaldi::SplitStatsByKey</a></div><div class="ttdeci">void SplitStatsByKey(const BuildTreeStatsType &amp;stats_in, EventKeyType key, std::vector&lt; BuildTreeStatsType &gt; *stats_out)</div><div class="ttdoc">SplitStatsByKey splits stats up according to the value of a particular key, which must be always defi...</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00198">build-tree-utils.cc:198</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4f60ee3443b23229d5ef766a26c289f9"><div class="ttname"><a href="namespacekaldi.html#a4f60ee3443b23229d5ef766a26c289f9">kaldi::kPdfClass</a></div><div class="ttdeci">static const EventKeyType kPdfClass</div><div class="ttdef"><b>Definition:</b> <a href="context-dep_8h_source.html#l00038">context-dep.h:38</a></div></div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_a951345011b75d2e8d9bfc18ca63510d2"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#a951345011b75d2e8d9bfc18ca63510d2">count</a></div><div class="ttdeci">const size_t count</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00065">arpa-file-parser-test.cc:65</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__clustering__group__simple_html_gaf94c6539a2a7130fc9ab220318dcbdd9"><div class="ttname"><a href="group__clustering__group__simple.html#gaf94c6539a2a7130fc9ab220318dcbdd9">kaldi::EnsureClusterableVectorNotNull</a></div><div class="ttdeci">void EnsureClusterableVectorNotNull(std::vector&lt; Clusterable * &gt; *stats)</div><div class="ttdoc">Fills in any (NULL) holes in &quot;stats&quot; vector, with empty stats, because certain algorithms require non...</div><div class="ttdef"><b>Definition:</b> <a href="cluster-utils_8cc_source.html#l00082">cluster-utils.cc:82</a></div></div>
<div class="ttc" id="group__tree__group__lower_html_ga8c594556191d0401cf83ebab7bebf068"><div class="ttname"><a href="group__tree__group__lower.html#ga8c594556191d0401cf83ebab7bebf068">kaldi::SumStatsVec</a></div><div class="ttdeci">void SumStatsVec(const std::vector&lt; BuildTreeStatsType &gt; &amp;stats_in, std::vector&lt; Clusterable * &gt; *stats_out)</div><div class="ttdoc">Sum a vector of stats. </div><div class="ttdef"><b>Definition:</b> <a href="build-tree-utils_8cc_source.html#l00279">build-tree-utils.cc:279</a></div></div>
<div class="ttc" id="group__clustering__group__algo_html_ga0d42ece3910ff042d1df1cc448a420dc"><div class="ttname"><a href="group__clustering__group__algo.html#ga0d42ece3910ff042d1df1cc448a420dc">kaldi::ClusterKMeans</a></div><div class="ttdeci">BaseFloat ClusterKMeans(const std::vector&lt; Clusterable * &gt; &amp;points, int32 num_clust, std::vector&lt; Clusterable * &gt; *clusters_out, std::vector&lt; int32 &gt; *assignments_out, ClusterKMeansOptions cfg)</div><div class="ttdoc">ClusterKMeans is a K-means-like clustering algorithm. </div><div class="ttdef"><b>Definition:</b> <a href="cluster-utils_8cc_source.html#l00985">cluster-utils.cc:985</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__tree__group_html_gab329e7820899feed82ce631806c61975"><div class="ttname"><a href="group__tree__group.html#gab329e7820899feed82ce631806c61975">kaldi::BuildTreeStatsType</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; EventType, Clusterable * &gt; &gt; BuildTreeStatsType</div><div class="ttdef"><b>Definition:</b> <a href="build-tree-questions_8h_source.html#l00032">build-tree-questions.h:32</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
<div class="ttc" id="namespacekaldi_html_a93a4038983f8cd71e343b85f1d117cac"><div class="ttname"><a href="namespacekaldi.html#a93a4038983f8cd71e343b85f1d117cac">kaldi::DeletePointers</a></div><div class="ttdeci">void DeletePointers(std::vector&lt; A * &gt; *v)</div><div class="ttdoc">Deletes any non-NULL pointers in the vector v, and sets the corresponding entries of v to NULL...</div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00198">stl-utils.h:198</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga82089f932878da16df7ea892d60f32d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadRootsFile </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>phone_sets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; *&#160;</td>
          <td class="paramname"><em>is_shared_root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; *&#160;</td>
          <td class="paramname"><em>is_split_root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the roots file (throws on error). </p>
<p>Format is lines like: "shared split 1 2 3 4", "not-shared not-split 5", and so on. The numbers are indexes of phones. </p>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00783">783</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="arpa-file-parser-test_8cc_source.html#l00040">line_number</a>.</p>

<p>Referenced by <a class="el" href="build-tree-two-level_8cc_source.html#l00053">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                                                   {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(phone_sets != NULL &amp;&amp; is_shared_root != NULL &amp;&amp;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;               is_split_root != NULL &amp;&amp; phone_sets-&gt;empty()</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;               &amp;&amp; is_shared_root-&gt;empty() &amp;&amp; is_split_root-&gt;empty());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  std::string line;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="arpa-file-parser-test_8cc.html#ad6523a106787ae90a963a9b351cb9d52">line_number</a> = 0;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordflow">while</span> ( ! getline(is, line).fail() ) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    line_number++;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    std::istringstream ss(line);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    std::string shared;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    ss &gt;&gt; shared;</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (ss.fail() &amp;&amp; shared != <span class="stringliteral">&quot;shared&quot;</span> &amp;&amp; shared != <span class="stringliteral">&quot;not-shared&quot;</span>)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad line in roots file: line &quot;</span>&lt;&lt; line_number &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; line;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    is_shared_root-&gt;push_back(shared == <span class="stringliteral">&quot;shared&quot;</span>);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    std::string split;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    ss &gt;&gt; split;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (ss.fail() &amp;&amp; shared != <span class="stringliteral">&quot;split&quot;</span> &amp;&amp; shared != <span class="stringliteral">&quot;not-split&quot;</span>)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad line in roots file: line &quot;</span>&lt;&lt; line_number &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; line;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    is_split_root-&gt;push_back(split == <span class="stringliteral">&quot;split&quot;</span>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    phone_sets-&gt;push_back(std::vector&lt;int32&gt;());</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">while</span> ( !(ss &gt;&gt; i).fail() ) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      phone_sets-&gt;back().push_back(i);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    std::sort(phone_sets-&gt;back().begin(), phone_sets-&gt;back().end());</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phone_sets-&gt;back()) || phone_sets-&gt;back().empty()</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        || phone_sets-&gt;back().front() &lt;= 0)</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad line in roots file [empty, or contains non-positive &quot;</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; or duplicate phone-ids]: line &quot;</span> &lt;&lt; line_number &lt;&lt; <span class="stringliteral">&quot;: &quot;</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                &lt;&lt; line;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  }</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  <span class="keywordflow">if</span> (phone_sets-&gt;empty())</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Empty roots file &quot;</span>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_ad6523a106787ae90a963a9b351cb9d52"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#ad6523a106787ae90a963a9b351cb9d52">line_number</a></div><div class="ttdeci">int32 line_number</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00040">arpa-file-parser-test.cc:40</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2dc32e93b34f2086c027c7b632d1e595"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadSymbolTableAsIntegers </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>include_eps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>syms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>included here because it's used in some tree-building calling code. </p>
<p>Reads an OpenFst symbl table, discards the symbols and outputs the integers </p>

<p>Definition at line <a class="el" href="tree_2build-tree_8cc_source.html#l00428">428</a> of file <a class="el" href="tree_2build-tree_8cc_source.html">build-tree.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, and <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>.</p>
<div class="fragment"><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                                       {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  std::ifstream is(filename.c_str());</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordflow">if</span> (!is.good())</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;ReadSymbolTableAsIntegers: could not open symbol table &quot;</span>&lt;&lt;filename;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  std::string line;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(syms != NULL);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  syms-&gt;clear();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">while</span> (getline(is, line)) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    std::string sym;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">int64</a> index;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    std::istringstream ss(line);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    ss &gt;&gt; sym &gt;&gt; index &gt;&gt; std::ws;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span> (ss.fail() || !ss.eof()) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Bad line in symbol table: &quot;</span>&lt;&lt; line&lt;&lt;<span class="stringliteral">&quot;, file is: &quot;</span>&lt;&lt;filename;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (include_eps || index != 0)</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      syms-&gt;push_back(index);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (index == 0 &amp;&amp; sym != <span class="stringliteral">&quot;&lt;eps&gt;&quot;</span>) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Symbol zero is &quot;</span>&lt;&lt;sym&lt;&lt;<span class="stringliteral">&quot;, traditionally &lt;eps&gt; is used.  Make sure this is not a \&quot;real\&quot; symbol.&quot;</span>;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="keywordtype">size_t</span> sz = syms-&gt;size();</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(syms);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">if</span> (syms-&gt;size() != sz)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Symbol table &quot;</span>&lt;&lt;filename&lt;&lt;<span class="stringliteral">&quot; seems to contain duplicate symbols.&quot;</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a7cde0074dfd288f2d70c0e035dacb28a"><div class="ttname"><a href="namespacekaldi.html#a7cde0074dfd288f2d70c0e035dacb28a">kaldi::int64</a></div><div class="ttdeci">int64_t int64</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00048">kaldi-types.h:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:39 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
