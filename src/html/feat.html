<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: Feature extraction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('feat.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Feature extraction </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="feat_intro"></a>
Introduction</h1>
<p>Our feature extraction and waveform-reading code aims to create standard MFCC and PLP features, setting reasonable defaults but leaving available the options that people are most likely to want to tweak (for example, the number of mel bins, minimum and maximum frequency cutoffs, and so on). This code only reads from .wav files containing pcm data. These files commonly have the suffix .wav or .pcm (although sometimes the .pcm suffix is applied to sphere files; in this case the file would have to be converted). If the source data is not a wave file then it is up to the user to find a command-line tool to convert it, but to cover a common case, we do provide installation instructions for sph2pipe.</p>
<p>The command-line tools compute-mfcc-feats and compute-plp-feats compute the features; as with other Kaldi tools, running them without arguments will give a list of options. The example scripts demonstrate the usage of these tools.</p>
<h1><a class="anchor" id="feat_mfcc"></a>
Computing MFCC features</h1>
<p>Here we describe how MFCC features are computed by the command-line tool compute-mfcc-feats. This program requires two command-line arguments: an rspecifier to read the .wav data (indexed by utterance) and a wspecifier to write the features (indexed by utterance); see <a class="el" href="io.html#io_sec_tables">The Table concept</a> and <a class="el" href="io.html#io_sec_specifiers">Specifying Table formats: wspecifiers and rspecifiers</a> for more explanation of these terms. In typical usage, we will write the data to one big "archive" file but also write out an "scp" file for easy random access; see <a class="el" href="io.html#io_sec_specifiers_both">Writing an archive and a script file simultaneously</a> for explanation. The program does not add delta features (for that, see add-deltas). It accepts an option &ndash;channel to select the channel (e.g. &ndash;channel=0, &ndash;channel=1), which is useful when reading stereo data.</p>
<p>The computation of MFCC features is done by an object of type <a class="el" href="classkaldi_1_1Mfcc.html" title="Class for computing MFCC features; see Computing MFCC features for more information. ">Mfcc</a>, which has a function <a class="el" href="classkaldi_1_1Mfcc.html#abed94259810675c3ca41d32f8a70b4de">Compute()</a> to compute the features from the waveform.</p>
<p>The overall MFCC computation is as follows:</p>
<ul>
<li>Work out the number of frames in the file (typically 25 ms frames shifted by 10ms each time).</li>
<li>For each frame:<ul>
<li>Extract the data, do optional dithering, preemphasis and dc offset removal, and multiply it by a windowing function (various options are supported here, e.g. Hamming)</li>
<li>Work out the energy at this point (if using log-energy not C0).</li>
<li>Do FFT and compute the power spectrum</li>
<li>Compute the energy in each mel bin; these are e.g. 23 triangular overlapping bins whose centers are equally spaced in the mel-frequency domain.</li>
<li>Compute the log of the energies and take the cosine transform, keeping as many coefficients as specified (e.g. 13)</li>
<li>Optionally do cepstral liftering; this is just a scaling of the coefficients, which ensures they have a reasonable range.</li>
</ul>
</li>
</ul>
<p>The lower and upper cutoff of the frequency range covered by the triangular mel bins are controlled by the options &ndash;low-freq and &ndash;high-freq, which are usually set close to zero and the Nyquist frequency respectively, e.g. &ndash;low-freq=20 and &ndash;high-freq=7800 for 16kHz sampled speech.</p>
<p>The features differ from HTK features in a number of ways, but almost all of these relate to having different defaults. With the option &ndash;htk-compat=true, and setting parameters correctly, it is possible to get very close to HTK features. One possibly important option that we do not support is energy max-normalization. This is because we prefer normalization methods that can be applied in a stateless way, and would like to keep the feature computation such that it could in principle be done frame by frame and still give the same results. The program compute-mfcc-feats does, however, have an option &ndash;subtract-mean to subtract the mean of the features. This is done per utterance; there are different ways to do it per speaker (e.g. search for "cmvn", meaning cepstral mean and variance normalization, in the scripts).</p>
<h1><a class="anchor" id="feat_plp"></a>
Computing PLP features</h1>
<p>The algorithm to compute PLP features is similar to the MFCC one in the early stages. We may add more to this section later, but for now see "Perceptual
  linear predictive (PLP) analysis of speech" by Hynek Hermansky, Journal of the Acoustical Society of America, vol. 87, no. 4, pages 1738&ndash;1752 (1990).</p>
<h1><a class="anchor" id="feat_vtln"></a>
Feature-level Vocal Tract Length Normalization (VTLN).</h1>
<p>The programs compute-mfcc-feats and compute-plp-feats accept a VTLN warp factor option. In current scripts this is only used as a means of initializing linear transforms for linear versions of VTLN. VTLN acts by moving the locations of the center frequencies of the triangular frequency bins. The warping function that moves the frequency bins around is a piecewise linear function in frequency space. To understand it, bear in mind the following quantities:</p>
<p>0 &lt;= low-freq &lt;= vtln-low &lt; vtln-high &lt; high-freq &lt;= nyquist</p>
<p>Here, low-freq and high-freq are the lowest and highest frequencies that are used in the standard MFCC or PLP computation (lower and higher frequencies are discarded). vtln-low and vtln-high are frequency cutoffs used in VTLN, and their function is to ensure that all the mel bins get a reasonable width.</p>
<p>The VTLN warping function we implement is a piecewise linear function with three segments that maps the interval [low-freq, high-freq] to [low-freq, high-freq]. Let the warping function be W(f), where f is the frequency. The central segment maps f to f/scale, where "scale" is the VTLN warp factor (typically in the range 0.8 to 1.2). The point on the x-axis at which the lower segment joins the middle segment is the point f defined so that min(f, W(f)) = vtln-low. The point on the x-axis at which the middle segment joins the upper segment is the point f defined so that max(f, W(f)) = vtln-high. The slope and offsets of the lower and upper segments are dictated by continuity and by the requirement that W(low-freq)=low-freq and W(high-freq)=high-freq. This warping function differs from HTK's; in the HTK version, the "vtln-low" and "vtln-high" quantities are interpreted as the points on the x-axis at which the discontinuity happens, and this means that the "vtln-high" variable has to be selected quite carefully based on knowledge of the possible range of warp factors (otherwise mel bins with empty size can occur).</p>
<p>A reasonable setup is the following (for 16kHz sampled speech); note that this is a reflection of our understanding of the reasonable values, and is not the product of any very careful tuning experiments.</p>
<table  border="1">
<tr>
<td>low-freq </td><td>vtln-low </td><td>vtln-high </td><td>high-freq </td><td>nyquist  </td></tr>
<tr>
<td>40  </td><td>60  </td><td>7200  </td><td>7800  </td><td>8000   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Kaldi</a></li>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:38 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
