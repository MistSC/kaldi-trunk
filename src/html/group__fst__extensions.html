<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: Fst_extensions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__fst__extensions.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Fst_extensions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfst_1_1DeterminizeLatticeOptions.html">DeterminizeLatticeOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfst_1_1DeterminizeLatticePrunedOptions.html">DeterminizeLatticePrunedOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structfst_1_1DeterminizeLatticePhonePrunedOptions.html">DeterminizeLatticePhonePrunedOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga09127115b60edc4f73f5ce64f5b2902d"><td class="memTemplParams" colspan="2">template&lt;class Weight , class IntType &gt; </td></tr>
<tr class="memitem:ga09127115b60edc4f73f5ce64f5b2902d"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#ga09127115b60edc4f73f5ce64f5b2902d">DeterminizeLattice</a> (const <a class="el" href="classFst.html">Fst</a>&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;ifst, MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *ofst, DeterminizeLatticeOptions opts=DeterminizeLatticeOptions(), bool *debug_ptr=NULL)</td></tr>
<tr class="memdesc:ga09127115b60edc4f73f5ce64f5b2902d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the normal version of DeterminizeLattice, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side.  <a href="#ga09127115b60edc4f73f5ce64f5b2902d">More...</a><br/></td></tr>
<tr class="separator:ga09127115b60edc4f73f5ce64f5b2902d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga089fac5db8728882ff4e454b10c0f10b"><td class="memTemplParams" colspan="2">template&lt;class Weight , class IntType &gt; </td></tr>
<tr class="memitem:ga089fac5db8728882ff4e454b10c0f10b"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#ga089fac5db8728882ff4e454b10c0f10b">DeterminizeLattice</a> (const <a class="el" href="classFst.html">Fst</a>&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;ifst, MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *ofst, DeterminizeLatticeOptions opts, bool *debug_ptr)</td></tr>
<tr class="separator:ga089fac5db8728882ff4e454b10c0f10b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6d4823e83f5353ae5b5ce569a7a29a3"><td class="memTemplParams" colspan="2">template&lt;class F &gt; </td></tr>
<tr class="memitem:gac6d4823e83f5353ae5b5ce569a7a29a3"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gac6d4823e83f5353ae5b5ce569a7a29a3">DeterminizeStar</a> (F &amp;ifst, MutableFst&lt; typename F::Arc &gt; *ofst, float delta=kDelta, bool *debug_ptr=NULL, int max_states=-1, bool allow_partial=false)</td></tr>
<tr class="memdesc:gac6d4823e83f5353ae5b5ce569a7a29a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the normal version of DeterminizeStar, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side.  <a href="#gac6d4823e83f5353ae5b5ce569a7a29a3">More...</a><br/></td></tr>
<tr class="separator:gac6d4823e83f5353ae5b5ce569a7a29a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa83b38f8e9a754bbd3ed552bef274977"><td class="memTemplParams" colspan="2">template&lt;class F &gt; </td></tr>
<tr class="memitem:gaa83b38f8e9a754bbd3ed552bef274977"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gaa83b38f8e9a754bbd3ed552bef274977">DeterminizeStar</a> (F &amp;ifst, MutableFst&lt; GallicArc&lt; typename F::Arc &gt; &gt; *ofst, float delta, bool *debug_ptr, int max_states, bool allow_partial)</td></tr>
<tr class="separator:gaa83b38f8e9a754bbd3ed552bef274977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga599f3ab3855e6847f4b23777e14b18ab"><td class="memTemplParams" colspan="2">template&lt;class Weight &gt; </td></tr>
<tr class="memitem:ga599f3ab3855e6847f4b23777e14b18ab"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#ga599f3ab3855e6847f4b23777e14b18ab">DeterminizeLatticePruned</a> (const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;ifst, double prune, MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *ofst, DeterminizeLatticePrunedOptions opts=DeterminizeLatticePrunedOptions())</td></tr>
<tr class="memdesc:ga599f3ab3855e6847f4b23777e14b18ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function implements the normal version of DeterminizeLattice, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side.  <a href="#ga599f3ab3855e6847f4b23777e14b18ab">More...</a><br/></td></tr>
<tr class="separator:ga599f3ab3855e6847f4b23777e14b18ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae37d77a64fdc7c92ad2c44ece0b74f9a"><td class="memTemplParams" colspan="2">template&lt;class Weight , class IntType &gt; </td></tr>
<tr class="memitem:gae37d77a64fdc7c92ad2c44ece0b74f9a"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gae37d77a64fdc7c92ad2c44ece0b74f9a">DeterminizeLatticePruned</a> (const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;ifst, double beam, MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *ofst, DeterminizeLatticePrunedOptions opts)</td></tr>
<tr class="separator:gae37d77a64fdc7c92ad2c44ece0b74f9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf1a298863d74aaa793841cdbb3b72fd"><td class="memTemplParams" colspan="2">template&lt;class Weight &gt; </td></tr>
<tr class="memitem:gadf1a298863d74aaa793841cdbb3b72fd"><td class="memTemplItemLeft" align="right" valign="top">ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt;::<a class="el" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gadf1a298863d74aaa793841cdbb3b72fd">DeterminizeLatticeInsertPhones</a> (const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;trans_model, MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *fst)</td></tr>
<tr class="memdesc:gadf1a298863d74aaa793841cdbb3b72fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes in lattices and inserts phones at phone boundaries.  <a href="#gadf1a298863d74aaa793841cdbb3b72fd">More...</a><br/></td></tr>
<tr class="separator:gadf1a298863d74aaa793841cdbb3b72fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39d3a3374e6395b20230e7294ca08e3e"><td class="memTemplParams" colspan="2">template&lt;class Weight &gt; </td></tr>
<tr class="memitem:ga39d3a3374e6395b20230e7294ca08e3e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#ga39d3a3374e6395b20230e7294ca08e3e">DeterminizeLatticeDeletePhones</a> (typename ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt;::<a class="el" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a> first_phone_label, MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *fst)</td></tr>
<tr class="memdesc:ga39d3a3374e6395b20230e7294ca08e3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes in lattices and deletes "phones" from them.  <a href="#ga39d3a3374e6395b20230e7294ca08e3e">More...</a><br/></td></tr>
<tr class="separator:ga39d3a3374e6395b20230e7294ca08e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac2efca45f2bc492afa7a87f7a8eeff13"><td class="memTemplParams" colspan="2">template&lt;class Weight , class IntType &gt; </td></tr>
<tr class="memitem:gac2efca45f2bc492afa7a87f7a8eeff13"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gac2efca45f2bc492afa7a87f7a8eeff13">DeterminizeLatticePhonePruned</a> (const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;trans_model, const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;ifst, double prune, MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *ofst, DeterminizeLatticePhonePrunedOptions opts=DeterminizeLatticePhonePrunedOptions())</td></tr>
<tr class="memdesc:gac2efca45f2bc492afa7a87f7a8eeff13"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a wrapper of <a class="el" href="namespacefst.html#a5003d0c78ef934fae8501cf4af8d334a" title="This function does a first pass determinization with phone symbols inserted at phone boundary...">DeterminizeLatticePhonePrunedFirstPass()</a> and <a class="el" href="group__fst__extensions.html#gae37d77a64fdc7c92ad2c44ece0b74f9a">DeterminizeLatticePruned()</a>.  <a href="#gac2efca45f2bc492afa7a87f7a8eeff13">More...</a><br/></td></tr>
<tr class="separator:gac2efca45f2bc492afa7a87f7a8eeff13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7a66f2c18ebe4f4f00424aad0401bc5"><td class="memTemplParams" colspan="2">template&lt;class Weight , class IntType &gt; </td></tr>
<tr class="memitem:gae7a66f2c18ebe4f4f00424aad0401bc5"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#gae7a66f2c18ebe4f4f00424aad0401bc5">DeterminizeLatticePhonePruned</a> (const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;trans_model, MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *ifst, double prune, MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *ofst, DeterminizeLatticePhonePrunedOptions opts=DeterminizeLatticePhonePrunedOptions())</td></tr>
<tr class="memdesc:gae7a66f2c18ebe4f4f00424aad0401bc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">"Destructive" version of <a class="el" href="group__fst__extensions.html#gae7a66f2c18ebe4f4f00424aad0401bc5" title="&quot;Destructive&quot; version of DeterminizeLatticePhonePruned() where the input lattice might be changed...">DeterminizeLatticePhonePruned()</a> where the input lattice might be changed.  <a href="#gae7a66f2c18ebe4f4f00424aad0401bc5">More...</a><br/></td></tr>
<tr class="separator:gae7a66f2c18ebe4f4f00424aad0401bc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49f7b58eaa834d7ad3535fee81de4d93"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fst__extensions.html#ga49f7b58eaa834d7ad3535fee81de4d93">DeterminizeLatticePhonePrunedWrapper</a> (const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;trans_model, MutableFst&lt; <a class="el" href="namespacekaldi.html#a417e37822095c5adb9680fa07dffea8d">kaldi::LatticeArc</a> &gt; *ifst, double prune, MutableFst&lt; <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a> &gt; *ofst, DeterminizeLatticePhonePrunedOptions opts=DeterminizeLatticePhonePrunedOptions())</td></tr>
<tr class="memdesc:ga49f7b58eaa834d7ad3535fee81de4d93"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is a wrapper of <a class="el" href="group__fst__extensions.html#gae7a66f2c18ebe4f4f00424aad0401bc5" title="&quot;Destructive&quot; version of DeterminizeLatticePhonePruned() where the input lattice might be changed...">DeterminizeLatticePhonePruned()</a> that works for Lattice type FSTs.  <a href="#ga49f7b58eaa834d7ad3535fee81de4d93">More...</a><br/></td></tr>
<tr class="separator:ga49f7b58eaa834d7ad3535fee81de4d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga09127115b60edc4f73f5ce64f5b2902d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLattice </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFst.html">Fst</a>&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticeOptions&#160;</td>
          <td class="paramname"><em>opts</em> = <code>DeterminizeLatticeOptions()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>debug_ptr</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function implements the normal version of DeterminizeLattice, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side. </p>
<p>The debug_ptr argument is an optional pointer to a bool that, if it becomes true while the algorithm is executing, the algorithm will print a traceback and terminate (used in <a class="el" href="fstdeterminizestar_8cc.html">fstdeterminizestar.cc</a> debug non-terminating determinization). More efficient if ifst is arc-sorted on input label. If the number of arcs gets more than max_states, it will throw std::runtime_error (otherwise this code does not use exceptions). This is mainly useful for debug. </p>

<p>Definition at line <a class="el" href="determinize-lattice-inl_8h_source.html#l01264">1264</a> of file <a class="el" href="determinize-lattice-inl_8h_source.html">determinize-lattice-inl.h</a>.</p>

<p>References <a class="el" href="determinize-lattice-inl_8h_source.html#l00498">LatticeDeterminizer&lt; Weight, IntType &gt;::Determinize()</a>, and <a class="el" href="determinize-lattice-inl_8h_source.html#l00272">LatticeDeterminizer&lt; Weight, IntType &gt;::Output()</a>.</p>

<p>Referenced by <a class="el" href="lattice-determinize_8cc_source.html#l00032">kaldi::DeterminizeLatticeWrapper()</a>, <a class="el" href="lattice-arcgraph_8cc_source.html#l00136">main()</a>, and <a class="el" href="minimize-lattice-test_8cc_source.html#l00030">kaldi::RandDeterministicCompactLattice()</a>.</p>
<div class="fragment"><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                                         {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.OutputSymbols());</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  LatticeDeterminizer&lt;Weight, IntType&gt; det(ifst, opts);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="keywordflow">if</span> (!det.Determinize(debug_ptr))</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  det.Output(ofst);</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga089fac5db8728882ff4e454b10c0f10b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLattice </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classFst.html">Fst</a>&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticeOptions&#160;</td>
          <td class="paramname"><em>opts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>debug_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="determinize-lattice-inl_8h_source.html#l01281">1281</a> of file <a class="el" href="determinize-lattice-inl_8h_source.html">determinize-lattice-inl.h</a>.</p>

<p>References <a class="el" href="determinize-lattice-inl_8h_source.html#l00498">LatticeDeterminizer&lt; Weight, IntType &gt;::Determinize()</a>, and <a class="el" href="determinize-lattice-inl_8h_source.html#l00272">LatticeDeterminizer&lt; Weight, IntType &gt;::Output()</a>.</p>
<div class="fragment"><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                                         {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.OutputSymbols());</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  LatticeDeterminizer&lt;Weight, IntType&gt; det(ifst, opts);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  <span class="keywordflow">if</span> (!det.Determinize(debug_ptr))</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  det.Output(ofst);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga39d3a3374e6395b20230e7294ca08e3e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DeterminizeLatticeDeletePhones </td>
          <td>(</td>
          <td class="paramtype">typename ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt;::<a class="el" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a>&#160;</td>
          <td class="paramname"><em>first_phone_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>fst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes in lattices and deletes "phones" from them. </p>
<p>The "phones" here are actually any label that is larger than first_phone_label because when we insert phones into the lattice, we map the original phone label to (first_phone_label + original_phone_label). It is supposed to be used together with <a class="el" href="group__fst__extensions.html#gadf1a298863d74aaa793841cdbb3b72fd" title="This function takes in lattices and inserts phones at phone boundaries. ">DeterminizeLatticeInsertPhones()</a> </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01360">1360</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                                      {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="comment">// Define some types.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="keyword">typedef</span> ArcTpl&lt;Weight&gt; <a class="code" href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">Arc</a>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">Arc::StateId</a> <a class="code" href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">StateId</a>;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Arc::Label</a> <a class="code" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="comment">// Delete phones here.</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordflow">for</span> (StateIterator&lt;MutableFst&lt;Arc&gt; &gt; siter(*fst);</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;       !siter.Done(); siter.Next()) {</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    StateId state = siter.Value();</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordflow">for</span> (MutableArcIterator&lt;MutableFst&lt;Arc&gt; &gt; aiter(fst, state);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;         !aiter.Done(); aiter.Next()) {</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;      Arc arc = aiter.Value();</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      <span class="keywordflow">if</span> (arc.ilabel &gt;= first_phone_label)</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        arc.ilabel = 0;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      aiter.SetValue(arc);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;}</div>
<div class="ttc" id="lattice-arcgraph_8cc_html_ae38f9e2cc96a39ff2953a2846c2538db"><div class="ttname"><a href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">StateId</a></div><div class="ttdeci">fst::StdArc::StateId StateId</div><div class="ttdef"><b>Definition:</b> <a href="lattice-arcgraph_8cc_source.html#l00027">lattice-arcgraph.cc:27</a></div></div>
<div class="ttc" id="lattice-arcgraph_8cc_html_a006b00477e4d9250474e76e1ec61bb3f"><div class="ttname"><a href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a></div><div class="ttdeci">fst::StdArc::Label Label</div><div class="ttdef"><b>Definition:</b> <a href="lattice-arcgraph_8cc_source.html#l00029">lattice-arcgraph.cc:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4ce48a4aa890590d2bbbeaa26cdac97b"><div class="ttname"><a href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">kaldi::Arc</a></div><div class="ttdeci">KwsLexicographicArc Arc</div><div class="ttdef"><b>Definition:</b> <a href="kws-search_8cc_source.html#l00028">kws-search.cc:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadf1a298863d74aaa793841cdbb3b72fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt;::<a class="el" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a> DeterminizeLatticeInsertPhones </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>fst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes in lattices and inserts phones at phone boundaries. </p>
<p>It uses the transition model to work out the transition_id to phone map. The returning value is the starting index of the phone label. Typically we pick (maximum_output_label_index + 1) as this value. The inserted phones are then mapped to (returning_value + original_phone_label) in the new lattice. The returning value will be used by <a class="el" href="group__fst__extensions.html#ga39d3a3374e6395b20230e7294ca08e3e" title="This function takes in lattices and deletes &quot;phones&quot; from them. ">DeterminizeLatticeDeletePhones()</a> where it works out the phones according to this value. </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01304">1304</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>

<p>References <a class="el" href="fstext-utils-inl_8h_source.html#l00054">fst::HighestNumberedInputSymbol()</a>, <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="transition-model_8cc_source.html#l00659">TransitionModel::TransitionIdToHmmState()</a>, and <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>.</p>

<p>Referenced by <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01401">fst::DeterminizeLatticePhonePrunedFirstPass()</a>.</p>
<div class="fragment"><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;                                      {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="comment">// Define some types.</span></div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keyword">typedef</span> ArcTpl&lt;Weight&gt; <a class="code" href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">Arc</a>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">Arc::StateId</a> <a class="code" href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">StateId</a>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keyword">typedef</span> <span class="keyword">typename</span> <a class="code" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Arc::Label</a> <a class="code" href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="comment">// Work out the first phone symbol. This is more related to the phone</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  <span class="comment">// insertion function, so we put it here and make it the returning value of</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;  <span class="comment">// DeterminizeLatticeInsertPhones(). </span></div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;  Label first_phone_label = <a class="code" href="namespacefst.html#ac359ee42978cf57f9c5dfdc50df8fe16">HighestNumberedInputSymbol</a>(*fst) + 1;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">// Insert phones here.</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="keywordflow">for</span> (StateIterator&lt;MutableFst&lt;Arc&gt; &gt; siter(*fst);</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;       !siter.Done(); siter.Next()) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    StateId state = siter.Value();</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordflow">if</span> (state == fst-&gt;Start())</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordflow">for</span> (MutableArcIterator&lt;MutableFst&lt;Arc&gt; &gt; aiter(fst, state);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;         !aiter.Done(); aiter.Next()) {</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      Arc arc = aiter.Value();</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;      <span class="comment">// Note: the words are on the input symbol side and transition-id&#39;s are on</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;      <span class="comment">// the output symbol side.</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      <span class="keywordflow">if</span> ((arc.olabel != 0)</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          &amp;&amp; (trans_model.<a class="code" href="classkaldi_1_1TransitionModel.html#ab2a1570ee8da4b2d70f539d0c76435e9">TransitionIdToHmmState</a>(arc.olabel) == 0)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          &amp;&amp; (!trans_model.<a class="code" href="classkaldi_1_1TransitionModel.html#a102a2cc462eb2f0322a295d21b6c5065">IsSelfLoop</a>(arc.olabel))) {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        Label phone =</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keyword">static_cast&lt;</span>Label<span class="keyword">&gt;</span>(trans_model.<a class="code" href="classkaldi_1_1TransitionModel.html#a73d4902379e96bbbdf4fe50b2dd65ae1">TransitionIdToPhone</a>(arc.olabel));</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        <span class="comment">// Skips &lt;eps&gt;.</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(phone != 0);</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        <span class="keywordflow">if</span> (arc.ilabel == 0) {</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          <span class="comment">// If there is no word on the arc, insert the phone directly.</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;          arc.ilabel = first_phone_label + phone;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="comment">// Otherwise, add an additional arc.</span></div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          StateId additional_state = fst-&gt;AddState();</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;          StateId next_state = arc.nextstate;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          arc.nextstate = additional_state;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          fst-&gt;AddArc(additional_state,</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                      <a class="code" href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">Arc</a>(first_phone_label + phone, 0,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                          Weight::One(), next_state));</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      }</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      aiter.SetValue(arc);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    }</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;  }</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="keywordflow">return</span> first_phone_label;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}</div>
<div class="ttc" id="lattice-arcgraph_8cc_html_ae38f9e2cc96a39ff2953a2846c2538db"><div class="ttname"><a href="lattice-arcgraph_8cc.html#ae38f9e2cc96a39ff2953a2846c2538db">StateId</a></div><div class="ttdeci">fst::StdArc::StateId StateId</div><div class="ttdef"><b>Definition:</b> <a href="lattice-arcgraph_8cc_source.html#l00027">lattice-arcgraph.cc:27</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_ab2a1570ee8da4b2d70f539d0c76435e9"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#ab2a1570ee8da4b2d70f539d0c76435e9">kaldi::TransitionModel::TransitionIdToHmmState</a></div><div class="ttdeci">int32 TransitionIdToHmmState(int32 trans_id) const </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8cc_source.html#l00659">transition-model.cc:659</a></div></div>
<div class="ttc" id="lattice-arcgraph_8cc_html_a006b00477e4d9250474e76e1ec61bb3f"><div class="ttname"><a href="lattice-arcgraph_8cc.html#a006b00477e4d9250474e76e1ec61bb3f">Label</a></div><div class="ttdeci">fst::StdArc::Label Label</div><div class="ttdef"><b>Definition:</b> <a href="lattice-arcgraph_8cc_source.html#l00029">lattice-arcgraph.cc:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4ce48a4aa890590d2bbbeaa26cdac97b"><div class="ttname"><a href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">kaldi::Arc</a></div><div class="ttdeci">KwsLexicographicArc Arc</div><div class="ttdef"><b>Definition:</b> <a href="kws-search_8cc_source.html#l00028">kws-search.cc:28</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a102a2cc462eb2f0322a295d21b6c5065"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a102a2cc462eb2f0322a295d21b6c5065">kaldi::TransitionModel::IsSelfLoop</a></div><div class="ttdeci">bool IsSelfLoop(int32 trans_id) const </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8cc_source.html#l00228">transition-model.cc:228</a></div></div>
<div class="ttc" id="namespacefst_html_ac359ee42978cf57f9c5dfdc50df8fe16"><div class="ttname"><a href="namespacefst.html#ac359ee42978cf57f9c5dfdc50df8fe16">fst::HighestNumberedInputSymbol</a></div><div class="ttdeci">Arc::Label HighestNumberedInputSymbol(const Fst&lt; Arc &gt; &amp;fst)</div><div class="ttdoc">Returns the highest numbered input symbol id of the FST (or zero for an empty FST. </div><div class="ttdef"><b>Definition:</b> <a href="fstext-utils-inl_8h_source.html#l00054">fstext-utils-inl.h:54</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a73d4902379e96bbbdf4fe50b2dd65ae1"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a73d4902379e96bbbdf4fe50b2dd65ae1">kaldi::TransitionModel::TransitionIdToPhone</a></div><div class="ttdeci">int32 TransitionIdToPhone(int32 trans_id) const </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8cc_source.html#l00642">transition-model.cc:642</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae7a66f2c18ebe4f4f00424aad0401bc5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLatticePhonePruned </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticePhonePrunedOptions&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"Destructive" version of <a class="el" href="group__fst__extensions.html#gae7a66f2c18ebe4f4f00424aad0401bc5" title="&quot;Destructive&quot; version of DeterminizeLatticePhonePruned() where the input lattice might be changed...">DeterminizeLatticePhonePruned()</a> where the input lattice might be changed. </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01424">1424</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>

<p>References <a class="el" href="determinize-lattice-pruned_8h_source.html#l00113">DeterminizeLatticePrunedOptions::delta</a>, <a class="el" href="determinize-lattice-pruned_8h_source.html#l00147">DeterminizeLatticePhonePrunedOptions::delta</a>, <a class="el" href="kaldi-error_8h_source.html#l00166">KALDI_VLOG</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="determinize-lattice-pruned_8h_source.html#l00114">DeterminizeLatticePrunedOptions::max_mem</a>, <a class="el" href="determinize-lattice-pruned_8h_source.html#l00150">DeterminizeLatticePhonePrunedOptions::max_mem</a>, <a class="el" href="determinize-lattice-pruned_8h_source.html#l00157">DeterminizeLatticePhonePrunedOptions::minimize</a>, <a class="el" href="determinize-lattice-pruned_8h_source.html#l00153">DeterminizeLatticePhonePrunedOptions::phone_determinize</a>, and <a class="el" href="determinize-lattice-pruned_8h_source.html#l00155">DeterminizeLatticePhonePrunedOptions::word_determinize</a>.</p>
<div class="fragment"><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                                               {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  <span class="comment">// Returning status.</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keywordtype">bool</span> ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;  <span class="comment">// Make sure at least one of opts.phone_determinize and opts.word_determinize</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">// is not false, otherwise calling this function doesn&#39;t make any sense.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <span class="keywordflow">if</span> ((opts.phone_determinize || opts.word_determinize) == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Both --phone-determinize and --word-determinize are set to &quot;</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;false, copying lattice without determinization.&quot;</span>;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// We are expecting the words on the input side.</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    ConvertLattice&lt;Weight, IntType&gt;(*ifst, ofst, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  }</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="comment">// Determinization options.</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  DeterminizeLatticePrunedOptions det_opts;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  det_opts.delta = opts.delta;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  det_opts.max_mem = opts.max_mem;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">// If --phone-determinize is true, do the determinization on phone + word</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="comment">// lattices.</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">if</span> (opts.phone_determinize) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Doing first pass of determinization on phone + word &quot;</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;lattices.&quot;</span>; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    ans = DeterminizeLatticePhonePrunedFirstPass&lt;Weight, IntType&gt;(</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        trans_model, beam, ifst, det_opts) &amp;&amp; ans;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// If --word-determinize is false, we&#39;ve finished the job and return here.</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">if</span> (!opts.word_determinize) {</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <span class="comment">// We are expecting the words on the input side.</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      ConvertLattice&lt;Weight, IntType&gt;(*ifst, ofst, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="comment">// If --word-determinize is true, do the determinization on word lattices.</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <span class="keywordflow">if</span> (opts.word_determinize) {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Doing second pass of determinization on word lattices.&quot;</span>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    ans = DeterminizeLatticePruned&lt;Weight, IntType&gt;(</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        *ifst, beam, ofst, det_opts) &amp;&amp; ans;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  }</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="comment">// If --minimize is true, push and minimize after determinization.</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;  <span class="keywordflow">if</span> (opts.minimize) {</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <a class="code" href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a>(1) &lt;&lt; <span class="stringliteral">&quot;Pushing and minimizing on word lattices.&quot;</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    ans = PushCompactLatticeStrings&lt;Weight, IntType&gt;(ofst) &amp;&amp; ans;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    ans = PushCompactLatticeWeights&lt;Weight, IntType&gt;(ofst) &amp;&amp; ans;</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    ans = MinimizeCompactLattice&lt;Weight, IntType&gt;(ofst) &amp;&amp; ans;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="group__error__group_html_ga16c81ec6ff3ba04c6ff96fdaed9d854e"><div class="ttname"><a href="group__error__group.html#ga16c81ec6ff3ba04c6ff96fdaed9d854e">KALDI_VLOG</a></div><div class="ttdeci">#define KALDI_VLOG(v)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00166">kaldi-error.h:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac2efca45f2bc492afa7a87f7a8eeff13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLatticePhonePruned </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prune</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticePhonePrunedOptions&#160;</td>
          <td class="paramname"><em>opts</em> = <code>DeterminizeLatticePhonePrunedOptions()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a wrapper of <a class="el" href="namespacefst.html#a5003d0c78ef934fae8501cf4af8d334a" title="This function does a first pass determinization with phone symbols inserted at phone boundary...">DeterminizeLatticePhonePrunedFirstPass()</a> and <a class="el" href="group__fst__extensions.html#gae37d77a64fdc7c92ad2c44ece0b74f9a">DeterminizeLatticePruned()</a>. </p>
<p>If &ndash;phone-determinize is set to true, it first calls <a class="el" href="namespacefst.html#a5003d0c78ef934fae8501cf4af8d334a" title="This function does a first pass determinization with phone symbols inserted at phone boundary...">DeterminizeLatticePhonePrunedFirstPass()</a> to do the initial pass of determinization on the phone + word lattices. If &ndash;word-determinize is set true, it then does a second pass of determinization on the word lattices by calling <a class="el" href="group__fst__extensions.html#gae37d77a64fdc7c92ad2c44ece0b74f9a">DeterminizeLatticePruned()</a>. If both are set to false, then it gives a warning and copying the lattices without determinization.</p>
<p>Note: the point of doing first a phone-level determinization pass and then a word-level determinization pass is that it allows us to determinize deeper lattices without "failing early" and returning a too-small lattice due to the max-mem constraint. The result should be the same as word-level determinization in general, but for deeper lattices it is a bit faster, despite the fact that we now have two passes of determinization by default. </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01485">1485</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;                                               {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  VectorFst&lt;ArcTpl&lt;Weight&gt; &gt; temp_fst(ifst);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="group__fst__extensions.html#gac2efca45f2bc492afa7a87f7a8eeff13">DeterminizeLatticePhonePruned</a>(trans_model, &amp;temp_fst,</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                                       beam, ofst, opts);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;}</div>
<div class="ttc" id="group__fst__extensions_html_gac2efca45f2bc492afa7a87f7a8eeff13"><div class="ttname"><a href="group__fst__extensions.html#gac2efca45f2bc492afa7a87f7a8eeff13">fst::DeterminizeLatticePhonePruned</a></div><div class="ttdeci">bool DeterminizeLatticePhonePruned(const kaldi::TransitionModel &amp;trans_model, const ExpandedFst&lt; ArcTpl&lt; Weight &gt; &gt; &amp;ifst, double beam, MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; Weight, IntType &gt; &gt; &gt; *ofst, DeterminizeLatticePhonePrunedOptions opts)</div><div class="ttdoc">This function is a wrapper of DeterminizeLatticePhonePrunedFirstPass() and DeterminizeLatticePruned()...</div><div class="ttdef"><b>Definition:</b> <a href="determinize-lattice-pruned_8cc_source.html#l01485">determinize-lattice-pruned.cc:1485</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga49f7b58eaa834d7ad3535fee81de4d93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLatticePhonePrunedWrapper </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkaldi_1_1TransitionModel.html">kaldi::TransitionModel</a> &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; <a class="el" href="namespacekaldi.html#a417e37822095c5adb9680fa07dffea8d">kaldi::LatticeArc</a> &gt; *&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prune</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; <a class="el" href="namespacekaldi.html#a33b7ea55be82ee6bab64430dd93cbcba">kaldi::CompactLatticeArc</a> &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticePhonePrunedOptions&#160;</td>
          <td class="paramname"><em>opts</em> = <code>DeterminizeLatticePhonePrunedOptions()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is a wrapper of <a class="el" href="group__fst__extensions.html#gae7a66f2c18ebe4f4f00424aad0401bc5" title="&quot;Destructive&quot; version of DeterminizeLatticePhonePruned() where the input lattice might be changed...">DeterminizeLatticePhonePruned()</a> that works for Lattice type FSTs. </p>
<p>It simplifies the calling process by calling TopSort() Invert() and ArcSort() for you. Unlike other determinization routines, the function requires "ifst" to have transition-id's on the input side and words on the output side. This function can be used as the top-level interface to all the determinization code. </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01496">1496</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>.</p>

<p>Referenced by <a class="el" href="gmm-latgen-biglm-faster_8cc_source.html#l00036">kaldi::DecodeUtterance()</a>, <a class="el" href="decoder-wrappers_8cc_source.html#l00197">kaldi::DecodeUtteranceLatticeFaster()</a>, <a class="el" href="decoder-wrappers_8cc_source.html#l00295">kaldi::DecodeUtteranceLatticeSimple()</a>, <a class="el" href="lattice-tracking-decoder_8cc_source.html#l00881">kaldi::DecodeUtteranceLatticeTracking()</a>, <a class="el" href="lattice-determinize-phone-pruned_8cc_source.html#l00027">main()</a>, <a class="el" href="lattice-determinize-phone-pruned-parallel_8cc_source.html#l00046">DeterminizeLatticeTask::operator()()</a>, and <a class="el" href="decoder-wrappers_8cc_source.html#l00061">DecodeUtteranceLatticeFasterClass::operator()()</a>.</p>
<div class="fragment"><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                                               {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordtype">bool</span> ans = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  Invert(ifst);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <span class="keywordflow">if</span> (ifst-&gt;Properties(fst::kTopSorted, <span class="keyword">true</span>) == 0) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">if</span> (!TopSort(ifst)) {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;      <span class="comment">// Cannot topologically sort the lattice -- determinization will fail.</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Topological sorting of state-level lattice failed (probably&quot;</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; your lexicon has empty words or your LM has epsilon cycles&quot;</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  }</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  ILabelCompare&lt;kaldi::LatticeArc&gt; ilabel_comp;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  ArcSort(ifst, ilabel_comp);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  ans = DeterminizeLatticePhonePruned&lt;kaldi::LatticeWeight, kaldi::int32&gt;(</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;      trans_model, ifst, beam, ofst, opts);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  Connect(ofst);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae37d77a64fdc7c92ad2c44ece0b74f9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLatticePruned </td>
          <td>(</td>
          <td class="paramtype">const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; CompactLatticeWeightTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a>, IntType &gt; &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticePrunedOptions&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01204">1204</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>

<p>References <a class="el" href="determinize-lattice-pruned_8cc_source.html#l00340">LatticeDeterminizerPruned&lt; Weight, IntType &gt;::Determinize()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00164">KALDI_LOG</a>, <a class="el" href="determinize-lattice-pruned_8cc_source.html#l00067">LatticeDeterminizerPruned&lt; Weight, IntType &gt;::Output()</a>, <a class="el" href="lattice-functions_8cc_source.html#l00187">kaldi::PruneLattice()</a>, and <a class="el" href="determinize-lattice-pruned_8h_source.html#l00120">DeterminizeLatticePrunedOptions::retry_cutoff</a>.</p>

<p>Referenced by <a class="el" href="lattice-simple-decoder_8cc_source.html#l00158">LatticeSimpleDecoder::GetLattice()</a>, <a class="el" href="lattice-faster-decoder_8cc_source.html#l00197">LatticeFasterDecoder::GetLattice()</a>, <a class="el" href="lattice-tracking-decoder_8cc_source.html#l00168">LatticeTrackingDecoder::GetLattice()</a>, <a class="el" href="lattice-biglm-faster-decoder_8h_source.html#l00204">LatticeBiglmFasterDecoder::GetLattice()</a>, <a class="el" href="lattice-determinize-pruned_8cc_source.html#l00027">main()</a>, <a class="el" href="lattice-determinize-pruned-parallel_8cc_source.html#l00046">DeterminizeLatticeTask::operator()()</a>, and <a class="el" href="confidence_8cc_source.html#l00085">kaldi::SentenceLevelConfidence()</a>.</p>
<div class="fragment"><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                          {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.OutputSymbols());</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="keywordflow">if</span> (ifst.NumStates() == 0) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    ofst-&gt;DeleteStates();</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;  }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(opts.retry_cutoff &gt;= 0.0 &amp;&amp; opts.retry_cutoff &lt; 1.0);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_num_iters = 10;  <span class="comment">// avoid the potential for infinite loops if</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;                             <span class="comment">// retrying.</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  VectorFst&lt;ArcTpl&lt;Weight&gt; &gt; temp_fst;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> iter = 0; iter &lt; max_num_iters; iter++) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    LatticeDeterminizerPruned&lt;Weight, IntType&gt; det(iter == 0 ? ifst : temp_fst,</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                                                   beam, opts);</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordtype">double</span> effective_beam;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordtype">bool</span> ans = det.Determinize(&amp;effective_beam);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="comment">// if it returns false it will typically still produce reasonable output,</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="comment">// just with a narrower beam than &quot;beam&quot;.  If the user specifies an infinite</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="comment">// beam we don&#39;t do this beam-narrowing.</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">if</span> (effective_beam &gt;= beam * opts.retry_cutoff ||</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        beam == std::numeric_limits&lt;double&gt;::infinity() ||</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        iter + 1 == max_num_iters) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      det.Output(ofst);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="comment">// The code below to set &quot;beam&quot; is a heuristic.</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      <span class="comment">// If effective_beam is very small, we want to reduce by a lot.</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="comment">// But never change the beam by more than a factor of two.</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="keywordflow">if</span> (effective_beam &lt; 0.0) effective_beam = 0.0;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordtype">double</span> new_beam = beam * sqrt(effective_beam / beam);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <span class="keywordflow">if</span> (new_beam &lt; 0.5 * beam) new_beam = 0.5 * beam;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      beam = new_beam;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      <span class="keywordflow">if</span> (iter == 0) temp_fst = ifst;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <a class="code" href="namespacekaldi.html#a206415e437a2e65abd8675ebe77c7c9b">kaldi::PruneLattice</a>(beam, &amp;temp_fst);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <a class="code" href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a> &lt;&lt; <span class="stringliteral">&quot;Pruned state-level lattice with beam &quot;</span> &lt;&lt; beam</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                &lt;&lt; <span class="stringliteral">&quot; and retrying determinization with that beam.&quot;</span>;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Suppress compiler warning; this code is unreachable.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a206415e437a2e65abd8675ebe77c7c9b"><div class="ttname"><a href="namespacekaldi.html#a206415e437a2e65abd8675ebe77c7c9b">kaldi::PruneLattice</a></div><div class="ttdeci">bool PruneLattice(BaseFloat beam, LatType *lat)</div><div class="ttdef"><b>Definition:</b> <a href="lattice-functions_8cc_source.html#l00187">lattice-functions.cc:187</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="group__error__group_html_gaf8fb55454306b60c9c1e07a6ef9d341a"><div class="ttname"><a href="group__error__group.html#gaf8fb55454306b60c9c1e07a6ef9d341a">KALDI_LOG</a></div><div class="ttdeci">#define KALDI_LOG</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00164">kaldi-error.h:164</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga599f3ab3855e6847f4b23777e14b18ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeLatticePruned </td>
          <td>(</td>
          <td class="paramtype">const ExpandedFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>prune</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; ArcTpl&lt; <a class="el" href="lattice-arcgraph_8cc.html#a2fdd196e46607f0d35b13369d9f9970d">Weight</a> &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DeterminizeLatticePrunedOptions&#160;</td>
          <td class="paramname"><em>opts</em> = <code>DeterminizeLatticePrunedOptions()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function implements the normal version of DeterminizeLattice, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side. </p>
<p>It also prunes using the beam in the "prune" parameter. The input FST must be topologically sorted in order for the algorithm to work. For efficiency it is recommended to sort ilabel as well. Returns true on success, and false if it had to terminate the determinization earlier than specified by the "prune" beam&ndash; that is, if it terminated because of the max_mem, max_loop or max_arcs constraints in the options. CAUTION: you may want to use the version below which outputs to CompactLattice. </p>

<p>Definition at line <a class="el" href="determinize-lattice-pruned_8cc_source.html#l01256">1256</a> of file <a class="el" href="determinize-lattice-pruned_8cc_source.html">determinize-lattice-pruned.cc</a>.</p>

<p>References <a class="el" href="determinize-lattice-pruned_8cc_source.html#l00340">LatticeDeterminizerPruned&lt; Weight, IntType &gt;::Determinize()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="determinize-lattice-pruned_8cc_source.html#l00067">LatticeDeterminizerPruned&lt; Weight, IntType &gt;::Output()</a>, <a class="el" href="lattice-functions_8cc_source.html#l00187">kaldi::PruneLattice()</a>, and <a class="el" href="determinize-lattice-pruned_8h_source.html#l00120">DeterminizeLatticePrunedOptions::retry_cutoff</a>.</p>
<div class="fragment"><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                                                    {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> IntType;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.OutputSymbols());</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(opts.retry_cutoff &gt;= 0.0 &amp;&amp; opts.retry_cutoff &lt; 1.0);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <span class="keywordflow">if</span> (ifst.NumStates() == 0) {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    ofst-&gt;DeleteStates();</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> max_num_iters = 10;  <span class="comment">// avoid the potential for infinite loops if</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                             <span class="comment">// retrying.</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  VectorFst&lt;ArcTpl&lt;Weight&gt; &gt; temp_fst;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> iter = 0; iter &lt; max_num_iters; iter++) {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    LatticeDeterminizerPruned&lt;Weight, IntType&gt; det(iter == 0 ? ifst : temp_fst,</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                                                   beam, opts);</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;    <span class="keywordtype">double</span> effective_beam;</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keywordtype">bool</span> ans = det.Determinize(&amp;effective_beam);</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// if it returns false it will typically still</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="comment">// produce reasonable output, just with a</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="comment">// narrower beam than &quot;beam&quot;.</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (effective_beam &gt;= beam * opts.retry_cutoff ||</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        iter + 1 == max_num_iters) {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      det.Output(ofst);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;      <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      <span class="comment">// The code below to set &quot;beam&quot; is a heuristic.</span></div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;      <span class="comment">// If effective_beam is very small, we want to reduce by a lot.</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;      <span class="comment">// But never change the beam by more than a factor of two.</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      <span class="keywordflow">if</span> (effective_beam &lt; 0)</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        effective_beam = 0;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      <span class="keywordtype">double</span> new_beam = beam * sqrt(effective_beam / beam);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      <span class="keywordflow">if</span> (new_beam &lt; 0.5 * beam) new_beam = 0.5 * beam;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Effective beam &quot;</span> &lt;&lt; effective_beam &lt;&lt; <span class="stringliteral">&quot; was less than beam &quot;</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                 &lt;&lt; beam &lt;&lt; <span class="stringliteral">&quot; * cutoff &quot;</span> &lt;&lt; opts.retry_cutoff &lt;&lt; <span class="stringliteral">&quot;, pruning raw &quot;</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;lattice with new beam &quot;</span> &lt;&lt; new_beam &lt;&lt; <span class="stringliteral">&quot; and retrying.&quot;</span>;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      beam = new_beam;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordflow">if</span> (iter == 0) temp_fst = ifst;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <a class="code" href="namespacekaldi.html#a206415e437a2e65abd8675ebe77c7c9b">kaldi::PruneLattice</a>(beam, &amp;temp_fst);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// Suppress compiler warning; this code is unreachable.</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a206415e437a2e65abd8675ebe77c7c9b"><div class="ttname"><a href="namespacekaldi.html#a206415e437a2e65abd8675ebe77c7c9b">kaldi::PruneLattice</a></div><div class="ttdeci">bool PruneLattice(BaseFloat beam, LatType *lat)</div><div class="ttdef"><b>Definition:</b> <a href="lattice-functions_8cc_source.html#l00187">lattice-functions.cc:187</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac6d4823e83f5353ae5b5ce569a7a29a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeStar </td>
          <td>(</td>
          <td class="paramtype">F &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; typename F::Arc &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>delta</em> = <code>kDelta</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>debug_ptr</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_states</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allow_partial</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function implements the normal version of DeterminizeStar, in which the output strings are represented using sequences of arcs, where all but the first one has an epsilon on the input side. </p>
<p>The debug_ptr argument is an optional pointer to a bool that, if it becomes true while the algorithm is executing, the algorithm will print a traceback and terminate (used in <a class="el" href="fstdeterminizestar_8cc.html">fstdeterminizestar.cc</a> debug non-terminating determinization). If max_states is positive, it will stop determinization and throw an exception as soon as the max-states is reached. This can be useful in test. If allow_partial is true, the algorithm will output partial results when the specified max_states is reached (when larger than zero), instead of throwing out an error. The function will return false if partial FST is generated, and true if the complete determinized FST is generated. </p>

<p>Definition at line <a class="el" href="determinize-star-inl_8h_source.html#l00632">632</a> of file <a class="el" href="determinize-star-inl_8h_source.html">determinize-star-inl.h</a>.</p>

<p>References <a class="el" href="determinize-star-inl_8h_source.html#l00192">DeterminizerStar&lt; F &gt;::Determinize()</a>, <a class="el" href="determinize-star-inl_8h_source.html#l00229">DeterminizerStar&lt; F &gt;::IsPartial()</a>, and <a class="el" href="determinize-star-inl_8h_source.html#l00871">DeterminizerStar&lt; F &gt;::Output()</a>.</p>

<p>Referenced by <a class="el" href="fstext-utils-inl_8h_source.html#l00441">fst::DeterminizeStarInLog()</a>, <a class="el" href="fstdeterminizestar_8cc_source.html#l00062">main()</a>, <a class="el" href="fstext-utils-inl_8h_source.html#l00427">fst::SafeDeterminizeMinimizeWrapper()</a>, <a class="el" href="fstext-utils-inl_8h_source.html#l00415">fst::SafeDeterminizeWrapper()</a>, <a class="el" href="determinize-star-test_8cc_source.html#l00069">fst::TestDeterminize()</a>, <a class="el" href="trivial-factor-weight-test_8cc_source.html#l00031">fst::TestFactor()</a>, and <a class="el" href="determinize-star-test_8cc_source.html#l00328">fst::TestMinimize()</a>.</p>
<div class="fragment"><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                                         {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.OutputSymbols());</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  DeterminizerStar&lt;F&gt; det(ifst, delta, max_states, allow_partial);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  det.Determinize(debug_ptr);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  det.Output(ofst);</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">return</span> det.IsPartial();</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa83b38f8e9a754bbd3ed552bef274977"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DeterminizeStar </td>
          <td>(</td>
          <td class="paramtype">F &amp;&#160;</td>
          <td class="paramname"><em>ifst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MutableFst&lt; GallicArc&lt; typename F::Arc &gt; &gt; *&#160;</td>
          <td class="paramname"><em>ofst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool *&#160;</td>
          <td class="paramname"><em>debug_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>allow_partial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="determinize-star-inl_8h_source.html#l00645">645</a> of file <a class="el" href="determinize-star-inl_8h_source.html">determinize-star-inl.h</a>.</p>

<p>References <a class="el" href="determinize-star-inl_8h_source.html#l00192">DeterminizerStar&lt; F &gt;::Determinize()</a>, <a class="el" href="determinize-star-inl_8h_source.html#l00229">DeterminizerStar&lt; F &gt;::IsPartial()</a>, and <a class="el" href="determinize-star-inl_8h_source.html#l00871">DeterminizerStar&lt; F &gt;::Output()</a>.</p>
<div class="fragment"><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                         {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  ofst-&gt;SetOutputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  ofst-&gt;SetInputSymbols(ifst.InputSymbols());</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  DeterminizerStar&lt;F&gt; det(ifst, delta, max_states, allow_partial);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  det.Determinize(debug_ptr);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  det.Output(ofst);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">return</span> det.IsPartial();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:39 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
