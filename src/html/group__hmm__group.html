<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: Classes and functions related to HMM topology and transition modeling</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__hmm__group.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Classes and functions related to HMM topology and transition modeling</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Classes and functions related to HMM topology and transition modeling:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__hmm__group.png" border="0" alt="" usemap="#group____hmm____group"/>
<map name="group____hmm____group" id="group____hmm____group">
<area shape="rect" id="node2" href="group__hmm__group__graph.html" title="Classes and functions\l for creating FSTs from HMMs" alt="" coords="237,11,445,53"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__hmm__group__graph"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group__graph.html">Classes and functions for creating FSTs from HMMs</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1HmmTopology.html">HmmTopology</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A class for storing topology information for phones.  <a href="classkaldi_1_1HmmTopology.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1MleTransitionUpdateConfig.html">MleTransitionUpdateConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structkaldi_1_1MapTransitionUpdateConfig.html">MapTransitionUpdateConfig</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1TransitionModel.html">TransitionModel</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8de8a15a25238f4a7834e4b38ccf3a4b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#ga8de8a15a25238f4a7834e4b38ccf3a4b">SplitToPhones</a> (const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;alignment, std::vector&lt; std::vector&lt; int32 &gt; &gt; *split_alignment)</td></tr>
<tr class="memdesc:ga8de8a15a25238f4a7834e4b38ccf3a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">SplitToPhones splits up the TransitionIds in "alignment" into their individual phones (one vector per instance of a phone).  <a href="#ga8de8a15a25238f4a7834e4b38ccf3a4b">More...</a><br/></td></tr>
<tr class="separator:ga8de8a15a25238f4a7834e4b38ccf3a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7843faa64ea1253826f4e23900d4f9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#gaa7843faa64ea1253826f4e23900d4f9a">ConvertAlignment</a> (const TransitionModel &amp;old_trans_model, const TransitionModel &amp;new_trans_model, const ContextDependencyInterface &amp;new_ctx_dep, const std::vector&lt; int32 &gt; &amp;old_alignment, int32 subsample_factor,bool reorder, const std::vector&lt; int32 &gt; *phone_map,std::vector&lt; int32 &gt; *new_alignment)</td></tr>
<tr class="memdesc:gaa7843faa64ea1253826f4e23900d4f9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">ConvertAlignment converts an alignment that was created using one model, to another model.  <a href="#gaa7843faa64ea1253826f4e23900d4f9a">More...</a><br/></td></tr>
<tr class="separator:gaa7843faa64ea1253826f4e23900d4f9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga195962035fa801828842ad8f64b49b14"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#ga195962035fa801828842ad8f64b49b14">ConvertPhnxToProns</a> (const std::vector&lt; int32 &gt; &amp;phnx, const std::vector&lt; int32 &gt; &amp;<a class="el" href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a>, int32 word_start_sym, int32 word_end_sym, std::vector&lt; std::vector&lt; int32 &gt; &gt; *prons)</td></tr>
<tr class="separator:ga195962035fa801828842ad8f64b49b14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafbe0662d074548f56f4507ff3030ffc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#gafbe0662d074548f56f4507ff3030ffc0">GetRandomAlignmentForPhone</a> (const ContextDependencyInterface &amp;ctx_dep, const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;phone_window, std::vector&lt; int32 &gt; *alignment)</td></tr>
<tr class="separator:gafbe0662d074548f56f4507ff3030ffc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02c0f6b69373c2c6a3a05e0afc38199e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#ga02c0f6b69373c2c6a3a05e0afc38199e">ChangeReorderingOfAlignment</a> (const TransitionModel &amp;trans_model, std::vector&lt; int32 &gt; *alignment)</td></tr>
<tr class="separator:ga02c0f6b69373c2c6a3a05e0afc38199e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0f3ce35b5963c3277c0f53d36bd11ad"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#gac0f3ce35b5963c3277c0f53d36bd11ad">GetPdfsForPhones</a> (const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;phones, std::vector&lt; int32 &gt; *pdfs)</td></tr>
<tr class="memdesc:gac0f3ce35b5963c3277c0f53d36bd11ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Works out which pdfs might correspond to the given phones.  <a href="#gac0f3ce35b5963c3277c0f53d36bd11ad">More...</a><br/></td></tr>
<tr class="separator:gac0f3ce35b5963c3277c0f53d36bd11ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a78a689d7521569166e52cc1e19c2c7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#ga4a78a689d7521569166e52cc1e19c2c7">GetPhonesForPdfs</a> (const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;pdfs, std::vector&lt; int32 &gt; *phones)</td></tr>
<tr class="memdesc:ga4a78a689d7521569166e52cc1e19c2c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Works out which phones might correspond to the given pdfs.  <a href="#ga4a78a689d7521569166e52cc1e19c2c7">More...</a><br/></td></tr>
<tr class="separator:ga4a78a689d7521569166e52cc1e19c2c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gad94539d80f1ba0b8731c6692b624b7a3"><td class="memItemLeft" align="right" valign="top">static const int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#gad94539d80f1ba0b8731c6692b624b7a3">kNoPdf</a> = -1</td></tr>
<tr class="memdesc:gad94539d80f1ba0b8731c6692b624b7a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">A constant used in the <a class="el" href="classkaldi_1_1HmmTopology.html" title="A class for storing topology information for phones. ">HmmTopology</a> class as the <a class="el" href="hmm.html#pdf_class">pdf-class</a> kNoPdf, which is used when a HMM-state is nonemitting (has no associated PDF).  <a href="#gad94539d80f1ba0b8731c6692b624b7a3">More...</a><br/></td></tr>
<tr class="separator:gad94539d80f1ba0b8731c6692b624b7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Integer mapping functions</h2></td></tr>
<tr class="memitem:ga1fb8326e780cac6c317f7e8dd2bc14dc"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__hmm__group.html#ga1fb8326e780cac6c317f7e8dd2bc14dc">TransitionIdToPdf</a> (int32 trans_id) const </td></tr>
<tr class="separator:ga1fb8326e780cac6c317f7e8dd2bc14dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga02c0f6b69373c2c6a3a05e0afc38199e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ChangeReorderingOfAlignment </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hmm-utils_8cc_source.html#l01140">1140</a> of file <a class="el" href="hmm-utils_8cc_source.html">hmm-utils.cc</a>.</p>

<p>References <a class="el" href="transition-model_8cc_source.html#l00228">TransitionModel::IsSelfLoop()</a>, <a class="el" href="basic-filebuf_8h_source.html#l00275">kaldi::swap()</a>, and <a class="el" href="transition-model_8cc_source.html#l00169">TransitionModel::TransitionIdToTransitionState()</a>.</p>

<p>Referenced by <a class="el" href="hmm-utils_8cc_source.html#l00707">kaldi::ConvertAlignmentForPhone()</a>.</p>
<div class="fragment"><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                                                              {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> start_pos = 0, size = alignment-&gt;size();</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">while</span> (start_pos != size) {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> start_tid = (*alignment)[start_pos];</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_tstate = trans_model.TransitionIdToTransitionState(start_tid);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordtype">bool</span> start_is_self_loop = trans_model.IsSelfLoop(start_tid) ? 0 : 1;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> end_pos = start_pos + 1;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="comment">// If the first instance of this transition-state was a self-loop, then eat</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="comment">// only non-self-loops of this state; if it was a non-self-loop, then eat</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// only self-loops of this state.  Imposing this condition on self-loops</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="comment">// would only actually matter in the rare circumstances that phones can</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">// have length 1.</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">while</span> (end_pos != size &amp;&amp;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;           trans_model.TransitionIdToTransitionState((*alignment)[end_pos]) ==</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;           cur_tstate) {</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      <span class="keywordtype">bool</span> this_is_self_loop = trans_model.IsSelfLoop((*alignment)[end_pos]);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      <span class="keywordflow">if</span> (!this_is_self_loop) {</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">if</span> (start_is_self_loop) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          <span class="keywordflow">break</span>;  <span class="comment">// stop before including this transition-id.</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;          end_pos++;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;          <span class="keywordflow">break</span>;  <span class="comment">// stop after including this transition-id.</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        }</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      end_pos++;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <a class="code" href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">std::swap</a>((*alignment)[start_pos], (*alignment)[end_pos - 1]);</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    start_pos = end_pos;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_aa3e99328db564bc2bf6397fa1eaee4d7"><div class="ttname"><a href="namespacekaldi.html#aa3e99328db564bc2bf6397fa1eaee4d7">kaldi::swap</a></div><div class="ttdeci">void swap(basic_filebuf&lt; CharT, Traits &gt; &amp;x, basic_filebuf&lt; CharT, Traits &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="basic-filebuf_8h_source.html#l00275">basic-filebuf.h:275</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa7843faa64ea1253826f4e23900d4f9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ConvertAlignment </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>old_trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>new_trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ContextDependencyInterface &amp;&#160;</td>
          <td class="paramname"><em>new_ctx_dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>old_alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>subsample_factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reorder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>phone_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>new_alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>ConvertAlignment converts an alignment that was created using one model, to another model. </p>
<p>Returns false if it could not be split to phones (e.g. because the alignment was partial), or because some other error happened, such as we couldn't convert the alignment because there were too few frames for the new topology.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">old_trans_model</td><td>[in] The transition model that the original alignment used. </td></tr>
    <tr><td class="paramname">new_trans_model</td><td>[in] The transition model that we want to use for the new alignment. </td></tr>
    <tr><td class="paramname">new_ctx_dep</td><td>[in] The new tree </td></tr>
    <tr><td class="paramname">old_alignment</td><td>[in] The alignment we want to convert </td></tr>
    <tr><td class="paramname">subsample_factor</td><td>[in] The frame subsampling factor... normally 1, but might be &gt; 1 if we're converting to a reduced-frame-rate system. </td></tr>
    <tr><td class="paramname">reorder</td><td>[in] True if you want the pdf-ids on the new alignment to be 'reordered'. (vs. the way they appear in the <a class="el" href="classkaldi_1_1HmmTopology.html" title="A class for storing topology information for phones. ">HmmTopology</a> object) </td></tr>
    <tr><td class="paramname">phone_map</td><td>[in] If non-NULL, map from old to new phones. </td></tr>
    <tr><td class="paramname">new_alignment</td><td>[out] The converted alignment. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="hmm-utils_8cc_source.html#l00859">859</a> of file <a class="el" href="hmm-utils_8cc_source.html">hmm-utils.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1ContextDependencyInterface.html#a63785b3c15a9e59679d01e91ec5deb32">ContextDependencyInterface::CentralPosition()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00790">kaldi::ComputeNewPhoneLengths()</a>, <a class="el" href="classkaldi_1_1ContextDependencyInterface.html#a5ab5836712a8f5537f9b88d05f429c42">ContextDependencyInterface::ContextWidth()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00707">kaldi::ConvertAlignmentForPhone()</a>, <a class="el" href="transition-model_8h_source.html#l00139">TransitionModel::GetTopo()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="hmm-utils_8cc_source.html#l00590">kaldi::IsReordered()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, <a class="el" href="kaldi-error_8h_source.html#l00162">KALDI_WARN</a>, <a class="el" href="hmm-utils_8cc_source.html#l00688">kaldi::SplitToPhones()</a>, and <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>.</p>

<p>Referenced by <a class="el" href="convert-ali_8cc_source.html#l00029">main()</a>, and <a class="el" href="hmm-utils-test_8cc_source.html#l00232">kaldi::TestConvertAlignment()</a>.</p>
<div class="fragment"><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                                       {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="keywordtype">bool</span> old_is_reordered = <a class="code" href="namespacekaldi.html#aa155e453f2d41dbeec5658a2cccf79b2">IsReordered</a>(old_trans_model, old_alignment);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(new_alignment != NULL);</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  new_alignment-&gt;clear();</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  new_alignment-&gt;reserve(old_alignment.size());</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; old_split;  <span class="comment">// split into phones.</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="group__hmm__group.html#ga8de8a15a25238f4a7834e4b38ccf3a4b">SplitToPhones</a>(old_trans_model, old_alignment, &amp;old_split))</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> phone_sequence_length = old_split.size();</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  std::vector&lt;int32&gt; mapped_phones(phone_sequence_length);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; phone_sequence_length; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(!old_split[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].empty());</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    mapped_phones[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = old_trans_model.TransitionIdToPhone(old_split[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][0]);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <span class="keywordflow">if</span> (phone_map != NULL) {  <span class="comment">// Map the phone sequence.</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> sz = phone_map-&gt;size();</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      <span class="keywordflow">if</span> (mapped_phones[i] &lt; 0 || mapped_phones[i] &gt;= sz ||</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          (*phone_map)[mapped_phones[i]] == -1)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;ConvertAlignment: could not map phone &quot;</span> &lt;&lt; mapped_phones[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      mapped_phones[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>] = (*phone_map)[mapped_phones[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>]];</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">// the sizes of each element of &#39;new_split&#39; indicate the length of alignment</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">// that we want for each phone in the new sequence.</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  std::vector&lt;std::vector&lt;int32&gt; &gt; new_split(phone_sequence_length);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  <span class="keywordflow">if</span> (subsample_factor == 1 &amp;&amp;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      old_trans_model.GetTopo() == new_trans_model.GetTopo()) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="comment">// we know the old phone lengths will be fine.</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; phone_sequence_length; i++)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      new_split[i].resize(old_split[i].size());</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    <span class="comment">// .. they may not be fine.</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    std::vector&lt;int32&gt; old_lengths(phone_sequence_length), new_lengths;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0; i &lt; phone_sequence_length; i++)</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      old_lengths[i] = old_split[i].size();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespacekaldi.html#a24917ac2a0edac09556b98711410a32b">ComputeNewPhoneLengths</a>(new_trans_model.GetTopo(),</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                                mapped_phones, old_lengths,</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                                subsample_factor, &amp;new_lengths)) {</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <a class="code" href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a> &lt;&lt; <span class="stringliteral">&quot;Failed to produce suitable phone lengths&quot;</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> i = 0; i &lt; phone_sequence_length; i++)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;      new_split[i].resize(new_lengths[i]);</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  }</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> N = new_ctx_dep.ContextWidth(),</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;      P = new_ctx_dep.CentralPosition();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// by starting at -N and going to phone_sequence_length + N, we&#39;re</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// being generous and not bothering to work out the exact</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// array bounds.</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> win_start = -N;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;       win_start &lt; static_cast&lt;int32&gt;(phone_sequence_length + N);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;       win_start++) {  <span class="comment">// start of a context window.</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> central_pos = win_start + P;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (static_cast&lt;size_t&gt;(central_pos) &lt; phone_sequence_length) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;      <span class="comment">// i.e. if (central_pos &gt;= 0 &amp;&amp; central_pos &lt; phone_sequence_length)</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      std::vector&lt;int32&gt; new_phone_window(N, 0);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> offset = 0; offset &lt; N; offset++)</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span> (static_cast&lt;size_t&gt;(win_start+offset) &lt; phone_sequence_length)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          new_phone_window[offset] = mapped_phones[win_start+offset];</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keyword">const</span> std::vector&lt;int32&gt; &amp;old_alignment_for_phone = old_split[central_pos];</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      std::vector&lt;int32&gt; &amp;new_alignment_for_phone = new_split[central_pos];</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;      <a class="code" href="namespacekaldi.html#a7ba7ead11bc18a0e3179cfac7720b88d">ConvertAlignmentForPhone</a>(old_trans_model, new_trans_model, new_ctx_dep,</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                               old_alignment_for_phone, new_phone_window,</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                               old_is_reordered, new_is_reordered,</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                               &amp;new_alignment_for_phone);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      new_alignment-&gt;insert(new_alignment-&gt;end(),</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                            new_alignment_for_phone.begin(),</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                            new_alignment_for_phone.end());</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(new_alignment-&gt;size() ==</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;               (old_alignment.size() + subsample_factor - 1)/subsample_factor);</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_aa155e453f2d41dbeec5658a2cccf79b2"><div class="ttname"><a href="namespacekaldi.html#aa155e453f2d41dbeec5658a2cccf79b2">kaldi::IsReordered</a></div><div class="ttdeci">static bool IsReordered(const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;alignment)</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00590">hmm-utils.cc:590</a></div></div>
<div class="ttc" id="group__hmm__group_html_ga8de8a15a25238f4a7834e4b38ccf3a4b"><div class="ttname"><a href="group__hmm__group.html#ga8de8a15a25238f4a7834e4b38ccf3a4b">kaldi::SplitToPhones</a></div><div class="ttdeci">bool SplitToPhones(const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;alignment, std::vector&lt; std::vector&lt; int32 &gt; &gt; *split_alignment)</div><div class="ttdoc">SplitToPhones splits up the TransitionIds in &quot;alignment&quot; into their individual phones (one vector per...</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00688">hmm-utils.cc:688</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="group__error__group_html_ga994be213ddf127b5d6f20a43a02b513a"><div class="ttname"><a href="group__error__group.html#ga994be213ddf127b5d6f20a43a02b513a">KALDI_WARN</a></div><div class="ttdeci">#define KALDI_WARN</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00162">kaldi-error.h:162</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a7ba7ead11bc18a0e3179cfac7720b88d"><div class="ttname"><a href="namespacekaldi.html#a7ba7ead11bc18a0e3179cfac7720b88d">kaldi::ConvertAlignmentForPhone</a></div><div class="ttdeci">static void ConvertAlignmentForPhone(const TransitionModel &amp;old_trans_model, const TransitionModel &amp;new_trans_model, const ContextDependencyInterface &amp;new_ctx_dep, const std::vector&lt; int32 &gt; &amp;old_phone_alignment, const std::vector&lt; int32 &gt; &amp;new_phone_window, bool old_is_reordered, bool new_is_reordered, std::vector&lt; int32 &gt; *new_phone_alignment)</div><div class="ttdoc">This function is used internally inside ConvertAlignment; it converts the alignment for a single phon...</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00707">hmm-utils.cc:707</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a24917ac2a0edac09556b98711410a32b"><div class="ttname"><a href="namespacekaldi.html#a24917ac2a0edac09556b98711410a32b">kaldi::ComputeNewPhoneLengths</a></div><div class="ttdeci">static bool ComputeNewPhoneLengths(const HmmTopology &amp;topology, const std::vector&lt; int32 &gt; &amp;mapped_phones, const std::vector&lt; int32 &gt; &amp;old_lengths, int32 subsample_factor, std::vector&lt; int32 &gt; *new_lengths)</div><div class="ttdoc">This function, called from ConvertAlignment(), works out suitable new lengths of phones in the case w...</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00790">hmm-utils.cc:790</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga195962035fa801828842ad8f64b49b14"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ConvertPhnxToProns </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phnx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>words</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>word_start_sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>word_end_sym</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>prons</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hmm-utils_8cc_source.html#l01041">1041</a> of file <a class="el" href="hmm-utils_8cc_source.html">hmm-utils.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>.</p>

<p>Referenced by <a class="el" href="phones-to-prons_8cc_source.html#l00062">main()</a>, and <a class="el" href="hmm-utils-test_8cc_source.html#l00028">kaldi::TestConvertPhnxToProns()</a>.</p>
<div class="fragment"><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                                                             {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;  <span class="keywordflow">while</span> (i &lt; phnx.size()) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">if</span> (phnx[i] == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// zeros not valid here.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">if</span> (phnx[i] == word_start_sym) { <span class="comment">// start a word...</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      std::vector&lt;int32&gt; pron;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &gt;= <a class="code" href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a>.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no word left..</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a>[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>] == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// zero word disallowed.</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;      pron.push_back(<a class="code" href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a>[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++]);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      i++;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <span class="keywordflow">while</span> (i &lt; phnx.size()) {</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == word_start_sym) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// error.</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == word_end_sym) { i++; <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        pron.push_back(phnx[i]);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        i++;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;      <span class="comment">// check we did see the word-end symbol.</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;      <span class="keywordflow">if</span> (!(i &gt; 0 &amp;&amp; phnx[i-1] == word_end_sym))</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      prons-&gt;push_back(pron);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phnx[i] == word_end_sym) {</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;  <span class="comment">// error.</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="comment">// start a non-word sequence of phones (e.g. opt-sil).</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      std::vector&lt;int32&gt; pron;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      pron.push_back(0); <span class="comment">// 0 serves as the word-id.</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <span class="keywordflow">while</span> (i &lt; phnx.size()) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == word_start_sym) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span> (phnx[i] == word_end_sym) <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// error.</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        pron.push_back(phnx[i]);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        i++;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      }</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      prons-&gt;push_back(pron);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> == <a class="code" href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a>.size());</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;}</div>
<div class="ttc" id="arpa-file-parser-test_8cc_html_a1e047defc56305925400c84666b87df3"><div class="ttname"><a href="arpa-file-parser-test_8cc.html#a1e047defc56305925400c84666b87df3">words</a></div><div class="ttdeci">int32 words[kMaxOrder]</div><div class="ttdef"><b>Definition:</b> <a href="arpa-file-parser-test_8cc_source.html#l00042">arpa-file-parser-test.cc:42</a></div></div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac0f3ce35b5963c3277c0f53d36bd11ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetPdfsForPhones </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phones</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>pdfs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Works out which pdfs might correspond to the given phones. </p>
<p>Will return true if these pdfs correspond *just* to these phones, false if these pdfs are also used by other phones. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trans_model</td><td>[in] Transition-model used to work out this information </td></tr>
    <tr><td class="paramname">phones</td><td>[in] A sorted, uniq vector that represents a set of phones </td></tr>
    <tr><td class="paramname">pdfs</td><td>[out] Will be set to a sorted, uniq list of pdf-ids that correspond to one of this set of phones. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if all of the pdfs output to "pdfs" correspond to phones from just this set (false if they may be shared with phones outside this set). </dd></dl>

<p>Definition at line <a class="el" href="transition-model_8cc_source.html#l00697">697</a> of file <a class="el" href="transition-model_8cc_source.html">transition-model.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="transition-model_8h_source.html#l00175">TransitionModel::NumTransitionStates()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="transition-model_8cc_source.html#l00184">TransitionModel::TransitionStateToPdf()</a>, and <a class="el" href="transition-model_8cc_source.html#l00179">TransitionModel::TransitionStateToPhone()</a>.</p>

<p>Referenced by <a class="el" href="gmm-boost-silence_8cc_source.html#l00025">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                              {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(phones));</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(pdfs != NULL);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;  pdfs-&gt;clear();</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tstate = 1; tstate &lt;= trans_model.NumTransitionStates(); tstate++) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (std::binary_search(phones.begin(), phones.end(),</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                          trans_model.TransitionStateToPhone(tstate)))</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      pdfs-&gt;push_back(trans_model.TransitionStateToPdf(tstate));</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;  }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(pdfs);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tstate = 1; tstate &lt;= trans_model.NumTransitionStates(); tstate++)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span> (std::binary_search(pdfs-&gt;begin(), pdfs-&gt;end(),</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                          trans_model.TransitionStateToPdf(tstate))</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;       &amp;&amp; !std::binary_search(phones.begin(), phones.end(),</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                              trans_model.TransitionStateToPhone(tstate)))</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4a78a689d7521569166e52cc1e19c2c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetPhonesForPdfs </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>pdfs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>phones</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Works out which phones might correspond to the given pdfs. </p>
<p>Similar to the above GetPdfsForPhones(, ,) </p>

<p>Definition at line <a class="el" href="transition-model_8cc_source.html#l00719">719</a> of file <a class="el" href="transition-model_8cc_source.html">transition-model.cc</a>.</p>

<p>References <a class="el" href="stl-utils_8h_source.html#l00075">kaldi::IsSortedAndUniq()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="transition-model_8h_source.html#l00175">TransitionModel::NumTransitionStates()</a>, <a class="el" href="stl-utils_8h_source.html#l00051">kaldi::SortAndUniq()</a>, <a class="el" href="transition-model_8cc_source.html#l00184">TransitionModel::TransitionStateToPdf()</a>, and <a class="el" href="transition-model_8cc_source.html#l00179">TransitionModel::TransitionStateToPhone()</a>.</p>

<p>Referenced by <a class="el" href="gmm-init-model_8cc_source.html#l00035">kaldi::InitAmGmm()</a>.</p>
<div class="fragment"><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                               {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(<a class="code" href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">IsSortedAndUniq</a>(pdfs));</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(phones != NULL);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  phones-&gt;clear();</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tstate = 1; tstate &lt;= trans_model.NumTransitionStates(); tstate++) {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">if</span> (std::binary_search(pdfs.begin(), pdfs.end(),</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                           trans_model.TransitionStateToPdf(tstate)))</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      phones-&gt;push_back(trans_model.TransitionStateToPhone(tstate));</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <a class="code" href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">SortAndUniq</a>(phones);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tstate = 1; tstate &lt;= trans_model.NumTransitionStates(); tstate++)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (std::binary_search(phones-&gt;begin(), phones-&gt;end(),</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                           trans_model.TransitionStateToPhone(tstate))</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        &amp;&amp; !std::binary_search(pdfs.begin(), pdfs.end(),</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                               trans_model.TransitionStateToPdf(tstate)))</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a3dd7a9cc33032bfb870b4b6c053822db"><div class="ttname"><a href="namespacekaldi.html#a3dd7a9cc33032bfb870b4b6c053822db">kaldi::SortAndUniq</a></div><div class="ttdeci">void SortAndUniq(std::vector&lt; T &gt; *vec)</div><div class="ttdoc">Sorts and uniq&#39;s (removes duplicates) from a vector. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00051">stl-utils.h:51</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a81dfa76eeac63eba502e32ee58e37d57"><div class="ttname"><a href="namespacekaldi.html#a81dfa76eeac63eba502e32ee58e37d57">kaldi::IsSortedAndUniq</a></div><div class="ttdeci">bool IsSortedAndUniq(const std::vector&lt; T &gt; &amp;vec)</div><div class="ttdoc">Returns true if the vector is sorted and contains each element only once. </div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00075">stl-utils.h:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gafbe0662d074548f56f4507ff3030ffc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetRandomAlignmentForPhone </td>
          <td>(</td>
          <td class="paramtype">const ContextDependencyInterface &amp;&#160;</td>
          <td class="paramname"><em>ctx_dep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>phone_window</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32 &gt; *&#160;</td>
          <td class="paramname"><em>alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="hmm-utils_8cc_source.html#l01087">1087</a> of file <a class="el" href="hmm-utils_8cc_source.html">hmm-utils.cc</a>.</p>

<p>References <a class="el" href="classkaldi_1_1ContextDependencyInterface.html#a63785b3c15a9e59679d01e91ec5deb32">ContextDependencyInterface::CentralPosition()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00169">kaldi::GetHmmAsFstSimple()</a>, <a class="el" href="fstext-utils-inl_8h_source.html#l00097">fst::GetInputSymbols()</a>, <a class="el" href="transition-model_8h_source.html#l00139">TransitionModel::GetTopo()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="hmm-topology_8cc_source.html#l00294">HmmTopology::MinLength()</a>.</p>

<p>Referenced by <a class="el" href="hmm-utils_8cc_source.html#l00707">kaldi::ConvertAlignmentForPhone()</a>.</p>
<div class="fragment"><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                                             {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keyword">typedef</span> <a class="code" href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a> <a class="code" href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">Arc</a>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> length = alignment-&gt;size();</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> prob_scale = 0.0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  fst::VectorFst&lt;Arc&gt; *fst = <a class="code" href="group__hmm__group__graph.html#gac4ea836399551f07c71147098f8c6b47">GetHmmAsFstSimple</a>(phone_window, ctx_dep,</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                                               trans_model, prob_scale);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  fst::RmEpsilon(fst);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  fst::VectorFst&lt;Arc&gt; length_constraint_fst;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  {  <span class="comment">// set up length_constraint_fst.</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    std::vector&lt;int32&gt; symbols;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordtype">bool</span> include_epsilon = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// note: &#39;fst&#39; is an acceptor so ilabels == olabels.</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="namespacefst.html#a497c657ffe831f50f0de2ce5c296beb6">GetInputSymbols</a>(*fst, include_epsilon, &amp;symbols);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> cur_state = length_constraint_fst.AddState();</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    length_constraint_fst.SetStart(cur_state);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; length; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> next_state = length_constraint_fst.AddState();</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; symbols.size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        length_constraint_fst.AddArc(cur_state,</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                                     <a class="code" href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">Arc</a>(symbols[<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>], symbols[j],</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                                         fst::TropicalWeight::One(),</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                         next_state));</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;      cur_state = next_state;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    length_constraint_fst.SetFinal(cur_state, fst::TropicalWeight::One());</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  fst::VectorFst&lt;Arc&gt; composed_fst;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  fst::Compose(*fst, length_constraint_fst, &amp;composed_fst);</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  fst::VectorFst&lt;Arc&gt; single_path_fst;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  {  <span class="comment">// randomly generate a single path.</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    fst::UniformArcSelector&lt;Arc&gt; selector;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    fst::RandGenOptions&lt;fst::UniformArcSelector&lt;Arc&gt; &gt; randgen_opts(selector);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    fst::RandGen(composed_fst, &amp;single_path_fst, randgen_opts);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  }</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <span class="keywordflow">if</span> (single_path_fst.NumStates() == 0) {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error generating random alignment (wrong length?): &quot;</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;requested length is &quot;</span> &lt;&lt; length &lt;&lt; <span class="stringliteral">&quot; versus min-length &quot;</span></div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;              &lt;&lt; trans_model.GetTopo().MinLength(</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                  phone_window[ctx_dep.CentralPosition()]);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;  }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  std::vector&lt;int32&gt; symbol_sequence;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordtype">bool</span> ans = fst::GetLinearSymbolSequence&lt;Arc, int32&gt;(</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      single_path_fst, &amp;symbol_sequence, NULL, NULL);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(ans &amp;&amp; symbol_sequence.size() == length);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  symbol_sequence.swap(*alignment);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <span class="keyword">delete</span> fst;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacefst_html_a70478eb2428a9406e4692d19a7a3a97f"><div class="ttname"><a href="namespacefst.html#a70478eb2428a9406e4692d19a7a3a97f">fst::StdArc</a></div><div class="ttdeci">fst::StdArc StdArc</div><div class="ttdef"><b>Definition:</b> <a href="deterministic-fst-test_8cc_source.html#l00053">deterministic-fst-test.cc:53</a></div></div>
<div class="ttc" id="namespacefst_html_a497c657ffe831f50f0de2ce5c296beb6"><div class="ttname"><a href="namespacefst.html#a497c657ffe831f50f0de2ce5c296beb6">fst::GetInputSymbols</a></div><div class="ttdeci">void GetInputSymbols(const Fst&lt; Arc &gt; &amp;fst, bool include_eps, vector&lt; I &gt; *symbols)</div><div class="ttdoc">GetInputSymbols gets the list of symbols on the input of fst (including epsilon, if include_eps == tr...</div><div class="ttdef"><b>Definition:</b> <a href="fstext-utils-inl_8h_source.html#l00097">fstext-utils-inl.h:97</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacekaldi_html_a4ce48a4aa890590d2bbbeaa26cdac97b"><div class="ttname"><a href="namespacekaldi.html#a4ce48a4aa890590d2bbbeaa26cdac97b">kaldi::Arc</a></div><div class="ttdeci">KwsLexicographicArc Arc</div><div class="ttdef"><b>Definition:</b> <a href="kws-search_8cc_source.html#l00028">kws-search.cc:28</a></div></div>
<div class="ttc" id="group__hmm__group__graph_html_gac4ea836399551f07c71147098f8c6b47"><div class="ttname"><a href="group__hmm__group__graph.html#gac4ea836399551f07c71147098f8c6b47">kaldi::GetHmmAsFstSimple</a></div><div class="ttdeci">fst::VectorFst&lt; fst::StdArc &gt; * GetHmmAsFstSimple(std::vector&lt; int32 &gt; phone_window, const ContextDependencyInterface &amp;ctx_dep, const TransitionModel &amp;trans_model, BaseFloat prob_scale)</div><div class="ttdoc">Included mainly as a form of documentation, not used in any other code currently. ...</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00169">hmm-utils.cc:169</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8de8a15a25238f4a7834e4b38ccf3a4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SplitToPhones </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>alignment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; int32 &gt; &gt; *&#160;</td>
          <td class="paramname"><em>split_alignment</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SplitToPhones splits up the TransitionIds in "alignment" into their individual phones (one vector per instance of a phone). </p>
<p>At output, the sum of the sizes of the vectors in split_alignment will be the same as the corresponding sum for "alignment". The function returns true on success. If the alignment appears to be incomplete, e.g. not ending at the end-state of a phone, it will still break it up into phones but it will return false. For more serious errors it will die or throw an exception. This function works out by itself whether the graph was created with "reordering", and just does the right thing. </p>

<p>Definition at line <a class="el" href="hmm-utils_8cc_source.html#l00688">688</a> of file <a class="el" href="hmm-utils_8cc_source.html">hmm-utils.cc</a>.</p>

<p>References <a class="el" href="hmm-utils_8cc_source.html#l00590">kaldi::IsReordered()</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="hmm-utils_8cc_source.html#l00624">kaldi::SplitToPhonesInternal()</a>.</p>

<p>Referenced by <a class="el" href="sgmm-clusterable_8cc_source.html#l00198">kaldi::AccumulateSgmmTreeStats()</a>, <a class="el" href="tree-accu_8cc_source.html#l00036">kaldi::AccumulateTreeStats()</a>, <a class="el" href="lattice-functions_8cc_source.html#l00972">kaldi::CompactLatticeToWordProns()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00859">kaldi::ConvertAlignment()</a>, <a class="el" href="word-align-lattice-lexicon_8cc_source.html#l00745">kaldi::IsPlausibleWord()</a>, <a class="el" href="ali-to-phones_8cc_source.html#l00028">main()</a>, <a class="el" href="hmm-utils-test_8cc_source.html#l00232">kaldi::TestConvertAlignment()</a>, and <a class="el" href="hmm-utils-test_8cc_source.html#l00203">kaldi::TestSplitToPhones()</a>.</p>
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                                                                  {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(split_alignment != NULL);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  split_alignment-&gt;clear();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;  <span class="keywordtype">bool</span> is_reordered = <a class="code" href="namespacekaldi.html#aa155e453f2d41dbeec5658a2cccf79b2">IsReordered</a>(trans_model, alignment);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacekaldi.html#aa3d5c28d3187ac6a3bc3bba44821001e">SplitToPhonesInternal</a>(trans_model, alignment,</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                               is_reordered, split_alignment);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_aa155e453f2d41dbeec5658a2cccf79b2"><div class="ttname"><a href="namespacekaldi.html#aa155e453f2d41dbeec5658a2cccf79b2">kaldi::IsReordered</a></div><div class="ttdeci">static bool IsReordered(const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;alignment)</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00590">hmm-utils.cc:590</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa3d5c28d3187ac6a3bc3bba44821001e"><div class="ttname"><a href="namespacekaldi.html#aa3d5c28d3187ac6a3bc3bba44821001e">kaldi::SplitToPhonesInternal</a></div><div class="ttdeci">static bool SplitToPhonesInternal(const TransitionModel &amp;trans_model, const std::vector&lt; int32 &gt; &amp;alignment, bool reordered, std::vector&lt; std::vector&lt; int32 &gt; &gt; *split_output)</div><div class="ttdef"><b>Definition:</b> <a href="hmm-utils_8cc_source.html#l00624">hmm-utils.cc:624</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1fb8326e780cac6c317f7e8dd2bc14dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int32 TransitionIdToPdf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a>&#160;</td>
          <td class="paramname"><em>trans_id</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="transition-model_8h_source.html#l00312">312</a> of file <a class="el" href="transition-model_8h_source.html">transition-model.h</a>.</p>

<p>References <a class="el" href="transition-model_8h_source.html#l00293">TransitionModel::id2state_</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="transition-model_8h_source.html#l00284">TransitionModel::triples_</a>.</p>

<p>Referenced by <a class="el" href="sgmm2-est-spkvecs-gpost_8cc_source.html#l00033">kaldi::AccumulateForUtterance()</a>, <a class="el" href="sgmm-clusterable_8cc_source.html#l00198">kaldi::AccumulateSgmmTreeStats()</a>, <a class="el" href="nnet-example-functions_8cc_source.html#l00236">DiscriminativeExampleSplitter::CollapseTransitionIds()</a>, <a class="el" href="fmpe_8cc_source.html#l00522">kaldi::ComputeAmGmmFeatureDeriv()</a>, <a class="el" href="nnet-example-functions_8cc_source.html#l00299">DiscriminativeExampleSplitter::ComputeFrameInfo()</a>, <a class="el" href="posterior_8cc_source.html#l00325">kaldi::ConvertPosteriorToPdfs()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00384">kaldi::GetPdfToTransitionIdTransducer()</a>, <a class="el" href="lattice-rescore-mapped_8cc_source.html#l00031">kaldi::LatticeAcousticRescore()</a>, <a class="el" href="nnet-train-mmi-sequential_8cc_source.html#l00046">kaldi::nnet1::LatticeAcousticRescore()</a>, <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00178">NnetDiscriminativeUpdater::LatticeComputations()</a>, <a class="el" href="lattice-functions_8cc_source.html#l00740">kaldi::LatticeForwardBackwardMpeVariants()</a>, <a class="el" href="decodable-am-sgmm_8h_source.html#l00051">DecodableAmSgmm::LogLikelihood()</a>, <a class="el" href="decodable-am-diag-gmm-regtree_8h_source.html#l00052">DecodableAmDiagGmmRegtreeFmllr::LogLikelihood()</a>, <a class="el" href="decodable-am-sgmm2_8h_source.html#l00065">DecodableAmSgmm2::LogLikelihood()</a>, <a class="el" href="decodable-matrix_8h_source.html#l00068">DecodableMatrixScaledMapped::LogLikelihood()</a>, <a class="el" href="online-nnet2-decodable_8cc_source.html#l00049">DecodableNnet2Online::LogLikelihood()</a>, <a class="el" href="decodable-am-nnet_8h_source.html#l00077">DecodableAmNnet::LogLikelihood()</a>, <a class="el" href="decodable-am-diag-gmm-regtree_8h_source.html#l00095">DecodableAmDiagGmmRegtreeMllr::LogLikelihood()</a>, <a class="el" href="decodable-am-sgmm_8h_source.html#l00106">DecodableAmSgmmScaled::LogLikelihood()</a>, <a class="el" href="decodable-am-diag-gmm_8h_source.html#l00108">DecodableAmDiagGmm::LogLikelihood()</a>, <a class="el" href="decodable-am-sgmm2_8h_source.html#l00126">DecodableAmSgmm2Scaled::LogLikelihood()</a>, <a class="el" href="decodable-am-nnet_8h_source.html#l00139">DecodableAmNnetParallel::LogLikelihood()</a>, <a class="el" href="decodable-am-diag-gmm_8h_source.html#l00142">DecodableAmDiagGmmScaled::LogLikelihood()</a>, <a class="el" href="decodable-matrix_8h_source.html#l00148">DecodableMatrixMappedOffset::LogLikelihood()</a>, <a class="el" href="nnet-am-decodable-simple_8cc_source.html#l00074">DecodableAmNnetSimple::LogLikelihood()</a>, <a class="el" href="ali-to-pdf_8cc_source.html#l00029">main()</a>, <a class="el" href="posterior_8cc_source.html#l00307">ComparePosteriorByPdfs::operator()()</a>, <a class="el" href="nnet-utils_8h_source.html#l00184">kaldi::nnet1::PosteriorToMatrixMapped()</a>, <a class="el" href="lattice-functions_8cc_source.html#l01163">kaldi::RescoreCompactLatticeInternal()</a>, <a class="el" href="nnet-train-transitions_8cc_source.html#l00028">kaldi::nnet2::SetPriors()</a>, and <a class="el" href="nnet3-am-train-transitions_8cc_source.html#l00028">kaldi::nnet3::SetPriors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                                    {</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// If a lot of time is spent here we may create an extra array</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// to handle this.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(static_cast&lt;size_t&gt;(trans_id) &lt; <a class="code" href="classkaldi_1_1TransitionModel.html#a576772fe55923a64de78a80a89a6db8a">id2state_</a>.size() &amp;&amp;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;               <span class="stringliteral">&quot;Likely graph/model mismatch (graph built from wrong model?)&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> trans_state = <a class="code" href="classkaldi_1_1TransitionModel.html#a576772fe55923a64de78a80a89a6db8a">id2state_</a>[trans_id];</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1TransitionModel.html#a6c153ad0c0fcbfbd672695cece6a17e2">triples_</a>[trans_state-1].pdf;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;}</div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a6c153ad0c0fcbfbd672695cece6a17e2"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a6c153ad0c0fcbfbd672695cece6a17e2">kaldi::TransitionModel::triples_</a></div><div class="ttdeci">std::vector&lt; Triple &gt; triples_</div><div class="ttdoc">Triples indexed by transition state minus one; the triples are in sorted order which allows us to do ...</div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8h_source.html#l00284">transition-model.h:284</a></div></div>
<div class="ttc" id="classkaldi_1_1TransitionModel_html_a576772fe55923a64de78a80a89a6db8a"><div class="ttname"><a href="classkaldi_1_1TransitionModel.html#a576772fe55923a64de78a80a89a6db8a">kaldi::TransitionModel::id2state_</a></div><div class="ttdeci">std::vector&lt; int32 &gt; id2state_</div><div class="ttdoc">For each transition-id, the corresponding transition state (indexed by transition-id). </div><div class="ttdef"><b>Definition:</b> <a href="transition-model_8h_source.html#l00293">transition-model.h:293</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gad94539d80f1ba0b8731c6692b624b7a3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int32 kNoPdf = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A constant used in the <a class="el" href="classkaldi_1_1HmmTopology.html" title="A class for storing topology information for phones. ">HmmTopology</a> class as the <a class="el" href="hmm.html#pdf_class">pdf-class</a> kNoPdf, which is used when a HMM-state is nonemitting (has no associated PDF). </p>

<p>Definition at line <a class="el" href="hmm-topology_8h_source.html#l00087">87</a> of file <a class="el" href="hmm-topology_8h_source.html">hmm-topology.h</a>.</p>

<p>Referenced by <a class="el" href="hmm-topology_8cc_source.html#l00197">HmmTopology::Check()</a>, <a class="el" href="transition-model_8cc_source.html#l00027">TransitionModel::ComputeTriples()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00030">kaldi::GetHmmAsFst()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00169">kaldi::GetHmmAsFstSimple()</a>, <a class="el" href="hmm-topology_8cc_source.html#l00039">HmmTopology::Read()</a>, <a class="el" href="hmm-utils_8cc_source.html#l00624">kaldi::SplitToPhonesInternal()</a>, and <a class="el" href="hmm-topology_8cc_source.html#l00143">HmmTopology::Write()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Tue Apr 26 2016 14:54:46 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
