<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: nnet2/nnet-precondition-online.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('nnet-precondition-online_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nnet-precondition-online.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="nnet-precondition-online_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// nnet2/nnet-precondition-online.h</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright 2013-2015   Johns Hopkins University (author: Daniel Povey)</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//                2015   Xiaohui Zhang</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// See ../../COPYING for clarification regarding multiple authors</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//  http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// THIS CODE IS PROVIDED *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">// WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// MERCHANTABLITY OR NON-INFRINGEMENT.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// See the Apache 2 License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">// limitations under the License.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifndef KALDI_NNET2_NNET_PRECONDITION_ONLINE_H_</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define KALDI_NNET2_NNET_PRECONDITION_ONLINE_H_</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kaldi-common_8h.html">base/kaldi-common.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="matrix-lib_8h.html">matrix/matrix-lib.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="cu-matrix-lib_8h.html">cudamatrix/cu-matrix-lib.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="kaldi-mutex_8h.html">thread/kaldi-mutex.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">namespace </span>kaldi {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">namespace </span>nnet2 {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div>
<div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">  414</a></span>&#160;<span class="keyword">class </span><a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">OnlinePreconditioner</a> {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ae5a325f51ed0d376954386aecddc7bca">OnlinePreconditioner</a>();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#afb9bffca178027f3e5d52ec73a1ee0fe">SetRank</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> rank);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af830848160afd5bf477387d1c5825d8c">SetUpdatePeriod</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> update_period);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="comment">// num_samples_history is a time-constant (in samples) that determines eta.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a92a77e900ccaf0f3a722e2a4a9dedb77">SetNumSamplesHistory</a>(<a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> num_samples_history);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a885862c5b0a0cf88d75bee40f5cf29f2">SetAlpha</a>(<a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> alpha);</div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a35086953bbc759bd2ac9cb660d87d83f">  423</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a35086953bbc759bd2ac9cb660d87d83f">TurnOnDebug</a>() { <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1bffda16ce504620d0ea2d1118cd0653">self_debug_</a> = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa941422a788ab260c8ba0eabe853ab8b">  424</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa941422a788ab260c8ba0eabe853ab8b">GetNumSamplesHistory</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af659a9e1c6ede20999b0996a58f97f34">num_samples_history_</a>; }</div>
<div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aadc1fa0af1d5b9e424a0da91a4d2da65">  425</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aadc1fa0af1d5b9e424a0da91a4d2da65">GetAlpha</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a43efd606b8c638dd071888c30b741e91">alpha_</a>; }</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a8c9c05c54c6edca6a9c09257ecb8e78b">  426</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a8c9c05c54c6edca6a9c09257ecb8e78b">GetRank</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af679b81005104cca1fc03ef8ee3b36d0">rank_</a>; }</div>
<div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aabdaf2b4595bcc542e45029f9e4b7fe6">  427</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aabdaf2b4595bcc542e45029f9e4b7fe6">GetUpdatePeriod</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab35b32394fce8242b6fb4ae4ba4e54e1">update_period_</a>; }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  <span class="comment">// The &quot;R&quot; pointer is both the input (R in the comment) and the output (P in</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="comment">// the comment; equal to the preconditioned directions before scaling by</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="comment">// gamma).  If the pointer &quot;row_prod&quot; is supplied, it&#39;s set to the inner product</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="comment">// of each row of the preconditioned directions P, at output, with itself.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="comment">// You would need to apply &quot;scale&quot; to R and &quot;scale * scale&quot; to row_prod, to</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="comment">// get the preconditioned directions; we don&#39;t do this ourselves, in order to</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// save CUDA calls.</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a40de84aa34756dd2c783f5f8a131670a">PreconditionDirections</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *R,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                              <a class="code" href="classkaldi_1_1CuVectorBase.html">CuVectorBase&lt;BaseFloat&gt;</a> *row_prod,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                              <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *scale);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="comment">// Copy constructor.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ae5a325f51ed0d376954386aecddc7bca">OnlinePreconditioner</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">OnlinePreconditioner</a> &amp;other);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="comment">// Assignent operator</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">OnlinePreconditioner</a> &amp;<a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a64f8f91edb72016058b1f1f34d8e13be">operator = </a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">OnlinePreconditioner</a> &amp;other);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">// This does the work of PreconditionDirections (the top-level</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// function handles some multithreading issues and then calls this function).</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// Note: WJKL_t (dimension 2*R by D + R) is [ W_t L_t; J_t K_t ].</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a0ecfb5492a4bb8115f1b875c13ae40c9">PreconditionDirectionsInternal</a>(<span class="keyword">const</span> <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> t,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rho_t,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> &amp;d_t,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                                      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *WJKL_t,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                                      <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *X_t,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                      <a class="code" href="classkaldi_1_1CuVectorBase.html">CuVectorBase&lt;BaseFloat&gt;</a> *row_prod,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                                      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> *scale);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a13754c332c9474526441d5f609af7d7d">ComputeEt</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                 <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> beta_t,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *e_t,</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *sqrt_e_t,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                 <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> *inv_sqrt_e_t) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1f899327134e367c4e7843d23dc4c039">ComputeZt</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> N,</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                 <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rho_t,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;inv_sqrt_e_t,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;K_t,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;L_t,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                 <a class="code" href="classkaldi_1_1SpMatrix.html">SpMatrix&lt;double&gt;</a> *Z_t) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// Computes W_{t+1}.  Overwrites J_t.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a62415da41b5e71f0c424b04b102f92fb">ComputeWt1</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> N,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t1,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rho_t,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rho_t1,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1MatrixBase.html">MatrixBase&lt;BaseFloat&gt;</a> &amp;U_t,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;sqrt_c_t,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;inv_sqrt_e_t,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;W_t,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *J_t,</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                  <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *W_t1) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">// This function is called if C_t has high condition number; it makes sure</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">// that R_{t+1} is orthogonal.  See the section in the extended comment above</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// on &quot;keeping R_t orthogonal&quot;.</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a04f608ae169f9f8893c5611d379ce5ae">ReorthogonalizeXt1</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1VectorBase.html">VectorBase&lt;BaseFloat&gt;</a> &amp;d_t1,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                          <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> rho_t1,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *W_t1,</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *temp_W,</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                          <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *temp_O);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af101bbf82527b43a60a43a287270fd0f">Init</a>(<span class="keyword">const</span> <a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> &amp;R0);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">// Initialize to some small &#39;default&#39; values, called from Init().  Init() then</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">// does a few iterations of update with the first batch&#39;s data to give more</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// reasonable values.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a8dcc86ffa0412cb5f8dcb8d6c98eca5a">InitDefault</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> D);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// initializes R, which is assumed to have at least as many columns as rows,</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// to a specially designed matrix with orthonormal rows, that has no zero rows</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// or columns.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a898dc92e6358fb2aa0306c4ce31b3a7b">InitOrthonormalSpecial</a>(<a class="code" href="classkaldi_1_1CuMatrixBase.html">CuMatrixBase&lt;BaseFloat&gt;</a> *R);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// Returns the learning rate eta as the function of the number of samples</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="comment">// (actually, N is the number of vectors we&#39;re preconditioning, which due to</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// context is not always exactly the same as the number of samples).  The</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;  <span class="comment">// value returned depends on num_samples_history_.</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a295a391825411ca346362302c6b71a64">Eta</a>(<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> N) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="comment">// called if self_debug_ = true, makes sure the members satisfy certain</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">// properties.</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a16fd6ba3f18fe4b8f34a6c0569d13ee1">SelfTest</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// Configuration values:</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  <span class="comment">// The rank of the correction to the unit matrix (e.g. 20).</span></div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af679b81005104cca1fc03ef8ee3b36d0">  517</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af679b81005104cca1fc03ef8ee3b36d0">rank_</a>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// After a few initial iterations of updating whenever we can, we start only</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// updating the Fisher-matrix parameters every &quot;update_period_&quot; minibatches;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">// this saves time.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab35b32394fce8242b6fb4ae4ba4e54e1">  522</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab35b32394fce8242b6fb4ae4ba4e54e1">update_period_</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// num_samples_history_ determines the value of eta, which in turn affects how</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="comment">// fast we update our estimate of the covariance matrix.  We&#39;ve done it this</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="comment">// way in order to make it easy to have a single configuration value that</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="comment">// doesn&#39;t have to be changed when we change the minibatch size.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af659a9e1c6ede20999b0996a58f97f34">  528</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af659a9e1c6ede20999b0996a58f97f34">num_samples_history_</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// alpha controls how much we smooth the Fisher matrix with the unit matrix.</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// e.g. alpha = 4.0.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a43efd606b8c638dd071888c30b741e91">  532</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a43efd606b8c638dd071888c30b741e91">alpha_</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// epsilon is an absolute floor on the unit-matrix scaling factor rho_t in our</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// Fisher estimate, which we set to 1.0e-10.  We don&#39;t actually make this</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">// configurable from the command line.  It&#39;s needed to avoid crashes on</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// all-zero inputs.</span></div>
<div class="line"><a name="l00538"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a008c4e6cc13410d1b983ad2b06fffeaf">  538</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a008c4e6cc13410d1b983ad2b06fffeaf">epsilon_</a>;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// delta is a relative floor on the unit-matrix scaling factor rho_t in our</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="comment">// Fisher estimate, which we set to 1.0e-05: this is relative to the largest</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">// value of D_t.  It&#39;s needed to control roundoff error.  We apply the same</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="comment">// floor to the eigenvalues in D_t.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">  544</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">delta_</a>;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="comment">// t is a counter that measures how many updates we&#39;ve done.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#abd17f633a8fc0939bc5bd0e83bd7153c">  547</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#abd17f633a8fc0939bc5bd0e83bd7153c">t_</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// This keeps track of how many minibatches we&#39;ve skipped updating the parameters,</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// since the most recent update; it&#39;s used in enforcing &quot;update_period_&quot;, which</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="comment">// is a mechanism to avoid spending too much time updating the subspace (which can</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="comment">// be wasteful).</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab3c6b16d7d97db660d96144a3239dc01">  553</a></span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab3c6b16d7d97db660d96144a3239dc01">num_updates_skipped_</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// If true, activates certain checks.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1bffda16ce504620d0ea2d1118cd0653">  556</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1bffda16ce504620d0ea2d1118cd0653">self_debug_</a>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a5a1f65814903de3b91358880a8955c1c">  558</a></span>&#160;  <a class="code" href="classkaldi_1_1CuMatrix.html">CuMatrix&lt;BaseFloat&gt;</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a5a1f65814903de3b91358880a8955c1c">W_t_</a>;</div>
<div class="line"><a name="l00559"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a9c611c2de39a87a3ad90640fd024b048">  559</a></span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a9c611c2de39a87a3ad90640fd024b048">rho_t_</a>;</div>
<div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af12dc036070d7e3229a0232e214c226e">  560</a></span>&#160;  <a class="code" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af12dc036070d7e3229a0232e214c226e">d_t_</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">// Used to prevent parameters being read or written in an inconsistent state.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af1d78e1270f4d516f8ba6c0c692b0f3d">  564</a></span>&#160;  <a class="code" href="classkaldi_1_1Mutex.html">Mutex</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af1d78e1270f4d516f8ba6c0c692b0f3d">read_write_mutex_</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// This mutex is used to control which thread gets to update the</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// parameters, in multi-threaded code.</span></div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a821f720a589e21eb0d6421ed02e90086">  568</a></span>&#160;  <a class="code" href="classkaldi_1_1Mutex.html">Mutex</a> <a class="code" href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a821f720a589e21eb0d6421ed02e90086">update_mutex_</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;};</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;} <span class="comment">// namespace nnet2</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;} <span class="comment">// namespace kaldi</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_aabdaf2b4595bcc542e45029f9e4b7fe6"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aabdaf2b4595bcc542e45029f9e4b7fe6">kaldi::nnet2::OnlinePreconditioner::GetUpdatePeriod</a></div><div class="ttdeci">int32 GetUpdatePeriod() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00427">nnet-precondition-online.h:427</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_ae5a325f51ed0d376954386aecddc7bca"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ae5a325f51ed0d376954386aecddc7bca">kaldi::nnet2::OnlinePreconditioner::OnlinePreconditioner</a></div><div class="ttdeci">OnlinePreconditioner()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00027">nnet-precondition-online.cc:27</a></div></div>
<div class="ttc" id="classkaldi_1_1SpMatrix_html"><div class="ttname"><a href="classkaldi_1_1SpMatrix.html">kaldi::SpMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="matrix-lib_8h_html"><div class="ttname"><a href="matrix-lib_8h.html">matrix-lib.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a16fd6ba3f18fe4b8f34a6c0569d13ee1"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a16fd6ba3f18fe4b8f34a6c0569d13ee1">kaldi::nnet2::OnlinePreconditioner::SelfTest</a></div><div class="ttdeci">void SelfTest() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00255">nnet-precondition-online.cc:255</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af679b81005104cca1fc03ef8ee3b36d0"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af679b81005104cca1fc03ef8ee3b36d0">kaldi::nnet2::OnlinePreconditioner::rank_</a></div><div class="ttdeci">int32 rank_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00517">nnet-precondition-online.h:517</a></div></div>
<div class="ttc" id="classkaldi_1_1MatrixBase_html"><div class="ttname"><a href="classkaldi_1_1MatrixBase.html">kaldi::MatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af12dc036070d7e3229a0232e214c226e"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af12dc036070d7e3229a0232e214c226e">kaldi::nnet2::OnlinePreconditioner::d_t_</a></div><div class="ttdeci">Vector&lt; BaseFloat &gt; d_t_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00560">nnet-precondition-online.h:560</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_abd17f633a8fc0939bc5bd0e83bd7153c"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#abd17f633a8fc0939bc5bd0e83bd7153c">kaldi::nnet2::OnlinePreconditioner::t_</a></div><div class="ttdeci">int32 t_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00547">nnet-precondition-online.h:547</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_afb9bffca178027f3e5d52ec73a1ee0fe"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#afb9bffca178027f3e5d52ec73a1ee0fe">kaldi::nnet2::OnlinePreconditioner::SetRank</a></div><div class="ttdeci">void SetRank(int32 rank)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00619">nnet-precondition-online.cc:619</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrix_html"><div class="ttname"><a href="classkaldi_1_1CuMatrix.html">kaldi::CuMatrix&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a8dcc86ffa0412cb5f8dcb8d6c98eca5a"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a8dcc86ffa0412cb5f8dcb8d6c98eca5a">kaldi::nnet2::OnlinePreconditioner::InitDefault</a></div><div class="ttdeci">void InitDefault(int32 D)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00075">nnet-precondition-online.cc:75</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a898dc92e6358fb2aa0306c4ce31b3a7b"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a898dc92e6358fb2aa0306c4ce31b3a7b">kaldi::nnet2::OnlinePreconditioner::InitOrthonormalSpecial</a></div><div class="ttdeci">static void InitOrthonormalSpecial(CuMatrixBase&lt; BaseFloat &gt; *R)</div><div class="ttdoc">This function creates a matrix with orthonormal rows that is like the following matrix, except with each row normalized to have unit 2-norm: [ 1.1 0 1 0 1 0 0 1.1 0 1 0 1 ] The reason why the first element in each row is 1.1 and not 1, is for symmetry-breaking... </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00045">nnet-precondition-online.cc:45</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_aa0ae63e5e17bafaf1ab9c9328517bb5b"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa0ae63e5e17bafaf1ab9c9328517bb5b">kaldi::nnet2::OnlinePreconditioner::delta_</a></div><div class="ttdeci">BaseFloat delta_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00544">nnet-precondition-online.h:544</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a13754c332c9474526441d5f609af7d7d"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a13754c332c9474526441d5f609af7d7d">kaldi::nnet2::OnlinePreconditioner::ComputeEt</a></div><div class="ttdeci">void ComputeEt(const VectorBase&lt; BaseFloat &gt; &amp;d_t, BaseFloat beta_t, VectorBase&lt; BaseFloat &gt; *e_t, VectorBase&lt; BaseFloat &gt; *sqrt_e_t, VectorBase&lt; BaseFloat &gt; *inv_sqrt_e_t) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00576">nnet-precondition-online.cc:576</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a885862c5b0a0cf88d75bee40f5cf29f2"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a885862c5b0a0cf88d75bee40f5cf29f2">kaldi::nnet2::OnlinePreconditioner::SetAlpha</a></div><div class="ttdeci">void SetAlpha(BaseFloat alpha)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00632">nnet-precondition-online.cc:632</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_aa941422a788ab260c8ba0eabe853ab8b"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aa941422a788ab260c8ba0eabe853ab8b">kaldi::nnet2::OnlinePreconditioner::GetNumSamplesHistory</a></div><div class="ttdeci">BaseFloat GetNumSamplesHistory() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00424">nnet-precondition-online.h:424</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a5a1f65814903de3b91358880a8955c1c"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a5a1f65814903de3b91358880a8955c1c">kaldi::nnet2::OnlinePreconditioner::W_t_</a></div><div class="ttdeci">CuMatrix&lt; BaseFloat &gt; W_t_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00558">nnet-precondition-online.h:558</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a40de84aa34756dd2c783f5f8a131670a"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a40de84aa34756dd2c783f5f8a131670a">kaldi::nnet2::OnlinePreconditioner::PreconditionDirections</a></div><div class="ttdeci">void PreconditionDirections(CuMatrixBase&lt; BaseFloat &gt; *R, CuVectorBase&lt; BaseFloat &gt; *row_prod, BaseFloat *scale)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00145">nnet-precondition-online.cc:145</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a295a391825411ca346362302c6b71a64"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a295a391825411ca346362302c6b71a64">kaldi::nnet2::OnlinePreconditioner::Eta</a></div><div class="ttdeci">BaseFloat Eta(int32 N) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00491">nnet-precondition-online.cc:491</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a92a77e900ccaf0f3a722e2a4a9dedb77"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a92a77e900ccaf0f3a722e2a4a9dedb77">kaldi::nnet2::OnlinePreconditioner::SetNumSamplesHistory</a></div><div class="ttdeci">void SetNumSamplesHistory(BaseFloat num_samples_history)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00627">nnet-precondition-online.cc:627</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a35086953bbc759bd2ac9cb660d87d83f"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a35086953bbc759bd2ac9cb660d87d83f">kaldi::nnet2::OnlinePreconditioner::TurnOnDebug</a></div><div class="ttdeci">void TurnOnDebug()</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00423">nnet-precondition-online.h:423</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af659a9e1c6ede20999b0996a58f97f34"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af659a9e1c6ede20999b0996a58f97f34">kaldi::nnet2::OnlinePreconditioner::num_samples_history_</a></div><div class="ttdeci">BaseFloat num_samples_history_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00528">nnet-precondition-online.h:528</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a1f899327134e367c4e7843d23dc4c039"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1f899327134e367c4e7843d23dc4c039">kaldi::nnet2::OnlinePreconditioner::ComputeZt</a></div><div class="ttdeci">void ComputeZt(int32 N, BaseFloat rho_t, const VectorBase&lt; BaseFloat &gt; &amp;d_t, const VectorBase&lt; BaseFloat &gt; &amp;inv_sqrt_e_t, const MatrixBase&lt; BaseFloat &gt; &amp;K_t, const MatrixBase&lt; BaseFloat &gt; &amp;L_t, SpMatrix&lt; double &gt; *Z_t) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00545">nnet-precondition-online.cc:545</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af1d78e1270f4d516f8ba6c0c692b0f3d"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af1d78e1270f4d516f8ba6c0c692b0f3d">kaldi::nnet2::OnlinePreconditioner::read_write_mutex_</a></div><div class="ttdeci">Mutex read_write_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00564">nnet-precondition-online.h:564</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_ab35b32394fce8242b6fb4ae4ba4e54e1"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab35b32394fce8242b6fb4ae4ba4e54e1">kaldi::nnet2::OnlinePreconditioner::update_period_</a></div><div class="ttdeci">int32 update_period_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00522">nnet-precondition-online.h:522</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a008c4e6cc13410d1b983ad2b06fffeaf"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a008c4e6cc13410d1b983ad2b06fffeaf">kaldi::nnet2::OnlinePreconditioner::epsilon_</a></div><div class="ttdeci">BaseFloat epsilon_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00538">nnet-precondition-online.h:538</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_aadc1fa0af1d5b9e424a0da91a4d2da65"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#aadc1fa0af1d5b9e424a0da91a4d2da65">kaldi::nnet2::OnlinePreconditioner::GetAlpha</a></div><div class="ttdeci">BaseFloat GetAlpha() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00425">nnet-precondition-online.h:425</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="classkaldi_1_1Mutex_html"><div class="ttname"><a href="classkaldi_1_1Mutex.html">kaldi::Mutex</a></div><div class="ttdoc">This class encapsulates mutex to ensure exclusive access to some critical section which manipulates s...</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-mutex_8h_source.html#l00036">kaldi-mutex.h:36</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a04f608ae169f9f8893c5611d379ce5ae"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a04f608ae169f9f8893c5611d379ce5ae">kaldi::nnet2::OnlinePreconditioner::ReorthogonalizeXt1</a></div><div class="ttdeci">void ReorthogonalizeXt1(const VectorBase&lt; BaseFloat &gt; &amp;d_t1, BaseFloat rho_t1, CuMatrixBase&lt; BaseFloat &gt; *W_t1, CuMatrixBase&lt; BaseFloat &gt; *temp_W, CuMatrixBase&lt; BaseFloat &gt; *temp_O)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00184">nnet-precondition-online.cc:184</a></div></div>
<div class="ttc" id="classkaldi_1_1CuMatrixBase_html"><div class="ttname"><a href="classkaldi_1_1CuMatrixBase.html">kaldi::CuMatrixBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="cu-matrix-lib_8h_html"><div class="ttname"><a href="cu-matrix-lib_8h.html">cu-matrix-lib.h</a></div></div>
<div class="ttc" id="classkaldi_1_1Vector_html"><div class="ttname"><a href="classkaldi_1_1Vector.html">kaldi::Vector&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a821f720a589e21eb0d6421ed02e90086"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a821f720a589e21eb0d6421ed02e90086">kaldi::nnet2::OnlinePreconditioner::update_mutex_</a></div><div class="ttdeci">Mutex update_mutex_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00568">nnet-precondition-online.h:568</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a64f8f91edb72016058b1f1f34d8e13be"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a64f8f91edb72016058b1f1f34d8e13be">kaldi::nnet2::OnlinePreconditioner::operator=</a></div><div class="ttdeci">OnlinePreconditioner &amp; operator=(const OnlinePreconditioner &amp;other)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00604">nnet-precondition-online.cc:604</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a8c9c05c54c6edca6a9c09257ecb8e78b"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a8c9c05c54c6edca6a9c09257ecb8e78b">kaldi::nnet2::OnlinePreconditioner::GetRank</a></div><div class="ttdeci">int32 GetRank() const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00426">nnet-precondition-online.h:426</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a9c611c2de39a87a3ad90640fd024b048"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a9c611c2de39a87a3ad90640fd024b048">kaldi::nnet2::OnlinePreconditioner::rho_t_</a></div><div class="ttdeci">BaseFloat rho_t_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00559">nnet-precondition-online.h:559</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a62415da41b5e71f0c424b04b102f92fb"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a62415da41b5e71f0c424b04b102f92fb">kaldi::nnet2::OnlinePreconditioner::ComputeWt1</a></div><div class="ttdeci">void ComputeWt1(int32 N, const VectorBase&lt; BaseFloat &gt; &amp;d_t, const VectorBase&lt; BaseFloat &gt; &amp;d_t1, BaseFloat rho_t, BaseFloat rho_t1, const MatrixBase&lt; BaseFloat &gt; &amp;U_t, const VectorBase&lt; BaseFloat &gt; &amp;sqrt_c_t, const VectorBase&lt; BaseFloat &gt; &amp;inv_sqrt_e_t, const CuMatrixBase&lt; BaseFloat &gt; &amp;W_t, CuMatrixBase&lt; BaseFloat &gt; *J_t, CuMatrixBase&lt; BaseFloat &gt; *W_t1) const </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00500">nnet-precondition-online.cc:500</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af101bbf82527b43a60a43a287270fd0f"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af101bbf82527b43a60a43a287270fd0f">kaldi::nnet2::OnlinePreconditioner::Init</a></div><div class="ttdeci">void Init(const CuMatrixBase&lt; BaseFloat &gt; &amp;R0)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00123">nnet-precondition-online.cc:123</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_af830848160afd5bf477387d1c5825d8c"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#af830848160afd5bf477387d1c5825d8c">kaldi::nnet2::OnlinePreconditioner::SetUpdatePeriod</a></div><div class="ttdeci">void SetUpdatePeriod(int32 update_period)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00623">nnet-precondition-online.cc:623</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html">kaldi::nnet2::OnlinePreconditioner</a></div><div class="ttdoc">Keywords for search: natural gradient, naturalgradient, NG-SGD. </div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00414">nnet-precondition-online.h:414</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html"><div class="ttname"><a href="classkaldi_1_1VectorBase.html">kaldi::VectorBase&lt; BaseFloat &gt;</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a1bffda16ce504620d0ea2d1118cd0653"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a1bffda16ce504620d0ea2d1118cd0653">kaldi::nnet2::OnlinePreconditioner::self_debug_</a></div><div class="ttdeci">bool self_debug_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00556">nnet-precondition-online.h:556</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_ab3c6b16d7d97db660d96144a3239dc01"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#ab3c6b16d7d97db660d96144a3239dc01">kaldi::nnet2::OnlinePreconditioner::num_updates_skipped_</a></div><div class="ttdeci">int32 num_updates_skipped_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00553">nnet-precondition-online.h:553</a></div></div>
<div class="ttc" id="kaldi-common_8h_html"><div class="ttname"><a href="kaldi-common_8h.html">kaldi-common.h</a></div></div>
<div class="ttc" id="kaldi-mutex_8h_html"><div class="ttname"><a href="kaldi-mutex_8h.html">kaldi-mutex.h</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a43efd606b8c638dd071888c30b741e91"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a43efd606b8c638dd071888c30b741e91">kaldi::nnet2::OnlinePreconditioner::alpha_</a></div><div class="ttdeci">BaseFloat alpha_</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8h_source.html#l00532">nnet-precondition-online.h:532</a></div></div>
<div class="ttc" id="classkaldi_1_1nnet2_1_1OnlinePreconditioner_html_a0ecfb5492a4bb8115f1b875c13ae40c9"><div class="ttname"><a href="classkaldi_1_1nnet2_1_1OnlinePreconditioner.html#a0ecfb5492a4bb8115f1b875c13ae40c9">kaldi::nnet2::OnlinePreconditioner::PreconditionDirectionsInternal</a></div><div class="ttdeci">void PreconditionDirectionsInternal(const int32 t, const BaseFloat rho_t, const Vector&lt; BaseFloat &gt; &amp;d_t, CuMatrixBase&lt; BaseFloat &gt; *WJKL_t, CuMatrixBase&lt; BaseFloat &gt; *X_t, CuVectorBase&lt; BaseFloat &gt; *row_prod, BaseFloat *scale)</div><div class="ttdef"><b>Definition:</b> <a href="nnet-precondition-online_8cc_source.html#l00300">nnet-precondition-online.cc:300</a></div></div>
<div class="ttc" id="classkaldi_1_1CuVectorBase_html"><div class="ttname"><a href="classkaldi_1_1CuVectorBase.html">kaldi::CuVectorBase&lt; BaseFloat &gt;</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_59421e7f380e574ca9527496739b16ca.html">nnet2</a></li><li class="navelem"><a class="el" href="nnet-precondition-online_8h.html">nnet-precondition-online.h</a></li>
    <li class="footer">Generated on Tue Apr 26 2016 14:54:41 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
