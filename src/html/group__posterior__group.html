<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Kaldi: Posterior_group</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" href="favicon.ico" type="image/x-icon" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" /> 
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
 <td id="projectlogo"><a href="http://kaldi-asr.org/"><img alt="Logo" src="KaldiTextAndLogoSmall.png"/ style="padding: 3px 5px 1px 5px"></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname" style="display:none">Kaldi
   </div>
  </td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief" style="display:none"></div>
    </td>
   <!--END PROJECT_BRIEF-->
  <!--END !PROJECT_NAME-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__posterior__group.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Posterior_group</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1PosteriorHolder.html">PosteriorHolder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkaldi_1_1GaussPostHolder.html">GaussPostHolder</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><td class="memItemLeft" align="right" valign="top">typedef std::vector<br class="typebreak"/>
&lt; std::vector&lt; std::pair<br class="typebreak"/>
&lt; int32, BaseFloat &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">Posterior</a></td></tr>
<tr class="memdesc:ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Posterior is a typedef for storing acoustic-state (actually, transition-id) posteriors over an utterance.  <a href="#ga5c99e6141a5a3b3c5d424e99ffbd1ac6">More...</a><br/></td></tr>
<tr class="separator:ga5c99e6141a5a3b3c5d424e99ffbd1ac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf9b500e1a5c4936b830558a58e18b3a0"><td class="memItemLeft" align="right" valign="top">typedef std::vector<br class="typebreak"/>
&lt; std::vector&lt; std::pair<br class="typebreak"/>
&lt; int32, Vector&lt; BaseFloat &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gaf9b500e1a5c4936b830558a58e18b3a0">GaussPost</a></td></tr>
<tr class="memdesc:gaf9b500e1a5c4936b830558a58e18b3a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">GaussPost is a typedef for storing Gaussian-level posteriors for an utterance.  <a href="#gaf9b500e1a5c4936b830558a58e18b3a0">More...</a><br/></td></tr>
<tr class="separator:gaf9b500e1a5c4936b830558a58e18b3a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc540c23c8ff792bf8fe8f0980cec66f"><td class="memItemLeft" align="right" valign="top">typedef TableWriter<br class="typebreak"/>
&lt; PosteriorHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gabc540c23c8ff792bf8fe8f0980cec66f">PosteriorWriter</a></td></tr>
<tr class="separator:gabc540c23c8ff792bf8fe8f0980cec66f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e0bd96e6b4dc049fd14f9bbf630ef94"><td class="memItemLeft" align="right" valign="top">typedef SequentialTableReader<br class="typebreak"/>
&lt; PosteriorHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga2e0bd96e6b4dc049fd14f9bbf630ef94">SequentialPosteriorReader</a></td></tr>
<tr class="separator:ga2e0bd96e6b4dc049fd14f9bbf630ef94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae76e68ece9c6cba8d88304407e4e5edf"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
RandomAccessTableReader<br class="typebreak"/>
&lt; PosteriorHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gae76e68ece9c6cba8d88304407e4e5edf">RandomAccessPosteriorReader</a></td></tr>
<tr class="separator:gae76e68ece9c6cba8d88304407e4e5edf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06e501d245b354e47a54406dc0c7161b"><td class="memItemLeft" align="right" valign="top">typedef TableWriter<br class="typebreak"/>
&lt; GaussPostHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga06e501d245b354e47a54406dc0c7161b">GaussPostWriter</a></td></tr>
<tr class="separator:ga06e501d245b354e47a54406dc0c7161b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga15df27c55c5fbb8c5f3c58d4e0b81d9a"><td class="memItemLeft" align="right" valign="top">typedef SequentialTableReader<br class="typebreak"/>
&lt; GaussPostHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga15df27c55c5fbb8c5f3c58d4e0b81d9a">SequentialGaussPostReader</a></td></tr>
<tr class="separator:ga15df27c55c5fbb8c5f3c58d4e0b81d9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga451d14ea4029cb0e1e95764908c8d1be"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
RandomAccessTableReader<br class="typebreak"/>
&lt; GaussPostHolder &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga451d14ea4029cb0e1e95764908c8d1be">RandomAccessGaussPostReader</a></td></tr>
<tr class="separator:ga451d14ea4029cb0e1e95764908c8d1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae2fa7dff89a0474b1b0f4e66c9b89c9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gae2fa7dff89a0474b1b0f4e66c9b89c9b">WritePosterior</a> (std::ostream &amp;os, bool binary, const Posterior &amp;post)</td></tr>
<tr class="memdesc:gae2fa7dff89a0474b1b0f4e66c9b89c9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">stand-alone function for writing a Posterior.  <a href="#gae2fa7dff89a0474b1b0f4e66c9b89c9b">More...</a><br/></td></tr>
<tr class="separator:gae2fa7dff89a0474b1b0f4e66c9b89c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b4511714e0765b532809029aa37f39e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga9b4511714e0765b532809029aa37f39e">ReadPosterior</a> (std::istream &amp;os, bool binary, Posterior *post)</td></tr>
<tr class="memdesc:ga9b4511714e0765b532809029aa37f39e"><td class="mdescLeft">&#160;</td><td class="mdescRight">stand-alone function for reading a Posterior.  <a href="#ga9b4511714e0765b532809029aa37f39e">More...</a><br/></td></tr>
<tr class="separator:ga9b4511714e0765b532809029aa37f39e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6fc6689ac2f9cb9e12f14aa1c10687c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga6fc6689ac2f9cb9e12f14aa1c10687c5">ScalePosterior</a> (BaseFloat scale, Posterior *post)</td></tr>
<tr class="memdesc:ga6fc6689ac2f9cb9e12f14aa1c10687c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scales the BaseFloat (weight) element in the posterior entries.  <a href="#ga6fc6689ac2f9cb9e12f14aa1c10687c5">More...</a><br/></td></tr>
<tr class="separator:ga6fc6689ac2f9cb9e12f14aa1c10687c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadf06e716aac0f922f02993c5204c78ec"><td class="memItemLeft" align="right" valign="top">BaseFloat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gadf06e716aac0f922f02993c5204c78ec">TotalPosterior</a> (const Posterior &amp;post)</td></tr>
<tr class="memdesc:gadf06e716aac0f922f02993c5204c78ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total of all the weights in "post".  <a href="#gadf06e716aac0f922f02993c5204c78ec">More...</a><br/></td></tr>
<tr class="separator:gadf06e716aac0f922f02993c5204c78ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga48db127ef5d5d1fdb4dd46b22eb4739d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga48db127ef5d5d1fdb4dd46b22eb4739d">PosteriorEntriesAreDisjoint</a> (const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;post_elem1, const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;post_elem2)</td></tr>
<tr class="memdesc:ga48db127ef5d5d1fdb4dd46b22eb4739d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the two lists of pairs have no common .first element.  <a href="#ga48db127ef5d5d1fdb4dd46b22eb4739d">More...</a><br/></td></tr>
<tr class="separator:ga48db127ef5d5d1fdb4dd46b22eb4739d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9c0927fa6fbb718751cdc2d413a1ae2a"><td class="memItemLeft" align="right" valign="top">int32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga9c0927fa6fbb718751cdc2d413a1ae2a">MergePosteriors</a> (const Posterior &amp;post1, const Posterior &amp;post2, bool merge, bool drop_frames, Posterior *post)</td></tr>
<tr class="memdesc:ga9c0927fa6fbb718751cdc2d413a1ae2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge two sets of posteriors, which must have the same length.  <a href="#ga9c0927fa6fbb718751cdc2d413a1ae2a">More...</a><br/></td></tr>
<tr class="separator:ga9c0927fa6fbb718751cdc2d413a1ae2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga320b770e2ff164f8384f50ca1bfdd9f5"><td class="memItemLeft" align="right" valign="top">BaseFloat&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga320b770e2ff164f8384f50ca1bfdd9f5">VectorToPosteriorEntry</a> (const VectorBase&lt; BaseFloat &gt; &amp;log_likes, int32 num_gselect, BaseFloat min_post, std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; *post_entry)</td></tr>
<tr class="memdesc:ga320b770e2ff164f8384f50ca1bfdd9f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Given a vector of log-likelihoods (typically of Gaussians in a GMM but could be of pdf-ids), a number gselect &gt;= 1 and a minimum posterior 0 &lt;= min_post &lt; 1, it gets the posterior for each element of log-likes by applying Softmax(), then prunes the posteriors using "gselect" and "min_post" (keeping at least one), and outputs the result into "post_entry", sorted from greatest to least posterior.  <a href="#ga320b770e2ff164f8384f50ca1bfdd9f5">More...</a><br/></td></tr>
<tr class="separator:ga320b770e2ff164f8384f50ca1bfdd9f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad1f476ed0a376bb88e35fe2e210bb99"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gaad1f476ed0a376bb88e35fe2e210bb99">AlignmentToPosterior</a> (const std::vector&lt; int32 &gt; &amp;ali, Posterior *post)</td></tr>
<tr class="memdesc:gaad1f476ed0a376bb88e35fe2e210bb99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert an alignment to a posterior (with a scale of 1.0 on each entry).  <a href="#gaad1f476ed0a376bb88e35fe2e210bb99">More...</a><br/></td></tr>
<tr class="separator:gaad1f476ed0a376bb88e35fe2e210bb99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9383616f3bcf8a97e3f6aeec32f829ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga9383616f3bcf8a97e3f6aeec32f829ca">SortPosteriorByPdfs</a> (const TransitionModel &amp;tmodel, Posterior *post)</td></tr>
<tr class="memdesc:ga9383616f3bcf8a97e3f6aeec32f829ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sorts posterior entries so that transition-ids with same pdf-id are next to each other.  <a href="#ga9383616f3bcf8a97e3f6aeec32f829ca">More...</a><br/></td></tr>
<tr class="separator:ga9383616f3bcf8a97e3f6aeec32f829ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac11fc3c8d382ca43c364622e2305eb82"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gac11fc3c8d382ca43c364622e2305eb82">ConvertPosteriorToPdfs</a> (const TransitionModel &amp;tmodel, const Posterior &amp;post_in, Posterior *post_out)</td></tr>
<tr class="memdesc:gac11fc3c8d382ca43c364622e2305eb82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a posterior over transition-ids to be a posterior over pdf-ids.  <a href="#gac11fc3c8d382ca43c364622e2305eb82">More...</a><br/></td></tr>
<tr class="separator:gac11fc3c8d382ca43c364622e2305eb82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4663089527ba258840e4468b6a9f7111"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga4663089527ba258840e4468b6a9f7111">ConvertPosteriorToPhones</a> (const TransitionModel &amp;tmodel, const Posterior &amp;post_in, Posterior *post_out)</td></tr>
<tr class="memdesc:ga4663089527ba258840e4468b6a9f7111"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts a posterior over transition-ids to be a posterior over phones.  <a href="#ga4663089527ba258840e4468b6a9f7111">More...</a><br/></td></tr>
<tr class="separator:ga4663089527ba258840e4468b6a9f7111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0c45742af960895b39f12ede42aca35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#gaf0c45742af960895b39f12ede42aca35">WeightSilencePost</a> (const TransitionModel &amp;trans_model, const ConstIntegerSet&lt; int32 &gt; &amp;silence_set, BaseFloat silence_scale, Posterior *post)</td></tr>
<tr class="memdesc:gaf0c45742af960895b39f12ede42aca35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Weight any silence phones in the posterior (i.e.  <a href="#gaf0c45742af960895b39f12ede42aca35">More...</a><br/></td></tr>
<tr class="separator:gaf0c45742af960895b39f12ede42aca35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0dfbba277ea6654cc320245091f4cf11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__posterior__group.html#ga0dfbba277ea6654cc320245091f4cf11">WeightSilencePostDistributed</a> (const TransitionModel &amp;trans_model, const ConstIntegerSet&lt; int32 &gt; &amp;silence_set, BaseFloat silence_scale, Posterior *post)</td></tr>
<tr class="memdesc:ga0dfbba277ea6654cc320245091f4cf11"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is similar to WeightSilencePost, except that on each frame it works out the amount by which the overall posterior would be reduced, and scales down everything on that frame by the same amount.  <a href="#ga0dfbba277ea6654cc320245091f4cf11">More...</a><br/></td></tr>
<tr class="separator:ga0dfbba277ea6654cc320245091f4cf11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="gaf9b500e1a5c4936b830558a58e18b3a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;std::vector&lt;std::pair&lt;int32, Vector&lt;BaseFloat&gt; &gt; &gt; &gt; GaussPost</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>GaussPost is a typedef for storing Gaussian-level posteriors for an utterance. </p>
<p>the "int32" is a transition-id, and the <a class="el" href="classkaldi_1_1Vector.html">Vector&lt;BaseFloat&gt;</a> is a vector of Gaussian posteriors. WARNING: We changed "int32" from transition-id to pdf-id, and the change is applied for all programs using GaussPost. This is for efficiency purpose. We also changed the name slightly from GauPost to GaussPost to reduce the chance that the change will go un-noticed in downstream code. </p>

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00051">51</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga06e501d245b354e47a54406dc0c7161b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef TableWriter&lt;GaussPostHolder&gt; GaussPostWriter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00128">128</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5c99e6141a5a3b3c5d424e99ffbd1ac6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; &gt; Posterior</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Posterior is a typedef for storing acoustic-state (actually, transition-id) posteriors over an utterance. </p>
<p>The "int32" is a transition-id, and the BaseFloat is a probability (typically between zero and one). </p>

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00042">42</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="gabc540c23c8ff792bf8fe8f0980cec66f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef TableWriter&lt;PosteriorHolder&gt; PosteriorWriter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00122">122</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga451d14ea4029cb0e1e95764908c8d1be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef RandomAccessTableReader&lt;GaussPostHolder&gt; RandomAccessGaussPostReader</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00130">130</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="gae76e68ece9c6cba8d88304407e4e5edf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef RandomAccessTableReader&lt;PosteriorHolder&gt; RandomAccessPosteriorReader</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00124">124</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga15df27c55c5fbb8c5f3c58d4e0b81d9a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef SequentialTableReader&lt;GaussPostHolder&gt; SequentialGaussPostReader</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00129">129</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga2e0bd96e6b4dc049fd14f9bbf630ef94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef SequentialTableReader&lt;PosteriorHolder&gt; SequentialPosteriorReader</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="posterior_8h_source.html#l00123">123</a> of file <a class="el" href="posterior_8h_source.html">posterior.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaad1f476ed0a376bb88e35fe2e210bb99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AlignmentToPosterior </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>ali</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert an alignment to a posterior (with a scale of 1.0 on each entry). </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00293">293</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="lattice-functions_8cc_source.html#l01361">kaldi::LatticeForwardBackwardMmi()</a>, and <a class="el" href="ali-to-post_8cc_source.html#l00031">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                           {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  post-&gt;clear();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  post-&gt;resize(ali.size());</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ali.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(1);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][0].first = ali[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][0].second = 1.0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gac11fc3c8d382ca43c364622e2305eb82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertPosteriorToPdfs </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a posterior over transition-ids to be a posterior over pdf-ids. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00325">325</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="transition-model_8h_source.html#l00312">TransitionModel::TransitionIdToPdf()</a>.</p>

<p>Referenced by <a class="el" href="gmm-est-fmllr-raw_8cc_source.html#l00031">kaldi::AccStatsForUtterance()</a>, <a class="el" href="gmm-basis-fmllr-accs_8cc_source.html#l00035">kaldi::AccumulateForUtterance()</a>, <a class="el" href="nnet-example-functions_8cc_source.html#l00838">kaldi::nnet2::ExampleToPdfPost()</a>, <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00326">NnetDiscriminativeUpdater::GetDiscriminativePosteriors()</a>, <a class="el" href="lattice-functions_8cc_source.html#l01361">kaldi::LatticeForwardBackwardMmi()</a>, and <a class="el" href="acc-lda_8cc_source.html#l00032">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                                 {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  post_out-&gt;clear();</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  post_out-&gt;resize(post_in.size());</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post_out-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    unordered_map&lt;int32, BaseFloat&gt; pdf_to_post;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first,</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;          pdf_id = tmodel.TransitionIdToPdf(tid);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> post = post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordflow">if</span> (pdf_to_post.count(pdf_id) == 0)</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        pdf_to_post[pdf_id] = post;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        pdf_to_post[pdf_id] += post;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    (*post_out)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].reserve(pdf_to_post.size());</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (unordered_map&lt;int32, BaseFloat&gt;::const_iterator iter =</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;             pdf_to_post.begin(); iter != pdf_to_post.end(); ++iter) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;second != 0.0)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        (*post_out)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            std::make_pair(iter-&gt;first, iter-&gt;second));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4663089527ba258840e4468b6a9f7111"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConvertPosteriorToPhones </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts a posterior over transition-ids to be a posterior over phones. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00351">351</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>.</p>

<p>Referenced by <a class="el" href="post-to-phone-post_8cc_source.html#l00026">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                   {</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  post_out-&gt;clear();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  post_out-&gt;resize(post_in.size());</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post_out-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    std::map&lt;int32, BaseFloat&gt; phone_to_post;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first,</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          phone_id = tmodel.TransitionIdToPhone(tid);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> post = post_in[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <span class="keywordflow">if</span> (phone_to_post.count(phone_id) == 0)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        phone_to_post[phone_id] = post;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        phone_to_post[phone_id] += post;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    (*post_out)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].reserve(phone_to_post.size());</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">for</span> (std::map&lt;int32, BaseFloat&gt;::const_iterator iter =</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;             phone_to_post.begin(); iter != phone_to_post.end(); ++iter) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      <span class="keywordflow">if</span> (iter-&gt;second != 0.0)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        (*post_out)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].push_back(</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            std::make_pair(iter-&gt;first, iter-&gt;second));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9c0927fa6fbb718751cdc2d413a1ae2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32 MergePosteriors </td>
          <td>(</td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>merge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>drop_frames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merge two sets of posteriors, which must have the same length. </p>
<p>If "merge" is true, it will make a common entry whenever there are duplicated entries, adding up the weights. If "drop_frames" is true, for frames where the two sets of posteriors were originally disjoint, makes no entries for that frame (relates to frame dropping, or drop_frames, see Vesely et al, ICASSP 2013). Returns the number of frames for which the two posteriors were disjoint (i.e. no common transition-ids or whatever index we are using). </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00261">261</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, <a class="el" href="stl-utils_8h_source.html#l00302">kaldi::MergePairVectorSumming()</a>, and <a class="el" href="posterior_8cc_source.html#l00245">kaldi::PosteriorEntriesAreDisjoint()</a>.</p>

<p>Referenced by <a class="el" href="lattice-functions_8cc_source.html#l01361">kaldi::LatticeForwardBackwardMmi()</a>, and <a class="el" href="sum-post_8cc_source.html#l00026">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                       {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(post1.size() == post2.size()); <span class="comment">// precondition.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  post-&gt;resize(post1.size());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_disjoint = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].reserve(post1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size() + post2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size());</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].insert((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end(),</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                      post1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), post1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].insert((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end(),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                      post2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), post2[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end());</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (merge) { <span class="comment">// combine and sum up entries with same transition-id.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <a class="code" href="namespacekaldi.html#a442f4c059f84e45b01905eb98484b028">MergePairVectorSumming</a>(&amp;((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>])); <span class="comment">// This sorts on</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="comment">// the transition-id merges the entries with the same</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// key (i.e. same .first element; same transition-id), and</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="comment">// gets rid of entries with zero .second element.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// just to keep them pretty, merge them.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      std::sort( (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end() );</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__posterior__group.html#ga48db127ef5d5d1fdb4dd46b22eb4739d">PosteriorEntriesAreDisjoint</a>(post1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>], post2[i])) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      num_disjoint++;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      <span class="keywordflow">if</span> (drop_frames)</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">return</span> num_disjoint;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="ttc" id="group__posterior__group_html_ga48db127ef5d5d1fdb4dd46b22eb4739d"><div class="ttname"><a href="group__posterior__group.html#ga48db127ef5d5d1fdb4dd46b22eb4739d">kaldi::PosteriorEntriesAreDisjoint</a></div><div class="ttdeci">bool PosteriorEntriesAreDisjoint(const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;post_elem1, const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;post_elem2)</div><div class="ttdoc">Returns true if the two lists of pairs have no common .first element. </div><div class="ttdef"><b>Definition:</b> <a href="posterior_8cc_source.html#l00245">posterior.cc:245</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="namespacekaldi_html_a442f4c059f84e45b01905eb98484b028"><div class="ttname"><a href="namespacekaldi.html#a442f4c059f84e45b01905eb98484b028">kaldi::MergePairVectorSumming</a></div><div class="ttdeci">void MergePairVectorSumming(std::vector&lt; std::pair&lt; I, F &gt; &gt; *vec)</div><div class="ttdoc">For a vector of pair&lt;I, F&gt; where I is an integer and F a floating-point or integer type...</div><div class="ttdef"><b>Definition:</b> <a href="stl-utils_8h_source.html#l00302">stl-utils.h:302</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga48db127ef5d5d1fdb4dd46b22eb4739d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool PosteriorEntriesAreDisjoint </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>post_elem1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>post_elem2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true if the two lists of pairs have no common .first element. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00245">245</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="posterior_8cc_source.html#l00261">kaldi::MergePosteriors()</a>.</p>
<div class="fragment"><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                                            {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  unordered_set&lt;int32&gt; set1;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post_elem1.size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) set1.insert(post_elem1[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].first);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; post_elem2.size(); i++)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (set1.count(post_elem2[i].first) != 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// The sets are disjoint.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9b4511714e0765b532809029aa37f39e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ReadPosterior </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stand-alone function for reading a Posterior. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00063">63</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="text-utils_8h_source.html#l00114">kaldi::ConvertStringToInteger()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="io-funcs-inl_8h_source.html#l00054">kaldi::ReadBasicType()</a>.</p>

<p>Referenced by <a class="el" href="posterior_8cc_source.html#l00138">PosteriorHolder::Read()</a>, and <a class="el" href="posterior-test_8cc_source.html#l00054">kaldi::TestPosteriorIo()</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                                 {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  post-&gt;clear();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (binary) {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> sz;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, <span class="keyword">true</span>, &amp;sz);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (sz &lt; 0 || sz &gt; 10000000)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Reading posterior: got negative or improbably large size&quot;</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                &lt;&lt; sz;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    post-&gt;resize(sz);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">for</span> (Posterior::iterator iter = post-&gt;begin(); iter != post-&gt;end(); ++iter) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> sz2;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, <span class="keyword">true</span>, &amp;sz2);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">if</span> (sz2 &lt; 0)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Reading posteriors: got negative size&quot;</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      iter-&gt;resize(sz2);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt;::iterator iter2=iter-&gt;begin();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;           iter2 != iter-&gt;end();</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;           iter2++) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, <span class="keyword">true</span>, &amp;(iter2-&gt;first));</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">ReadBasicType</a>(is, <span class="keyword">true</span>, &amp;(iter2-&gt;second));</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;      }</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    std::string line;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    getline(is, line);  <span class="comment">// This will discard the \n, if present.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                        <span class="comment">// The Posterior is terminated by a newlinhe.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keywordflow">if</span> (is.fail())</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;holder of Posterior: error reading line &quot;</span> &lt;&lt; (is.eof() ? <span class="stringliteral">&quot;[eof]&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    std::istringstream line_is(line);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      std::string str;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      line_is &gt;&gt; std::ws;  <span class="comment">// eat up whitespace.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">if</span> (line_is.eof()) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;      line_is &gt;&gt; str;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;      <span class="keywordflow">if</span> (str != <span class="stringliteral">&quot;[&quot;</span>) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> str_int;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// if str is an integer, we can give a slightly more concrete suggestion</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// of what might have gone wrong.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Reading Posterior object: expecting [, got &#39;&quot;</span> &lt;&lt; str</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                  &lt;&lt; (<a class="code" href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">ConvertStringToInteger</a>(str, &amp;str_int) ?</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                      <span class="stringliteral">&quot;&#39;: did you provide alignments instead of posteriors?&quot;</span> :</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                      <span class="stringliteral">&quot;&#39;.&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      }</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; this_vec;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">while</span> (1) {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        line_is &gt;&gt; std::ws;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keywordflow">if</span> (line_is.peek() == <span class="charliteral">&#39;]&#39;</span>) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          line_is.get();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>; <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> p;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        line_is &gt;&gt; i &gt;&gt; p;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">if</span> (line_is.fail())</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Error reading Posterior object (could not get data after \&quot;[\&quot;);&quot;</span>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        this_vec.push_back(std::make_pair(i, p));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      post-&gt;push_back(this_vec);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_a39eb3f7ce5fab6dbbcb396b3f8e196f4"><div class="ttname"><a href="namespacekaldi.html#a39eb3f7ce5fab6dbbcb396b3f8e196f4">kaldi::ConvertStringToInteger</a></div><div class="ttdeci">bool ConvertStringToInteger(const std::string &amp;str, Int *out)</div><div class="ttdoc">Converts a string into an integer via strtoll and returns false if there was any kind of problem (i...</div><div class="ttdef"><b>Definition:</b> <a href="text-utils_8h_source.html#l00114">text-utils.h:114</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga1bd1af0ef712b76f2332febcec8d095a"><div class="ttname"><a href="group__io__funcs__basic.html#ga1bd1af0ef712b76f2332febcec8d095a">kaldi::ReadBasicType</a></div><div class="ttdeci">void ReadBasicType(std::istream &amp;is, bool binary, T *t)</div><div class="ttdoc">ReadBasicType is the name of the read function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00054">io-funcs-inl.h:54</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga6fc6689ac2f9cb9e12f14aa1c10687c5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ScalePosterior </td>
          <td>(</td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Scales the BaseFloat (weight) element in the posterior entries. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00221">221</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>.</p>

<p>Referenced by <a class="el" href="nnet-example-functions_8cc_source.html#l00838">kaldi::nnet2::ExampleToPdfPost()</a>, <a class="el" href="nnet-compute-discriminative_8cc_source.html#l00178">NnetDiscriminativeUpdater::LatticeComputations()</a>, <a class="el" href="lattice-functions_8cc_source.html#l01361">kaldi::LatticeForwardBackwardMmi()</a>, <a class="el" href="copy-post_8cc_source.html#l00026">main()</a>, and <a class="el" href="ivector-extract_8cc_source.html#l00092">kaldi::RunPerSpeaker()</a>.</p>
<div class="fragment"><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                                      {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> (scale == 1.0) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (scale == 0.0) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].clear();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second *= scale;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9383616f3bcf8a97e3f6aeec32f829ca"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SortPosteriorByPdfs </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>tmodel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sorts posterior entries so that transition-ids with same pdf-id are next to each other. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00317">317</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="sgmm2-post-to-gpost_8cc_source.html#l00031">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                          {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  ComparePosteriorByPdfs compare(tmodel);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    sort((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].begin(), (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].end(), compare);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadf06e716aac0f922f02993c5204c78ec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BaseFloat TotalPosterior </td>
          <td>(</td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the total of all the weights in "post". </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00233">233</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>.</p>

<p>Referenced by <a class="el" href="fgmm-global-acc-stats-post_8cc_source.html#l00032">main()</a>, and <a class="el" href="ivector-extract_8cc_source.html#l00064">IvectorExtractTask::~IvectorExtractTask()</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                                {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordtype">double</span> sum =  0.0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="keywordtype">size_t</span> T = post.size();</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> t = 0; t &lt; T; t++) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">size_t</span> I = post[t].size();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; I; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      sum += post[t][<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga320b770e2ff164f8384f50ca1bfdd9f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BaseFloat VectorToPosteriorEntry </td>
          <td>(</td>
          <td class="paramtype">const VectorBase&lt; BaseFloat &gt; &amp;&#160;</td>
          <td class="paramname"><em>log_likes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32&#160;</td>
          <td class="paramname"><em>num_gselect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>min_post</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::pair&lt; int32, BaseFloat &gt; &gt; *&#160;</td>
          <td class="paramname"><em>post_entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Given a vector of log-likelihoods (typically of Gaussians in a GMM but could be of pdf-ids), a number gselect &gt;= 1 and a minimum posterior 0 &lt;= min_post &lt; 1, it gets the posterior for each element of log-likes by applying Softmax(), then prunes the posteriors using "gselect" and "min_post" (keeping at least one), and outputs the result into "post_entry", sorted from greatest to least posterior. </p>
<p>Returns the total log-likelihood (the output of calling ApplySoftMax() on a copy of log_likes). </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00444">444</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="kaldi-vector_8cc_source.html#l00840">VectorBase&lt; Real &gt;::ApplySoftMax()</a>, <a class="el" href="kaldi-vector_8h_source.html#l00059">VectorBase&lt; Real &gt;::Dim()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, and <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>.</p>

<p>Referenced by <a class="el" href="gmm-global-get-post_8cc_source.html#l00027">main()</a>, and <a class="el" href="posterior-test_8cc_source.html#l00026">kaldi::TestVectorToPosteriorEntry()</a>.</p>
<div class="fragment"><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                                                       {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_gselect &gt; 0 &amp;&amp; min_post &gt;= 0 &amp;&amp; min_post &lt; 1.0);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="comment">// we name num_gauss assuming each entry in log_likes represents a Gaussian;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">// it doesn&#39;t matter if they don&#39;t.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> num_gauss = log_likes.<a class="code" href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">Dim</a>();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(num_gauss &gt; 0);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordflow">if</span> (num_gselect &gt; num_gauss)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    num_gselect = num_gauss;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  Vector&lt;BaseFloat&gt; log_likes_normalized(log_likes);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> ans = log_likes_normalized.ApplySoftMax();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; temp_post(num_gauss);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> g = 0; g &lt; num_gauss; g++)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    temp_post[g] = std::pair&lt;int32, BaseFloat&gt;(g, log_likes_normalized(g));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  CompareReverseSecond compare;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="comment">// Sort in decreasing order on posterior.  For efficiency we</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// first do nth_element and then sort, as we only need the part we&#39;re</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">// going to output, to be sorted.</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  std::nth_element(temp_post.begin(),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                   temp_post.begin() + num_gselect, temp_post.end(),</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                   compare);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  std::sort(temp_post.begin(), temp_post.begin() + num_gselect,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            compare);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  post_entry-&gt;clear();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  post_entry-&gt;insert(post_entry-&gt;end(),</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                     temp_post.begin(), temp_post.begin() + num_gselect);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keywordflow">while</span> (post_entry-&gt;size() &gt; 1 &amp;&amp; post_entry-&gt;back().second &lt; min_post)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    post_entry-&gt;pop_back();  </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Now renormalize to sum to one after pruning.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> tot = 0.0;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="keywordtype">size_t</span> size = post_entry-&gt;size();</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    tot += (*post_entry)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> inv_tot = 1.0 / tot;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; size; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    (*post_entry)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].second *= inv_tot;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="keywordflow">return</span> ans;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;}</div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
<div class="ttc" id="classkaldi_1_1VectorBase_html_ac22929ffa93fd50a886e150013ed81fe"><div class="ttname"><a href="classkaldi_1_1VectorBase.html#ac22929ffa93fd50a886e150013ed81fe">kaldi::VectorBase::Dim</a></div><div class="ttdeci">MatrixIndexT Dim() const </div><div class="ttdoc">Returns the dimension of the vector. </div><div class="ttdef"><b>Definition:</b> <a href="kaldi-vector_8h_source.html#l00059">kaldi-vector.h:59</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf0c45742af960895b39f12ede42aca35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WeightSilencePost </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ConstIntegerSet&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>silence_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>silence_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Weight any silence phones in the posterior (i.e. </p>
<p>any phones in the set "silence_set" by scale "silence_scale". The interface was changed in Feb 2014 to do the modification "in-place" rather than having separate input and output. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00378">378</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="const-integer-set-inl_8h_source.html#l00062">ConstIntegerSet&lt; I &gt;::count()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, and <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>.</p>

<p>Referenced by <a class="el" href="weight-silence-post_8cc_source.html#l00029">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                        {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; this_post;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    this_post.reserve((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;          phone = trans_model.TransitionIdToPhone(tid);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> weight = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      <span class="keywordflow">if</span> (silence_set.count(phone) != 0) {  <span class="comment">// is a silence.</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (silence_scale != 0.0)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;          this_post.push_back(std::make_pair(tid, weight*silence_scale));</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        this_post.push_back(std::make_pair(tid, weight));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].swap(this_post);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga0dfbba277ea6654cc320245091f4cf11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WeightSilencePostDistributed </td>
          <td>(</td>
          <td class="paramtype">const TransitionModel &amp;&#160;</td>
          <td class="paramname"><em>trans_model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ConstIntegerSet&lt; int32 &gt; &amp;&#160;</td>
          <td class="paramname"><em>silence_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BaseFloat&#160;</td>
          <td class="paramname"><em>silence_scale</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Posterior *&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is similar to WeightSilencePost, except that on each frame it works out the amount by which the overall posterior would be reduced, and scales down everything on that frame by the same amount. </p>
<p>It has the effect that frames that are mostly silence get down-weighted. The interface was changed in Feb 2014 to do the modification "in-place" rather than having separate input and output. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00401">401</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="const-integer-set-inl_8h_source.html#l00062">ConstIntegerSet&lt; I &gt;::count()</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::i</a>, <a class="el" href="mikolov-rnnlm-lib_8cc_source.html#l00066">rnnlm::j</a>, <a class="el" href="kaldi-error_8h_source.html#l00143">KALDI_ASSERT</a>, and <a class="el" href="transition-model_8cc_source.html#l00642">TransitionModel::TransitionIdToPhone()</a>.</p>

<p>Referenced by <a class="el" href="weight-silence-post_8cc_source.html#l00029">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                                                   {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; post-&gt;size(); <a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>++) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt; this_post;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    this_post.reserve((*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size());</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> sil_weight = 0.0, nonsil_weight = 0.0;   </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          phone = trans_model.TransitionIdToPhone(tid);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> weight = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> (silence_set.count(phone) != 0) sil_weight += weight;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">else</span> nonsil_weight += weight;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a>(sil_weight &gt;= 0.0 &amp;&amp; nonsil_weight &gt;= 0.0); <span class="comment">// This &quot;distributed&quot;</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// weighting approach doesn&#39;t make sense if we have negative weights.</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (sil_weight + nonsil_weight == 0.0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> frame_scale = (sil_weight * silence_scale + nonsil_weight) /</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                            (sil_weight + nonsil_weight);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (frame_scale != 0.0) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> = 0; <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a> &lt; (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].size(); <a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>++) {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> tid = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].first;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <a class="code" href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">BaseFloat</a> weight = (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>][<a class="code" href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">j</a>].second;    </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        this_post.push_back(std::make_pair(tid, weight * frame_scale));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    (*post)[<a class="code" href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">i</a>].swap(this_post);    </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="ttc" id="namespacernnlm_html_a37d972ae0b47b9099e30983131d31916"><div class="ttname"><a href="namespacernnlm.html#a37d972ae0b47b9099e30983131d31916">rnnlm::j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="namespacekaldi_html_aa66ff8367094543664b3b6a13d77c139"><div class="ttname"><a href="namespacekaldi.html#aa66ff8367094543664b3b6a13d77c139">kaldi::BaseFloat</a></div><div class="ttdeci">float BaseFloat</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00029">kaldi-types.h:29</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="namespacernnlm_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="namespacernnlm.html#acb559820d9ca11295b4500f179ef6392">rnnlm::i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="mikolov-rnnlm-lib_8cc_source.html#l00066">mikolov-rnnlm-lib.cc:66</a></div></div>
<div class="ttc" id="group__error__group_html_gad5710173d69cddcda4fa21ded3c77f16"><div class="ttname"><a href="group__error__group.html#gad5710173d69cddcda4fa21ded3c77f16">KALDI_ASSERT</a></div><div class="ttdeci">#define KALDI_ASSERT(cond)</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00143">kaldi-error.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae2fa7dff89a0474b1b0f4e66c9b89c9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WritePosterior </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>binary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Posterior &amp;&#160;</td>
          <td class="paramname"><em>post</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stand-alone function for writing a Posterior. </p>

<p>Definition at line <a class="el" href="posterior_8cc_source.html#l00031">31</a> of file <a class="el" href="posterior_8cc_source.html">posterior.cc</a>.</p>

<p>References <a class="el" href="kaldi-error_8h_source.html#l00160">KALDI_ERR</a>, and <a class="el" href="io-funcs-inl_8h_source.html#l00033">kaldi::WriteBasicType()</a>.</p>

<p>Referenced by <a class="el" href="posterior-test_8cc_source.html#l00054">kaldi::TestPosteriorIo()</a>, and <a class="el" href="posterior_8cc_source.html#l00126">PosteriorHolder::Write()</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                                                        {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">if</span> (binary) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> sz = post.size();</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, sz);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">for</span> (Posterior::const_iterator iter = post.begin(); iter != post.end(); ++iter) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">int32</a> sz2 = iter-&gt;size();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, sz2);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt;::const_iterator</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;               iter2 = iter-&gt;begin(); iter2 != iter-&gt;end(); ++iter2) {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, iter2-&gt;first);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <a class="code" href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">WriteBasicType</a>(os, binary, iter2-&gt;second);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  } <span class="keywordflow">else</span> {  <span class="comment">// In text-mode, choose a human-friendly, script-friendly format.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// format is [ 1235 0.6 12 0.4 ] [ 34 1.0 ] ...</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// We could have used the same code as in the binary case above,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// but this would have resulted in less readable output.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keywordflow">for</span> (Posterior::const_iterator iter = post.begin(); iter != post.end(); ++iter) {</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;[ &quot;</span>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;      <span class="keywordflow">for</span> (std::vector&lt;std::pair&lt;int32, BaseFloat&gt; &gt;::const_iterator iter2=iter-&gt;begin();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;           iter2 != iter-&gt;end();</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;           iter2++) {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        os &lt;&lt; iter2-&gt;first &lt;&lt; <span class="charliteral">&#39; &#39;</span> &lt;&lt; iter2-&gt;second &lt;&lt; <span class="charliteral">&#39; &#39;</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;] &quot;</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;  <span class="comment">// newline terminates the Posterior.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (!os.good())</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a> &lt;&lt; <span class="stringliteral">&quot;Output stream error writing Posterior.&quot;</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="ttc" id="group__error__group_html_ga0251fa005e2fdb1dcc6e24f06afe3b1f"><div class="ttname"><a href="group__error__group.html#ga0251fa005e2fdb1dcc6e24f06afe3b1f">KALDI_ERR</a></div><div class="ttdeci">#define KALDI_ERR</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-error_8h_source.html#l00160">kaldi-error.h:160</a></div></div>
<div class="ttc" id="namespacekaldi_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="namespacekaldi.html#ab7903878916593daecbeb95b98115ab0">kaldi::int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="kaldi-types_8h_source.html#l00047">kaldi-types.h:47</a></div></div>
<div class="ttc" id="group__io__funcs__basic_html_ga108506a9aabafd9006926aa1b47617da"><div class="ttname"><a href="group__io__funcs__basic.html#ga108506a9aabafd9006926aa1b47617da">kaldi::WriteBasicType</a></div><div class="ttdeci">void WriteBasicType(std::ostream &amp;os, bool binary, T t)</div><div class="ttdoc">WriteBasicType is the name of the write function for bool, integer types, and floating-point types...</div><div class="ttdef"><b>Definition:</b> <a href="io-funcs-inl_8h_source.html#l00033">io-funcs-inl.h:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Apr 28 2016 15:42:39 for Kaldi by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
